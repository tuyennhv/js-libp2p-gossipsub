(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PGossipsub=(()=>{var pd=Object.create;var ts=Object.defineProperty;var dd=Object.getOwnPropertyDescriptor;var gd=Object.getOwnPropertyNames;var yd=Object.getPrototypeOf,md=Object.prototype.hasOwnProperty;var D=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ve=(t,e)=>{for(var r in e)ts(t,r,{get:e[r],enumerable:!0})},pu=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of gd(e))!md.call(t,i)&&i!==r&&ts(t,i,{get:()=>e[i],enumerable:!(n=dd(e,i))||n.enumerable});return t};var ae=(t,e,r)=>(r=t!=null?pd(yd(t)):{},pu(e||!t||!t.__esModule?ts(r,"default",{value:t,enumerable:!0}):r,t)),vd=t=>pu(ts({},"__esModule",{value:!0}),t);var qu=D((lw,Ku)=>{var Cn=1e3,Rn=Cn*60,Pn=Rn*60,$r=Pn*24,Rg=$r*7,Pg=$r*365.25;Ku.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return kg(t);if(r==="number"&&isFinite(t))return e.long?Mg(t):Dg(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function kg(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Pg;case"weeks":case"week":case"w":return r*Rg;case"days":case"day":case"d":return r*$r;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Pn;case"minutes":case"minute":case"mins":case"min":case"m":return r*Rn;case"seconds":case"second":case"secs":case"sec":case"s":return r*Cn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Dg(t){var e=Math.abs(t);return e>=$r?Math.round(t/$r)+"d":e>=Pn?Math.round(t/Pn)+"h":e>=Rn?Math.round(t/Rn)+"m":e>=Cn?Math.round(t/Cn)+"s":t+"ms"}function Mg(t){var e=Math.abs(t);return e>=$r?is(t,e,$r,"day"):e>=Pn?is(t,e,Pn,"hour"):e>=Rn?is(t,e,Rn,"minute"):e>=Cn?is(t,e,Cn,"second"):t+" ms"}function is(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var zu=D((pw,Vu)=>{function Ng(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=qu(),r.destroy=u,Object.keys(t).forEach(f=>{r[f]=t[f]}),r.names=[],r.skips=[],r.formatters={};function e(f){let h=0;for(let l=0;l<f.length;l++)h=(h<<5)-h+f.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(f){let h,l=null,d,p;function g(...y){if(!g.enabled)return;let v=g,x=Number(new Date),A=x-(h||x);v.diff=A,v.prev=h,v.curr=x,h=x,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let _=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(S,P)=>{if(S==="%%")return"%";_++;let O=r.formatters[P];if(typeof O=="function"){let K=y[_];S=O.call(v,K),y.splice(_,1),_--}return S}),r.formatArgs.call(v,y),(v.log||r.log).apply(v,y)}return g.namespace=f,g.useColors=r.useColors(),g.color=r.selectColor(f),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(f)),p),set:y=>{l=y}}),typeof r.init=="function"&&r.init(g),g}function n(f,h){let l=r(this.namespace+(typeof h>"u"?":":h)+f);return l.log=this.log,l}function i(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let h,l=(typeof f=="string"?f:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(f=l[h].replace(/\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(f))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Vu.exports=Ng});var Gu=D((st,ss)=>{st.formatArgs=Og;st.save=Fg;st.load=Ug;st.useColors=Lg;st.storage=Kg();st.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();st.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Lg(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Og(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+ss.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}st.log=console.debug||console.log||(()=>{});function Fg(t){try{t?st.storage.setItem("debug",t):st.storage.removeItem("debug")}catch{}}function Ug(){let t;try{t=st.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Kg(){try{return localStorage}catch{}}ss.exports=zu()(st);var{formatters:qg}=ss.exports;qg.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var ta=D((Ew,$u)=>{"use strict";$u.exports=zg;function zg(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(f){if(s)if(s=!1,f)c(f);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var Yu=D(Qu=>{"use strict";var us=Qu;us.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var kn=new Array(64),Ju=new Array(123);for(St=0;St<64;)Ju[kn[St]=St<26?St+65:St<52?St+71:St<62?St-4:St-59|43]=St++;var St;us.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var u=e[r++];switch(a){case 0:s[o++]=kn[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=kn[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=kn[c|u>>6],s[o++]=kn[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=kn[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Zu="invalid encoding";us.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=Ju[c])===void 0)throw Error(Zu);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Zu);return n-i};us.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var ju=D((Aw,Xu)=>{"use strict";Xu.exports=fs;function fs(){this._listeners={}}fs.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};fs.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};fs.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var af=D((Iw,of)=>{"use strict";of.exports=ef(ef);function ef(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,u,f){e[0]=c,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3]}function s(c,u,f){e[0]=c,u[f]=r[3],u[f+1]=r[2],u[f+2]=r[1],u[f+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,tf),t.writeFloatBE=e.bind(null,rf);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,nf),t.readFloatBE=r.bind(null,sf)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,u,f){e[0]=c,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3],u[f+4]=r[4],u[f+5]=r[5],u[f+6]=r[6],u[f+7]=r[7]}function s(c,u,f){e[0]=c,u[f]=r[7],u[f+1]=r[6],u[f+2]=r[5],u[f+3]=r[4],u[f+4]=r[3],u[f+5]=r[2],u[f+6]=r[1],u[f+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+s);else{var f;if(o<22250738585072014e-324)f=o/5e-324,n(f>>>0,a,c+i),n((u<<31|f/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),f=o*Math.pow(2,-h),n(f*4503599627370496>>>0,a,c+i),n((u<<31|h+1023<<20|f*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,tf,0,4),t.writeDoubleBE=e.bind(null,rf,4,0);function r(n,i,s,o,a){var c=n(o,a+i),u=n(o,a+s),f=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+c;return h===2047?l?NaN:f*(1/0):h===0?f*5e-324*l:f*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,nf,0,4),t.readDoubleBE=r.bind(null,sf,4,0)}(),t}function tf(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function rf(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function nf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function sf(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var ra=D((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var uf=D(cf=>{"use strict";var na=cf;na.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};na.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};na.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var hf=D((Bw,ff)=>{"use strict";ff.exports=Gg;function Gg(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return t(c);o+c>n&&(s=t(n),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var pf=D((Cw,lf)=>{"use strict";lf.exports=De;var yi=Et();function De(t,e){this.lo=t>>>0,this.hi=e>>>0}var Zr=De.zero=new De(0,0);Zr.toNumber=function(){return 0};Zr.zzEncode=Zr.zzDecode=function(){return this};Zr.length=function(){return 1};var Hg=De.zeroHash="\0\0\0\0\0\0\0\0";De.fromNumber=function(e){if(e===0)return Zr;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new De(n,i)};De.from=function(e){if(typeof e=="number")return De.fromNumber(e);if(yi.isString(e))if(yi.Long)e=yi.Long.fromString(e);else return De.fromNumber(parseInt(e,10));return e.low||e.high?new De(e.low>>>0,e.high>>>0):Zr};De.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};De.prototype.toLong=function(e){return yi.Long?new yi.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Er=String.prototype.charCodeAt;De.fromHash=function(e){return e===Hg?Zr:new De((Er.call(e,0)|Er.call(e,1)<<8|Er.call(e,2)<<16|Er.call(e,3)<<24)>>>0,(Er.call(e,4)|Er.call(e,5)<<8|Er.call(e,6)<<16|Er.call(e,7)<<24)>>>0)};De.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};De.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};De.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};De.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Et=D(ia=>{"use strict";var U=ia;U.asPromise=ta();U.base64=Yu();U.EventEmitter=ju();U.float=af();U.inquire=ra();U.utf8=uf();U.pool=hf();U.LongBits=pf();U.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);U.global=U.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||ia;U.emptyArray=Object.freeze?Object.freeze([]):[];U.emptyObject=Object.freeze?Object.freeze({}):{};U.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};U.isString=function(e){return typeof e=="string"||e instanceof String};U.isObject=function(e){return e&&typeof e=="object"};U.isset=U.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};U.Buffer=function(){try{var t=U.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();U._Buffer_from=null;U._Buffer_allocUnsafe=null;U.newBuffer=function(e){return typeof e=="number"?U.Buffer?U._Buffer_allocUnsafe(e):new U.Array(e):U.Buffer?U._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};U.Array=typeof Uint8Array<"u"?Uint8Array:Array;U.Long=U.global.dcodeIO&&U.global.dcodeIO.Long||U.global.Long||U.inquire("long");U.key2Re=/^true|false|0|1$/;U.key32Re=/^-?(?:0|[1-9][0-9]*)$/;U.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;U.longToHash=function(e){return e?U.LongBits.from(e).toHash():U.LongBits.zeroHash};U.longFromHash=function(e,r){var n=U.LongBits.fromHash(e);return U.Long?U.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function df(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}U.merge=df;U.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function gf(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&df(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}U.newError=gf;U.ProtocolError=gf("ProtocolError");U.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};U.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};U.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};U._configure=function(){var t=U.Buffer;if(!t){U._Buffer_from=U._Buffer_allocUnsafe=null;return}U._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},U._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var vi=D((Pw,bf)=>{"use strict";bf.exports=re;var pt=Et(),sa,hs=pt.LongBits,yf=pt.base64,mf=pt.utf8;function mi(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function aa(){}function Wg(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function re(){this.len=0,this.head=new mi(aa,0,0),this.tail=this.head,this.states=null}var vf=function(){return pt.Buffer?function(){return(re.create=function(){return new sa})()}:function(){return new re}};re.create=vf();re.alloc=function(e){return new pt.Array(e)};pt.Array!==Array&&(re.alloc=pt.pool(re.alloc,pt.Array.prototype.subarray));re.prototype._push=function(e,r,n){return this.tail=this.tail.next=new mi(e,r,n),this.len+=r,this};function ca(t,e,r){e[r]=t&255}function $g(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function ua(t,e){this.len=t,this.next=void 0,this.val=e}ua.prototype=Object.create(mi.prototype);ua.prototype.fn=$g;re.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ua((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};re.prototype.int32=function(e){return e<0?this._push(fa,10,hs.fromNumber(e)):this.uint32(e)};re.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function fa(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}re.prototype.uint64=function(e){var r=hs.from(e);return this._push(fa,r.length(),r)};re.prototype.int64=re.prototype.uint64;re.prototype.sint64=function(e){var r=hs.from(e).zzEncode();return this._push(fa,r.length(),r)};re.prototype.bool=function(e){return this._push(ca,1,e?1:0)};function oa(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}re.prototype.fixed32=function(e){return this._push(oa,4,e>>>0)};re.prototype.sfixed32=re.prototype.fixed32;re.prototype.fixed64=function(e){var r=hs.from(e);return this._push(oa,4,r.lo)._push(oa,4,r.hi)};re.prototype.sfixed64=re.prototype.fixed64;re.prototype.float=function(e){return this._push(pt.float.writeFloatLE,4,e)};re.prototype.double=function(e){return this._push(pt.float.writeDoubleLE,8,e)};var Zg=pt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};re.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(ca,1,0);if(pt.isString(e)){var n=re.alloc(r=yf.length(e));yf.decode(e,n,0),e=n}return this.uint32(r)._push(Zg,r,e)};re.prototype.string=function(e){var r=mf.length(e);return r?this.uint32(r)._push(mf.write,r,e):this._push(ca,1,0)};re.prototype.fork=function(){return this.states=new Wg(this),this.head=this.tail=new mi(aa,0,0),this.len=0,this};re.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new mi(aa,0,0),this.len=0),this};re.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};re.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};re._configure=function(t){sa=t,re.create=vf(),sa._configure()}});var ha=D((kw,wf)=>{"use strict";wf.exports=Ft;var xf=vi();(Ft.prototype=Object.create(xf.prototype)).constructor=Ft;var _r=Et();function Ft(){xf.call(this)}Ft._configure=function(){Ft.alloc=_r._Buffer_allocUnsafe,Ft.writeBytesBuffer=_r.Buffer&&_r.Buffer.prototype instanceof Uint8Array&&_r.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Ft.prototype.bytes=function(e){_r.isString(e)&&(e=_r._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Ft.writeBytesBuffer,r,e),this};function Jg(t,e,r){t.length<40?_r.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Ft.prototype.string=function(e){var r=_r.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Jg,r,e),this};Ft._configure()});var bi=D((Dw,If)=>{"use strict";If.exports=Te;var Ut=Et(),pa,_f=Ut.LongBits,Qg=Ut.utf8;function _t(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Te(t){this.buf=t,this.pos=0,this.len=t.length}var Sf=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Te(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Te(e);throw Error("illegal buffer")},Af=function(){return Ut.Buffer?function(r){return(Te.create=function(i){return Ut.Buffer.isBuffer(i)?new pa(i):Sf(i)})(r)}:Sf};Te.create=Af();Te.prototype._slice=Ut.Array.prototype.subarray||Ut.Array.prototype.slice;Te.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,_t(this,10);return e}}();Te.prototype.int32=function(){return this.uint32()|0};Te.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function la(){var t=new _f(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw _t(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw _t(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Te.prototype.bool=function(){return this.uint32()!==0};function ls(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Te.prototype.fixed32=function(){if(this.pos+4>this.len)throw _t(this,4);return ls(this.buf,this.pos+=4)};Te.prototype.sfixed32=function(){if(this.pos+4>this.len)throw _t(this,4);return ls(this.buf,this.pos+=4)|0};function Ef(){if(this.pos+8>this.len)throw _t(this,8);return new _f(ls(this.buf,this.pos+=4),ls(this.buf,this.pos+=4))}Te.prototype.float=function(){if(this.pos+4>this.len)throw _t(this,4);var e=Ut.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Te.prototype.double=function(){if(this.pos+8>this.len)throw _t(this,4);var e=Ut.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Te.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw _t(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Te.prototype.string=function(){var e=this.bytes();return Qg.read(e,0,e.length)};Te.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw _t(this,e);this.pos+=e}else do if(this.pos>=this.len)throw _t(this);while(this.buf[this.pos++]&128);return this};Te.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Te._configure=function(t){pa=t,Te.create=Af(),pa._configure();var e=Ut.Long?"toLong":"toNumber";Ut.merge(Te.prototype,{int64:function(){return la.call(this)[e](!1)},uint64:function(){return la.call(this)[e](!0)},sint64:function(){return la.call(this).zzDecode()[e](!1)},fixed64:function(){return Ef.call(this)[e](!0)},sfixed64:function(){return Ef.call(this)[e](!1)}})}});var da=D((Mw,Cf)=>{"use strict";Cf.exports=Jr;var Bf=bi();(Jr.prototype=Object.create(Bf.prototype)).constructor=Jr;var Tf=Et();function Jr(t){Bf.call(this,t)}Jr._configure=function(){Tf.Buffer&&(Jr.prototype._slice=Tf.Buffer.prototype.slice)};Jr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Jr._configure()});var Pf=D((Nw,Rf)=>{"use strict";Rf.exports=xi;var ga=Et();(xi.prototype=Object.create(ga.EventEmitter.prototype)).constructor=xi;function xi(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");ga.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!r}xi.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return ga.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(f){return o.emit("error",f,e),s(f)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};xi.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var ya=D(kf=>{"use strict";var Yg=kf;Yg.Service=Pf()});var ma=D((Ow,Df)=>{"use strict";Df.exports={}});var Lf=D(Nf=>{"use strict";var je=Nf;je.build="minimal";je.Writer=vi();je.BufferWriter=ha();je.Reader=bi();je.BufferReader=da();je.util=Et();je.rpc=ya();je.roots=ma();je.configure=Mf;function Mf(){je.util._configure(),je.Writer._configure(je.BufferWriter),je.Reader._configure(je.BufferReader)}Mf()});var Ff=D((Uw,Of)=>{"use strict";Of.exports=va;function va(t,e){typeof t=="string"&&(e=t,t=void 0);var r=[];function n(s){if(typeof s!="string"){var o=i();if(va.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),u=new Array(a.length),f=0;f<a.length;)c[f]=a[f],u[f]=s[a[f++]];return c[f]=o,Function.apply(null,c).apply(null,u)}return Function(o)()}for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l]=arguments[++l];if(l=0,s=s.replace(/%([%dfijs])/g,function(p,g){var y=h[l++];switch(g){case"d":case"f":return String(Number(y));case"i":return String(Math.floor(y));case"j":return JSON.stringify(y);case"s":return String(y)}return"%"}),l!==h.length)throw Error("parameter count mismatch");return r.push(s),n}function i(s){return"function "+(s||e||"")+"("+(t&&t.join(",")||"")+`){
  `+r.join(`
  `)+`
}`}return n.toString=i,n}va.verbose=!1});var Kf=D((Kw,Uf)=>{"use strict";Uf.exports=wi;var Xg=ta(),jg=ra(),ba=jg("fs");function wi(t,e,r){return typeof e=="function"?(r=e,e={}):e||(e={}),r?!e.xhr&&ba&&ba.readFile?ba.readFile(t,function(i,s){return i&&typeof XMLHttpRequest<"u"?wi.xhr(t,e,r):i?r(i):r(null,e.binary?s:s.toString("utf8"))}):wi.xhr(t,e,r):Xg(wi,this,t,e)}wi.xhr=function(e,r,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return n(Error("status "+i.status));if(r.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return n(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return n(null,i.responseText)}},r.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var zf=D(Vf=>{"use strict";var wa=Vf,qf=wa.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},xa=wa.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var r=e.split("/"),n=qf(e),i="";n&&(i=r.shift()+"/");for(var s=0;s<r.length;)r[s]===".."?s>0&&r[s-1]!==".."?r.splice(--s,2):n?r.splice(s,1):++s:r[s]==="."?r.splice(s,1):++s;return i+r.join("/")};wa.resolve=function(e,r,n){return n||(r=xa(r)),qf(r)?r:(n||(e=xa(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?xa(e+"/"+r):r)}});var Qr=D(Gf=>{"use strict";var Si=Gf,ey=Me(),ty=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Ei(t,e){var r=0,n={};for(e|=0;r<t.length;)n[ty[r+e]]=t[r++];return n}Si.basic=Ei([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Si.defaults=Ei([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",ey.emptyArray,null]);Si.long=Ei([0,0,0,1,1],7);Si.mapKey=Ei([0,0,0,5,5,0,0,0,1,1,0,2],2);Si.packed=Ei([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Ar=D((zw,$f)=>{"use strict";$f.exports=dt;var ps=Yr();((dt.prototype=Object.create(ps.prototype)).constructor=dt).className="Field";var Hf=At(),Wf=Qr(),Re=Me(),Sa,ry=/^required|optional|repeated$/;dt.fromJSON=function(e,r){return new dt(e,r.id,r.type,r.rule,r.extend,r.options,r.comment)};function dt(t,e,r,n,i,s,o){if(Re.isObject(n)?(o=i,s=n,n=i=void 0):Re.isObject(i)&&(o=s,s=i,i=void 0),ps.call(this,t,s),!Re.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Re.isString(r))throw TypeError("type must be a string");if(n!==void 0&&!ry.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!Re.isString(i))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=r,this.id=e,this.extend=i||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Re.Long?Wf.long[r]!==void 0:!1,this.bytes=r==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(dt.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});dt.prototype.setOption=function(e,r,n){return e==="packed"&&(this._packed=null),ps.prototype.setOption.call(this,e,r,n)};dt.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return Re.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};dt.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=Wf.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Sa?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Hf&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Hf))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Re.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Re.base64.test(this.typeDefault)?Re.base64.decode(this.typeDefault,e=Re.newBuffer(Re.base64.length(this.typeDefault)),0):Re.utf8.write(this.typeDefault,e=Re.newBuffer(Re.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Re.emptyObject:this.repeated?this.defaultValue=Re.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Sa&&(this.parent.ctor.prototype[this.name]=this.defaultValue),ps.prototype.resolve.call(this)};dt.d=function(e,r,n,i){return typeof r=="function"?r=Re.decorateType(r).name:r&&typeof r=="object"&&(r=Re.decorateEnum(r).name),function(o,a){Re.decorateType(o.constructor).add(new dt(a,e,r,n,{default:i}))}};dt._configure=function(e){Sa=e}});var Dn=D((Gw,Qf)=>{"use strict";Qf.exports=gt;var gs=Yr();((gt.prototype=Object.create(gs.prototype)).constructor=gt).className="OneOf";var Zf=Ar(),ds=Me();function gt(t,e,r,n){if(Array.isArray(e)||(r=e,e=void 0),gs.call(this,t,r),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=n}gt.fromJSON=function(e,r){return new gt(e,r.oneof,r.options,r.comment)};gt.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return ds.toObject(["options",this.options,"oneof",this.oneof,"comment",r?this.comment:void 0])};function Jf(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}gt.prototype.add=function(e){if(!(e instanceof Zf))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,Jf(this),this};gt.prototype.remove=function(e){if(!(e instanceof Zf))throw TypeError("field must be a Field");var r=this.fieldsArray.indexOf(e);if(r<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(r,1),r=this.oneof.indexOf(e.name),r>-1&&this.oneof.splice(r,1),e.partOf=null,this};gt.prototype.onAdd=function(e){gs.prototype.onAdd.call(this,e);for(var r=this,n=0;n<this.oneof.length;++n){var i=e.get(this.oneof[n]);i&&!i.partOf&&(i.partOf=r,r.fieldsArray.push(i))}Jf(this)};gt.prototype.onRemove=function(e){for(var r=0,n;r<this.fieldsArray.length;++r)(n=this.fieldsArray[r]).parent&&n.parent.remove(n);gs.prototype.onRemove.call(this,e)};gt.d=function(){for(var e=new Array(arguments.length),r=0;r<arguments.length;)e[r]=arguments[r++];return function(i,s){ds.decorateType(i.constructor).add(new gt(s,e)),Object.defineProperty(i,s,{get:ds.oneOfGetter(e),set:ds.oneOfSetter(e)})}}});var Ln=D((Hw,eh)=>{"use strict";eh.exports=se;var Ea=Yr();((se.prototype=Object.create(Ea.prototype)).constructor=se).className="Namespace";var Yf=Ar(),ys=Me(),ny=Dn(),Mn,_i,Nn;se.fromJSON=function(e,r){return new se(e,r.options).addJSON(r.nested)};function Xf(t,e){if(t&&t.length){for(var r={},n=0;n<t.length;++n)r[t[n].name]=t[n].toJSON(e);return r}}se.arrayToJSON=Xf;se.isReservedId=function(e,r){if(e){for(var n=0;n<e.length;++n)if(typeof e[n]!="string"&&e[n][0]<=r&&e[n][1]>r)return!0}return!1};se.isReservedName=function(e,r){if(e){for(var n=0;n<e.length;++n)if(e[n]===r)return!0}return!1};function se(t,e){Ea.call(this,t,e),this.nested=void 0,this._nestedArray=null}function jf(t){return t._nestedArray=null,t}Object.defineProperty(se.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=ys.toArray(this.nested))}});se.prototype.toJSON=function(e){return ys.toObject(["options",this.options,"nested",Xf(this.nestedArray,e)])};se.prototype.addJSON=function(e){var r=this;if(e)for(var n=Object.keys(e),i=0,s;i<n.length;++i)s=e[n[i]],r.add((s.fields!==void 0?Mn.fromJSON:s.values!==void 0?Nn.fromJSON:s.methods!==void 0?_i.fromJSON:s.id!==void 0?Yf.fromJSON:se.fromJSON)(n[i],s));return this};se.prototype.get=function(e){return this.nested&&this.nested[e]||null};se.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Nn)return this.nested[e].values;throw Error("no such enum: "+e)};se.prototype.add=function(e){if(!(e instanceof Yf&&e.extend!==void 0||e instanceof Mn||e instanceof ny||e instanceof Nn||e instanceof _i||e instanceof se))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var r=this.get(e.name);if(r)if(r instanceof se&&e instanceof se&&!(r instanceof Mn||r instanceof _i)){for(var n=r.nestedArray,i=0;i<n.length;++i)e.add(n[i]);this.remove(r),this.nested||(this.nested={}),e.setOptions(r.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),jf(this)};se.prototype.remove=function(e){if(!(e instanceof Ea))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),jf(this)};se.prototype.define=function(e,r){if(ys.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var n=this;e.length>0;){var i=e.shift();if(n.nested&&n.nested[i]){if(n=n.nested[i],!(n instanceof se))throw Error("path conflicts with non-namespace objects")}else n.add(n=new se(i))}return r&&n.addJSON(r),n};se.prototype.resolveAll=function(){for(var e=this.nestedArray,r=0;r<e.length;)e[r]instanceof se?e[r++].resolveAll():e[r++].resolve();return this.resolve()};se.prototype.lookup=function(e,r,n){if(typeof r=="boolean"?(n=r,r=void 0):r&&!Array.isArray(r)&&(r=[r]),ys.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),r);var i=this.get(e[0]);if(i){if(e.length===1){if(!r||r.indexOf(i.constructor)>-1)return i}else if(i instanceof se&&(i=i.lookup(e.slice(1),r,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof se&&(i=this._nestedArray[s].lookup(e,r,!0)))return i;return this.parent===null||n?null:this.parent.lookup(e,r)};se.prototype.lookupType=function(e){var r=this.lookup(e,[Mn]);if(!r)throw Error("no such type: "+e);return r};se.prototype.lookupEnum=function(e){var r=this.lookup(e,[Nn]);if(!r)throw Error("no such Enum '"+e+"' in "+this);return r};se.prototype.lookupTypeOrEnum=function(e){var r=this.lookup(e,[Mn,Nn]);if(!r)throw Error("no such Type or Enum '"+e+"' in "+this);return r};se.prototype.lookupService=function(e){var r=this.lookup(e,[_i]);if(!r)throw Error("no such Service '"+e+"' in "+this);return r};se._configure=function(t,e,r){Mn=t,_i=e,Nn=r}});var ms=D((Ww,th)=>{"use strict";th.exports=cr;var _a=Ar();((cr.prototype=Object.create(_a.prototype)).constructor=cr).className="MapField";var iy=Qr(),Ai=Me();function cr(t,e,r,n,i,s){if(_a.call(this,t,e,n,void 0,void 0,i,s),!Ai.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}cr.fromJSON=function(e,r){return new cr(e,r.id,r.keyType,r.type,r.options,r.comment)};cr.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return Ai.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};cr.prototype.resolve=function(){if(this.resolved)return this;if(iy.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return _a.prototype.resolve.call(this)};cr.d=function(e,r,n){return typeof n=="function"?n=Ai.decorateType(n).name:n&&typeof n=="object"&&(n=Ai.decorateEnum(n).name),function(s,o){Ai.decorateType(s.constructor).add(new cr(o,e,r,n))}}});var vs=D(($w,rh)=>{"use strict";rh.exports=Xr;var Aa=Yr();((Xr.prototype=Object.create(Aa.prototype)).constructor=Xr).className="Method";var On=Me();function Xr(t,e,r,n,i,s,o,a,c){if(On.isObject(i)?(o=i,i=s=void 0):On.isObject(s)&&(o=s,s=void 0),!(e===void 0||On.isString(e)))throw TypeError("type must be a string");if(!On.isString(r))throw TypeError("requestType must be a string");if(!On.isString(n))throw TypeError("responseType must be a string");Aa.call(this,t,o),this.type=e||"rpc",this.requestType=r,this.requestStream=i?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}Xr.fromJSON=function(e,r){return new Xr(e,r.type,r.requestType,r.responseType,r.requestStream,r.responseStream,r.options,r.comment,r.parsedOptions)};Xr.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return On.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",r?this.comment:void 0,"parsedOptions",this.parsedOptions])};Xr.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Aa.prototype.resolve.call(this))}});var bs=D((Zw,ih)=>{"use strict";ih.exports=yt;var Ir=Ln();((yt.prototype=Object.create(Ir.prototype)).constructor=yt).className="Service";var Ia=vs(),Ii=Me(),sy=ya();function yt(t,e){Ir.call(this,t,e),this.methods={},this._methodsArray=null}yt.fromJSON=function(e,r){var n=new yt(e,r.options);if(r.methods)for(var i=Object.keys(r.methods),s=0;s<i.length;++s)n.add(Ia.fromJSON(i[s],r.methods[i[s]]));return r.nested&&n.addJSON(r.nested),n.comment=r.comment,n};yt.prototype.toJSON=function(e){var r=Ir.prototype.toJSON.call(this,e),n=e?!!e.keepComments:!1;return Ii.toObject(["options",r&&r.options||void 0,"methods",Ir.arrayToJSON(this.methodsArray,e)||{},"nested",r&&r.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(yt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Ii.toArray(this.methods))}});function nh(t){return t._methodsArray=null,t}yt.prototype.get=function(e){return this.methods[e]||Ir.prototype.get.call(this,e)};yt.prototype.resolveAll=function(){for(var e=this.methodsArray,r=0;r<e.length;++r)e[r].resolve();return Ir.prototype.resolve.call(this)};yt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Ia?(this.methods[e.name]=e,e.parent=this,nh(this)):Ir.prototype.add.call(this,e)};yt.prototype.remove=function(e){if(e instanceof Ia){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,nh(this)}return Ir.prototype.remove.call(this,e)};yt.prototype.create=function(e,r,n){for(var i=new sy.Service(e,r,n),s=0,o;s<this.methodsArray.length;++s){var a=Ii.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Ii.codegen(["r","c"],Ii.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var xs=D((Jw,sh)=>{"use strict";sh.exports=Kt;var oy=Et();function Kt(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)this[e[r]]=t[e[r]]}Kt.create=function(e){return this.$type.create(e)};Kt.encode=function(e,r){return this.$type.encode(e,r)};Kt.encodeDelimited=function(e,r){return this.$type.encodeDelimited(e,r)};Kt.decode=function(e){return this.$type.decode(e)};Kt.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Kt.verify=function(e){return this.$type.verify(e)};Kt.fromObject=function(e){return this.$type.fromObject(e)};Kt.toObject=function(e,r){return this.$type.toObject(e,r)};Kt.prototype.toJSON=function(){return this.$type.toObject(this,oy.toJSONOptions)}});var Ta=D((Qw,ah)=>{"use strict";ah.exports=uy;var ay=At(),ur=Qr(),oh=Me();function cy(t){return"missing required '"+t.name+"'"}function uy(t){var e=oh.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var r=0;r<t.fieldsArray.length;++r){var n=t._fieldsArray[r].resolve(),i=n.resolvedType instanceof ay?"int32":n.type,s="m"+oh.safeProp(n.name);e("case %i: {",n.id),n.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),ur.defaults[n.keyType]!==void 0?e("k=%j",ur.defaults[n.keyType]):e("k=null"),ur.defaults[i]!==void 0?e("value=%j",ur.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),ur.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",r):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),ur.long[n.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):n.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),ur.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),ur.basic[i]===void 0?e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,r):e("%s.push(r.%s())",s,i)):ur.basic[i]===void 0?e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,r):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<t._fieldsArray.length;++r){var o=t._fieldsArray[r];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",cy(o))}return e("return m")}});var Ra=D((Yw,ch)=>{"use strict";ch.exports=ly;var fy=At(),Ba=Me();function mt(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function Ca(t,e,r,n){if(e.resolvedType)if(e.resolvedType instanceof fy){t("switch(%s){",n)("default:")("return%j",mt(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)t("case %i:",e.resolvedType.values[i[s]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",r,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",n)("return%j",mt(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",mt(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',n)("return%j",mt(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',n)("return%j",mt(e,"boolean"));break;case"string":t("if(!util.isString(%s))",n)("return%j",mt(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",mt(e,"buffer"));break}return t}function hy(t,e,r){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",r)("return%j",mt(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",r)("return%j",mt(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",r)("return%j",mt(e,"boolean key"));break}return t}function ly(t){var e=Ba.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=t.oneofsArray,n={};r.length&&e("var p={}");for(var i=0;i<t.fieldsArray.length;++i){var s=t._fieldsArray[i].resolve(),o="m"+Ba.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",mt(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),hy(e,s,"k[i]"),Ca(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",mt(s,"array"))("for(var i=0;i<%s.length;++i){",o),Ca(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=Ba.safeProp(s.partOf.name);n[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),n[s.partOf.name]=1,e("p%s=1",a)}Ca(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var Da=D(fh=>{"use strict";var uh=fh,Ti=At(),qt=Me();function Pa(t,e,r,n){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof Ti){t("switch(d%s){",n);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!i&&(t("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),e.repeated||t("break"),i=!0),t("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",n,s[o[a]])("break");t("}")}else t('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var c=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",n,n);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":t('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":t("m%s=String(d%s)",n,n);break;case"bool":t("m%s=Boolean(d%s)",n,n);break}}return t}uh.fromObject=function(e){var r=e.fieldsArray,n=qt.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!r.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<r.length;++i){var s=r[i].resolve(),o=qt.safeProp(s.name);s.map?(n("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Pa(n,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Pa(n,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Ti||n("if(d%s!=null){",o),Pa(n,s,i,o),s.resolvedType instanceof Ti||n("}"))}return n("return m")};function ka(t,e,r,n){if(e.resolvedType)e.resolvedType instanceof Ti?t("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,r,n,n,r,n,n):t("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var i=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,i?"true":"",n);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:t("d%s=m%s",n,n);break}}return t}uh.toObject=function(e){var r=e.fieldsArray.slice().sort(qt.compareFieldsById);if(!r.length)return qt.codegen()("return {}");for(var n=qt.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<r.length;++a)r[a].partOf||(r[a].resolve().repeated?i:r[a].map?s:o).push(r[a]);if(i.length){for(n("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)n("d%s=[]",qt.safeProp(i[a].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),a=0;a<s.length;++a)n("d%s={}",qt.safeProp(s[a].name));n("}")}if(o.length){for(n("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],u=qt.safeProp(c.name);if(c.resolvedType instanceof Ti)n("d%s=o.enums===String?%j:%j",u,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var f="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",u,f)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")}else n("d%s=%j",u,c.typeDefault)}n("}")}var h=!1;for(a=0;a<r.length;++a){var c=r[a],l=e._fieldsArray.indexOf(c),u=qt.safeProp(c.name);c.map?(h||(h=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){"),ka(n,c,l,u+"[ks2[j]]")("}")):c.repeated?(n("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u),ka(n,c,l,u+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",u,c.name),ka(n,c,l,u),c.partOf&&n("if(o.oneofs)")("d%s=%j",qt.safeProp(c.partOf.name),c.name)),n("}")}return n("return d")}});var Ma=D(hh=>{"use strict";var py=hh,dy=xs();py[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),r=this.lookup(e);if(r){var n=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:r.encode(r.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var r="type.googleapis.com/",n="",i="";if(e&&e.json&&t.type_url&&t.value){i=t.type_url.substring(t.type_url.lastIndexOf("/")+1),n=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(t=s.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof dy){var o=t.$type.toObject(t,e),a=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return n===""&&(n=r),i=n+a,o["@type"]=i,o}return this.toObject(t,e)}}});var Es=D((eS,ph)=>{"use strict";ph.exports=pe;var It=Ln();((pe.prototype=Object.create(It.prototype)).constructor=pe).className="Type";var gy=At(),Oa=Dn(),ws=Ar(),yy=ms(),my=bs(),Na=xs(),La=bi(),vy=vi(),He=Me(),by=Fa(),xy=Ta(),wy=Ra(),lh=Da(),Sy=Ma();function pe(t,e){It.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(pe.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var r=this.fields[t[e]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=He.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=He.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=pe.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof Na||((t.prototype=new Na).constructor=t,He.merge(t.prototype,e)),t.$type=t.prototype.$type=this,He.merge(t,Na,!0),this._ctor=t;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:He.oneOfGetter(this._oneofsArray[r].oneof),set:He.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(t.prototype,n)}}});pe.generateConstructor=function(e){for(var r=He.codegen(["p"],e.name),n=0,i;n<e.fieldsArray.length;++n)(i=e._fieldsArray[n]).map?r("this%s={}",He.safeProp(i.name)):i.repeated&&r("this%s=[]",He.safeProp(i.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function Ss(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}pe.fromJSON=function(e,r){var n=new pe(e,r.options);n.extensions=r.extensions,n.reserved=r.reserved;for(var i=Object.keys(r.fields),s=0;s<i.length;++s)n.add((typeof r.fields[i[s]].keyType<"u"?yy.fromJSON:ws.fromJSON)(i[s],r.fields[i[s]]));if(r.oneofs)for(i=Object.keys(r.oneofs),s=0;s<i.length;++s)n.add(Oa.fromJSON(i[s],r.oneofs[i[s]]));if(r.nested)for(i=Object.keys(r.nested),s=0;s<i.length;++s){var o=r.nested[i[s]];n.add((o.id!==void 0?ws.fromJSON:o.fields!==void 0?pe.fromJSON:o.values!==void 0?gy.fromJSON:o.methods!==void 0?my.fromJSON:It.fromJSON)(i[s],o))}return r.extensions&&r.extensions.length&&(n.extensions=r.extensions),r.reserved&&r.reserved.length&&(n.reserved=r.reserved),r.group&&(n.group=!0),r.comment&&(n.comment=r.comment),n};pe.prototype.toJSON=function(e){var r=It.prototype.toJSON.call(this,e),n=e?!!e.keepComments:!1;return He.toObject(["options",r&&r.options||void 0,"oneofs",It.arrayToJSON(this.oneofsArray,e),"fields",It.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",r&&r.nested||void 0,"comment",n?this.comment:void 0])};pe.prototype.resolveAll=function(){for(var e=this.fieldsArray,r=0;r<e.length;)e[r++].resolve();var n=this.oneofsArray;for(r=0;r<n.length;)n[r++].resolve();return It.prototype.resolveAll.call(this)};pe.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};pe.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof ws&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),Ss(this)}return e instanceof Oa?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),Ss(this)):It.prototype.add.call(this,e)};pe.prototype.remove=function(e){if(e instanceof ws&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),Ss(this)}if(e instanceof Oa){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),Ss(this)}return It.prototype.remove.call(this,e)};pe.prototype.isReservedId=function(e){return It.isReservedId(this.reserved,e)};pe.prototype.isReservedName=function(e){return It.isReservedName(this.reserved,e)};pe.prototype.create=function(e){return new this.ctor(e)};pe.prototype.setup=function(){for(var e=this.fullName,r=[],n=0;n<this.fieldsArray.length;++n)r.push(this._fieldsArray[n].resolve().resolvedType);this.encode=by(this)({Writer:vy,types:r,util:He}),this.decode=xy(this)({Reader:La,types:r,util:He}),this.verify=wy(this)({types:r,util:He}),this.fromObject=lh.fromObject(this)({types:r,util:He}),this.toObject=lh.toObject(this)({types:r,util:He});var i=Sy[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};pe.prototype.encode=function(e,r){return this.setup().encode(e,r)};pe.prototype.encodeDelimited=function(e,r){return this.encode(e,r&&r.len?r.fork():r).ldelim()};pe.prototype.decode=function(e,r){return this.setup().decode(e,r)};pe.prototype.decodeDelimited=function(e){return e instanceof La||(e=La.create(e)),this.decode(e,e.uint32())};pe.prototype.verify=function(e){return this.setup().verify(e)};pe.prototype.fromObject=function(e){return this.setup().fromObject(e)};pe.prototype.toObject=function(e,r){return this.setup().toObject(e,r)};pe.d=function(e){return function(n){He.decorateType(n,e)}}});var Is=D((tS,vh)=>{"use strict";vh.exports=ot;var As=Ln();((ot.prototype=Object.create(As.prototype)).constructor=ot).className="Root";var Ka=Ar(),gh=At(),Ey=Dn(),Tr=Me(),yh,Ua,Bi;function ot(t){As.call(this,"",t),this.deferred=[],this.files=[]}ot.fromJSON=function(e,r){return r||(r=new ot),e.options&&r.setOptions(e.options),r.addJSON(e.nested)};ot.prototype.resolvePath=Tr.path.resolve;ot.prototype.fetch=Tr.fetch;function mh(){}ot.prototype.load=function t(e,r,n){typeof r=="function"&&(n=r,r=void 0);var i=this;if(!n)return Tr.asPromise(t,i,e,r);var s=n===mh;function o(d,p){if(n){var g=n;if(n=null,s)throw d;g(d,p)}}function a(d){var p=d.lastIndexOf("google/protobuf/");if(p>-1){var g=d.substring(p);if(g in Bi)return g}return null}function c(d,p){try{if(Tr.isString(p)&&p.charAt(0)==="{"&&(p=JSON.parse(p)),!Tr.isString(p))i.setOptions(p.options).addJSON(p.nested);else{Ua.filename=d;var g=Ua(p,i,r),y,v=0;if(g.imports)for(;v<g.imports.length;++v)(y=a(g.imports[v])||i.resolvePath(d,g.imports[v]))&&u(y);if(g.weakImports)for(v=0;v<g.weakImports.length;++v)(y=a(g.weakImports[v])||i.resolvePath(d,g.weakImports[v]))&&u(y,!0)}}catch(x){o(x)}!s&&!f&&o(null,i)}function u(d,p){if(d=a(d)||d,!(i.files.indexOf(d)>-1)){if(i.files.push(d),d in Bi){s?c(d,Bi[d]):(++f,setTimeout(function(){--f,c(d,Bi[d])}));return}if(s){var g;try{g=Tr.fs.readFileSync(d).toString("utf8")}catch(y){p||o(y);return}c(d,g)}else++f,i.fetch(d,function(y,v){if(--f,!!n){if(y){p?f||o(null,i):o(y);return}c(d,v)}})}}var f=0;Tr.isString(e)&&(e=[e]);for(var h=0,l;h<e.length;++h)(l=i.resolvePath("",e[h]))&&u(l);if(s)return i;f||o(null,i)};ot.prototype.loadSync=function(e,r){if(!Tr.isNode)throw Error("not supported");return this.load(e,r,mh)};ot.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return As.prototype.resolveAll.call(this)};var _s=/^[A-Z]/;function dh(t,e){var r=e.parent.lookup(e.extend);if(r){var n=new Ka(e.fullName,e.id,e.type,e.rule,void 0,e.options);return r.get(n.name)||(n.declaringField=e,e.extensionField=n,r.add(n)),!0}return!1}ot.prototype._handleAdd=function(e){if(e instanceof Ka)e.extend!==void 0&&!e.extensionField&&(dh(this,e)||this.deferred.push(e));else if(e instanceof gh)_s.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof Ey)){if(e instanceof yh)for(var r=0;r<this.deferred.length;)dh(this,this.deferred[r])?this.deferred.splice(r,1):++r;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);_s.test(e.name)&&(e.parent[e.name]=e)}};ot.prototype._handleRemove=function(e){if(e instanceof Ka){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var r=this.deferred.indexOf(e);r>-1&&this.deferred.splice(r,1)}}else if(e instanceof gh)_s.test(e.name)&&delete e.parent[e.name];else if(e instanceof As){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);_s.test(e.name)&&delete e.parent[e.name]}};ot._configure=function(t,e,r){yh=t,Ua=e,Bi=r}});var Me=D((rS,xh)=>{"use strict";var Be=xh.exports=Et(),bh=ma(),qa,Va;Be.codegen=Ff();Be.fetch=Kf();Be.path=zf();Be.fs=Be.inquire("fs");Be.toArray=function(e){if(e){for(var r=Object.keys(e),n=new Array(r.length),i=0;i<r.length;)n[i]=e[r[i++]];return n}return[]};Be.toObject=function(e){for(var r={},n=0;n<e.length;){var i=e[n++],s=e[n++];s!==void 0&&(r[i]=s)}return r};var _y=/\\/g,Ay=/"/g;Be.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Be.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Be.isReserved(e)?'["'+e.replace(_y,"\\\\").replace(Ay,'\\"')+'"]':"."+e};Be.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var Iy=/_([a-z])/g;Be.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(Iy,function(r,n){return n.toUpperCase()})};Be.compareFieldsById=function(e,r){return e.id-r.id};Be.decorateType=function(e,r){if(e.$type)return r&&e.$type.name!==r&&(Be.decorateRoot.remove(e.$type),e.$type.name=r,Be.decorateRoot.add(e.$type)),e.$type;qa||(qa=Es());var n=new qa(r||e.name);return Be.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var Ty=0;Be.decorateEnum=function(e){if(e.$type)return e.$type;Va||(Va=At());var r=new Va("Enum"+Ty++,e);return Be.decorateRoot.add(r),Object.defineProperty(e,"$type",{value:r,enumerable:!1}),r};Be.setProperty=function(e,r,n){function i(s,o,a){var c=o.shift();if(c==="__proto__"||c==="prototype")return s;if(o.length>0)s[c]=i(s[c]||{},o,a);else{var u=s[c];u&&(a=[].concat(u).concat(a)),s[c]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!r)throw TypeError("path must be specified");return r=r.split("."),i(e,r,n)};Object.defineProperty(Be,"decorateRoot",{get:function(){return bh.decorated||(bh.decorated=new(Is()))}})});var Yr=D((nS,wh)=>{"use strict";wh.exports=at;at.className="ReflectionObject";var Ts=Me(),Bs;function at(t,e){if(!Ts.isString(t))throw TypeError("name must be a string");if(e&&!Ts.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(at.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});at.prototype.toJSON=function(){throw Error()};at.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var r=e.root;r instanceof Bs&&r._handleAdd(this)};at.prototype.onRemove=function(e){var r=e.root;r instanceof Bs&&r._handleRemove(this),this.parent=null,this.resolved=!1};at.prototype.resolve=function(){return this.resolved?this:(this.root instanceof Bs&&(this.resolved=!0),this)};at.prototype.getOption=function(e){if(this.options)return this.options[e]};at.prototype.setOption=function(e,r,n){return(!n||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=r),this};at.prototype.setParsedOption=function(e,r,n){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(n){var s=i.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];Ts.setProperty(o,n,r)}else s={},s[e]=Ts.setProperty({},n,r),i.push(s)}else{var a={};a[e]=r,i.push(a)}return this};at.prototype.setOptions=function(e,r){if(e)for(var n=Object.keys(e),i=0;i<n.length;++i)this.setOption(n[i],e[n[i]],r);return this};at.prototype.toString=function(){var e=this.constructor.className,r=this.fullName;return r.length?e+" "+r:e};at._configure=function(t){Bs=t}});var At=D((iS,_h)=>{"use strict";_h.exports=Vt;var Sh=Yr();((Vt.prototype=Object.create(Sh.prototype)).constructor=Vt).className="Enum";var Eh=Ln(),Cs=Me();function Vt(t,e,r,n,i,s){if(Sh.call(this,t,r),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=i||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}Vt.fromJSON=function(e,r){var n=new Vt(e,r.values,r.options,r.comment,r.comments);return n.reserved=r.reserved,n};Vt.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return Cs.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",r?this.comment:void 0,"comments",r?this.comments:void 0])};Vt.prototype.add=function(e,r,n,i){if(!Cs.isString(e))throw TypeError("name must be a string");if(!Cs.isInteger(r))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(r))throw Error("id "+r+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[r]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+r+" in "+this);this.values[e]=r}else this.valuesById[this.values[e]=r]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=n||null,this};Vt.prototype.remove=function(e){if(!Cs.isString(e))throw TypeError("name must be a string");var r=this.values[e];if(r==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[r],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Vt.prototype.isReservedId=function(e){return Eh.isReservedId(this.reserved,e)};Vt.prototype.isReservedName=function(e){return Eh.isReservedName(this.reserved,e)}});var Fa=D((sS,Ih)=>{"use strict";Ih.exports=Cy;var By=At(),za=Qr(),Ga=Me();function Ah(t,e,r,n){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(e.id<<3|2)>>>0)}function Cy(t){for(var e=Ga.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),r,n,i=t.fieldsArray.slice().sort(Ga.compareFieldsById),r=0;r<i.length;++r){var s=i[r].resolve(),o=t._fieldsArray.indexOf(s),a=s.resolvedType instanceof By?"int32":s.type,c=za.basic[a];n="m"+Ga.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|za.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,n):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,n),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",n,n),s.packed&&za.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",a,n)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",n),c===void 0?Ah(e,s,o,n+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,n)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,s.name),c===void 0?Ah(e,s,o,n):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,n))}return e("return w")}});var Bh=D((oS,Th)=>{"use strict";var X=Th.exports=Lf();X.build="light";function Ry(t,e,r){return typeof e=="function"?(r=e,e=new X.Root):e||(e=new X.Root),e.load(t,r)}X.load=Ry;function Py(t,e){return e||(e=new X.Root),e.loadSync(t)}X.loadSync=Py;X.encoder=Fa();X.decoder=Ta();X.verifier=Ra();X.converter=Da();X.ReflectionObject=Yr();X.Namespace=Ln();X.Root=Is();X.Enum=At();X.Type=Es();X.Field=Ar();X.OneOf=Dn();X.MapField=ms();X.Service=bs();X.Method=vs();X.Message=xs();X.wrappers=Ma();X.types=Qr();X.util=Me();X.ReflectionObject._configure(X.Root);X.Namespace._configure(X.Type,X.Service,X.Enum);X.Root._configure(X.Type);X.Field._configure(X.Type)});var Wa=D((aS,Ph)=>{"use strict";Ph.exports=Rh;var Ha=/[\s{}=;:[\],'"()<>]/g,ky=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,Dy=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,My=/^ *[*/]+ */,Ny=/^\s*\*?\/*/,Ly=/\n/g,Oy=/\s/,Fy=/\\(.?)/g,Uy={0:"\0",r:"\r",n:`
`,t:"	"};function Ch(t){return t.replace(Fy,function(e,r){switch(r){case"\\":case"":return r;default:return Uy[r]||""}})}Rh.unescape=Ch;function Rh(t,e){t=t.toString();var r=0,n=t.length,i=1,s=0,o={},a=[],c=null;function u(_){return Error("illegal "+_+" (line "+i+")")}function f(){var _=c==="'"?Dy:ky;_.lastIndex=r-1;var w=_.exec(t);if(!w)throw u("string");return r=_.lastIndex,y(c),c=null,Ch(w[1])}function h(_){return t.charAt(_)}function l(_,w,S){var P={type:t.charAt(_++),lineEmpty:!1,leading:S},O;e?O=2:O=3;var K=_-O,$;do if(--K<0||($=t.charAt(K))===`
`){P.lineEmpty=!0;break}while($===" "||$==="	");for(var ue=t.substring(_,w).split(Ly),Q=0;Q<ue.length;++Q)ue[Q]=ue[Q].replace(e?Ny:My,"").trim();P.text=ue.join(`
`).trim(),o[i]=P,s=i}function d(_){var w=p(_),S=t.substring(_,w),P=/^\s*\/{1,2}/.test(S);return P}function p(_){for(var w=_;w<n&&h(w)!==`
`;)w++;return w}function g(){if(a.length>0)return a.shift();if(c)return f();var _,w,S,P,O,K=r===0;do{if(r===n)return null;for(_=!1;Oy.test(S=h(r));)if(S===`
`&&(K=!0,++i),++r===n)return null;if(h(r)==="/"){if(++r===n)throw u("comment");if(h(r)==="/")if(e){if(P=r,O=!1,d(r)){O=!0;do if(r=p(r),r===n||(r++,!K))break;while(d(r))}else r=Math.min(n,p(r)+1);O&&(l(P,r,K),K=!0),i++,_=!0}else{for(O=h(P=r+1)==="/";h(++r)!==`
`;)if(r===n)return null;++r,O&&(l(P,r-1,K),K=!0),++i,_=!0}else if((S=h(r))==="*"){P=r+1,O=e||h(P)==="*";do{if(S===`
`&&++i,++r===n)throw u("comment");w=S,S=h(r)}while(w!=="*"||S!=="/");++r,O&&(l(P,r-2,K),K=!0),_=!0}else return"/"}}while(_);var $=r;Ha.lastIndex=0;var ue=Ha.test(h($++));if(!ue)for(;$<n&&!Ha.test(h($));)++$;var Q=t.substring(r,r=$);return(Q==='"'||Q==="'")&&(c=Q),Q}function y(_){a.push(_)}function v(){if(!a.length){var _=g();if(_===null)return null;y(_)}return a[0]}function x(_,w){var S=v(),P=S===_;if(P)return g(),!0;if(!w)throw u("token '"+S+"', '"+_+"' expected");return!1}function A(_){var w=null,S;return _===void 0?(S=o[i-1],delete o[i-1],S&&(e||S.type==="*"||S.lineEmpty)&&(w=S.leading?S.text:null)):(s<_&&v(),S=o[_],delete o[_],S&&!S.lineEmpty&&(e||S.type==="/")&&(w=S.leading?null:S.text)),w}return Object.defineProperty({next:g,peek:v,push:y,skip:x,cmnt:A},"line",{get:function(){return i}})}});var Oh=D((cS,Lh)=>{"use strict";Lh.exports=fr;fr.filename=null;fr.defaults={keepCase:!1};var Ky=Wa(),kh=Is(),Dh=Es(),Mh=Ar(),qy=ms(),Nh=Dn(),Vy=At(),zy=bs(),Gy=vs(),$a=Qr(),Za=Me(),Hy=/^[1-9][0-9]*$/,Wy=/^-?[1-9][0-9]*$/,$y=/^0[x][0-9a-fA-F]+$/,Zy=/^-?0[x][0-9a-fA-F]+$/,Jy=/^0[0-7]+$/,Qy=/^-?0[0-7]+$/,Yy=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,zt=/^[a-zA-Z_][a-zA-Z_0-9]*$/,Gt=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,Xy=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function fr(t,e,r){e instanceof kh||(r=e,e=new kh),r||(r=fr.defaults);var n=r.preferTrailingComment||!1,i=Ky(t,r.alternateCommentMode||!1),s=i.next,o=i.push,a=i.peek,c=i.skip,u=i.cmnt,f=!0,h,l,d,p,g=!1,y=e,v=r.keepCase?function(C){return C}:Za.camelCase;function x(C,R,k){var V=fr.filename;return k||(fr.filename=null),Error("illegal "+(R||"token")+" '"+C+"' ("+(V?V+", ":"")+"line "+i.line+")")}function A(){var C=[],R;do{if((R=s())!=='"'&&R!=="'")throw x(R);C.push(s()),c(R),R=a()}while(R==='"'||R==="'");return C.join("")}function _(C){var R=s();switch(R){case"'":case'"':return o(R),A();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return S(R,!0)}catch{if(C&&Gt.test(R))return R;throw x(R,"value")}}function w(C,R){var k,V;do R&&((k=a())==='"'||k==="'")?C.push(A()):C.push([V=P(s()),c("to",!0)?P(s()):V]);while(c(",",!0));c(";")}function S(C,R){var k=1;switch(C.charAt(0)==="-"&&(k=-1,C=C.substring(1)),C){case"inf":case"INF":case"Inf":return k*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(Hy.test(C))return k*parseInt(C,10);if($y.test(C))return k*parseInt(C,16);if(Jy.test(C))return k*parseInt(C,8);if(Yy.test(C))return k*parseFloat(C);throw x(C,"number",R)}function P(C,R){switch(C){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!R&&C.charAt(0)==="-")throw x(C,"id");if(Wy.test(C))return parseInt(C,10);if(Zy.test(C))return parseInt(C,16);if(Qy.test(C))return parseInt(C,8);throw x(C,"id")}function O(){if(h!==void 0)throw x("package");if(h=s(),!Gt.test(h))throw x(h,"name");y=y.define(h),c(";")}function K(){var C=a(),R;switch(C){case"weak":R=d||(d=[]),s();break;case"public":s();default:R=l||(l=[]);break}C=A(),c(";"),R.push(C)}function $(){if(c("="),p=A(),g=p==="proto3",!g&&p!=="proto2")throw x(p,"syntax");c(";")}function ue(C,R){switch(R){case"option":return Ye(C,R),c(";"),!0;case"message":return ir(C,R),!0;case"enum":return yn(C,R),!0;case"service":return fd(C,R),!0;case"extend":return ld(C,R),!0}return!1}function Q(C,R,k){var V=i.line;if(C&&(typeof C.comment!="string"&&(C.comment=u()),C.filename=fr.filename),c("{",!0)){for(var q;(q=s())!=="}";)R(q);c(";",!0)}else k&&k(),c(";"),C&&(typeof C.comment!="string"||n)&&(C.comment=u(V)||C.comment)}function ir(C,R){if(!zt.test(R=s()))throw x(R,"type name");var k=new Dh(R);Q(k,function(q){if(!ue(k,q))switch(q){case"map":Ge(k,q);break;case"required":case"repeated":Ke(k,q);break;case"optional":g?Ke(k,"proto3_optional"):Ke(k,"optional");break;case"oneof":G(k,q);break;case"extensions":w(k.extensions||(k.extensions=[]));break;case"reserved":w(k.reserved||(k.reserved=[]),!0);break;default:if(!g||!Gt.test(q))throw x(q);o(q),Ke(k,"optional");break}}),C.add(k)}function Ke(C,R,k){var V=s();if(V==="group"){Ee(C,R);return}for(;V.endsWith(".")||a().startsWith(".");)V+=s();if(!Gt.test(V))throw x(V,"type");var q=s();if(!zt.test(q))throw x(q,"name");q=v(q),c("=");var Z=new Mh(q,P(s()),V,R,k);if(Q(Z,function(it){if(it==="option")Ye(Z,it),c(";");else throw x(it)},function(){Co(Z)}),R==="proto3_optional"){var qe=new Nh("_"+q);Z.setOption("proto3_optional",!0),qe.add(Z),C.add(qe)}else C.add(Z);!g&&Z.repeated&&($a.packed[V]!==void 0||$a.basic[V]===void 0)&&Z.setOption("packed",!1,!0)}function Ee(C,R){var k=s();if(!zt.test(k))throw x(k,"name");var V=Za.lcFirst(k);k===V&&(k=Za.ucFirst(k)),c("=");var q=P(s()),Z=new Dh(k);Z.group=!0;var qe=new Mh(V,q,k,R);qe.filename=fr.filename,Q(Z,function(it){switch(it){case"option":Ye(Z,it),c(";");break;case"required":case"repeated":Ke(Z,it);break;case"optional":g?Ke(Z,"proto3_optional"):Ke(Z,"optional");break;case"message":ir(Z,it);break;case"enum":yn(Z,it);break;default:throw x(it)}}),C.add(Z).add(qe)}function Ge(C){c("<");var R=s();if($a.mapKey[R]===void 0)throw x(R,"type");c(",");var k=s();if(!Gt.test(k))throw x(k,"type");c(">");var V=s();if(!zt.test(V))throw x(V,"name");c("=");var q=new qy(v(V),P(s()),R,k);Q(q,function(qe){if(qe==="option")Ye(q,qe),c(";");else throw x(qe)},function(){Co(q)}),C.add(q)}function G(C,R){if(!zt.test(R=s()))throw x(R,"name");var k=new Nh(v(R));Q(k,function(q){q==="option"?(Ye(k,q),c(";")):(o(q),Ke(k,"optional"))}),C.add(k)}function yn(C,R){if(!zt.test(R=s()))throw x(R,"name");var k=new Vy(R);Q(k,function(q){switch(q){case"option":Ye(k,q),c(";");break;case"reserved":w(k.reserved||(k.reserved=[]),!0);break;default:ci(k,q)}}),C.add(k)}function ci(C,R){if(!zt.test(R))throw x(R,"name");c("=");var k=P(s(),!0),V={options:void 0};V.setOption=function(q,Z){this.options===void 0&&(this.options={}),this.options[q]=Z},Q(V,function(Z){if(Z==="option")Ye(V,Z),c(";");else throw x(Z)},function(){Co(V)}),C.add(R,k,V.comment,V.options)}function Ye(C,R){var k=c("(",!0);if(!Gt.test(R=s()))throw x(R,"name");var V=R,q=V,Z;k&&(c(")"),V="("+V+")",q=V,R=a(),Xy.test(R)&&(Z=R.slice(1),V+=R,s())),c("=");var qe=mn(C,V);ud(C,q,qe,Z)}function mn(C,R){if(c("{",!0)){for(var k={};!c("}",!0);){if(!zt.test(Xe=s()))throw x(Xe,"name");var V,q=Xe;if(c(":",!0),a()==="{")V=mn(C,R+"."+Xe);else if(a()==="["){V=[];var Z;if(c("[",!0)){do Z=_(!0),V.push(Z);while(c(",",!0));c("]"),typeof Z<"u"&&vn(C,R+"."+Xe,Z)}}else V=_(!0),vn(C,R+"."+Xe,V);var qe=k[q];qe&&(V=[].concat(qe).concat(V)),k[q]=V,c(",",!0),c(";",!0)}return k}var vr=_(!0);return vn(C,R,vr),vr}function vn(C,R,k){C.setOption&&C.setOption(R,k)}function ud(C,R,k,V){C.setParsedOption&&C.setParsedOption(R,k,V)}function Co(C){if(c("[",!0)){do Ye(C,"option");while(c(",",!0));c("]")}return C}function fd(C,R){if(!zt.test(R=s()))throw x(R,"service name");var k=new zy(R);Q(k,function(q){if(!ue(k,q))if(q==="rpc")hd(k,q);else throw x(q)}),C.add(k)}function hd(C,R){var k=u(),V=R;if(!zt.test(R=s()))throw x(R,"name");var q=R,Z,qe,vr,it;if(c("("),c("stream",!0)&&(qe=!0),!Gt.test(R=s())||(Z=R,c(")"),c("returns"),c("("),c("stream",!0)&&(it=!0),!Gt.test(R=s())))throw x(R);vr=R,c(")");var es=new Gy(q,V,Z,vr,qe,it);es.comment=k,Q(es,function(Ro){if(Ro==="option")Ye(es,Ro),c(";");else throw x(Ro)}),C.add(es)}function ld(C,R){if(!Gt.test(R=s()))throw x(R,"reference");var k=R;Q(null,function(q){switch(q){case"required":case"repeated":Ke(C,q,k);break;case"optional":g?Ke(C,"proto3_optional",k):Ke(C,"optional",k);break;default:if(!g||!Gt.test(q))throw x(q);o(q),Ke(C,"optional",k);break}})}for(var Xe;(Xe=s())!==null;)switch(Xe){case"package":if(!f)throw x(Xe);O();break;case"import":if(!f)throw x(Xe);K();break;case"syntax":if(!f)throw x(Xe);$();break;case"option":Ye(y,Xe),c(";");break;default:if(ue(y,Xe)){f=!1;continue}throw x(Xe)}return fr.filename=null,{package:h,imports:l,weakImports:d,syntax:p,root:e}}});var Kh=D((uS,Uh)=>{"use strict";Uh.exports=Tt;var jy=/\/|\./;function Tt(t,e){jy.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Tt[t]=e}Tt("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Fh;Tt("duration",{Duration:Fh={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Tt("timestamp",{Timestamp:Fh});Tt("empty",{Empty:{fields:{}}});Tt("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Tt("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Tt("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Tt.get=function(e){return Tt[e]||null}});var Vh=D((fS,qh)=>{"use strict";var Br=qh.exports=Bh();Br.build="full";Br.tokenize=Wa();Br.parse=Oh();Br.common=Kh();Br.Root._configure(Br.Type,Br.parse,Br.common)});var Ja=D((hS,zh)=>{"use strict";zh.exports=Vh()});var fe=D((FS,Yh)=>{Yh.exports={options:{usePureJavaScript:!1}}});var el=D((US,jh)=>{var rc={};jh.exports=rc;var Xh={};rc.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=im(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,u=t[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};rc.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Xh[e];if(!r){r=Xh[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*i,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var f=0;t[f]===s&&f<t.length-1;++f)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function im(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Ce=D((KS,il)=>{var tl=fe(),rl=el(),m=il.exports=tl.util=tl.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){m.nextTick=process.nextTick,typeof setImmediate=="function"?m.setImmediate=setImmediate:m.setImmediate=m.nextTick;return}if(typeof setImmediate=="function"){m.setImmediate=function(){return setImmediate.apply(void 0,arguments)},m.nextTick=function(a){return setImmediate(a)};return}if(m.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(f){f()})}};var o=a,t="forge.setImmediate",e=[];m.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=m.setImmediate;m.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}m.nextTick=m.setImmediate})();m.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;m.globalScope=function(){return m.isNodejs?globalThis:typeof self>"u"?window:self}();m.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};m.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};m.isArrayBufferView=function(t){return t&&m.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Ri(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}m.ByteBuffer=nc;function nc(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(m.isArrayBuffer(t)||m.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof nc||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}m.ByteStringBuffer=nc;var sm=4096;m.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>sm&&(this.data.substr(0,1),this._constructedStringLength=0)};m.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};m.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};m.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};m.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};m.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};m.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(m.encodeUtf8(t))};m.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};m.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};m.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};m.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};m.ByteStringBuffer.prototype.putInt=function(t,e){Ri(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};m.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};m.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};m.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};m.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};m.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};m.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};m.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};m.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};m.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};m.ByteStringBuffer.prototype.getInt=function(t){Ri(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};m.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};m.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};m.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};m.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};m.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};m.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};m.ByteStringBuffer.prototype.copy=function(){var t=m.createBuffer(this.data);return t.read=this.read,t};m.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};m.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};m.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};m.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};m.ByteStringBuffer.prototype.toString=function(){return m.decodeUtf8(this.bytes())};function om(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=m.isArrayBuffer(t),n=m.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}m.DataBuffer=om;m.DataBuffer.prototype.length=function(){return this.write-this.read};m.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};m.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};m.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};m.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};m.DataBuffer.prototype.putBytes=function(t,e){if(m.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(m.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof m.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&m.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof m.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=m.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=m.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=m.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};m.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};m.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};m.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};m.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};m.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};m.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};m.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};m.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};m.DataBuffer.prototype.putInt=function(t,e){Ri(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};m.DataBuffer.prototype.putSignedInt=function(t,e){return Ri(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};m.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};m.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};m.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};m.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};m.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};m.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};m.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};m.DataBuffer.prototype.getInt=function(t){Ri(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};m.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};m.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};m.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};m.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};m.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};m.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};m.DataBuffer.prototype.copy=function(){return new m.DataBuffer(this)};m.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};m.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};m.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};m.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};m.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return m.binary.raw.encode(e);if(t==="hex")return m.binary.hex.encode(e);if(t==="base64")return m.binary.base64.encode(e);if(t==="utf8")return m.text.utf8.decode(e);if(t==="utf16")return m.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};m.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=m.encodeUtf8(t)),new m.ByteBuffer(t)};m.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};m.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};m.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};m.bytesToHex=function(t){return m.createBuffer(t).toHex()};m.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Rr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],nl="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";m.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=Rr.charAt(i>>2),r+=Rr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Rr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Rr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};m.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=Pr[t.charCodeAt(o++)-43],n=Pr[t.charCodeAt(o++)-43],i=Pr[t.charCodeAt(o++)-43],s=Pr[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};m.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};m.decodeUtf8=function(t){return decodeURIComponent(escape(t))};m.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:rl.encode,decode:rl.decode}};m.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};m.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};m.binary.hex.encode=m.bytesToHex;m.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};m.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=Rr.charAt(i>>2),r+=Rr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Rr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Rr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};m.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,u=r;c<t.length;)i=Pr[t.charCodeAt(c++)-43],s=Pr[t.charCodeAt(c++)-43],o=Pr[t.charCodeAt(c++)-43],a=Pr[t.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};m.binary.base58.encode=function(t,e){return m.binary.baseN.encode(t,nl,e)};m.binary.base58.decode=function(t,e){return m.binary.baseN.decode(t,nl,e)};m.text={utf8:{},utf16:{}};m.text.utf8.encode=function(t,e,r){t=m.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};m.text.utf8.decode=function(t){return m.decodeUtf8(String.fromCharCode.apply(null,t))};m.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};m.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};m.deflate=function(t,e,r){if(e=m.decode64(t.deflate(m.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};m.inflate=function(t,e,r){var n=t.inflate(m.encode64(e)).rval;return n===null?null:m.decode64(n)};var ic=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=m.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},sc=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(m.decode64(r))),r},am=function(t,e,r,n){var i=sc(t,e);i===null&&(i={}),i[r]=n,ic(t,e,i)},cm=function(t,e,r){var n=sc(t,e);return n!==null&&(n=r in n?n[r]:null),n},um=function(t,e,r){var n=sc(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),ic(t,e,n)}},fm=function(t,e){ic(t,e,null)},ks=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};m.setItem=function(t,e,r,n,i){ks(am,arguments,i)};m.getItem=function(t,e,r,n){return ks(cm,arguments,n)};m.removeItem=function(t,e,r,n){ks(um,arguments,n)};m.clearItems=function(t,e,r){ks(fm,arguments,r)};m.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};m.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};m.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",f=u.length>3?u.length%3:0;return c+(f?u.substr(0,f)+a:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};m.formatSize=function(t){return t>=1073741824?t=m.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=m.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=m.formatNumber(t/1024,0)+" KiB":t=m.formatNumber(t,0)+" bytes",t};m.bytesFromIP=function(t){return t.indexOf(".")!==-1?m.bytesFromIPv4(t):t.indexOf(":")!==-1?m.bytesFromIPv6(t):null};m.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=m.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};m.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=m.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=m.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};m.bytesToIP=function(t){return t.length===4?m.bytesToIPv4(t):t.length===16?m.bytesToIPv6(t):null};m.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};m.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=m.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};m.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in m&&!t.update)return e(null,m.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return m.cores=navigator.hardwareConcurrency,e(null,m.cores);if(typeof Worker>"u")return m.cores=1,e(null,m.cores);if(typeof Blob>"u")return m.cores=2,e(null,m.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(f,h){return f+h},0)/o.length);return m.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,m.cores)}i(c,function(f,h){o.push(s(c,h)),n(o,a-1,c)})}function i(o,a){for(var c=[],u=[],f=0;f<o;++f){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===o){for(var d=0;d<o;++d)c[d].terminate();a(null,u)}}),c.push(h)}for(var f=0;f<o;++f)c[f].postMessage(f)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var f=a[u],h=c[u]=[],l=0;l<o;++l)if(u!==l){var d=a[l];(f.st>d.st&&f.st<d.et||d.st>f.st&&d.st<f.et)&&h.push(l)}return c.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Ds=D((qS,sl)=>{var Pi=fe();Pi.pki=Pi.pki||{};var oc=sl.exports=Pi.pki.oids=Pi.oids=Pi.oids||{};function B(t,e){oc[t]=e,oc[e]=t}function ce(t,e){oc[t]=e}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("1.3.14.3.2.29","sha1WithRSASignature");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("2.16.840.1.101.3.4.2.4","sha224");B("2.16.840.1.101.3.4.2.5","sha512-224");B("2.16.840.1.101.3.4.2.6","sha512-256");B("1.2.840.113549.2.2","md2");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.4","surname");B("2.5.4.5","serialNumber");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.12","title");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("2.5.4.42","givenName");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");ce("2.5.29.1","authorityKeyIdentifier");ce("2.5.29.2","keyAttributes");ce("2.5.29.3","certificatePolicies");ce("2.5.29.4","keyUsageRestriction");ce("2.5.29.5","policyMapping");ce("2.5.29.6","subtreesConstraint");ce("2.5.29.7","subjectAltName");ce("2.5.29.8","issuerAltName");ce("2.5.29.9","subjectDirectoryAttributes");ce("2.5.29.10","basicConstraints");ce("2.5.29.11","nameConstraints");ce("2.5.29.12","policyConstraints");ce("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");ce("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");ce("2.5.29.20","cRLNumber");ce("2.5.29.21","cRLReason");ce("2.5.29.22","expirationDate");ce("2.5.29.23","instructionCode");ce("2.5.29.24","invalidityDate");ce("2.5.29.25","cRLDistributionPoints");ce("2.5.29.26","issuingDistributionPoint");ce("2.5.29.27","deltaCRLIndicator");ce("2.5.29.28","issuingDistributionPoint");ce("2.5.29.29","certificateIssuer");ce("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");ce("2.5.29.33","policyMappings");ce("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");ce("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");ce("2.5.29.46","freshestCRL");ce("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Di=D((VS,al)=>{var ge=fe();Ce();Ds();var M=al.exports=ge.asn1=ge.asn1||{};M.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};M.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};M.create=function(t,e,r,n,i){if(ge.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||ge.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=M.copy(a)),a};M.copy=function(t,e){var r;if(ge.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(M.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:M.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};M.equals=function(t,e,r){if(ge.util.isArray(t)){if(!ge.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!M.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&M.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};M.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function ki(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var hm=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;ki(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};M.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ge.util.createBuffer(t));var r=t.length(),n=Ms(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Ms(t,e,r,n){var i;ki(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=hm(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var f,h,l=(s&32)===32;if(l)if(f=[],c===void 0)for(;;){if(ki(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),f.push(Ms(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),f.push(Ms(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(f===void 0&&o===M.Class.UNIVERSAL&&a===M.Type.BITSTRING&&(h=t.bytes(c)),f===void 0&&n.decodeBitStrings&&o===M.Class.UNIVERSAL&&a===M.Type.BITSTRING&&c>1){var d=t.read,p=e,g=0;if(a===M.Type.BITSTRING&&(ki(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},v=Ms(t,e,r+1,y),x=i-t.length();e-=x,a==M.Type.BITSTRING&&x++;var A=v.tagClass;x===c&&(A===M.Class.UNIVERSAL||A===M.Class.CONTEXT_SPECIFIC)&&(f=[v])}catch{}f===void 0&&(t.read=d,e=p)}if(f===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===M.Type.BMPSTRING)for(f="";c>0;c-=2)ki(t,e,2),f+=String.fromCharCode(t.getInt16()),e-=2;else f=t.getBytes(c),e-=c}var _=h===void 0?null:{bitStringContents:h};return M.create(o,a,l,f,_)}M.toDer=function(t){var e=ge.util.createBuffer(),r=t.tagClass|t.type,n=ge.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=M.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(M.toDer(t.value[s]))}else if(t.type===M.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===M.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};M.oidToDer=function(t){var e=t.split("."),r=ge.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};M.derToOid=function(t){var e;typeof t=="string"&&(t=ge.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};M.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var f=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),l=f*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};M.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,f=!1;t.charAt(t.length-1)==="Z"&&(f=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);u=d*60+p,u*=6e4,l==="+"&&(u*=-1),f=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),f?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};M.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};M.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};M.integerToDer=function(t){var e=ge.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};M.derToInteger=function(t){typeof t=="string"&&(t=ge.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};M.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&ge.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=M.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var ol=/[^\\u0000-\\u00ff]/;M.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case M.Class.UNIVERSAL:n+="Universal:";break;case M.Class.APPLICATION:n+="Application:";break;case M.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case M.Class.PRIVATE:n+="Private:";break}if(t.tagClass===M.Class.UNIVERSAL)switch(n+=t.type,t.type){case M.Type.NONE:n+=" (None)";break;case M.Type.BOOLEAN:n+=" (Boolean)";break;case M.Type.INTEGER:n+=" (Integer)";break;case M.Type.BITSTRING:n+=" (Bit string)";break;case M.Type.OCTETSTRING:n+=" (Octet string)";break;case M.Type.NULL:n+=" (Null)";break;case M.Type.OID:n+=" (Object Identifier)";break;case M.Type.ODESC:n+=" (Object Descriptor)";break;case M.Type.EXTERNAL:n+=" (External or Instance of)";break;case M.Type.REAL:n+=" (Real)";break;case M.Type.ENUMERATED:n+=" (Enumerated)";break;case M.Type.EMBEDDED:n+=" (Embedded PDV)";break;case M.Type.UTF8:n+=" (UTF8)";break;case M.Type.ROID:n+=" (Relative Object Identifier)";break;case M.Type.SEQUENCE:n+=" (Sequence)";break;case M.Type.SET:n+=" (Set)";break;case M.Type.PRINTABLESTRING:n+=" (Printable String)";break;case M.Type.IA5String:n+=" (IA5String (ASCII))";break;case M.Type.UTCTIME:n+=" (UTC time)";break;case M.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case M.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=M.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===M.Type.OID){var c=M.derToOid(t.value);n+=c,ge.pki&&ge.pki.oids&&c in ge.pki.oids&&(n+=" ("+ge.pki.oids[c]+") ")}if(t.type===M.Type.INTEGER)try{n+=M.derToInteger(t.value)}catch{n+="0x"+ge.util.bytesToHex(t.value)}else if(t.type===M.Type.BITSTRING){if(t.value.length>1?n+="0x"+ge.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===M.Type.OCTETSTRING)ol.test(t.value)||(n+="("+t.value+") "),n+="0x"+ge.util.bytesToHex(t.value);else if(t.type===M.Type.UTF8)try{n+=ge.util.decodeUtf8(t.value)}catch(f){if(f.message==="URI malformed")n+="0x"+ge.util.bytesToHex(t.value)+" (malformed UTF8)";else throw f}else t.type===M.Type.PRINTABLESTRING||t.type===M.Type.IA5String?n+=t.value:ol.test(t.value)?n+="0x"+ge.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var cc=D((zS,cl)=>{var Ne=fe();Ce();cl.exports=Ne.cipher=Ne.cipher||{};Ne.cipher.algorithms=Ne.cipher.algorithms||{};Ne.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ne.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ne.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ne.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ne.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ne.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ne.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ne.cipher.algorithms[t]=e};Ne.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ne.cipher.algorithms?Ne.cipher.algorithms[t]:null};var ac=Ne.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ac.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ne.util.createBuffer(),this.output=t.output||Ne.util.createBuffer(),this.mode.start(e)};ac.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ac.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var fc=D((GS,ul)=>{var Le=fe();Ce();Le.cipher=Le.cipher||{};var J=ul.exports=Le.cipher.modes=Le.cipher.modes||{};J.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};J.ecb.prototype.start=function(t){};J.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};J.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};J.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};J.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};J.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};J.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Ns(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};J.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};J.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};J.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};J.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};J.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0};J.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ns(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};J.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};J.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};J.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0};J.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ns(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};J.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};J.ofb.prototype.decrypt=J.ofb.prototype.encrypt;J.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0};J.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ns(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};J.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Ls(this._inBlock)};J.ctr.prototype.decrypt=J.ctr.prototype.encrypt;J.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Le.util.createBuffer(),this._partialBytes=0,this._R=3774873600};J.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Le.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Le.util.createBuffer(t.additionalData):r=Le.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Le.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(uc(n*8)))}this._inBlock=this._j0.slice(0),Ls(this._inBlock),this._partialBytes=0,r=Le.util.createBuffer(r),this._aDataLength=uc(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};J.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ls(this._inBlock)};J.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ls(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};J.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Le.util.createBuffer();var n=this._aDataLength.concat(uc(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};J.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};J.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};J.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};J.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};J.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,u=(n-1-o%n)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};J.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function Ns(t,e){if(typeof t=="string"&&(t=Le.util.createBuffer(t)),Le.util.isArray(t)&&t.length>4){var r=t;t=Le.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Le.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function Ls(t){t[t.length-1]=t[t.length-1]+1&4294967295}function uc(t){return[t/4294967296|0,t&4294967295]}});var Fs=D((HS,pl)=>{var de=fe();cc();fc();Ce();pl.exports=de.aes=de.aes||{};de.aes.startEncrypting=function(t,e,r,n){var i=Os({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};de.aes.createEncryptionCipher=function(t,e){return Os({key:t,output:null,decrypt:!1,mode:e})};de.aes.startDecrypting=function(t,e,r,n){var i=Os({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};de.aes.createDecryptionCipher=function(t,e){return Os({key:t,output:null,decrypt:!0,mode:e})};de.aes.Algorithm=function(t,e){pc||hl();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return lc(r._w,n,i,!1)},decrypt:function(n,i){return lc(r._w,n,i,!0)}}}),r._init=!1};de.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=de.util.createBuffer(e);else if(de.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=de.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!de.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!de.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=ll(e,t.decrypt&&!o),this._init=!0}};de.aes._expandKey=function(t,e){return pc||hl(),ll(t,e)};de.aes._updateBlock=lc;Un("AES-ECB",de.cipher.modes.ecb);Un("AES-CBC",de.cipher.modes.cbc);Un("AES-CFB",de.cipher.modes.cfb);Un("AES-OFB",de.cipher.modes.ofb);Un("AES-CTR",de.cipher.modes.ctr);Un("AES-GCM",de.cipher.modes.gcm);function Un(t,e){var r=function(){return new de.aes.Algorithm(t,e)};de.cipher.registerAlgorithm(t,r)}var pc=!1,Fn=4,$e,hc,fl,en,kt;function hl(){pc=!0,fl=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;$e=new Array(256),hc=new Array(256),en=new Array(4),kt=new Array(4);for(var e=0;e<4;++e)en[e]=new Array(256),kt[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,u,f,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,$e[r]=a,hc[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],u=c<<24^a<<16^a<<8^(a^c),f=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)en[h][r]=u,kt[h][a]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function ll(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=Fn*o,c=s;c<a;++c)n=r[c-1],c%s===0?(n=$e[n>>>16&255]<<24^$e[n>>>8&255]<<16^$e[n&255]<<8^$e[n>>>24]^fl[i]<<24,i++):s>6&&c%s===4&&(n=$e[n>>>24]<<24^$e[n>>>16&255]<<16^$e[n>>>8&255]<<8^$e[n&255]),r[c]=r[c-s]^n;if(e){var u,f=kt[0],h=kt[1],l=kt[2],d=kt[3],p=r.slice(0);a=r.length;for(var c=0,g=a-Fn;c<a;c+=Fn,g-=Fn)if(c===0||c===a-Fn)p[c]=r[g],p[c+1]=r[g+3],p[c+2]=r[g+2],p[c+3]=r[g+1];else for(var y=0;y<Fn;++y)u=r[g+y],p[c+(3&-y)]=f[$e[u>>>24]]^h[$e[u>>>16&255]]^l[$e[u>>>8&255]]^d[$e[u&255]];r=p}return r}function lc(t,e,r,n){var i=t.length/4-1,s,o,a,c,u;n?(s=kt[0],o=kt[1],a=kt[2],c=kt[3],u=hc):(s=en[0],o=en[1],a=en[2],c=en[3],u=$e);var f,h,l,d,p,g,y;f=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var v=3,x=1;x<i;++x)p=s[f>>>24]^o[h>>>16&255]^a[l>>>8&255]^c[d&255]^t[++v],g=s[h>>>24]^o[l>>>16&255]^a[d>>>8&255]^c[f&255]^t[++v],y=s[l>>>24]^o[d>>>16&255]^a[f>>>8&255]^c[h&255]^t[++v],d=s[d>>>24]^o[f>>>16&255]^a[h>>>8&255]^c[l&255]^t[++v],f=p,h=g,l=y;r[0]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^t[++v],r[n?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[f&255]^t[++v],r[2]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[f>>>8&255]<<8^u[h&255]^t[++v],r[n?1:3]=u[d>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^t[++v]}function Os(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=de.cipher.createDecipher(r,t.key):n=de.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof de.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var yl=D((WS,gl)=>{var xe=fe();cc();fc();Ce();gl.exports=xe.des=xe.des||{};xe.des.startEncrypting=function(t,e,r,n){var i=Us({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};xe.des.createEncryptionCipher=function(t,e){return Us({key:t,output:null,decrypt:!1,mode:e})};xe.des.startDecrypting=function(t,e,r,n){var i=Us({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};xe.des.createDecryptionCipher=function(t,e){return Us({key:t,output:null,decrypt:!0,mode:e})};xe.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return dl(r._keys,n,i,!1)},decrypt:function(n,i){return dl(r._keys,n,i,!0)}}}),r._init=!1};xe.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=xe.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=xm(e),this._init=!0}};Wt("DES-ECB",xe.cipher.modes.ecb);Wt("DES-CBC",xe.cipher.modes.cbc);Wt("DES-CFB",xe.cipher.modes.cfb);Wt("DES-OFB",xe.cipher.modes.ofb);Wt("DES-CTR",xe.cipher.modes.ctr);Wt("3DES-ECB",xe.cipher.modes.ecb);Wt("3DES-CBC",xe.cipher.modes.cbc);Wt("3DES-CFB",xe.cipher.modes.cfb);Wt("3DES-OFB",xe.cipher.modes.ofb);Wt("3DES-CTR",xe.cipher.modes.ctr);function Wt(t,e){var r=function(){return new xe.des.Algorithm(t,e)};xe.cipher.registerAlgorithm(t,r)}var lm=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],pm=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],dm=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],gm=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],ym=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],mm=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],vm=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],bm=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function xm(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,y=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],x=0,A,_=0;_<g;_++){var w=t.getInt32(),S=t.getInt32();A=(w>>>4^S)&252645135,S^=A,w^=A<<4,A=(S>>>-16^w)&65535,w^=A,S^=A<<-16,A=(w>>>2^S)&858993459,S^=A,w^=A<<2,A=(S>>>-16^w)&65535,w^=A,S^=A<<-16,A=(w>>>1^S)&1431655765,S^=A,w^=A<<1,A=(S>>>8^w)&16711935,w^=A,S^=A<<8,A=(w>>>1^S)&1431655765,S^=A,w^=A<<1,A=w<<8|S>>>20&240,w=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=A;for(var P=0;P<v.length;++P){v[P]?(w=w<<2|w>>>26,S=S<<2|S>>>26):(w=w<<1|w>>>27,S=S<<1|S>>>27),w&=-15,S&=-15;var O=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|s[w>>>12&15]|o[w>>>8&15]|a[w>>>4&15],K=c[S>>>28]|u[S>>>24&15]|f[S>>>20&15]|h[S>>>16&15]|l[S>>>12&15]|d[S>>>8&15]|p[S>>>4&15];A=(K>>>16^O)&65535,y[x++]=O^A,y[x++]=K^A<<16}}return y}function dl(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var f=s[u+1],h=s[u+2],l=s[u];l!=f;l+=h){var d=c^t[l],p=(c>>>4|c<<28)^t[l+1];o=a,a=c,c=o^(pm[d>>>24&63]|gm[d>>>16&63]|mm[d>>>8&63]|bm[d&63]|lm[p>>>24&63]|dm[p>>>16&63]|ym[p>>>8&63]|vm[p&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function Us(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=xe.cipher.createDecipher(r,t.key):n=xe.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof xe.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var tn=D(($S,ml)=>{var Ks=fe();ml.exports=Ks.md=Ks.md||{};Ks.md.algorithms=Ks.md.algorithms||{}});var bl=D((ZS,vl)=>{var lr=fe();tn();Ce();var wm=vl.exports=lr.hmac=lr.hmac||{};wm.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in lr.md.algorithms)e=lr.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=lr.util.createBuffer(o);else if(lr.util.isArray(o)){var a=o;o=lr.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=lr.util.createBuffer(),n=lr.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Kn=D(()=>{});var dc=D((YS,xl)=>{var Ze=fe();bl();tn();Ce();var Sm=Ze.pkcs5=Ze.pkcs5||{},pr;Ze.util.isNodejs&&!Ze.options.usePureJavaScript&&(pr=Kn());xl.exports=Ze.pbkdf2=Sm.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Ze.util.isNodejs&&!Ze.options.usePureJavaScript&&pr.pbkdf2&&(i===null||typeof i!="object")&&(pr.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?pr.pbkdf2Sync.length===4?pr.pbkdf2(t,e,r,n,function(A,_){if(A)return s(A);s(null,_.toString("binary"))}):pr.pbkdf2(t,e,r,n,i,function(A,_){if(A)return s(A);s(null,_.toString("binary"))}):pr.pbkdf2Sync.length===4?pr.pbkdf2Sync(t,e,r,n).toString("binary"):pr.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ze.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ze.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),u=n-(c-1)*o,f=Ze.hmac.create();f.start(i,t);var h="",l,d,p;if(!s){for(var g=1;g<=c;++g){f.start(null,null),f.update(e),f.update(Ze.util.int32ToBytes(g)),l=p=f.digest().getBytes();for(var y=2;y<=r;++y)f.start(null,null),f.update(p),d=f.digest().getBytes(),l=Ze.util.xorBytes(l,d,o),p=d;h+=g<c?l:l.substr(0,u)}return h}var g=1,y;function v(){if(g>c)return s(null,h);f.start(null,null),f.update(e),f.update(Ze.util.int32ToBytes(g)),l=p=f.digest().getBytes(),y=2,x()}function x(){if(y<=r)return f.start(null,null),f.update(p),d=f.digest().getBytes(),l=Ze.util.xorBytes(l,d,o),p=d,++y,Ze.util.setImmediate(x);h+=g<c?l:l.substr(0,u),++g,v()}v()}});var El=D((XS,Sl)=>{var Vs=fe();Ce();var wl=Sl.exports=Vs.pem=Vs.pem||{};wl.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=qs(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=qs(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=qs(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=qs(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Vs.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};wl.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Vs.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(i),u=0;s&&u<c.length;){for(var f=c[u].replace(/\s+$/,""),h=u+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;f+=l,u=h}if(s=f.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)d.values.push(Em(p[g]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function qs(t){for(var e=t.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function Em(t){return t.replace(/^\s+/,"")}});var Cl=D((jS,Bl)=>{var $t=fe();tn();Ce();var Al=Bl.exports=$t.sha256=$t.sha256||{};$t.md.sha256=$t.md.algorithms.sha256=Al;Al.create=function(){Il||_m();var t=null,e=$t.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=$t.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=$t.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),_l(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=$t.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(gc.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};_l(h,r,i);var l=$t.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var gc=null,Il=!1,Tl=null;function _m(){gc=String.fromCharCode(128),gc+=$t.util.fillString(String.fromCharCode(0),64),Tl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Il=!0}function _l(t,e,r){for(var n,i,s,o,a,c,u,f,h,l,d,p,g,y,v,x=r.length();x>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(f=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,y=t.h6,v=t.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=y^p&(g^y),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&h|l&(f^h),n=v+o+a+Tl[u]+e[u],i=s+c,v=y,y=g,g=p,p=d+n>>>0,d=l,l=h,h=f,f=n+i>>>0;t.h0=t.h0+f|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+y|0,t.h7=t.h7+v|0,x-=64}}});var Pl=D((eE,Rl)=>{var Zt=fe();Ce();var zs=null;Zt.util.isNodejs&&!Zt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(zs=Kn());var Am=Rl.exports=Zt.prng=Zt.prng||{};Am.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,f){if(!f)return e.generateSync(u);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=Zt.util.createBuffer();e.key=null,y();function y(v){if(v)return f(v);if(g.length()>=u)return f(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Zt.util.nextTick(function(){s(y)});var x=h(e.key,e.seed);e.generated+=x.length,g.putBytes(x),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Zt.util.setImmediate(y)}},e.generateSync=function(u){var f=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Zt.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=f(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(f(e.key,h(e.seed))),e.seed=d(f(e.key,e.seed))}return p.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(h,l){if(h)return u(h);e.collect(l),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var f=1,h=0;h<32;++h)e.reseeds%f===0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),f=f<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var l=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(u){var f=null,h=Zt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(f=function(w){return l.getRandomValues(w)});var d=Zt.util.createBuffer();if(f)for(;d.length()<u;){var p=Math.max(1,Math.min(u-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{f(g);for(var y=0;y<g.length;++y)d.putInt32(g[y])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(d.length()<u)for(var v,x,A,_=Math.floor(Math.random()*65536);d.length()<u;){x=16807*(_&65535),v=16807*(_>>16),x+=(v&32767)<<16,x+=v>>15,x=(x&2147483647)+(x>>31),_=x&4294967295;for(var y=0;y<3;++y)A=_>>>(y<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(u)}return zs?(e.seedFile=function(u,f){zs.randomBytes(u,function(h,l){if(h)return f(h);f(null,l.toString())})},e.seedFileSync=function(u){return zs.randomBytes(u).toString()}):(e.seedFile=function(u,f){try{f(null,c(u))}catch(h){f(h)}},e.seedFileSync=c),e.collect=function(u){for(var f=u.length,h=0;h<f;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,f){for(var h="",l=0;l<f;l+=8)h+=String.fromCharCode(u>>l&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var f=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){u.postMessage({forge:{prng:{err:d,bytes:p}}})})};u.addEventListener("message",f)}},e}});var Mi=D((tE,yc)=>{var Oe=fe();Fs();Cl();Pl();Ce();(function(){if(Oe.random&&Oe.random.getBytes){yc.exports=Oe.random;return}(function(t){var e={},r=new Array(4),n=Oe.util.createBuffer();e.formatKey=function(h){var l=Oe.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Oe.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Oe.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Oe.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Oe.md.sha256;function i(){var h=Oe.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=Oe.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),Oe.options.usePureJavaScript||!Oe.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch{}s.collect(u),u=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Oe.random)Oe.random=s;else for(var f in s)Oe.random[f]=s[f];Oe.random.createInstance=i,yc.exports=Oe.random})(typeof jQuery<"u"?jQuery:null)})()});var Nl=D((rE,Ml)=>{var et=fe();Ce();var mc=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],kl=[1,2,3,5],Im=function(t,e){return t<<e&65535|(t&65535)>>16-e},Tm=function(t,e){return(t&65535)>>e|t<<16-e&65535};Ml.exports=et.rc2=et.rc2||{};et.rc2.expandKey=function(t,e){typeof t=="string"&&(t=et.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(mc[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,mc[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,mc[r.at(a+1)^r.at(a+s)]);return r};var Dl=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,u,f,h=[];for(t=et.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(a=function(p){for(u=0;u<4;u++)p[u]+=h[f]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=Im(p[u],kl[u]),f++},c=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(a=function(p){for(u=3;u>=0;u--)p[u]=Tm(p[u],kl[u]),p[u]-=h[f]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),f--},c=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var g=[];for(u=0;u<4;u++){var y=i.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),g.push(y&65535)}f=r?0:63;for(var v=0;v<p.length;v++)for(var x=0;x<p[v][0];x++)p[v][1](g);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=et.util.createBuffer(p)),n=!1,i=et.util.createBuffer(),s=g||new et.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,s,!r);else{var v=s.length(),x=s.at(v-1);x>v?g=!1:s.truncate(x)}return g}},d};et.rc2.startEncrypting=function(t,e,r){var n=et.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};et.rc2.createEncryptionCipher=function(t,e){return Dl(t,e,!0)};et.rc2.startDecrypting=function(t,e,r){var n=et.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};et.rc2.createDecryptionCipher=function(t,e){return Dl(t,e,!1)}});var Ws=D((nE,zl)=>{var vc=fe();zl.exports=vc.jsbn=vc.jsbn||{};var dr,Bm=0xdeadbeefcafe,Ll=(Bm&16777215)==15715070;function I(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}vc.jsbn.BigInteger=I;function ne(){return new I(null)}function Cm(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function Rm(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,f=a*c+u*o;c=o*c+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(f>>>15)+a*u+(i>>>30),r.data[n++]=c&1073741823}return i}function Ol(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,f=a*c+u*o;c=o*c+((f&16383)<<14)+r.data[n]+i,i=(c>>28)+(f>>14)+a*u,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(I.prototype.am=Ol,dr=28):Ll&&navigator.appName=="Microsoft Internet Explorer"?(I.prototype.am=Rm,dr=30):Ll&&navigator.appName!="Netscape"?(I.prototype.am=Cm,dr=26):(I.prototype.am=Ol,dr=28);I.prototype.DB=dr;I.prototype.DM=(1<<dr)-1;I.prototype.DV=1<<dr;var bc=52;I.prototype.FV=Math.pow(2,bc);I.prototype.F1=bc-dr;I.prototype.F2=2*dr-bc;var Pm="0123456789abcdefghijklmnopqrstuvwxyz",Gs=new Array,qn,vt;qn="0".charCodeAt(0);for(vt=0;vt<=9;++vt)Gs[qn++]=vt;qn="a".charCodeAt(0);for(vt=10;vt<36;++vt)Gs[qn++]=vt;qn="A".charCodeAt(0);for(vt=10;vt<36;++vt)Gs[qn++]=vt;function Fl(t){return Pm.charAt(t)}function Ul(t,e){var r=Gs[t.charCodeAt(e)];return r??-1}function km(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Dm(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function kr(t){var e=ne();return e.fromInt(t),e}function Mm(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:Ul(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&I.ZERO.subTo(this,this)}function Nm(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Lm(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Fl(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Fl(n));return i?s:"0"}function Om(){var t=ne();return I.ZERO.subTo(this,t),t}function Fm(){return this.s<0?this.negate():this}function Um(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Hs(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Km(){return this.t<=0?0:this.DB*(this.t-1)+Hs(this.data[this.t-1]^this.s&this.DM)}function qm(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Vm(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function zm(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Gm(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function Hm(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Wm(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&I.ZERO.subTo(e,e)}function $m(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Zm(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ne());var s=ne(),o=this.s,a=t.s,c=this.DB-Hs(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,f=s.data[u-1];if(f!=0){var h=f*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,y=g-u,v=e??ne();for(s.dlShiftTo(y,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),I.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--y>=0;){var x=r.data[--g]==f?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=s.am(0,x,r,y,0,u))<x)for(s.dlShiftTo(y,v),r.subTo(v,r);r.data[g]<--x;)r.subTo(v,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&I.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&I.ZERO.subTo(r,r)}}}function Jm(t){var e=ne();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(I.ZERO)>0&&t.subTo(e,e),e}function rn(t){this.m=t}function Qm(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Ym(t){return t}function Xm(t){t.divRemTo(this.m,null,t)}function jm(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function ev(t,e){t.squareTo(e),this.reduce(e)}rn.prototype.convert=Qm;rn.prototype.revert=Ym;rn.prototype.reduce=Xm;rn.prototype.mulTo=jm;rn.prototype.sqrTo=ev;function tv(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function nn(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function rv(t){var e=ne();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(I.ZERO)>0&&this.m.subTo(e,e),e}function nv(t){var e=ne();return t.copyTo(e),this.reduce(e),e}function iv(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function sv(t,e){t.squareTo(e),this.reduce(e)}function ov(t,e,r){t.multiplyTo(e,r),this.reduce(r)}nn.prototype.convert=rv;nn.prototype.revert=nv;nn.prototype.reduce=iv;nn.prototype.mulTo=ov;nn.prototype.sqrTo=sv;function av(){return(this.t>0?this.data[0]&1:this.s)==0}function cv(t,e){if(t>4294967295||t<1)return I.ONE;var r=ne(),n=ne(),i=e.convert(this),s=Hs(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function uv(t,e){var r;return t<256||e.isEven()?r=new rn(e):r=new nn(e),this.exp(t,r)}I.prototype.copyTo=km;I.prototype.fromInt=Dm;I.prototype.fromString=Mm;I.prototype.clamp=Nm;I.prototype.dlShiftTo=qm;I.prototype.drShiftTo=Vm;I.prototype.lShiftTo=zm;I.prototype.rShiftTo=Gm;I.prototype.subTo=Hm;I.prototype.multiplyTo=Wm;I.prototype.squareTo=$m;I.prototype.divRemTo=Zm;I.prototype.invDigit=tv;I.prototype.isEven=av;I.prototype.exp=cv;I.prototype.toString=Lm;I.prototype.negate=Om;I.prototype.abs=Fm;I.prototype.compareTo=Um;I.prototype.bitLength=Km;I.prototype.mod=Jm;I.prototype.modPowInt=uv;I.ZERO=kr(0);I.ONE=kr(1);function fv(){var t=ne();return this.copyTo(t),t}function hv(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function lv(){return this.t==0?this.s:this.data[0]<<24>>24}function pv(){return this.t==0?this.s:this.data[0]<<16>>16}function dv(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function gv(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function yv(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=kr(r),i=ne(),s=ne(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function mv(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=Ul(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&I.ZERO.subTo(this,this)}function vv(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(I.ONE.shiftLeft(t-1),xc,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(I.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function bv(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function xv(t){return this.compareTo(t)==0}function wv(t){return this.compareTo(t)<0?this:t}function Sv(t){return this.compareTo(t)>0?this:t}function Ev(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function _v(t,e){return t&e}function Av(t){var e=ne();return this.bitwiseTo(t,_v,e),e}function xc(t,e){return t|e}function Iv(t){var e=ne();return this.bitwiseTo(t,xc,e),e}function Kl(t,e){return t^e}function Tv(t){var e=ne();return this.bitwiseTo(t,Kl,e),e}function ql(t,e){return t&~e}function Bv(t){var e=ne();return this.bitwiseTo(t,ql,e),e}function Cv(){for(var t=ne(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Rv(t){var e=ne();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Pv(t){var e=ne();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function kv(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Dv(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+kv(this.data[t]);return this.s<0?this.t*this.DB:-1}function Mv(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Nv(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Mv(this.data[r]^e);return t}function Lv(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Ov(t,e){var r=I.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Fv(t){return this.changeBit(t,xc)}function Uv(t){return this.changeBit(t,ql)}function Kv(t){return this.changeBit(t,Kl)}function qv(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Vv(t){var e=ne();return this.addTo(t,e),e}function zv(t){var e=ne();return this.subTo(t,e),e}function Gv(t){var e=ne();return this.multiplyTo(t,e),e}function Hv(t){var e=ne();return this.divRemTo(t,e,null),e}function Wv(t){var e=ne();return this.divRemTo(t,null,e),e}function $v(t){var e=ne(),r=ne();return this.divRemTo(t,e,r),new Array(e,r)}function Zv(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Jv(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Ni(){}function Vl(t){return t}function Qv(t,e,r){t.multiplyTo(e,r)}function Yv(t,e){t.squareTo(e)}Ni.prototype.convert=Vl;Ni.prototype.revert=Vl;Ni.prototype.mulTo=Qv;Ni.prototype.sqrTo=Yv;function Xv(t){return this.exp(t,new Ni)}function jv(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function e1(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Vn(t){this.r2=ne(),this.q3=ne(),I.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function t1(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ne();return t.copyTo(e),this.reduce(e),e}function r1(t){return t}function n1(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function i1(t,e){t.squareTo(e),this.reduce(e)}function s1(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Vn.prototype.convert=t1;Vn.prototype.revert=r1;Vn.prototype.reduce=n1;Vn.prototype.mulTo=s1;Vn.prototype.sqrTo=i1;function o1(t,e){var r=t.bitLength(),n,i=kr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new rn(e):e.isEven()?s=new Vn(e):s=new nn(e);var o=new Array,a=3,c=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var f=ne();for(s.sqrTo(o[1],f);a<=u;)o[a]=ne(),s.mulTo(f,o[a-2],o[a]),a+=2}var h=t.t-1,l,d=!0,p=ne(),g;for(r=Hs(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&u:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(g=i,i=p,p=g),s.mulTo(p,o[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)s.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function a1(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function c1(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function u1(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return I.ZERO;for(var r=t.clone(),n=this.clone(),i=kr(1),s=kr(0),o=kr(0),a=kr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(I.ONE)!=0)return I.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Dt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],f1=(1<<26)/Dt[Dt.length-1];function h1(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Dt[Dt.length-1]){for(e=0;e<Dt.length;++e)if(r.data[0]==Dt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Dt.length;){for(var n=Dt[e],i=e+1;i<Dt.length&&n<f1;)n*=Dt[i++];for(n=r.modInt(n);e<i;)if(n%Dt[e++]==0)return!1}return r.millerRabin(t)}function l1(t){var e=this.subtract(I.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=p1(),s,o=0;o<t;++o){do s=new I(this.bitLength(),i);while(s.compareTo(I.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(I.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(I.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function p1(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}I.prototype.chunkSize=dv;I.prototype.toRadix=yv;I.prototype.fromRadix=mv;I.prototype.fromNumber=vv;I.prototype.bitwiseTo=Ev;I.prototype.changeBit=Ov;I.prototype.addTo=qv;I.prototype.dMultiply=Zv;I.prototype.dAddOffset=Jv;I.prototype.multiplyLowerTo=jv;I.prototype.multiplyUpperTo=e1;I.prototype.modInt=c1;I.prototype.millerRabin=l1;I.prototype.clone=fv;I.prototype.intValue=hv;I.prototype.byteValue=lv;I.prototype.shortValue=pv;I.prototype.signum=gv;I.prototype.toByteArray=bv;I.prototype.equals=xv;I.prototype.min=wv;I.prototype.max=Sv;I.prototype.and=Av;I.prototype.or=Iv;I.prototype.xor=Tv;I.prototype.andNot=Bv;I.prototype.not=Cv;I.prototype.shiftLeft=Rv;I.prototype.shiftRight=Pv;I.prototype.getLowestSetBit=Dv;I.prototype.bitCount=Nv;I.prototype.testBit=Lv;I.prototype.setBit=Fv;I.prototype.clearBit=Uv;I.prototype.flipBit=Kv;I.prototype.add=Vv;I.prototype.subtract=zv;I.prototype.multiply=Gv;I.prototype.divide=Hv;I.prototype.remainder=Wv;I.prototype.divideAndRemainder=$v;I.prototype.modPow=o1;I.prototype.modInverse=u1;I.prototype.pow=Xv;I.prototype.gcd=a1;I.prototype.isProbablePrime=h1});var Zl=D((iE,$l)=>{var Jt=fe();tn();Ce();var Hl=$l.exports=Jt.sha1=Jt.sha1||{};Jt.md.sha1=Jt.md.algorithms.sha1=Hl;Hl.create=function(){Wl||d1();var t=null,e=Jt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Jt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Jt.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Gl(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Jt.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(wc.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Gl(h,r,i);var l=Jt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var wc=null,Wl=!1;function d1(){wc=String.fromCharCode(128),wc+=Jt.util.fillString(String.fromCharCode(0),64),Wl=!0}function Gl(t,e,r){for(var n,i,s,o,a,c,u,f,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,f=0;f<16;++f)n=r.getInt32(),e[f]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<20;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<32;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<40;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<60;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<80;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var Yl=D((sE,Ql)=>{var Qt=fe();Ce();Mi();Zl();var Jl=Ql.exports=Qt.pkcs1=Qt.pkcs1||{};Jl.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Qt.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var f=s.digest(),h="",l=c-e.length,d=0;d<l;d++)h+="\0";var p=f.getBytes()+h+""+e;if(!i)i=Qt.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var g=$s(i,a-s.digestLength-1,o),y=Qt.util.xorBytes(p,g,p.length),v=$s(y,s.digestLength,o),x=Qt.util.xorBytes(i,v,i.length);return"\0"+x+y};Jl.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=o,y}if(i===void 0?i=Qt.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),u=e.substring(1,i.digestLength+1),f=e.substring(1+i.digestLength),h=$s(f,i.digestLength,s),l=Qt.util.xorBytes(u,h,u.length),d=$s(l,o-i.digestLength-1,s),p=Qt.util.xorBytes(f,d,f.length),g=p.substring(0,i.digestLength),y=c!=="\0",v=0;v<i.digestLength;++v)y|=a.charAt(v)!==g.charAt(v);for(var x=1,A=i.digestLength,_=i.digestLength;_<p.length;_++){var w=p.charCodeAt(_),S=w&1^1,P=x?65534:0;y|=w&P,x=x&S,A+=x}if(y||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function $s(t,e,r){r||(r=Qt.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var Xl=D((oE,Sc)=>{var Dr=fe();Ce();Ws();Mi();(function(){if(Dr.prime){Sc.exports=Dr.prime;return}var t=Sc.exports=Dr.prime=Dr.prime||{},e=Dr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Dr.random,y={nextBytes:function(v){for(var x=g.getBytesSync(v.length),A=0;A<v.length;++A)v[A]=x.charCodeAt(A)}};if(p.name==="PRIMEINC")return s(h,y,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?c(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var g=u(h,l),y=0,v=f(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var x=10;"maxBlockTime"in d&&(x=d.maxBlockTime),a(g,h,l,y,v,x,p)}function a(h,l,d,p,g,y,v){var x=+new Date;do{if(h.bitLength()>l&&(h=u(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-x<y);Dr.util.setImmediate(function(){a(h,l,d,p,g,y,v)})}function c(h,l,d,p){if(typeof Worker>"u")return o(h,l,d,p);var g=u(h,l),y=d.workers,v=d.workLoad||100,x=v*30/8,A=d.workerScript||"forge/prime.worker.js";if(y===-1)return Dr.util.estimateCores(function(w,S){w&&(S=2),y=S-1,_()});_();function _(){y=Math.max(1,y);for(var w=[],S=0;S<y;++S)w[S]=new Worker(A);for(var P=y,S=0;S<y;++S)w[S].addEventListener("message",K);var O=!1;function K($){if(!O){--P;var ue=$.data;if(ue.found){for(var Q=0;Q<w.length;++Q)w[Q].terminate();return O=!0,p(null,new e(ue.prime,16))}g.bitLength()>h&&(g=u(h,l));var ir=g.toString(16);$.target.postMessage({hex:ir,workLoad:v}),g.dAddOffset(x,0)}}}}function u(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function f(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Js=D((aE,s0)=>{var z=fe();Di();Ws();Ds();Yl();Xl();Mi();Ce();typeof j>"u"&&(j=z.jsbn.BigInteger);var j,Ec=z.util.isNodejs?Kn():null,b=z.asn1,bt=z.util;z.pki=z.pki||{};s0.exports=z.pki.rsa=z.rsa=z.rsa||{};var H=z.pki,g1=[6,4,2,4,2,4,6,2],y1={name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},m1={name:"RSAPrivateKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},v1={name:"RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},b1=z.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},x1={name:"DigestInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},w1=function(t){var e;if(t.algorithm in H.oids)e=H.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=b.oidToDer(e).getBytes(),i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),s=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);s.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,n)),s.value.push(b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,""));var o=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),b.toDer(i).getBytes()},n0=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(j.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(j.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new j(z.util.bytesToHex(z.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(j.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};H.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=i0(t,e,r)):(i=z.util.createBuffer(),i.putBytes(t));for(var o=new j(i.toHex(),16),a=n0(o,e,n),c=a.toString(16),u=z.util.createBuffer(),f=s-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(z.util.hexToBytes(c)),u.getBytes()};H.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new j(z.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=n0(o,e,r),c=a.toString(16),u=z.util.createBuffer(),f=i-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(z.util.hexToBytes(c)),n!==!1?Zs(u.getBytes(),e,r):u.getBytes()};H.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||z.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new j(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};H.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new j(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(j.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(E1(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(g1[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(j.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var f=t.e.modInverse(t.phi);t.keys={privateKey:H.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:H.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};H.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!z.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(jl("generateKeyPair"))return Ec.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:H.privateKeyFromPem(u),publicKey:H.publicKeyFromPem(c)})});if(e0("generateKey")&&e0("exportKey"))return bt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:r0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return bt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=H.privateKeyFromAsn1(b.fromDer(z.util.createBuffer(a)));n(null,{privateKey:c,publicKey:H.setRsaPublicKey(c.n,c.e)})}});if(t0("generateKey")&&t0("exportKey")){var i=bt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:r0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,u=bt.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(f){var h=f.target.result,l=H.privateKeyFromAsn1(b.fromDer(z.util.createBuffer(h)));n(null,{privateKey:l,publicKey:H.setRsaPublicKey(l.n,l.e)})},u.onerror=function(f){n(f)}},i.onerror=function(a){n(a)};return}}else if(jl("generateKeyPairSync")){var s=Ec.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:H.privateKeyFromPem(s.privateKey),publicKey:H.publicKeyFromPem(s.publicKey)}}}var o=H.rsa.createKeyPairGenerationState(t,e,r);if(!n)return H.rsa.stepKeyPairGenerationState(o,0),o.keys;S1(o,r,n)};H.setRsaPublicKey=H.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,u){return i0(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return z.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return H.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=Zs(u,r,!0);var f=b.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!b.validate(f,x1,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=b.derToOid(h.algorithmIdentifier);if(!(p===z.oids.md2||p===z.oids.md5||p===z.oids.sha1||p===z.oids.sha224||p===z.oids.sha256||p===z.oids.sha384||p===z.oids.sha512||p===z.oids["sha512-224"]||p===z.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===z.oids.md2||p===z.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=Zs(u,r,!0),c===u}});var a=H.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};H.setRsaPrivateKey=H.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,f,h){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var l=H.rsa.decrypt(u,c,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:Zs};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(d,p){return z.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(l,c,!1)},c.sign=function(u,f){var h=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:w1},h=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return u}},h=1);var l=f.encode(u,c.n.bitLength());return H.rsa.encrypt(l,c,h)},c};H.wrapRsaPrivateKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(H.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(t).getBytes())])};H.privateKeyFromAsn1=function(t){var e={},r=[];if(b.validate(t,y1,e,r)&&(t=b.fromDer(z.util.createBuffer(e.privateKey))),e={},r=[],!b.validate(t,m1,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,u,f,h;return i=z.util.createBuffer(e.privateKeyModulus).toHex(),s=z.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=z.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=z.util.createBuffer(e.privateKeyPrime1).toHex(),c=z.util.createBuffer(e.privateKeyPrime2).toHex(),u=z.util.createBuffer(e.privateKeyExponent1).toHex(),f=z.util.createBuffer(e.privateKeyExponent2).toHex(),h=z.util.createBuffer(e.privateKeyCoefficient).toHex(),H.setRsaPrivateKey(new j(i,16),new j(s,16),new j(o,16),new j(a,16),new j(c,16),new j(u,16),new j(f,16),new j(h,16))};H.privateKeyToAsn1=H.privateKeyToRSAPrivateKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.e)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.d)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.p)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.q)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.dP)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.dQ)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.qInv))])};H.publicKeyFromAsn1=function(t){var e={},r=[];if(b.validate(t,b1,e,r)){var n=b.derToOid(e.publicKeyOid);if(n!==H.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!b.validate(t,v1,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=z.util.createBuffer(e.publicKeyModulus).toHex(),o=z.util.createBuffer(e.publicKeyExponent).toHex();return H.setRsaPublicKey(new j(s,16),new j(o,16))};H.publicKeyToAsn1=H.publicKeyToSubjectPublicKeyInfo=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(H.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,[H.publicKeyToRSAPublicKey(t)])])};H.publicKeyToRSAPublicKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,Yt(t.e))])};function i0(t,e,r){var n=z.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var u=0,f=z.random.getBytes(o),c=0;c<o;++c)a=f.charCodeAt(c),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function Zs(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=z.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var f=s.getByte();if(f!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function S1(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){z.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.p=null,i();return}if(t.q.subtract(j.ONE).gcd(t.e).compareTo(j.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(j.ONE),t.q1=t.q.subtract(j.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(j.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var f=t.e.modInverse(t.phi);t.keys={privateKey:H.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:H.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Yt(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=z.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function E1(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function jl(t){return z.util.isNodejs&&typeof Ec[t]=="function"}function e0(t){return typeof bt.globalScope<"u"&&typeof bt.globalScope.crypto=="object"&&typeof bt.globalScope.crypto.subtle=="object"&&typeof bt.globalScope.crypto.subtle[t]=="function"}function t0(t){return typeof bt.globalScope<"u"&&typeof bt.globalScope.msCrypto=="object"&&typeof bt.globalScope.msCrypto.subtle=="object"&&typeof bt.globalScope.msCrypto.subtle[t]=="function"}function r0(t){for(var e=z.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var h0=D((cE,f0)=>{var N=fe();Fs();Di();yl();tn();Ds();dc();El();Mi();Nl();Js();Ce();typeof o0>"u"&&(o0=N.jsbn.BigInteger);var o0,E=N.asn1,W=N.pki=N.pki||{};f0.exports=W.pbe=N.pbe=N.pbe||{};var sn=W.oids,_1={name:"EncryptedPrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},A1={name:"PBES2Algorithms",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},I1={name:"pkcs-12PbeParams",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=N.random.getBytesSync(r.saltSize),i=r.count,s=E.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,f,h;switch(r.algorithm){case"aes128":o=16,u=16,f=sn["aes128-CBC"],h=N.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,f=sn["aes192-CBC"],h=N.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,f=sn["aes256-CBC"],h=N.aes.createEncryptionCipher;break;case"des":o=8,u=8,f=sn.desCBC,h=N.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=u0(d),g=N.pkcs5.pbkdf2(e,n,i,o,p),y=N.random.getBytesSync(u),v=h(g);v.start(y),v.update(E.toDer(t)),v.finish(),c=v.output.getBytes();var x=T1(n,s,o,d);a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(sn.pkcs5PBES2).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(sn.pkcs5PBKDF2).getBytes()),x]),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(f).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var A=new N.util.ByteBuffer(n),g=W.pbe.generatePkcs12Key(e,A,1,i,o),y=W.pbe.generatePkcs12Key(e,A,2,i,o),v=N.des.createEncryptionCipher(g);v.start(y),v.update(E.toDer(t)),v.finish(),c=v.output.getBytes(),a=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(sn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,n),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var _=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[a,E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,c)]);return _};W.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!E.validate(t,_1,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=E.derToOid(n.encryptionOid),a=W.pbe.getCipher(o,n.encryptionParams,e),c=N.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=E.fromDer(a.output)),r};W.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:E.toDer(t).getBytes()};return N.pem.encode(r,{maxline:e})};W.encryptedPrivateKeyFromPem=function(t){var e=N.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return E.fromDer(e.body)};W.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(t));return n=W.encryptPrivateKeyInfo(n,e,r),W.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=N.random.getBytesSync(16),a=N.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=N.random.getBytesSync(16),a=N.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=N.random.getBytesSync(16),a=N.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=N.random.getBytesSync(8),a=N.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=N.random.getBytesSync(8),a=N.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=N.pbe.opensslDeriveBytes(e,s.substr(0,8),o),f=a(u);f.start(s),f.update(E.toDer(W.privateKeyToAsn1(t))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:N.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return N.pem.encode(h)};W.decryptRsaPrivateKey=function(t,e){var r=null,n=N.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=N.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=N.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=N.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=N.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=N.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return N.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return N.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return N.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=N.util.hexToBytes(n.dekInfo.parameters),c=N.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(N.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(E.fromDer(r),e):r=E.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in N.md))throw new Error('"sha1" hash algorithm unavailable.');s=N.md.sha1.create()}var c=s.digestLength,u=s.blockLength,f=new N.util.ByteBuffer,h=new N.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=e.length(),p=new N.util.ByteBuffer;p.fillWithByte(r,u);var g=u*Math.ceil(d/u),y=new N.util.ByteBuffer;for(a=0;a<g;a++)y.putByte(e.at(a%d));var v=u*Math.ceil(l/u),x=new N.util.ByteBuffer;for(a=0;a<v;a++)x.putByte(h.at(a%l));var A=y;A.putBuffer(x);for(var _=Math.ceil(i/c),w=1;w<=_;w++){var S=new N.util.ByteBuffer;S.putBytes(p.bytes()),S.putBytes(A.bytes());for(var P=0;P<n;P++)s.start(),s.update(S.getBytes()),S=s.digest();var O=new N.util.ByteBuffer;for(a=0;a<u;a++)O.putByte(S.at(a%c));var K=Math.ceil(d/u)+Math.ceil(l/u),$=new N.util.ByteBuffer;for(o=0;o<K;o++){var ue=new N.util.ByteBuffer(A.getBytes(u)),Q=511;for(a=O.length()-1;a>=0;a--)Q=Q>>8,Q+=O.at(a)+ue.at(a),ue.setAt(a,Q&255);$.putBuffer(ue)}A=$,f.putBuffer(S)}return f.truncate(f.length()-i),f};W.pbe.getCipher=function(t,e,r){switch(t){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(t,e,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!E.validate(e,A1,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=E.derToOid(n.kdfOid),t!==W.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=E.derToOid(n.encOid),t!==W.oids["aes128-CBC"]&&t!==W.oids["aes192-CBC"]&&t!==W.oids["aes256-CBC"]&&t!==W.oids["des-EDE3-CBC"]&&t!==W.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=N.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(W.oids[t]){case"aes128-CBC":c=16,u=N.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=N.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=N.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=N.des.createDecryptionCipher;break;case"desCBC":c=8,u=N.des.createDecryptionCipher;break}var f=c0(n.prfOid),h=N.pkcs5.pbkdf2(r,o,a,c,f),l=n.encIv,d=u(h);return d.start(l),d};W.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!E.validate(e,I1,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=N.util.createBuffer(n.salt),a=N.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,f;switch(t){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,f=N.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,f=function(g,y){var v=N.rc2.createDecryptionCipher(g,40);return v.start(y,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=c0(n.prfOid),l=W.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var d=W.pbe.generatePkcs12Key(r,o,2,a,u,h);return f(l,d)};W.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in N.md))throw new Error('"md5" hash algorithm unavailable.');n=N.md.md5.create()}e===null&&(e="");for(var i=[a0(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(a0(n,i[o-1]+t+e));return i.join("").substr(0,r)};function a0(t,e){return t.start().update(e).digest().getBytes()}function c0(t){var e;if(!t)e="hmacWithSHA1";else if(e=W.oids[E.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return u0(e)}function u0(t){var e=N.md;switch(t){case"hmacWithSHA224":e=N.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function T1(t,e,r,n){var i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,t),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,N.util.hexToBytes(r.toString(16))),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(W.oids[n]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])),i}});var U0=D((b4,F0)=>{var me=fe();tn();Ce();var qi=F0.exports=me.sha512=me.sha512||{};me.md.sha512=me.md.algorithms.sha512=qi;var L0=me.sha384=me.sha512.sha384=me.sha512.sha384||{};L0.create=function(){return qi.create("SHA-384")};me.md.sha384=me.md.algorithms.sha384=L0;me.sha512.sha256=me.sha512.sha256||{create:function(){return qi.create("SHA-512/256")}};me.md["sha512/256"]=me.md.algorithms["sha512/256"]=me.sha512.sha256;me.sha512.sha224=me.sha512.sha224||{create:function(){return qi.create("SHA-512/224")}};me.md["sha512/224"]=me.md.algorithms["sha512/224"]=me.sha512.sha224;qi.create=function(t){if(O0||e2(),typeof t>"u"&&(t="SHA-512"),!(t in cn))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=cn[t],r=null,n=me.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=me.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=me.util.encodeUtf8(c));var f=c.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=f[1],f[1]=f[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(c),N0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=me.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=u&a.blockLength-1;c.putBytes(qc.substr(0,a.blockLength-f));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,c.putInt32(d>>>0),d=h>>>0;c.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);N0(g,i,c);var y=me.util.createBuffer(),v;t==="SHA-512"?v=g.length:t==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)y.putInt32(g[p][0]),(p!==v-1||t!=="SHA-512/224")&&y.putInt32(g[p][1]);return y},a};var qc=null,O0=!1,Vc=null,cn=null;function e2(){qc=String.fromCharCode(128),qc+=me.util.fillString(String.fromCharCode(0),128),Vc=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],cn={},cn["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],cn["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],cn["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],cn["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],O0=!0}function N0(t,e,r){for(var n,i,s,o,a,c,u,f,h,l,d,p,g,y,v,x,A,_,w,S,P,O,K,$,ue,Q,ir,Ke,Ee,Ge,G,yn,ci,Ye,mn,vn=r.length();vn>=128;){for(Ee=0;Ee<16;++Ee)e[Ee][0]=r.getInt32()>>>0,e[Ee][1]=r.getInt32()>>>0;for(;Ee<80;++Ee)yn=e[Ee-2],Ge=yn[0],G=yn[1],n=((Ge>>>19|G<<13)^(G>>>29|Ge<<3)^Ge>>>6)>>>0,i=((Ge<<13|G>>>19)^(G<<3|Ge>>>29)^(Ge<<26|G>>>6))>>>0,Ye=e[Ee-15],Ge=Ye[0],G=Ye[1],s=((Ge>>>1|G<<31)^(Ge>>>8|G<<24)^Ge>>>7)>>>0,o=((Ge<<31|G>>>1)^(Ge<<24|G>>>8)^(Ge<<25|G>>>7))>>>0,ci=e[Ee-7],mn=e[Ee-16],G=i+ci[1]+o+mn[1],e[Ee][0]=n+ci[0]+s+mn[0]+(G/4294967296>>>0)>>>0,e[Ee][1]=G>>>0;for(g=t[0][0],y=t[0][1],v=t[1][0],x=t[1][1],A=t[2][0],_=t[2][1],w=t[3][0],S=t[3][1],P=t[4][0],O=t[4][1],K=t[5][0],$=t[5][1],ue=t[6][0],Q=t[6][1],ir=t[7][0],Ke=t[7][1],Ee=0;Ee<80;++Ee)u=((P>>>14|O<<18)^(P>>>18|O<<14)^(O>>>9|P<<23))>>>0,f=((P<<18|O>>>14)^(P<<14|O>>>18)^(O<<23|P>>>9))>>>0,h=(ue^P&(K^ue))>>>0,l=(Q^O&($^Q))>>>0,a=((g>>>28|y<<4)^(y>>>2|g<<30)^(y>>>7|g<<25))>>>0,c=((g<<4|y>>>28)^(y<<30|g>>>2)^(y<<25|g>>>7))>>>0,d=(g&v|A&(g^v))>>>0,p=(y&x|_&(y^x))>>>0,G=Ke+f+l+Vc[Ee][1]+e[Ee][1],n=ir+u+h+Vc[Ee][0]+e[Ee][0]+(G/4294967296>>>0)>>>0,i=G>>>0,G=c+p,s=a+d+(G/4294967296>>>0)>>>0,o=G>>>0,ir=ue,Ke=Q,ue=K,Q=$,K=P,$=O,G=S+i,P=w+n+(G/4294967296>>>0)>>>0,O=G>>>0,w=A,S=_,A=v,_=x,v=g,x=y,G=i+o,g=n+s+(G/4294967296>>>0)>>>0,y=G>>>0;G=t[0][1]+y,t[0][0]=t[0][0]+g+(G/4294967296>>>0)>>>0,t[0][1]=G>>>0,G=t[1][1]+x,t[1][0]=t[1][0]+v+(G/4294967296>>>0)>>>0,t[1][1]=G>>>0,G=t[2][1]+_,t[2][0]=t[2][0]+A+(G/4294967296>>>0)>>>0,t[2][1]=G>>>0,G=t[3][1]+S,t[3][0]=t[3][0]+w+(G/4294967296>>>0)>>>0,t[3][1]=G>>>0,G=t[4][1]+O,t[4][0]=t[4][0]+P+(G/4294967296>>>0)>>>0,t[4][1]=G>>>0,G=t[5][1]+$,t[5][0]=t[5][0]+K+(G/4294967296>>>0)>>>0,t[5][1]=G>>>0,G=t[6][1]+Q,t[6][0]=t[6][0]+ue+(G/4294967296>>>0)>>>0,t[6][1]=G>>>0,G=t[7][1]+Ke,t[7][0]=t[7][0]+ir+(G/4294967296>>>0)>>>0,t[7][1]=G>>>0,vn-=128}}});var _p=D((T_,Ep)=>{"use strict";function Ie(t,r){var r=r||{};this._head=0,this._tail=0,this._capacity=r.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}Ie.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};Ie.prototype.get=function(e){return this.peekAt(e)};Ie.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Ie.prototype.peekFront=function(){return this.peek()};Ie.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Ie.prototype,"length",{get:function(){return this.size()}});Ie.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Ie.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Ie.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Ie.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Ie.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};Ie.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return s}}};Ie.prototype.remove=function(e,r){var n=e,i,s=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return i=new Array(1),i[0]=this.removeOne(n),i;if(n===0&&n+r>=o)return i=this.toArray(),this.clear(),i;n+r>o&&(r=o-n);var c;for(i=new Array(r),c=0;c<r;c++)i[c]=this._list[this._head+n+c&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(n<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;s>0;)this._list[n=n-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),i}}};Ie.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var i=this.size();if(n<0&&(n+=i),!(n>i))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,f=2;if(!i||n<i/2){for(o=new Array(n),s=0;s<n;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);c>f;)this.unshift(arguments[--c]);for(s=n;s>0;s--)this.unshift(o[s-1])}else{o=new Array(i-(n+r));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+n+r+s&this._capacityMask];for(r===0?(a=[],n!=i&&(this._tail=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+u&this._capacityMask);f<c;)this.push(arguments[f++]);for(s=0;s<h;s++)this.push(o[s])}return a}else return this.remove(n,r)}};Ie.prototype.clear=function(){this._head=0,this._tail=0};Ie.prototype.isEmpty=function(){return this._head===this._tail};Ie.prototype.toArray=function(){return this._copyArray(!1)};Ie.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};Ie.prototype._copyArray=function(e){var r=[],n=this._list,i=n.length,s;if(e||this._head>this._tail){for(s=this._head;s<i;s++)r.push(n[s]);for(s=0;s<this._tail;s++)r.push(n[s])}else for(s=this._head;s<this._tail;s++)r.push(n[s]);return r};Ie.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};Ie.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Ep.exports=Ie});var Vp=D((t3,qp)=>{"use strict";function Kp(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function eb(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Kp(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Kp(new i,r)}}qp.exports=eb});var $p=D((A3,Wp)=>{Wp.exports=uu;var Hp=128,ub=127,fb=~ub,hb=Math.pow(2,31);function uu(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw uu.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=hb;)e[r++]=t&255|Hp,t/=128;for(;t&fb;)e[r++]=t&255|Hp,t>>>=7;return e[r]=t|0,uu.bytes=r-n+1,e}});var Qp=D((I3,Jp)=>{Jp.exports=fu;var lb=128,Zp=127;function fu(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a||i>49)throw fu.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Zp)<<i:(o&Zp)*Math.pow(2,i),i+=7}while(o>=lb);return fu.bytes=s-n,r}});var Xp=D((T3,Yp)=>{var pb=Math.pow(2,7),db=Math.pow(2,14),gb=Math.pow(2,21),yb=Math.pow(2,28),mb=Math.pow(2,35),vb=Math.pow(2,42),bb=Math.pow(2,49),xb=Math.pow(2,56),wb=Math.pow(2,63);Yp.exports=function(t){return t<pb?1:t<db?2:t<gb?3:t<yb?4:t<mb?5:t<vb?6:t<bb?7:t<xb?8:t<wb?9:10}});var ed=D((B3,jp)=>{jp.exports={encode:$p(),decode:Qp(),encodingLength:Xp()}});var ox={};Ve(ox,{GossipSub:()=>ji,gossipsub:()=>sx,multicodec:()=>ix});var rs=class{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},bn=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new rs(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new rs(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function sr(t={}){return bd(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function bd(t,e){e=e??{};let r=e.onEnd,n=new bn,i,s,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((g,y)=>{s=v=>{s=null,n.push(v);try{g(t(n))}catch(x){y(x)}return i}}):t(n),c=g=>s!=null?s(g):(n.push(g),i),u=g=>(n=new bn,s!=null?s({error:g}):(n.push({error:g}),i)),f=g=>{if(o)return i;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:g})},h=g=>o?i:(o=!0,g!=null?u(g):c({done:!0})),l=()=>(n=new bn,h(),{done:!0}),d=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:l,throw:d,push:f,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(g){return p.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:f,end(g){return p.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return p.readableLength}},i}function xd(t){return t[Symbol.asyncIterator]!=null}function wd(...t){let e=[];for(let r of t)xd(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=sr({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var du=wd;function xn(t,...e){if(t==null)throw new Error("Empty pipeline");if(Po(t)){let n=t;t=()=>n.source}else if(yu(t)||gu(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&Po(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)Po(r[n])&&(r[n]=Ed(r[n]));return Sd(...r)}var Sd=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},gu=t=>t?.[Symbol.asyncIterator]!=null,yu=t=>t?.[Symbol.iterator]!=null,Po=t=>t==null?!1:t.sink!=null&&t.source!=null,Ed=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=sr({objectMode:!0});r.then(()=>{n.end()},o=>{n.end(o)});let i,s=t.source;if(gu(s))i=async function*(){yield*s,n.end()};else if(yu(s))i=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return du(n,i())}return t.source};var _d=bu,mu=128,Ad=127,Id=~Ad,Td=Math.pow(2,31);function bu(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Td;)e[r++]=t&255|mu,t/=128;for(;t&Id;)e[r++]=t&255|mu,t>>>=7;return e[r]=t|0,bu.bytes=r-n+1,e}var Bd=ko,Cd=128,vu=127;function ko(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw ko.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&vu)<<i:(o&vu)*Math.pow(2,i),i+=7}while(o>=Cd);return ko.bytes=s-n,r}var Rd=Math.pow(2,7),Pd=Math.pow(2,14),kd=Math.pow(2,21),Dd=Math.pow(2,28),Md=Math.pow(2,35),Nd=Math.pow(2,42),Ld=Math.pow(2,49),Od=Math.pow(2,56),Fd=Math.pow(2,63),Ud=function(t){return t<Rd?1:t<Pd?2:t<kd?3:t<Dd?4:t<Md?5:t<Nd?6:t<Ld?7:t<Od?8:t<Fd?9:10},Kd={encode:_d,decode:Bd,encodingLength:Ud},qd=Kd,ui=qd;var fi=(t,e=0)=>[ui.decode(t,e),ui.decode.bytes],wn=(t,e,r=0)=>(ui.encode(t,e,r),e),Sn=t=>ui.encodingLength(t);var bx=new Uint8Array(0);var xu=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},or=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var wu=t=>new TextEncoder().encode(t),Su=t=>new TextDecoder().decode(t);var br=(t,e)=>{let r=e.byteLength,n=Sn(t),i=n+Sn(r),s=new Uint8Array(i+r);return wn(t,s,0),wn(r,s,n),s.set(e,i),new En(t,r,e,s)},_n=t=>{let e=or(t),[r,n]=fi(e),[i,s]=fi(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new En(r,i,o,e)},_u=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&xu(t.bytes,r.bytes)}},En=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Oo={};Ve(Oo,{base58btc:()=>ke,base58flickr:()=>$d});function Vd(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,y=0,v=0,x=p.length;v!==x&&p[v]===0;)v++,g++;for(var A=(x-v)*f+1>>>0,_=new Uint8Array(A);v!==x;){for(var w=p[v],S=0,P=A-1;(w!==0||S<y)&&P!==-1;P--,S++)w+=256*_[P]>>>0,_[P]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");y=S,v++}for(var O=A-y;O!==A&&_[O]===0;)O++;for(var K=c.repeat(g);O<A;++O)K+=t.charAt(_[O]);return K}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var y=0,v=0;p[g]===c;)y++,g++;for(var x=(p.length-g)*u+1>>>0,A=new Uint8Array(x);p[g];){var _=r[p.charCodeAt(g)];if(_===255)return;for(var w=0,S=x-1;(_!==0||w<v)&&S!==-1;S--,w++)_+=a*A[S]>>>0,A[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");v=w,g++}if(p[g]!==" "){for(var P=x-v;P!==x&&A[P]===0;)P++;for(var O=new Uint8Array(y+(x-P)),K=y;P!==x;)O[K++]=A[P++];return O}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var zd=Vd,Gd=zd,Au=Gd;var Do=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Mo=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Iu(this,e)}},No=class{constructor(e){this.decoders=e}or(e){return Iu(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Iu=(t,e)=>new No({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Lo=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Do(e,r,n),this.decoder=new Mo(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},An=({name:t,prefix:e,encode:r,decode:n})=>new Lo(t,e,r,n),xr=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Au(r,e);return An({prefix:t,name:e,encode:n,decode:s=>or(i(s))})},Hd=(t,e,r,n)=>{let i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let f=0;f<s;++f){let h=i[t[f]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Wd=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},_e=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>An({prefix:e,name:t,encode(i){return Wd(i,n,r)},decode(i){return Hd(i,n,r,t)}});var ke=xr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$d=xr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Fo={};Ve(Fo,{base32:()=>ar,base32hex:()=>Yd,base32hexpad:()=>jd,base32hexpadupper:()=>eg,base32hexupper:()=>Xd,base32pad:()=>Jd,base32padupper:()=>Qd,base32upper:()=>Zd,base32z:()=>tg});var ar=_e({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Zd=_e({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Jd=_e({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Qd=_e({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yd=_e({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Xd=_e({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jd=_e({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),eg=_e({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),tg=_e({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Tu=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return ng(r,Uo(t),e||ke.encoder);default:return ig(r,Uo(t),e||ar.encoder)}};var Bu=new WeakMap,Uo=t=>{let e=Bu.get(t);if(e==null){let r=new Map;return Bu.set(t,r),r}return e},be=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==hi)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==sg)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return be.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=br(e,r);return be.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return be.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&_u(e.multihash,n.multihash)}toString(e){return Tu(this,e)}toJSON(){return{"/":Tu(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof be)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:o}=r;return new be(n,i,s,o||Cu(n,i,s.bytes))}else if(r[og]===!0){let{version:n,multihash:i,code:s}=r,o=_n(i);return be.create(n,s,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==hi)throw new Error(`Version 0 CID must use dag-pb (code: ${hi}) block encoding`);return new be(e,r,n,n.bytes)}case 1:{let i=Cu(e,r,n.bytes);return new be(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return be.create(0,hi,e)}static createV1(e,r){return be.create(1,e,r)}static decode(e){let[r,n]=be.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=be.inspectBytes(e),n=r.size-r.multihashSize,i=or(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new En(r.multihashCode,r.digestSize,s,i);return[r.version===0?be.createV0(o):be.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=fi(e.subarray(r));return r+=l,h},i=n(),s=hi;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),u=r+c,f=u-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:f,size:u}}static parse(e,r){let[n,i]=rg(e,r),s=be.decode(i);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Uo(s).set(n,e),s}},rg=(t,e)=>{switch(t[0]){case"Q":{let r=e||ke;return[ke.prefix,r.decode(`${ke.prefix}${t}`)]}case ke.prefix:{let r=e||ke;return[ke.prefix,r.decode(t)]}case ar.prefix:{let r=e||ar;return[ar.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},ng=(t,e,r)=>{let{prefix:n}=r;if(n!==ke.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},ig=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},hi=112,sg=18,Cu=(t,e,r)=>{let n=Sn(t),i=n+Sn(e),s=new Uint8Array(i+r.byteLength);return wn(t,s,0),wn(e,s,n),s.set(r,i),s},og=Symbol.for("@ipld/js-cid/CID");var Ko={};Ve(Ko,{identity:()=>ag});var ag=An({prefix:"\0",name:"identity",encode:t=>Su(t),decode:t=>wu(t)});var qo={};Ve(qo,{base2:()=>cg});var cg=_e({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Vo={};Ve(Vo,{base8:()=>ug});var ug=_e({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zo={};Ve(zo,{base10:()=>fg});var fg=xr({prefix:"9",name:"base10",alphabet:"0123456789"});var Go={};Ve(Go,{base16:()=>hg,base16upper:()=>lg});var hg=_e({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lg=_e({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ho={};Ve(Ho,{base36:()=>pg,base36upper:()=>dg});var pg=xr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dg=xr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Wo={};Ve(Wo,{base64:()=>In,base64pad:()=>gg,base64url:()=>yg,base64urlpad:()=>mg});var In=_e({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gg=_e({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yg=_e({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mg=_e({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $o={};Ve($o,{base256emoji:()=>Sg});var Ru=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),vg=Ru.reduce((t,e,r)=>(t[r]=e,t),[]),bg=Ru.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function xg(t){return t.reduce((e,r)=>(e+=vg[r],e),"")}function wg(t){let e=[];for(let r of t){let n=bg[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Sg=An({prefix:"\u{1F680}",name:"base256emoji",encode:xg,decode:wg});var Qo={};Ve(Qo,{sha256:()=>Pe,sha512:()=>Eg});var Jo=({name:t,code:e,encode:r})=>new Zo(t,e,r),Zo=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?br(this.code,r):r.then(n=>br(this.code,n))}else throw Error("Unknown type, must be binary type")}};var ku=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pe=Jo({name:"sha2-256",code:18,encode:ku("SHA-256")}),Eg=Jo({name:"sha2-512",code:19,encode:ku("SHA-512")});var Yo={};Ve(Yo,{identity:()=>Tn});var Du=0,_g="identity",Mu=or,Ag=t=>br(Du,Mu(t)),Tn={code:Du,name:_g,encode:Mu,digest:Ag};var Gx=new TextEncoder,Hx=new TextDecoder;var wr={...Ko,...qo,...Vo,...zo,...Go,...Fo,...Ho,...Oo,...Wo,...$o},Qx={...Qo,...Yo};function ze(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var F=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Nu=Symbol.for("@libp2p/peer-id");var Bg=Symbol.for("nodejs.util.inspect.custom"),Lu=Object.values(wr).map(t=>t.decoder).reduce((t,e)=>t.or(e),wr.identity.decoder),Ou=114,Fu=36,Uu=37,li=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Nu](){return!0}toString(){return this.string==null&&(this.string=ke.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return be.createV1(Ou,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return ze(this.multihash.bytes,e);if(typeof e=="string")return Wr(e).equals(this);if(e?.multihash?.bytes!=null)return ze(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Bg](){return`PeerId(${this.toString()})`}},pi=class extends li{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},di=class extends li{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},gi=class extends li{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function Wr(t,e){if(e=e??Lu,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=_n(ke.decode(`z${t}`));return t.startsWith("12D")?new di({multihash:r}):t.startsWith("16U")?new gi({multihash:r}):new pi({multihash:r})}return Bn(Lu.decode(t))}function Bn(t){try{let e=_n(t);if(e.code===Tn.code){if(e.digest.length===Fu)return new di({multihash:e});if(e.digest.length===Uu)return new gi({multihash:e})}if(e.code===Pe.code)return new pi({multihash:e})}catch{return Cg(be.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Cg(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==Ou)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Pe.code)return new pi({multihash:t.multihash});if(e.code===Tn.code){if(e.digest.length===Fu)return new di({multihash:t.multihash});if(e.digest.length===Uu)return new gi({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}var lt=ae(Gu(),1);lt.default.formatters.b=t=>t==null?"undefined":ke.baseEncode(t);lt.default.formatters.t=t=>t==null?"undefined":ar.baseEncode(t);lt.default.formatters.m=t=>t==null?"undefined":In.baseEncode(t);lt.default.formatters.p=t=>t==null?"undefined":t.toString();lt.default.formatters.c=t=>t==null?"undefined":t.toString();lt.default.formatters.k=t=>t==null?"undefined":t.toString();function Vg(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function os(t){let e=Vg(`${t}:trace`);return lt.default.enabled(`${t}:trace`)&&lt.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,lt.default)(`${t}:trace`)),Object.assign((0,lt.default)(t),{error:(0,lt.default)(`${t}:error`),trace:e})}var Xo=Symbol.for("@libp2p/topology");var Hu=()=>{},jo=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??Hu,this.onDisconnect=e.onDisconnect??Hu}get[Symbol.toStringTag](){return Xo.toString()}get[Xo](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function Wu(t){return new jo(t)}var as=class extends EventTarget{#e=new Map;listenerCount(e){let r=this.#e.get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let i=this.#e.get(e);i==null&&(i=[],this.#e.set(e,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e.toString(),r??null,n);let i=this.#e.get(e);i!=null&&(i=i.filter(({callback:s})=>s!==r),this.#e.set(e,i))}dispatchEvent(e){let r=super.dispatchEvent(e),n=this.#e.get(e.type);return n==null||(n=n.filter(({once:i})=>!i),this.#e.set(e.type,n)),r}safeDispatchEvent(e,r){return this.dispatchEvent(new Sr(e,r))}},ea=class extends Event{detail;constructor(e,r){super(e,r),this.detail=r?.detail}},Sr=globalThis.CustomEvent??ea;var cs=class{constructor(e,r,n){this.gossip=e,this.msgs=new Map,this.history=[],this.notValidatedCount=0,this.msgIdToStrFn=n;for(let i=0;i<r;i++)this.history[i]=[]}get size(){return this.msgs.size}put(e,r,n=!1){let{msgIdStr:i}=e;return this.msgs.has(i)?!1:(this.msgs.set(i,{message:r,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:r.topic}),n||this.notValidatedCount++,!0)}observeDuplicate(e,r){let n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(r)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,r){let n=this.msgs.get(e);if(!n)return null;let i=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,i),{msg:n.message,count:i}}getGossipIDs(e){let r=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(i=>{let s=this.msgs.get(i.msgIdStr);if(s&&s.validated&&e.has(i.topic)){let o=r.get(i.topic);o||(o=[],r.set(i.topic,o)),o.push(i.msgId)}});return r}validate(e){let r=this.msgs.get(e);if(!r)return null;r.validated||this.notValidatedCount--;let{message:n,originatingPeers:i}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:i}}shift(){this.history[this.history.length-1].forEach(r=>{let n=this.msgs.get(r.msgIdStr);n&&(this.msgs.delete(r.msgIdStr),n.validated||this.notValidatedCount--)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r?(this.msgs.delete(e),r):null}};var Gh=ae(Ja(),1),Qa=Gh.default.Reader,em=["uint64","int64","sint64","fixed64","sfixed64"];em.forEach(t=>{let e=Qa.prototype[t];Qa.prototype[t]=function(){return BigInt(e.call(this).toString())}});function Bt(t,e){let r=Qa.create(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}var Hh=ae(Ja(),1),Ya=Hh.default.Writer,tm=["uint64","int64","sint64","fixed64","sfixed64"];tm.forEach(t=>{let e=Ya.prototype[t];Ya.prototype[t]=function(r){return e.call(this,r.toString())}});function Ct(t,e){let r=Ya.create();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Ci;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Ci||(Ci={}));function Xa(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Rt(t,e){return Xa("message",Ci.LENGTH_DELIMITED,t,e)}var Cr;(function(t){let e;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{p.lengthDelimited!==!1&&d.fork(),l.subscribe!=null&&(d.uint32(8),d.bool(l.subscribe)),l.topic!=null&&(d.uint32(18),d.string(l.topic)),p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.subscribe=l.bool();break;case 2:p.topic=l.string();break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(e=t.SubOpts||(t.SubOpts={}));let r;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{if(p.lengthDelimited!==!1&&d.fork(),l.from!=null&&(d.uint32(10),d.bytes(l.from)),l.data!=null&&(d.uint32(18),d.bytes(l.data)),l.seqno!=null&&(d.uint32(26),d.bytes(l.seqno)),l.topic!=null)d.uint32(34),d.string(l.topic);else throw new Error('Protocol error: required field "topic" was not found in object');l.signature!=null&&(d.uint32(42),d.bytes(l.signature)),l.key!=null&&(d.uint32(50),d.bytes(l.key)),p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={topic:""},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.from=l.bytes();break;case 2:p.data=l.bytes();break;case 3:p.seqno=l.bytes();break;case 4:p.topic=l.string();break;case 5:p.signature=l.bytes();break;case 6:p.key=l.bytes();break;default:l.skipType(y&7);break}}if(p.topic==null)throw new Error('Protocol error: value for required field "topic" was not found in protobuf');return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(r=t.Message||(t.Message={}));let n;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{if(p.lengthDelimited!==!1&&d.fork(),l.ihave!=null)for(let g of l.ihave)d.uint32(10),t.ControlIHave.codec().encode(g,d);else throw new Error('Protocol error: required field "ihave" was not found in object');if(l.iwant!=null)for(let g of l.iwant)d.uint32(18),t.ControlIWant.codec().encode(g,d);else throw new Error('Protocol error: required field "iwant" was not found in object');if(l.graft!=null)for(let g of l.graft)d.uint32(26),t.ControlGraft.codec().encode(g,d);else throw new Error('Protocol error: required field "graft" was not found in object');if(l.prune!=null)for(let g of l.prune)d.uint32(34),t.ControlPrune.codec().encode(g,d);else throw new Error('Protocol error: required field "prune" was not found in object');p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={ihave:[],iwant:[],graft:[],prune:[]},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.ihave.push(t.ControlIHave.codec().decode(l,l.uint32()));break;case 2:p.iwant.push(t.ControlIWant.codec().decode(l,l.uint32()));break;case 3:p.graft.push(t.ControlGraft.codec().decode(l,l.uint32()));break;case 4:p.prune.push(t.ControlPrune.codec().decode(l,l.uint32()));break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(n=t.ControlMessage||(t.ControlMessage={}));let i;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{if(p.lengthDelimited!==!1&&d.fork(),l.topicID!=null&&(d.uint32(10),d.string(l.topicID)),l.messageIDs!=null)for(let g of l.messageIDs)d.uint32(18),d.bytes(g);else throw new Error('Protocol error: required field "messageIDs" was not found in object');p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={messageIDs:[]},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.topicID=l.string();break;case 2:p.messageIDs.push(l.bytes());break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(i=t.ControlIHave||(t.ControlIHave={}));let s;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{if(p.lengthDelimited!==!1&&d.fork(),l.messageIDs!=null)for(let g of l.messageIDs)d.uint32(10),d.bytes(g);else throw new Error('Protocol error: required field "messageIDs" was not found in object');p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={messageIDs:[]},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.messageIDs.push(l.bytes());break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(s=t.ControlIWant||(t.ControlIWant={}));let o;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{p.lengthDelimited!==!1&&d.fork(),l.topicID!=null&&(d.uint32(10),d.string(l.topicID)),p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.topicID=l.string();break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(o=t.ControlGraft||(t.ControlGraft={}));let a;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{if(p.lengthDelimited!==!1&&d.fork(),l.topicID!=null&&(d.uint32(10),d.string(l.topicID)),l.peers!=null)for(let g of l.peers)d.uint32(18),t.PeerInfo.codec().encode(g,d);else throw new Error('Protocol error: required field "peers" was not found in object');l.backoff!=null&&(d.uint32(24),d.uint64(l.backoff)),p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={peers:[]},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.topicID=l.string();break;case 2:p.peers.push(t.PeerInfo.codec().decode(l,l.uint32()));break;case 3:p.backoff=l.uint64();break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(a=t.ControlPrune||(t.ControlPrune={}));let c;(function(f){let h;f.codec=()=>(h==null&&(h=Rt((l,d,p={})=>{p.lengthDelimited!==!1&&d.fork(),l.peerID!=null&&(d.uint32(10),d.bytes(l.peerID)),l.signedPeerRecord!=null&&(d.uint32(18),d.bytes(l.signedPeerRecord)),p.lengthDelimited!==!1&&d.ldelim()},(l,d)=>{let p={},g=d==null?l.len:l.pos+d;for(;l.pos<g;){let y=l.uint32();switch(y>>>3){case 1:p.peerID=l.bytes();break;case 2:p.signedPeerRecord=l.bytes();break;default:l.skipType(y&7);break}}return p})),h),f.encode=l=>Ct(l,f.codec()),f.decode=l=>Bt(l,f.codec())})(c=t.PeerInfo||(t.PeerInfo={}));let u;t.codec=()=>(u==null&&(u=Rt((f,h,l={})=>{if(l.lengthDelimited!==!1&&h.fork(),f.subscriptions!=null)for(let d of f.subscriptions)h.uint32(10),t.SubOpts.codec().encode(d,h);else throw new Error('Protocol error: required field "subscriptions" was not found in object');if(f.messages!=null)for(let d of f.messages)h.uint32(18),t.Message.codec().encode(d,h);else throw new Error('Protocol error: required field "messages" was not found in object');f.control!=null&&(h.uint32(26),t.ControlMessage.codec().encode(f.control,h)),l.lengthDelimited!==!1&&h.ldelim()},(f,h)=>{let l={subscriptions:[],messages:[]},d=h==null?f.len:f.pos+h;for(;f.pos<d;){let p=f.uint32();switch(p>>>3){case 1:l.subscriptions.push(t.SubOpts.codec().decode(f,f.uint32()));break;case 2:l.messages.push(t.Message.codec().decode(f,f.uint32()));break;case 3:l.control=t.ControlMessage.codec().decode(f,f.uint32());break;default:f.skipType(p&7);break}}return l})),u),t.encode=f=>Ct(f,t.codec()),t.decode=f=>Bt(f,t.codec())})(Cr||(Cr={}));var ja="/floodsub/1.0.0",ec="/meshsub/1.0.0",Rs="/meshsub/1.1.0";var Wh="ERR_TOPIC_VALIDATOR_REJECT",$h="ERR_TOPIC_VALIDATOR_IGNORE";function Ht(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),i=t[r];t[r]=t[n],t[n]=i}return t}function jr(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function hr(t=0){return globalThis.Buffer?.alloc!=null?jr(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function Pt(t=0){return globalThis.Buffer?.allocUnsafe!=null?jr(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Jh(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Zh=Jh("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),tc=Jh("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Pt(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),nm={utf8:Zh,"utf-8":Zh,hex:wr.base16,latin1:tc,ascii:tc,binary:tc,...wr},Ps=nm;function le(t,e="utf8"){let r=Ps[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Qh(t){return le(t,"base64")}var e_=ae(Di(),1),t_=ae(h0(),1);var R2=ae(fe(),1);function Fe(t,e="utf8"){let r=Ps[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?jr(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var Kc={};Ve(Kc,{Ed25519PrivateKey:()=>an,Ed25519PublicKey:()=>Ki,generateKeyPair:()=>Y1,generateKeyPairFromSeed:()=>P0,unmarshalEd25519PrivateKey:()=>J1,unmarshalEd25519PublicKey:()=>Q1});var B1=ae(Kn(),1);var Ue=BigInt(0),ee=BigInt(1),Lr=BigInt(2),C1=BigInt(8),l0=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),ye=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:l0,n:l0,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var m0=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Li=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),lE=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),R1=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),P1=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),k1=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),D1=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Y=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof we))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(we.ZERO)?Y.ZERO:new Y(e.x,e.y,ee,T(e.x*e.y))}static toAffineBatch(e){let r=L1(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){d0(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=T(r*a),u=T(s*i),f=T(n*a),h=T(o*i);return c===u&&f===h}negate(){return new Y(T(-this.x),this.y,this.z,T(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=ye,s=T(e*e),o=T(r*r),a=T(Lr*T(n*n)),c=T(i*s),u=e+r,f=T(T(u*u)-s-o),h=c+o,l=h-a,d=c-o,p=T(f*l),g=T(h*d),y=T(f*d),v=T(l*h);return new Y(p,g,v,y)}add(e){d0(e);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:c,t:u}=e,f=T((n-r)*(a+o)),h=T((n+r)*(a-o)),l=T(h-f);if(l===Ue)return this.double();let d=T(i*Lr*u),p=T(s*Lr*c),g=p+d,y=h+f,v=p-d,x=T(g*l),A=T(y*v),_=T(g*v),w=T(l*y);return new Y(x,A,w,_)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Y.BASE)&&(r=we.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Bc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Y.normalizeZ(i),Bc.set(r,i)));let s=Y.ZERO,o=Y.BASE,a=1+256/n,c=2**(n-1),u=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(e&u);e>>=h,p>c&&(p-=f,e+=ee);let g=d,y=d+Math.abs(p)-1,v=l%2!==0,x=p<0;p===0?o=o.add(p0(v,i[g])):s=s.add(p0(x,i[y]))}return Y.normalizeZ([s,o])[0]}multiply(e,r){return this.wNAF(Ys(e,ye.l),r)}multiplyUnsafe(e){let r=Ys(e,ye.l,!1),n=Y.BASE,i=Y.ZERO;if(r===Ue)return i;if(this.equals(i)||r===ee)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>Ue;)r&ee&&(s=s.add(o)),o=o.double(),r>>=ee;return s}isSmallOrder(){return this.multiplyUnsafe(ye.h).equals(Y.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(ye.l/Lr).double();return ye.l%Lr&&(e=e.add(this)),e.equals(Y.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,s=this.equals(Y.ZERO);e==null&&(e=s?C1:Xs(i));let o=T(r*e),a=T(n*e),c=T(i*e);if(s)return we.ZERO;if(c!==ee)throw new Error("invZ was invalid");return new we(o,a)}fromRistrettoBytes(){Ac()}toRistrettoBytes(){Ac()}fromRistrettoHash(){Ac()}};Y.BASE=new Y(ye.Gx,ye.Gy,ee,T(ye.Gx*ye.Gy));Y.ZERO=new Y(Ue,ee,ee,Ue);function p0(t,e){let r=e.negate();return t?r:e}function d0(t){if(!(t instanceof Y))throw new TypeError("ExtendedPoint expected")}function _c(t){if(!(t instanceof tt))throw new TypeError("RistrettoPoint expected")}function Ac(){throw new Error("Legacy method: switch to RistrettoPoint")}var tt=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=ye,n=T(Li*e*e),i=T((n+ee)*k1),s=BigInt(-1),o=T((s-r*n)*T(n+r)),{isValid:a,value:c}=Rc(i,o),u=T(c*e);Nr(u)||(u=T(-u)),a||(c=u),a||(s=n);let f=T(s*(n-ee)*D1-o),h=c*c,l=T((c+c)*o),d=T(f*R1),p=T(ee-h),g=T(ee+h);return new Y(T(l*g),T(p*d),T(d*g),T(l*p))}static hashToCurve(e){e=Or(e,64);let r=Ic(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Ic(e.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new tt(n.add(s))}static fromHex(e){e=Or(e,32);let{a:r,d:n}=ye,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Ic(e);if(!F1(Oi(s),e)||Nr(s))throw new Error(i);let o=T(s*s),a=T(ee+r*o),c=T(ee-r*o),u=T(a*a),f=T(c*c),h=T(r*n*u-f),{isValid:l,value:d}=y0(T(h*f)),p=T(d*c),g=T(d*p*h),y=T((s+s)*p);Nr(y)&&(y=T(-y));let v=T(a*g),x=T(y*v);if(!l||Nr(x)||v===Ue)throw new Error(i);return new tt(new Y(y,v,ee,x))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,s=T(T(n+r)*T(n-r)),o=T(e*r),a=T(o*o),{value:c}=y0(T(s*a)),u=T(c*s),f=T(c*o),h=T(u*f*i),l;if(Nr(i*h)){let p=T(r*Li),g=T(e*Li);e=p,r=g,l=T(u*P1)}else l=f;Nr(e*h)&&(r=T(-r));let d=T((n-r)*l);return Nr(d)&&(d=T(-d)),Oi(d)}toHex(){return Fi(this.toRawBytes())}toString(){return this.toHex()}equals(e){_c(e);let r=this.ep,n=e.ep,i=T(r.x*n.y)===T(r.y*n.x),s=T(r.y*n.y)===T(r.x*n.x);return i||s}add(e){return _c(e),new tt(this.ep.add(e.ep))}subtract(e){return _c(e),new tt(this.ep.subtract(e.ep))}multiply(e){return new tt(this.ep.multiply(e))}multiplyUnsafe(e){return new tt(this.ep.multiplyUnsafe(e))}};tt.BASE=new tt(Y.BASE);tt.ZERO=new tt(Y.ZERO);var Bc=new WeakMap,we=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Bc.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=ye;e=Or(e,32);let s=e.slice();s[31]=e[31]&-129;let o=Ui(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=m0)throw new Error("Expected 0 < hex < 2**256");let a=T(o*o),c=T(a-ee),u=T(n*a+ee),{isValid:f,value:h}=Rc(c,u);if(!f)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&ee)===ee;return(e[31]&128)!==0!==l&&(h=T(-h)),new we(h,o)}static async fromPrivateKey(e){return(await js(e)).point}toRawBytes(){let e=Oi(this.y);return e[31]|=this.x&ee?128:0,e}toHex(){return Fi(this.toRawBytes())}toX25519(){let{y:e}=this,r=T((ee+e)*Xs(ee-e));return Oi(r)}isTorsionFree(){return Y.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new we(T(-this.x),this.y)}add(e){return Y.fromAffine(this).add(Y.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Y.fromAffine(this).multiply(e,this).toAffine()}};we.BASE=new we(ye.Gx,ye.Gy);we.ZERO=new we(Ue,ee);var on=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Or(e,64),n=we.fromHex(r.slice(0,32),!1),i=Ui(r.slice(32,64));return new on(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof we))throw new Error("Expected Point instance");return Ys(r,ye.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Oi(this.s),32),e}toHex(){return Fi(this.toRawBytes())}};function g0(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var M1=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Fi(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=M1[t[r]];return e}function Cc(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function v0(t){let r=t.toString(16).padStart(64,"0");return Cc(r)}function Oi(t){return v0(t).reverse()}function Nr(t){return(T(t)&ee)===ee}function Ui(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Fi(Uint8Array.from(t).reverse()))}var N1=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Ic(t){return T(Ui(t)&N1)}function T(t,e=ye.P){let r=t%e;return r>=Ue?r:e+r}function Xs(t,e=ye.P){if(t===Ue||e<=Ue)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=T(t,e),n=e,i=Ue,s=ee,o=ee,a=Ue;for(;r!==Ue;){let u=n/r,f=n%r,h=i-o*u,l=s-a*u;n=r,r=f,i=o,s=a,o=h,a=l}if(n!==ee)throw new Error("invert: does not exist");return T(i,e)}function L1(t,e=ye.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===Ue?s:(r[a]=s,T(s*o,e)),ee),i=Xs(n,e);return t.reduceRight((s,o,a)=>o===Ue?s:(r[a]=T(s*r[a],e),T(s*o,e)),i),r}function Xt(t,e){let{P:r}=ye,n=t;for(;e-- >Ue;)n*=n,n%=r;return n}function O1(t){let{P:e}=ye,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),c=t*t%e*t%e,u=Xt(c,Lr)*c%e,f=Xt(u,ee)*t%e,h=Xt(f,r)*f%e,l=Xt(h,n)*h%e,d=Xt(l,i)*l%e,p=Xt(d,s)*d%e,g=Xt(p,o)*p%e,y=Xt(g,o)*p%e,v=Xt(y,n)*h%e;return{pow_p_5_8:Xt(v,Lr)*t%e,b2:c}}function Rc(t,e){let r=T(e*e*e),n=T(r*r*e),i=O1(t*n).pow_p_5_8,s=T(t*r*i),o=T(e*s*s),a=s,c=T(s*Li),u=o===t,f=o===T(-t),h=o===T(-t*Li);return u&&(s=a),(f||h)&&(s=c),Nr(s)&&(s=T(-s)),{isValid:u||f,value:s}}function y0(t){return Rc(ee,t)}function Qs(t){return T(Ui(t),ye.l)}function F1(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Or(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):Cc(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Ys(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(Ue<t)return t}else if(Ue<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function U1(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function K1(t){if(t=typeof t=="bigint"||typeof t=="number"?v0(Ys(t,m0)):Or(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function q1(t){let e=U1(t.slice(0,32)),r=t.slice(32,64),n=Qs(e),i=we.BASE.multiply(n),s=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:s}}var Tc;async function js(t){return q1(await Fr.sha512(K1(t)))}async function Pc(t){return(await js(t)).pointBytes}async function b0(t,e){t=Or(t);let{prefix:r,scalar:n,pointBytes:i}=await js(e),s=Qs(await Fr.sha512(r,t)),o=we.BASE.multiply(s),a=Qs(await Fr.sha512(o.toRawBytes(),i,t)),c=T(s+a*n,ye.l);return new on(o,c).toRawBytes()}function V1(t,e,r){e=Or(e),r instanceof we||(r=we.fromHex(r,!1));let{r:n,s:i}=t instanceof on?t.assertValidity():on.fromHex(t),s=Y.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:e}}function z1(t,e,r,n){let i=Qs(n),s=Y.fromAffine(t).multiplyUnsafe(i);return Y.fromAffine(e).add(s).subtract(r).multiplyUnsafe(ye.h).equals(Y.ZERO)}async function x0(t,e,r){let{r:n,SB:i,msg:s,pub:o}=V1(t,e,r),a=await Fr.sha512(n.toRawBytes(),o.toRawBytes(),s);return z1(o,n,i,a)}we.BASE._setWindowSize(8);var Mr={node:B1,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Fr={bytesToHex:Fi,hexToBytes:Cc,concatBytes:g0,getExtendedPublicKey:js,mod:T,invert:Xs,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=Or(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return T(Ui(t),ye.l-ee)+ee},randomBytes:(t=32)=>{if(Mr.web)return Mr.web.getRandomValues(new Uint8Array(t));if(Mr.node){let{randomBytes:e}=Mr.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Fr.randomBytes(32),sha512:async(...t)=>{let e=g0(...t);if(Mr.web){let r=await Mr.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(Mr.node)return Uint8Array.from(Mr.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=we.BASE){let r=e.equals(we.BASE)?e:new we(e.x,e.y);return r._setWindowSize(t),r.multiply(Lr),r},sha512Sync:void 0};Object.defineProperties(Fr,{sha512Sync:{configurable:!1,get(){return Tc},set(t){Tc||(Tc=t)}}});var zn=32,gr=64,eo=32;async function w0(){let t=Fr.randomPrivateKey(),e=await Pc(t);return{privateKey:A0(t,e),publicKey:e}}async function S0(t){if(t.length!==eo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Pc(e);return{privateKey:A0(e,r),publicKey:r}}async function E0(t,e){let r=t.subarray(0,eo);return b0(e,r)}async function _0(t,e,r){return x0(e,r,t)}function A0(t,e){let r=new Uint8Array(gr);for(let n=0;n<eo;n++)r[n]=t[n],r[eo+n]=e[n];return r}function rt(t,e){e==null&&(e=t.reduce((i,s)=>i+s.length,0));let r=Pt(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return jr(r)}var nt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var kc={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Dc(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",s=t?.saltLength??16,o=t?.iterations??32767,a=nt.get();r*=8;async function c(h,l){let d=a.getRandomValues(new Uint8Array(s)),p=a.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=Fe(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",kc,{name:"AES-GCM"},!0,["encrypt"]);try{let x={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},A=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(x,A,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",kc,{name:"AES-GCM"},!0,["encrypt"])}}else{let x={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},A=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(x,A,{name:e,length:r},!0,["encrypt"])}let v=await a.subtle.encrypt(g,y,h);return rt([d,g.iv,new Uint8Array(v)])}async function u(h,l){let d=h.subarray(0,s),p=h.subarray(s,s+n),g=h.subarray(s+n),y={name:e,iv:p};typeof l=="string"&&(l=Fe(l));let v;if(l.length===0)try{let A={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},_=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await a.subtle.deriveKey(A,_,{name:e,length:r},!0,["decrypt"])}catch{v=await a.subtle.importKey("jwk",kc,{name:"AES-GCM"},!0,["decrypt"])}else{let A={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},_=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await a.subtle.deriveKey(A,_,{name:e,length:r},!0,["decrypt"])}let x=await a.subtle.decrypt(y,v,g);return new Uint8Array(x)}return{encrypt:c,decrypt:u}}async function Gn(t,e){let n=await Dc().encrypt(t,e);return In.encode(n)}var Mc=ae(bi(),1),T0=ae(da(),1),B0=ae(Et(),1),Nc=ae(vi(),1),C0=ae(ha(),1);function W1(){B0.default._configure(),Mc.default._configure(T0.default),Nc.default._configure(C0.default)}W1();var R0=["uint64","int64","sint64","fixed64","sfixed64"];function $1(t){for(let e of R0){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Lc(t){return $1(new Mc.default(t))}function Z1(t){for(let e of R0){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Oc(){return Z1(Nc.default.create())}function to(t,e){let r=Lc(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function ro(t,e){let r=Oc();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Hn;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Hn||(Hn={}));function no(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Fc(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(s,o){let a=e(s);o.int32(a)},n=function(s){let o=s.int32();return e(o)};return no("enum",Hn.VARINT,r,n)}function io(t,e){return no("message",Hn.LENGTH_DELIMITED,t,e)}var Se;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(Se||(Se={}));var Uc;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Uc||(Uc={}));(function(t){t.codec=()=>Fc(Uc)})(Se||(Se={}));var jt;(function(t){let e;t.codec=()=>(e==null&&(e=io((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Se.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=Se.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>ro(r,t.codec()),t.decode=r=>to(r,t.codec())})(jt||(jt={}));var er;(function(t){let e;t.codec=()=>(e==null&&(e=io((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Se.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.Type=Se.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>ro(r,t.codec()),t.decode=r=>to(r,t.codec())})(er||(er={}));var Ki=class{_key;constructor(e){this._key=Wn(e,zn)}async verify(e,r){return _0(this._key,r,e)}marshal(){return this._key}get bytes(){return jt.encode({Type:Se.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ze(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pe.digest(this.bytes);return e}},an=class{_key;_publicKey;constructor(e,r){this._key=Wn(e,gr),this._publicKey=Wn(r,zn)}async sign(e){return E0(this._key,e)}get public(){return new Ki(this._publicKey)}marshal(){return this._key}get bytes(){return er.encode({Type:Se.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ze(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pe.digest(this.bytes);return e}async id(){let e=Tn.digest(this.public.bytes);return ke.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Gn(this.bytes,e);throw new F(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function J1(t){if(t.length>gr){t=Wn(t,gr+zn);let n=t.subarray(0,gr),i=t.subarray(gr,t.length);return new an(n,i)}t=Wn(t,gr);let e=t.subarray(0,gr),r=t.subarray(zn);return new an(e,r)}function Q1(t){return t=Wn(t,zn),new Ki(t)}async function Y1(){let{privateKey:t,publicKey:e}=await w0();return new an(t,e)}async function P0(t){let{privateKey:e,publicKey:r}=await S0(t);return new an(e,r)}function Wn(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new F(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var HE=ae(Ce(),1),WE=ae(Ws(),1),k0=ae(fe(),1);function Mt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rt([new Uint8Array(e-r.length),r])}return le(r,"base64url")}function ct(t){let e=D0(t);return new k0.default.jsbn.BigInteger(le(e,"base16"),16)}function D0(t,e){let r=Fe(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rt([new Uint8Array(e-r.length),r])}return r}var X1={"P-256":256,"P-384":384,"P-521":521},j1=Object.keys(X1),n4=j1.join(" / ");var Yc={};Ve(Yc,{RsaPrivateKey:()=>jn,RsaPublicKey:()=>$i,fromJwk:()=>_2,generateKeyPair:()=>A2,unmarshalRsaPrivateKey:()=>S2,unmarshalRsaPublicKey:()=>E2});var Wi=ae(fe(),1);var q4=ae(U0(),1);var t2=ae(Kn(),1);var te=BigInt(0),ve=BigInt(1),Kr=BigInt(2),zi=BigInt(3),K0=BigInt(8),Ae=Object.freeze({a:te,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:ve,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),q0=(t,e)=>(t+e/Kr)/e,oo={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=Ae,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ve*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=q0(s*t,e),c=q0(-n*t,e),u=L(t-a*r-c*i,e),f=L(-a*n-c*s,e),h=u>o,l=f>o;if(h&&(u=e-u),l&&(f=e-f),u>o||f>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:u,k2neg:l,k2:f}}},Nt=32,Jn=32,r2=32,V0=Nt+1,z0=2*Nt+1;function G0(t){let{a:e,b:r}=Ae,n=L(t*t),i=L(n*t);return L(i+e*t+r)}var ao=Ae.a===te,fo=class extends Error{constructor(e){super(e)}};function H0(t){if(!(t instanceof ie))throw new TypeError("JacobianPoint expected")}var ie=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof oe))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(oe.ZERO)?ie.ZERO:new ie(e.x,e.y,ve)}static toAffineBatch(e){let r=a2(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return ie.toAffineBatch(e).map(ie.fromAffine)}equals(e){H0(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=L(i*i),u=L(a*a),f=L(r*u),h=L(s*c),l=L(L(n*a)*u),d=L(L(o*i)*c);return f===h&&l===d}negate(){return new ie(this.x,L(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=L(e*e),s=L(r*r),o=L(s*s),a=e+s,c=L(Kr*(L(a*a)-i-o)),u=L(zi*i),f=L(u*u),h=L(f-Kr*c),l=L(u*(c-h)-K0*o),d=L(Kr*r*n);return new ie(h,l,d)}add(e){H0(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e;if(s===te||o===te)return this;if(r===te||n===te)return e;let c=L(i*i),u=L(a*a),f=L(r*u),h=L(s*c),l=L(L(n*a)*u),d=L(L(o*i)*c),p=L(h-f),g=L(d-l);if(p===te)return g===te?this.double():ie.ZERO;let y=L(p*p),v=L(p*y),x=L(f*y),A=L(g*g-v-Kr*x),_=L(g*(x-A)-l*v),w=L(i*a*p);return new ie(A,_,w)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=ie.ZERO;if(typeof e=="bigint"&&e===te)return r;let n=Z0(e);if(n===ve)return this;if(!ao){let h=r,l=this;for(;n>te;)n&ve&&(h=h.add(l)),l=l.double(),n>>=ve;return h}let{k1neg:i,k1:s,k2neg:o,k2:a}=oo.splitScalar(n),c=r,u=r,f=this;for(;s>te||a>te;)s&ve&&(c=c.add(f)),a&ve&&(u=u.add(f)),f=f.double(),s>>=ve,a>>=ve;return i&&(c=c.negate()),o&&(u=u.negate()),u=new ie(L(u.x*oo.beta),u.y,u.z),c.add(u)}precomputeWindow(e){let r=ao?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(ie.BASE)&&(r=oe.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Gc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=ie.normalizeZ(i),Gc.set(r,i)));let s=ie.ZERO,o=ie.BASE,a=1+(ao?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*c,p=Number(e&u);e>>=h,p>c&&(p-=f,e+=ve);let g=d,y=d+Math.abs(p)-1,v=l%2!==0,x=p<0;p===0?o=o.add(co(v,i[g])):s=s.add(co(x,i[y]))}return{p:s,f:o}}multiply(e,r){let n=Z0(e),i,s;if(ao){let{k1neg:o,k1:a,k2neg:c,k2:u}=oo.splitScalar(n),{p:f,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(u,r);f=co(o,f),l=co(c,l),l=new ie(L(l.x*oo.beta),l.y,l.z),i=f.add(l),s=h.add(d)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return ie.normalizeZ([i,s])[0]}toAffine(e){let{x:r,y:n,z:i}=this,s=this.equals(ie.ZERO);e==null&&(e=s?K0:Xn(i));let o=e,a=L(o*o),c=L(a*o),u=L(r*a),f=L(n*c),h=L(i*o);if(s)return oe.ZERO;if(h!==ve)throw new Error("invZ was invalid");return new oe(u,f)}};ie.BASE=new ie(Ae.Gx,Ae.Gy,ve);ie.ZERO=new ie(te,ve,te);function co(t,e){let r=e.negate();return t?r:e}var Gc=new WeakMap,oe=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Gc.delete(this)}hasEvenY(){return this.y%Kr===te}static fromCompressedHex(e){let r=e.length===32,n=qr(r?e:e.subarray(1));if(!zc(n))throw new Error("Point is not on curve");let i=G0(n),s=o2(i),o=(s&ve)===ve;r?o&&(s=L(-s)):(e[0]&1)===1!==o&&(s=L(-s));let a=new oe(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=qr(e.subarray(1,Nt+1)),n=qr(e.subarray(Nt+1,Nt*2+1)),i=new oe(r,n);return i.assertValidity(),i}static fromHex(e){let r=Yn(e),n=r.length,i=r[0];if(n===Nt)return this.fromCompressedHex(r);if(n===V0&&(i===2||i===3))return this.fromCompressedHex(r);if(n===z0&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${V0} compressed bytes or ${z0} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return oe.BASE.multiply(lo(e))}static fromSignature(e,r,n){let{r:i,s}=J0(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let o=$c(Yn(e)),{n:a}=Ae,c=n===2||n===3?i+a:i,u=Xn(c,a),f=L(-o*u,a),h=L(s*u,a),l=n&1?"03":"02",d=oe.fromHex(l+$n(c)),p=oe.BASE.multiplyAndAddUnsafe(d,f,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return un(this.toHex(e))}toHex(e=!1){let r=$n(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${$n(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!zc(r)||!zc(n))throw new Error(e);let i=L(n*n),s=G0(r);if(L(i-s)!==te)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new oe(this.x,L(-this.y))}double(){return ie.fromAffine(this).double().toAffine()}add(e){return ie.fromAffine(this).add(ie.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ie.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=ie.fromAffine(this),s=r===te||r===ve||this!==oe.BASE?i.multiplyUnsafe(r):i.multiply(r),o=ie.fromAffine(e).multiplyUnsafe(n),a=s.add(o);return a.equals(ie.ZERO)?void 0:a.toAffine()}};oe.BASE=new oe(Ae.Gx,Ae.Gy);oe.ZERO=new oe(te,te);function W0(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function $0(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Qn(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:qr(r),left:t.subarray(e+2)}}function n2(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Qn(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=$0(t.subarray(2)),{data:n,left:i}=$0(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Qn(i)}`);return{r:e,s:n}}var tr=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Qn(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new tr(ho(i.slice(0,64)),ho(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=n2(r?e:un(e));return new tr(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Hi(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Hi(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=Ae.n>>ve;return this.s>e}normalizeS(){return this.hasHighS()?new tr(this.r,L(-this.s,Ae.n)):this}toDERRawBytes(){return un(this.toDERHex())}toDERHex(){let e=W0(Vi(this.s)),r=W0(Vi(this.r)),n=e.length/2,i=r.length/2,s=Vi(n),o=Vi(i);return`30${Vi(i+n+4)}02${o}${r}02${s}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return un(this.toCompactHex())}toCompactHex(){return $n(this.r)+$n(this.s)}};function Ur(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var i2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Qn(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=i2[t[r]];return e}var s2=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function $n(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(te<=t&&t<s2))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function Hc(t){let e=un($n(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Vi(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ho(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function un(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function qr(t){return ho(Qn(t))}function Yn(t){return t instanceof Uint8Array?Uint8Array.from(t):un(t)}function Z0(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Hi(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function L(t,e=Ae.P){let r=t%e;return r>=te?r:e+r}function xt(t,e){let{P:r}=Ae,n=t;for(;e-- >te;)n*=n,n%=r;return n}function o2(t){let{P:e}=Ae,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=t*t*t%e,u=c*c*t%e,f=xt(u,zi)*u%e,h=xt(f,zi)*u%e,l=xt(h,Kr)*c%e,d=xt(l,n)*l%e,p=xt(d,i)*d%e,g=xt(p,o)*p%e,y=xt(g,a)*g%e,v=xt(y,o)*p%e,x=xt(v,zi)*u%e,A=xt(x,s)*d%e,_=xt(A,r)*c%e,w=xt(_,Kr);if(w*w%e!==t)throw new Error("Cannot find square root");return w}function Xn(t,e=Ae.P){if(t===te||e<=te)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=L(t,e),n=e,i=te,s=ve,o=ve,a=te;for(;r!==te;){let u=n/r,f=n%r,h=i-o*u,l=s-a*u;n=r,r=f,i=o,s=a,o=h,a=l}if(n!==ve)throw new Error("invert: does not exist");return L(i,e)}function a2(t,e=Ae.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===te?s:(r[a]=s,L(s*o,e)),ve),i=Xn(n,e);return t.reduceRight((s,o,a)=>o===te?s:(r[a]=L(s*r[a],e),L(s*o,e)),i),r}function c2(t){let e=t.length*8-Jn*8,r=qr(t);return e>0?r>>BigInt(e):r}function $c(t,e=!1){let r=c2(t);if(e)return r;let{n}=Ae;return r>=n?r-n:r}var Zn,Gi,Wc=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Lt.hmacSha256(this.k,...e)}hmacSync(...e){return Gi(this.k,...e)}checkSync(){if(typeof Gi!="function")throw new fo("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Ur(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Ur(...r)}};function Hi(t){return te<t&&t<Ae.n}function zc(t){return te<t&&t<Ae.P}function u2(t,e,r,n=!0){let{n:i}=Ae,s=$c(t,!0);if(!Hi(s))return;let o=Xn(s,i),a=oe.BASE.multiply(s),c=L(a.x,i);if(c===te)return;let u=L(o*L(e+r*c,i),i);if(u===te)return;let f=new tr(c,u),h=(a.x===f.r?0:2)|Number(a.y&ve);return n&&f.hasHighS()&&(f=f.normalizeS(),h^=1),{sig:f,recovery:h}}function lo(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*Jn)throw new Error("Expected 32 bytes of private key");e=ho(t)}else if(t instanceof Uint8Array){if(t.length!==Jn)throw new Error("Expected 32 bytes of private key");e=qr(t)}else throw new TypeError("Expected valid private key");if(!Hi(e))throw new Error("Expected private key: 0 < key < n");return e}function f2(t){return t instanceof oe?(t.assertValidity(),t):oe.fromHex(t)}function J0(t){if(t instanceof tr)return t.assertValidity(),t;try{return tr.fromDER(t)}catch{return tr.fromCompact(t)}}function Zc(t,e=!1){return oe.fromPrivateKey(t).toRawBytes(e)}function Q0(t){let e=t.length>Nt?t.slice(0,Nt):t;return qr(e)}function h2(t){let e=Q0(t),r=L(e,Ae.n);return Y0(r<te?e:r)}function Y0(t){return Hc(t)}function l2(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Yn(t),i=lo(e),s=[Y0(i),h2(n)];if(r!=null){r===!0&&(r=Lt.randomBytes(Nt));let c=Yn(r);if(c.length!==Nt)throw new Error(`sign: Expected ${Nt} bytes of extra data`);s.push(c)}let o=Ur(...s),a=Q0(n);return{seed:o,m:a,d:i}}function p2(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},e),o=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[o,n]:o}async function X0(t,e,r={}){let{seed:n,m:i,d:s}=l2(t,e,r.extraEntropy),o=new Wc(r2,Jn);await o.reseed(n);let a;for(;!(a=u2(await o.generate(),i,s,r.canonical));)await o.reseed();return p2(a,r)}var d2={strict:!0};function j0(t,e,r,n=d2){let i;try{i=J0(t),e=Yn(e)}catch{return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=$c(e),c;try{c=f2(r)}catch{return!1}let{n:u}=Ae,f=Xn(o,u),h=L(a*f,u),l=L(s*f,u),d=oe.BASE.multiplyAndAddUnsafe(c,h,l);return d?L(d.x,u)===s:!1}oe.BASE._setWindowSize(8);var ut={node:t2,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var uo={},Lt={bytesToHex:Qn,hexToBytes:un,concatBytes:Ur,mod:L,invert:Xn,isValidPrivateKey(t){try{return lo(t),!0}catch{return!1}},_bigintTo32Bytes:Hc,_normalizePrivateKey:lo,hashToPrivateKey:t=>{t=Yn(t);let e=Jn+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=L(qr(t),Ae.n-ve)+ve;return Hc(r)},randomBytes:(t=32)=>{if(ut.web)return ut.web.getRandomValues(new Uint8Array(t));if(ut.node){let{randomBytes:e}=ut.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Lt.hashToPrivateKey(Lt.randomBytes(Jn+8)),precompute(t=8,e=oe.BASE){let r=e===oe.BASE?e:new oe(e.x,e.y);return r._setWindowSize(t),r.multiply(zi),r},sha256:async(...t)=>{if(ut.web){let e=await ut.web.subtle.digest("SHA-256",Ur(...t));return new Uint8Array(e)}else if(ut.node){let{createHash:e}=ut.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(ut.web){let r=await ut.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Ur(...e),i=await ut.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(ut.node){let{createHmac:r}=ut.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=uo[t];if(r===void 0){let n=await Lt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Ur(n,n),uo[t]=r}return Lt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof Zn!="function")throw new fo("sha256Sync is undefined, you need to set it");let r=uo[t];if(r===void 0){let n=Zn(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Ur(n,n),uo[t]=r}return Zn(r,...e)},_JacobianPoint:ie};Object.defineProperties(Lt,{sha256Sync:{configurable:!1,get(){return Zn},set(t){Zn||(Zn=t)}},hmacSha256Sync:{configurable:!1,get(){return Gi},set(t){Gi||(Gi=t)}}});function Vr(t){if(isNaN(t)||t<=0)throw new F("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Lt.randomBytes(t)}var E4=ae(Js(),1),Jc=ae(fe(),1);function ep(t,e){return e.map(r=>ct(t[r]))}function tp(t){return Jc.default.pki.setRsaPrivateKey(...ep(t,["n","e","d","p","q","dp","dq","qi"]))}function rp(t){return Jc.default.pki.setRsaPublicKey(...ep(t,["n","e"]))}var fn={};Ve(fn,{jwkToPkcs1:()=>m2,jwkToPkix:()=>b2,pkcs1ToJwk:()=>y2,pkixToJwk:()=>v2});var I4=ae(Di(),1),T4=ae(Js(),1);var yr=ae(fe(),1);function y2(t){let e=yr.default.asn1.fromDer(le(t,"ascii")),r=yr.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Mt(r.n),e:Mt(r.e),d:Mt(r.d),p:Mt(r.p),q:Mt(r.q),dp:Mt(r.dP),dq:Mt(r.dQ),qi:Mt(r.qInv),alg:"RS256"}}function m2(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new F("JWK was missing components","ERR_INVALID_PARAMETERS");let e=yr.default.pki.privateKeyToAsn1({n:ct(t.n),e:ct(t.e),d:ct(t.d),p:ct(t.p),q:ct(t.q),dP:ct(t.dp),dQ:ct(t.dq),qInv:ct(t.qi)});return Fe(yr.default.asn1.toDer(e).getBytes(),"ascii")}function v2(t){let e=yr.default.asn1.fromDer(le(t,"ascii")),r=yr.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Mt(r.n),e:Mt(r.e)}}function b2(t){if(t.n==null||t.e==null)throw new F("JWK was missing components","ERR_INVALID_PARAMETERS");let e=yr.default.pki.publicKeyToAsn1({n:ct(t.n),e:ct(t.e)});return Fe(yr.default.asn1.toDer(e).getBytes(),"ascii")}async function np(t){let e=await nt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await op(e);return{privateKey:r[0],publicKey:r[1]}}async function Qc(t){let r=[await nt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await x2(t)],n=await op({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function ip(t,e){let r=await nt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await nt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function sp(t,e,r){let n=await nt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return nt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function op(t){if(t.privateKey==null||t.publicKey==null)throw new F("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([nt.get().subtle.exportKey("jwk",t.privateKey),nt.get().subtle.exportKey("jwk",t.publicKey)])}async function x2(t){return nt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function ap(t,e,r,n){let i=e?rp(t):tp(t),s=le(Uint8Array.from(r),"ascii"),o=n(s,i);return Fe(o,"ascii")}function cp(t,e){return ap(t,!0,e,(r,n)=>n.encrypt(r))}function up(t,e){return ap(t,!1,e,(r,n)=>n.decrypt(r))}var $i=class{_key;constructor(e){this._key=e}async verify(e,r){return sp(this._key,r,e)}marshal(){return fn.jwkToPkix(this._key)}get bytes(){return jt.encode({Type:Se.RSA,Data:this.marshal()}).subarray()}encrypt(e){return cp(this._key,e)}equals(e){return ze(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pe.digest(this.bytes);return e}},jn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Vr(16)}async sign(e){return ip(this._key,e)}get public(){if(this._publicKey==null)throw new F("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new $i(this._publicKey)}decrypt(e){return up(this._key,e)}marshal(){return fn.jwkToPkcs1(this._key)}get bytes(){return er.encode({Type:Se.RSA,Data:this.marshal()}).subarray()}equals(e){return ze(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return le(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Wi.default.util.ByteBuffer(this.marshal()),i=Wi.default.asn1.fromDer(n),s=Wi.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Wi.default.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return Gn(this.bytes,e);throw new F(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function S2(t){let e=fn.pkcs1ToJwk(t),r=await Qc(e);return new jn(r.privateKey,r.publicKey)}function E2(t){let e=fn.pkixToJwk(t);return new $i(e)}async function _2(t){let e=await Qc(t);return new jn(e.privateKey,e.publicKey)}async function A2(t){let e=await np(t);return new jn(e.privateKey,e.publicKey)}var jc={};Ve(jc,{Secp256k1PrivateKey:()=>Ji,Secp256k1PublicKey:()=>Zi,generateKeyPair:()=>C2,unmarshalSecp256k1PrivateKey:()=>T2,unmarshalSecp256k1PublicKey:()=>B2});function fp(){return Lt.randomPrivateKey()}async function hp(t,e){let{digest:r}=await Pe.digest(e);try{return await X0(r,t)}catch(n){throw new F(String(n),"ERR_INVALID_INPUT")}}async function lp(t,e,r){try{let{digest:n}=await Pe.digest(r);return j0(e,n,t)}catch(n){throw new F(String(n),"ERR_INVALID_INPUT")}}function pp(t){return oe.fromHex(t).toRawBytes(!0)}function dp(t){try{Zc(t,!0)}catch(e){throw new F(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Xc(t){try{oe.fromHex(t)}catch(e){throw new F(String(e),"ERR_INVALID_PUBLIC_KEY")}}function gp(t){try{return Zc(t,!0)}catch(e){throw new F(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Zi=class{_key;constructor(e){Xc(e),this._key=e}async verify(e,r){return lp(this._key,r,e)}marshal(){return pp(this._key)}get bytes(){return jt.encode({Type:Se.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ze(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pe.digest(this.bytes);return e}},Ji=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??gp(e),dp(this._key),Xc(this._publicKey)}async sign(e){return hp(this._key,e)}get public(){return new Zi(this._publicKey)}marshal(){return this._key}get bytes(){return er.encode({Type:Se.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ze(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Pe.digest(this.bytes);return e}async id(){let e=await this.public.hash();return le(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Gn(this.bytes,e);throw new F(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function T2(t){return new Ji(t)}function B2(t){return new Zi(t)}async function C2(){let t=fp();return new Ji(t)}var zr={rsa:Yc,ed25519:Kc,secp256k1:jc};function eu(t){let e=Object.keys(zr).join(" / ");return new F(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function P2(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return zr[t];throw eu(t)}function tu(t){let e=jt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case Se.RSA:return zr.rsa.unmarshalRsaPublicKey(r);case Se.Ed25519:return zr.ed25519.unmarshalEd25519PublicKey(r);case Se.Secp256k1:return zr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw eu(e.Type??"RSA")}}function yp(t,e){return e=(e??"rsa").toLowerCase(),P2(e),t.bytes}async function mp(t){let e=er.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case Se.RSA:return zr.rsa.unmarshalRsaPrivateKey(r);case Se.Ed25519:return zr.ed25519.unmarshalEd25519PrivateKey(r);case Se.Secp256k1:return zr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw eu(e.Type??"RSA")}}var hn="StrictSign",ei="StrictNoSign",Ot;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(Ot||(Ot={}));var vp;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(vp||(vp={}));var Gr;(function(t){t[t.Signing=0]="Signing",t[t.Anonymous=1]="Anonymous"})(Gr||(Gr={}));var Je;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(Je||(Je={}));var We;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(We||(We={}));var wt;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(wt||(wt={}));function ru(t){switch(t){case Ot.Ignore:return Je.Ignore;case Ot.Reject:return Je.Reject}}async function nu(t,e){switch(t){case hn:{if(!e)throw Error("Must provide PeerId");if(e.privateKey==null)throw Error("Cannot sign message, no private key present");if(e.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await mp(e.privateKey);return{type:Gr.Signing,author:e,key:e.publicKey,privateKey:r}}case ei:return{type:Gr.Anonymous};default:throw new Error(`Unknown signature policy "${t}"`)}}var he="ERR_INVALID_PEER_SCORE_PARAMS";var D2={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},M2={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function bp(t={}){return{...D2,...t,topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=N2(n),e),{}):{}}}function N2(t={}){return{...M2,...t}}function xp(t){for(let[e,r]of Object.entries(t.topics))try{L2(r)}catch(n){throw new F(`invalid score parameters for topic ${e}: ${n.message}`,he)}if(t.topicScoreCap<0)throw new F("invalid topic score cap; must be positive (or 0 for no cap)",he);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw new F("missing application specific score function",he);if(t.IPColocationFactorWeight>0)throw new F("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",he);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw new F("invalid IPColocationFactorThreshold; must be at least 1",he);if(t.behaviourPenaltyWeight>0)throw new F("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",he);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw new F("invalid BehaviourPenaltyDecay; must be between 0 and 1",he);if(t.decayInterval<1e3)throw new F("invalid DecayInterval; must be at least 1s",he);if(t.decayToZero<=0||t.decayToZero>=1)throw new F("invalid DecayToZero; must be between 0 and 1",he)}function L2(t){if(t.topicWeight<0)throw new F("invalid topic weight; must be >= 0",he);if(t.timeInMeshQuantum===0)throw new F("invalid TimeInMeshQuantum; must be non zero",he);if(t.timeInMeshWeight<0)throw new F("invalid TimeInMeshWeight; must be positive (or 0 to disable)",he);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw new F("invalid TimeInMeshQuantum; must be positive",he);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw new F("invalid TimeInMeshCap; must be positive",he);if(t.firstMessageDeliveriesWeight<0)throw new F("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",he);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw new F("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",he);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw new F("invalid FirstMessageDeliveriesCap; must be positive",he);if(t.meshMessageDeliveriesWeight>0)throw new F("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",he);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw new F("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",he);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw new F("invalid MeshMessageDeliveriesCap; must be positive",he);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw new F("invalid MeshMessageDeliveriesThreshold; must be positive",he);if(t.meshMessageDeliveriesWindow<0)throw new F("invalid MeshMessageDeliveriesWindow; must be non-negative",he);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw new F("invalid MeshMessageDeliveriesActivation; must be at least 1s",he);if(t.meshFailurePenaltyWeight>0)throw new F("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",he);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw new F("invalid MeshFailurePenaltyDecay; must be between 0 and 1",he);if(t.invalidMessageDeliveriesWeight>0)throw new F("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",he);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw new F("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",he)}var O2={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function wp(t={}){return{...O2,...t}}function Sp(t,e,r,n){let i=0;Object.entries(e.topics).forEach(([o,a])=>{let c=r.topics[o];if(c===void 0)return;let u=0;if(a.inMesh){let d=a.meshTime/c.timeInMeshQuantum;d>c.timeInMeshCap&&(d=c.timeInMeshCap),u+=d*c.timeInMeshWeight}let f=a.firstMessageDeliveries;if(f>c.firstMessageDeliveriesCap&&(f=c.firstMessageDeliveriesCap),u+=f*c.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<c.meshMessageDeliveriesThreshold){let d=c.meshMessageDeliveriesThreshold-a.meshMessageDeliveries,p=d*d;u+=p*c.meshMessageDeliveriesWeight}let h=a.meshFailurePenalty;u+=h*c.meshFailurePenaltyWeight;let l=a.invalidMessageDeliveries*a.invalidMessageDeliveries;u+=l*c.invalidMessageDeliveriesWeight,i+=u*c.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap);let s=r.appSpecificScore(t);if(i+=s*r.appSpecificWeight,e.knownIPs.forEach(o=>{if(r.IPColocationFactorWhitelist.has(o))return;let a=n.get(o),c=a?a.size:0;if(c>r.IPColocationFactorThreshold){let u=c-r.IPColocationFactorThreshold,f=u*u;i+=f*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let o=e.behaviourPenalty-r.behaviourPenaltyThreshold,a=o*o;i+=a*r.behaviourPenaltyWeight}return i}var Ap=ae(_p(),1),Qe;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(Qe||(Qe={}));var po=class{constructor(){this.records=new Map,this.queue=new Ap.default}getRecord(e){return this.records.get(e)}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:Qe.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};function yo(t,e,r=()=>!0){let n=new Set;if(e<=0)return n;for(let i of t){if(n.size>=e)break;r(i)&&(n.add(i),t.delete(i))}return n}function Ip(t,e){return yo(t,e,()=>!0)}var go=class extends Map{constructor(e){super(),this.getDefault=e}getOrDefault(e){let r=super.get(e);return r===void 0&&(r=this.getDefault(),this.set(e,r)),r}};var ti=os("libp2p:gossipsub:score"),mo=class{constructor(e,r,n){this.params=e,this.metrics=r,this.peerStats=new Map,this.peerIPs=new go(()=>new Set),this.scoreCache=new Map,this.deliveryRecords=new po,xp(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??Sp}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){ti("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),ti("started")}stop(){if(!this._backgroundInterval){ti("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),ti("stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}messageFirstSeenTimestampMs(e){let r=this.deliveryRecords.getRecord(e);return r?r.firstSeenTsMs:null}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,i)=>{if(!n.connected){e>n.expire&&(this.removeIPsForPeer(i,n.knownIPs),this.peerStats.delete(i),this.scoreCache.delete(i));return}Object.entries(n.topics).forEach(([s,o])=>{let a=this.params.topics[s];a!==void 0&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(!r)return 0;let n=Date.now(),i=this.scoreCache.get(e);if(i&&i.cacheUntil>n)return i.score;this.metrics?.scoreFnRuns.inc();let s=this.computeScore(e,r,this.params,this.peerIPs),o=n+this.scoreCacheValidityMs;return i?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-i.score)),i.score=s,i.cacheUntil=o):this.scoreCache.set(e,{score:s,cacheUntil:o}),s}addPenalty(e,r,n){let i=this.peerStats.get(e);i&&(i.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(e){let r={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,r)}addIP(e,r){let n=this.peerStats.get(e);n&&n.knownIPs.add(r),this.peerIPs.getOrDefault(r).add(e)}removeIP(e,r){let n=this.peerStats.get(e);n&&n.knownIPs.delete(r);let i=this.peerIPs.get(r);i&&(i.delete(e),i.size===0&&this.peerIPs.delete(r))}removePeer(e){let r=this.peerStats.get(e);if(r){if(this.score(e)>0){this.removeIPsForPeer(e,r.knownIPs),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,i])=>{i.firstMessageDeliveries=0;let s=this.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1,i.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.inMesh=!0,i.graftTime=Date.now(),i.meshTime=0,i.meshMessageDeliveriesActive=!1)}}prune(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.meshMessageDeliveriesActive=!1,i.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,n){this.markFirstMessageDelivery(e,n);let i=this.deliveryRecords.ensureRecord(r),s=Date.now();if(i.status!==Qe.unknown){ti("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,s-i.firstSeenTsMs,Qe[i.status]);return}i.status=Qe.valid,i.validated=s,i.peers.forEach(o=>{o!==e.toString()&&this.markDuplicateMessageDelivery(o,n)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,n,i){switch(i){case Je.Error:this.markInvalidMessageDelivery(e,n);return;case Je.Blacklisted:return}let s=this.deliveryRecords.ensureRecord(r);if(s.status!==Qe.unknown){ti("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeenTsMs,Qe[s.status]);return}if(i===Je.Ignore){s.status=Qe.ignored,s.peers.clear();return}s.status=Qe.invalid,this.markInvalidMessageDelivery(e,n),s.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),s.peers.clear()}duplicateMessage(e,r,n){let i=this.deliveryRecords.ensureRecord(r);if(!i.peers.has(e))switch(i.status){case Qe.unknown:i.peers.add(e);break;case Qe.valid:i.peers.add(e),this.markDuplicateMessageDelivery(e,n,i.validated);break;case Qe.invalid:this.markInvalidMessageDelivery(e,n);break;case Qe.ignored:break}}markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let s=this.params.topics[r].firstMessageDeliveriesCap;i.firstMessageDeliveries=Math.min(s,i.firstMessageDeliveries+1),i.inMesh&&(s=this.params.topics[r].meshMessageDeliveriesCap,i.meshMessageDeliveries=Math.min(s,i.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,n){let i=this.peerStats.get(e);if(i){let s=n!==void 0?Date.now():0,o=this.getPtopicStats(i,r);if(o&&o.inMesh){let a=this.params.topics[r];if(n!==void 0){let u=s-n,f=u>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,u,f),f)return}let c=a.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(c,o.meshMessageDeliveries+1)}}}removeIPsForPeer(e,r){for(let n of r){let i=this.peerIPs.get(n);i&&(i.delete(e),i.size===0&&this.peerIPs.delete(n))}}getPtopicStats(e,r){let n=e.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=n,n):null}};var vo=class{constructor(e,r,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=r,this.metrics=n,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let n=Math.floor(Math.random()*r.length),i=r[n],s=this.msgIdToStrFn(i),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o));let a=Date.now();o.has(e)||(o.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(s)||this.requestMsByMsg.set(s,a)))}getBrokenPromises(){let e=Date.now(),r=new Map,n=0;return this.promises.forEach((i,s)=>{i.forEach((o,a)=>{o<e&&(r.set(a,(r.get(a)??0)+1),i.delete(a),n++)}),i.size||this.promises.delete(s)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(e,r=!1){this.trackMessage(e);let n=this.promises.get(e);n&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),r&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(n.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case Je.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire,r=0;for(let[n,i]of this.requestMsByMsg.entries())if(i<e)this.requestMsByMsg.delete(n),r++;else break;this.metrics?.iwantMessagePruned.inc(r)}trackMessage(e){if(this.metrics){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};var ri=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){return this.entries.has(e)?!0:(this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){let e=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};var Tp;(function(t){t.forward="forward",t.publish="publish"})(Tp||(Tp={}));var mr;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(mr||(mr={}));var ln;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Excess="excess"})(ln||(ln={}));var ii;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(ii||(ii={}));var si;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(si||(si={}));var ni;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(ni||(ni={}));function Bp(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["reason"]}),meshPeerInclusionEventsByTopic:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_by_topic_total",help:"Number of times we include peers in a topic",labelNames:["topic"]}),meshPeerChurnEvents:t.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["reason"]}),meshPeerChurnEventsByTopic:t.gauge({name:"gossipsub_peer_churn_events_by_topic_total",help:"Number of times we remove peers in a topic",labelNames:["topic"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:t.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result",labelNames:["acceptance"]}),asyncValidationResultByTopic:t.gauge({name:"gossipsub_async_validation_result_by_topic_total",help:"Message validation result for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:t.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",labelNames:["topic"],buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:t.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:t.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:t.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:t.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:t.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["peerGroup"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishMs:t.histogram({name:"gossipsub_msg_publish_ms",help:"Total time in millisecond to publish a message",buckets:[1,2,5,10,100,500,1e3],labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:t.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),msgReceivedStatus:t.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["status"]}),msgReceivedTopic:t.gauge({name:"gossipsub_msg_received_topic_total",help:"Tracks distribution of recv msgs by topic label",labelNames:["topic"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:t.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:t.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:t.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:t.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),iwantPromiseUntracked:t.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:t.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:t.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:t.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:t.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:e,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,i,s){let o=this.toTopic(n);this.meshPeerInclusionEvents.inc({reason:i},s),this.meshPeerInclusionEventsByTopic.inc({topic:o},s)},onRemoveFromMesh(n,i,s){let o=this.toTopic(n);this.meshPeerChurnEvents.inc({reason:i},s),this.meshPeerChurnEventsByTopic.inc({topic:o},s)},onReportValidation(n,i,s){if(this.asyncValidationMcacheHit.inc({hit:n!=null?"hit":"miss"}),n!=null){let o=this.toTopic(n.message.topic);this.asyncValidationResult.inc({acceptance:i}),this.asyncValidationResultByTopic.inc({topic:o})}s!=null?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-s)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,i,s){let o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},i),this.ihaveRcvNotSeenMsgids.inc({topic:o},s)},onIwantRcv(n,i){for(let[s,o]of n){let a=this.toTopic(s);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(i)},onForwardMsg(n,i){let s=this.toTopic(n);this.msgForwardCount.inc({topic:s},1),this.msgForwardPeers.inc({topic:s},i)},onPublishMsg(n,i,s,o,a){let c=this.toTopic(n);this.msgPublishCount.inc({topic:c},1),this.msgPublishBytes.inc({topic:c},s*o),this.msgPublishPeersByTopic.inc({topic:c},s),this.msgPublishPeersByGroup.inc({peerGroup:"direct"},i.direct),this.msgPublishPeersByGroup.inc({peerGroup:"floodsub"},i.floodsub),this.msgPublishPeersByGroup.inc({peerGroup:"mesh"},i.mesh),this.msgPublishPeersByGroup.inc({peerGroup:"fanout"},i.fanout),this.msgPublishMs.observe({topic:c},a)},onMsgRecvPreValidation(n){let i=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:i},1)},onMsgRecvError(n){let i=this.toTopic(n);this.msgReceivedError.inc({topic:i},1)},onMsgRecvResult(n,i){let s=this.toTopic(n);this.msgReceivedTopic.inc({topic:s}),this.msgReceivedStatus.inc({status:i})},onMsgRecvInvalid(n,i){let s=this.toTopic(n),o=i.reason===Je.Error?i.error:i.reason;this.msgReceivedInvalid.inc({error:o},1),this.msgReceivedInvalidByTopic.inc({topic:s},1)},onDuplicateMsgDelivery(n,i,s){if(this.duplicateMsgDeliveryDelay.observe(i/1e3),s){let o=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:o},1)}},onPublishDuplicateMsg(n){let i=this.toTopic(n);this.duplicateMsgIgnored.inc({topic:i},1)},onPeerReadStreamError(){this.peerReadStreamError.inc(1)},onRpcRecvError(){this.rpcRecvError.inc(1)},onRpcDataError(){this.rpcDataError.inc(1)},onRpcRecv(n,i){this.rpcRecvBytes.inc(i),this.rpcRecvCount.inc(1),this.rpcRecvSubscription.inc(n.subscriptions.length),this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),this.rpcRecvIHave.inc(n.control.ihave.length),this.rpcRecvIWant.inc(n.control.iwant.length),this.rpcRecvGraft.inc(n.control.graft.length),this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,i){if(this.rpcSentBytes.inc(i),this.rpcSentCount.inc(1),this.rpcSentSubscription.inc(n.subscriptions.length),this.rpcSentMessage.inc(n.messages.length),n.control){let s=n.control.ihave.length,o=n.control.iwant.length,a=n.control.graft.length,c=n.control.prune.length;s>0&&this.rpcSentIHave.inc(s),o>0&&this.rpcSentIWant.inc(o),a>0&&this.rpcSentGraft.inc(a),c>0&&this.rpcSentPrune.inc(c),(s>0||o>0||a>0||c>0)&&this.rpcSentControl.inc(1)}},registerScores(n,i){let s=0,o=0,a=0,c=0;for(let u of n)u>=i.graylistThreshold&&s++,u>=i.publishThreshold&&o++,u>=i.gossipThreshold&&a++,u>=0&&c++;this.peersByScoreThreshold.set({threshold:ni.graylist},s),this.peersByScoreThreshold.set({threshold:ni.publish},o),this.peersByScoreThreshold.set({threshold:ni.gossip},a),this.peersByScoreThreshold.set({threshold:ni.mesh},c),this.score.set(n)},registerScoreWeights(n){for(let[i,s]of n.byTopic)this.scoreWeights.set({topic:i,p:"p1"},s.p1w),this.scoreWeights.set({topic:i,p:"p2"},s.p2w),this.scoreWeights.set({topic:i,p:"p3"},s.p3w),this.scoreWeights.set({topic:i,p:"p3b"},s.p3bw),this.scoreWeights.set({topic:i,p:"p4"},s.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,i){let s=new Map;n.forEach((o,a)=>{let c=this.topicStrToLabel.get(a)??"unknown",u=s.get(c);u||(u=new Set,s.set(c,u)),o.forEach(f=>u?.add(f))});for(let[o,a]of s){let c=[];a.forEach(u=>{c.push(i.get(u)??0)}),this.scorePerMesh.set({topic:o},c)}}}}var J_=ae(Fs(),1),U2=ae(fe(),1);var V2=ae(dc(),1),z2=ae(Ce(),1);var Cp=Fe("libp2p-pubsub:");async function Rp(t,e,r,n){switch(t.type){case Gr.Signing:{let i={from:t.author.toBytes(),data:n,seqno:Vr(8),topic:e,signature:void 0,key:void 0},s=rt([Cp,Cr.Message.encode(i)]);i.signature=await t.privateKey.sign(s),i.key=t.key;let o={type:"signed",from:t.author,data:r,sequenceNumber:BigInt(`0x${le(i.seqno,"base16")}`),topic:e,signature:i.signature,key:i.key};return{raw:i,msg:o}}case Gr.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:e,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:e}}}}async function Pp(t,e){switch(t){case ei:return e.signature!=null?{valid:!1,error:We.SignaturePresent}:e.seqno!=null?{valid:!1,error:We.SeqnoPresent}:e.key!=null?{valid:!1,error:We.FromPresent}:{valid:!0,message:{type:"unsigned",topic:e.topic,data:e.data??new Uint8Array(0)}};case hn:{if(e.seqno==null)return{valid:!1,error:We.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:We.InvalidSeqno};if(e.signature==null)return{valid:!1,error:We.InvalidSignature};if(e.from==null)return{valid:!1,error:We.InvalidPeerId};let r;try{r=Bn(e.from)}catch{return{valid:!1,error:We.InvalidPeerId}}let n;if(e.key){if(n=tu(e.key),r.publicKey!==void 0&&!ze(n.bytes,r.publicKey))return{valid:!1,error:We.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:We.InvalidPeerId};n=tu(r.publicKey)}let i={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},s=rt([Cp,Cr.Message.encode(i)]);return await n.verify(s,e.signature)?{valid:!0,message:{type:"signed",from:r,data:e.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${le(e.seqno,"base16")}`),topic:e.topic,signature:e.signature,key:e.key??yp(n)}}:{valid:!1,error:We.InvalidSignature}}}}var kp=(t,e)=>{let r=Fe(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(t.length+r.length);return n.set(t,0),n.set(r,t.length),n};function Dp(t){if(t.type!=="signed")throw new Error("expected signed message type");if(t.sequenceNumber==null)throw Error("missing seqno field");return kp(t.from.toBytes(),t.sequenceNumber)}async function Mp(t){return await Pe.encode(t.data)}function G2(t,e,r,n,i){let s=0,o=new Map;if(Object.entries(e.topics).forEach(([l,d])=>{let p=i.get(l)??"unknown",g=r.topics[l];if(g===void 0)return;let y=o.get(p);y||(y={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(p,y));let v=0,x=0,A=0,_=0,w=0;if(d.inMesh){let K=Math.max(d.meshTime/g.timeInMeshQuantum,g.timeInMeshCap);v+=K*g.timeInMeshWeight}let S=d.firstMessageDeliveries;if(S>g.firstMessageDeliveriesCap&&(S=g.firstMessageDeliveriesCap),x+=S*g.firstMessageDeliveriesWeight,d.meshMessageDeliveriesActive&&d.meshMessageDeliveries<g.meshMessageDeliveriesThreshold){let K=g.meshMessageDeliveriesThreshold-d.meshMessageDeliveries,$=K*K;A+=$*g.meshMessageDeliveriesWeight}let P=d.meshFailurePenalty;_+=P*g.meshFailurePenaltyWeight;let O=d.invalidMessageDeliveries*d.invalidMessageDeliveries;w+=O*g.invalidMessageDeliveriesWeight,s+=(v+x+A+_+w)*g.topicWeight,y.p1w+=v,y.p2w+=x,y.p3w+=A,y.p3bw+=_,y.p4w+=w}),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;let l=r.topicScoreCap/s;for(let d of o.values())d.p1w*=l,d.p2w*=l,d.p3w*=l,d.p3bw*=l,d.p4w*=l}let a=0,c=0,u=0,f=r.appSpecificScore(t);a+=f*r.appSpecificWeight,e.knownIPs.forEach(l=>{if(r.IPColocationFactorWhitelist.has(l))return;let d=n.get(l),p=d?d.size:0;if(p>r.IPColocationFactorThreshold){let g=p-r.IPColocationFactorThreshold,y=g*g;c+=y*r.IPColocationFactorWeight}});let h=e.behaviourPenalty*e.behaviourPenalty;return u+=h*r.behaviourPenaltyWeight,s+=a+c+u,{byTopic:o,p5w:a,p6w:c,p7w:u,score:s}}function Np(t,e,r,n,i){let s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let o of t){let a=e.get(o);if(a){let c=G2(o,a,r,n,i);for(let[u,f]of c.byTopic){let h=s.byTopic.get(u);h||(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(u,h)),h.p1w.push(f.p1w),h.p2w.push(f.p2w),h.p3w.push(f.p3w),h.p3bw.push(f.p3bw),h.p4w.push(f.p4w)}s.p5w.push(c.p5w),s.p6w.push(c.p6w),s.p7w.push(c.p7w),s.score.push(c.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}var Qi=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Lp(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function iu(t,e,r){let n=r??{},i=Lp(t);async function*s(){let o,a=()=>{o?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:f,abortCode:h}=n;throw new Qi(f,h)}let u=new Promise((f,h)=>{o=()=>{let{abortMessage:l,abortCode:d}=n;h(new Qi(l,d))}});c=await Promise.race([u,i.next()]),o=null}catch(u){e.removeEventListener("abort",a);let f=u.type==="aborted"&&e.aborted;if(f&&n.onAbort!=null&&n.onAbort(t),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(f&&n.returnOnAbort===!0)return;throw u}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return s()}var Fp=Symbol.for("@achingbrain/uint8arraylist");function Op(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function bo(t){return!!t?.[Fp]}var rr=class{constructor(...e){Object.defineProperty(this,Fp,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(bo(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(bo(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=Op(this.bufs,e);return r.buf[r.index]}set(e,r){let n=Op(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(bo(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return rt(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:rt(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),s=new rr;return s.length=i,s.bufs=n,s}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let o=this.bufs[s],a=i,c=a+o.byteLength;if(i=c,e>=c)continue;let u=e>=a&&e<c,f=r>a&&r<=c;if(u&&f){if(e===a&&r===c){n.push(o);break}let h=e-a;n.push(o.subarray(h,h+(r-e)));break}if(u){if(e===0){n.push(o);continue}n.push(o.subarray(e-a));continue}if(f){if(r===c){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!bo(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,o=new Int32Array(s);for(let h=0;h<s;h++)o[h]=-1;for(let h=0;h<i;h++)o[n[h]]=h;let a=o,c=this.byteLength-n.byteLength,u=n.byteLength-1,f;for(let h=r;h<=c;h+=f){f=0;for(let l=u;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){f=Math.max(1,l-a[d]);break}}if(f===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=Pt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=hr(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=hr(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=hr(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=Pt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=hr(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=hr(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=hr(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=hr(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=hr(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof rr)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!ze(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new rr;return n.bufs=e,r==null&&(r=e.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function xo(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var Up=4294967296,ft=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new ft(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new ft(r,n)}toBytes(e,r=0){let n=xo(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new ft;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Up&&(i=0,++n>Up&&(n=0))),new ft(n,i)}static fromNumber(e){if(e===0)return new ft;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new ft(i,n)}static fromBytes(e,r=0){let n=xo(e),i=new ft,s=0;if(e.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(e.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<e.byteLength)for(;s<5;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var H2=Math.pow(2,7),W2=Math.pow(2,14),$2=Math.pow(2,21),Z2=Math.pow(2,28),J2=Math.pow(2,35),Q2=Math.pow(2,42),Y2=Math.pow(2,49),X2=Math.pow(2,56),j2=Math.pow(2,63),pn={encodingLength(t){return t<H2?1:t<W2?2:t<$2?3:t<Z2?4:t<J2?5:t<Q2?6:t<Y2?7:t<X2?8:t<j2?9:10},encode(t,e,r=0){if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=Pt(pn.encodingLength(t))),ft.fromNumber(t).toBytes(e,r),e},decode(t,e=0){return ft.fromBytes(t,e).toNumber(!0)}};function wo(t){return t[Symbol.asyncIterator]!=null}var So=t=>{let e=pn.encodingLength(t),r=Pt(e);return pn.encode(t,r),So.bytes=e,r};So.bytes=0;function Eo(t,e){e=e??{};let r=e.lengthEncoder??So;function*n(i){let s=r(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}return wo(t)?async function*(){for await(let i of t)yield*n(i)}():function*(){for(let i of t)yield*n(i)}()}Eo.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??So;return new rr(r(t.byteLength),t)};var oi=ae(Vp(),1);var tb=8,rb=1024*1024*4,dn;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(dn||(dn={}));var su=t=>{let e=pn.decode(t);return su.bytes=pn.encodingLength(e),e};su.bytes=0;function Yi(t,e){let r=new rr,n=dn.LENGTH,i=-1,s=e?.lengthDecoder??su,o=e?.maxLengthLength??tb,a=e?.maxDataLength??rb;function*c(){for(;r.byteLength>0;){if(n===dn.LENGTH)try{if(i=s(r),i<0)throw(0,oi.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,oi.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=s.bytes;r.consume(u),e?.onLength!=null&&e.onLength(i),n=dn.DATA}catch(u){if(u instanceof RangeError){if(r.byteLength>o)throw(0,oi.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===dn.DATA){if(r.byteLength<i)break;let u=r.sublist(0,i);r.consume(i),e?.onData!=null&&e.onData(u),yield u,n=dn.LENGTH}}}return wo(t)?async function*(){for await(let u of t)r.append(u),yield*c();if(r.byteLength>0)throw(0,oi.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of t)r.append(u),yield*c();if(r.byteLength>0)throw(0,oi.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}Yi.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await t.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return Yi(n,{...e??{},onLength:s=>{r=s}})};var _o=class{constructor(e,r,n){this.rawStream=e,this.pushable=sr({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=n.maxBufferSize??1/0,xn(iu(this.pushable,this.closeController.signal,{returnOnAbort:!0}),i=>Eo(i),this.rawStream).catch(r)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}},Ao=class{constructor(e,r={}){this.rawStream=e,this.closeController=new AbortController,this.source=iu(xn(this.rawStream,n=>Yi(n,r)),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}};var Io=class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){let r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){let r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{let r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,i){return this.readAtomically(()=>{let s=0,o=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",u=2**(8*i)-1;for(;;){let f=this.readAtomically(()=>{let h=this.readChar();if(h===void 0)return;let l=Number.parseInt(h,e);if(!Number.isNaN(l))return l});if(f===void 0)break;if(s*=e,s+=f,s>u||(o+=1,r!==void 0&&o>r))return}if(o!==0)return!n&&c&&o>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let e=new Uint8Array(4);for(let r=0;r<e.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){let e=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let o=this.readSeparator(":",n,()=>this.readIPv4Addr());if(o!==void 0)return r[i]=o[0],r[i+1]=o[1],r[i+2]=o[2],r[i+3]=o[3],[i+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[i,!1];r[i]=s>>8,r[i+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=e(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),o=16-(n+2),[a]=e(s.subarray(0,o));return r.set(s.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var nb=45;var zp=new Io;function To(t){if(!(t.length>nb))return zp.new(t).parseWith(()=>zp.readIPAddr())}function ou(t){return!!To(t)}var Gp=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let i=[];for(let s=0;s<r;s++)i.push(t[e+s]);return i.join(".")}if(r===16){let i=[];for(let s=0;s<r;s+=2)i.push(n.getUint16(e+s).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var au={},cu={},ab=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];ab.forEach(t=>{let e=cb(...t);cu[e.code]=e,au[e.name]=e});function cb(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:!!n,path:!!i}}function Xi(t){if(typeof t=="number"){if(cu[t]!=null)return cu[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(au[t]!=null)return au[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var gn=ae(ed(),1);var N3=parseInt("0xFFFF",16),L3=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);var d8=Xi("ip4"),g8=Xi("ip6"),y8=Xi("ipcidr");function sd(t,e){switch(Xi(t).code){case 4:case 41:return Ib(e);case 42:return nd(e);case 6:case 273:case 33:case 132:return od(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return nd(e);case 421:return Bb(e);case 444:return id(e);case 445:return id(e);case 466:return Tb(e);default:return le(e,"base16")}}var hu=Object.values(wr).map(t=>t.decoder),m8=function(){let t=hu[0].or(hu[1]);return hu.slice(2).forEach(e=>t=t.or(e)),t}();function Ib(t){let e=Gp(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!ou(e))throw new Error("invalid ip address");return e}function od(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function nd(t){let e=gn.default.decode(t);if(t=t.slice(gn.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return le(t)}function Tb(t){let e=gn.default.decode(t),r=t.slice(gn.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return"u"+le(r,"base64url")}function Bb(t){let e=gn.default.decode(t),r=t.slice(gn.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return le(r,"base58btc")}function id(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=le(e,"base32"),i=od(r);return`${n}:${i}`}var Bo;(function(t){t[t.ip4=4]="ip4",t[t.ip6=41]="ip6"})(Bo||(Bo={}));function ad(t){for(let e of t.tuples())switch(e[0]){case Bo.ip4:case Bo.ip6:return sd(e[0],e[1])}return null}function nr(t=[],e){return{subscriptions:[],messages:t,control:e?{graft:e.graft||[],prune:e.prune||[],ihave:e.ihave||[],iwant:e.iwant||[]}:void 0}}function lu(t){return t.control||(t.control={graft:[],prune:[],ihave:[],iwant:[]}),t}var ix=Rs,ht;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(ht||(ht={}));var ji=class extends as{constructor(e,r={}){super(),this.multicodecs=[Rs,ec],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=sr({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.directPeerInitial=null,this.status={code:ht.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let i=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(s=>{this.log("Error running heartbeat",s)}).finally(()=>{if(i?.(),this.status.code===ht.started){clearTimeout(this.status.heartbeatTimeout);let s=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;s<this.opts.heartbeatInterval*.25&&(s+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,s)}})};let n={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,unsubcribeBackoff:1e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...r,scoreParams:bp(r.scoreParams),scoreThresholds:wp(r.scoreThresholds)};if(this.components=e,this.globalSignaturePolicy=n.globalSignaturePolicy??hn,n.fallbackToFloodsub&&this.multicodecs.push(ja),this.log=os(n.debugName??"libp2p:gossipsub"),this.opts=n,this.direct=new Set(n.directPeers.map(i=>i.id.toString())),this.seenCache=new ri({validityMs:n.seenTTL}),this.publishedMessageIds=new ri({validityMs:n.seenTTL}),r.msgIdFn)this.msgIdFn=r.msgIdFn;else switch(this.globalSignaturePolicy){case hn:this.msgIdFn=Dp;break;case ei:this.msgIdFn=Mp;break}if(r.fastMsgIdFn&&(this.fastMsgIdFn=r.fastMsgIdFn,this.fastMsgIdCache=new ri({validityMs:n.seenTTL})),this.msgIdToStrFn=r.msgIdToStrFn??Qh,this.mcache=r.messageCache||new cs(n.mcacheGossip,n.mcacheLength,this.msgIdToStrFn),r.dataTransform&&(this.dataTransform=r.dataTransform),r.metricsRegister){if(!r.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let i=Math.max(...Object.values(n.scoreParams.topics).map(o=>o.meshMessageDeliveriesWindow),1e3),s=Bp(r.metricsRegister,r.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:n.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:i/1e3});s.mcacheSize.addCollect(()=>this.onScrapeMetrics(s));for(let o of this.multicodecs)s.protocolsEnabled.set({protocol:o},1);this.metrics=s}else this.metrics=null;this.gossipTracer=new vo(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new mo(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:n.heartbeatInterval}),this.maxInboundStreams=r.maxInboundStreams,this.maxOutboundStreams=r.maxOutboundStreams,this.allowedTopics=n.allowedTopics?new Set(n.allowedTopics):null}getPeers(){return[...this.peers.keys()].map(e=>Wr(e))}isStarted(){return this.status.code===ht.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await nu(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=sr({objectMode:!0}),xn(this.outboundInflightQueue,async s=>{for await(let{peerId:o,connection:a}of s)await this.createOutboundStream(o,a)}).catch(s=>this.log.error("outbound inflight queue error",s)),await Promise.all(this.opts.directPeers.map(async s=>{await this.components.peerStore.merge(s.id,{multiaddrs:s.addrs})}));let e=this.components.registrar;await Promise.all(this.multicodecs.map(s=>e.handle(s,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r=Wu({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),n=await Promise.all(this.multicodecs.map(s=>e.register(s,r))),i=setTimeout(this.runHeartbeat,100);this.status={code:ht.started,registrarTopologyIds:n,heartbeatTimeout:i,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async s=>await this.connect(s)))}).catch(s=>{this.log(s)})},1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==ht.started)return;let{registrarTopologyIds:e}=this.status;this.status={code:ht.stopped};let r=this.components.registrar;await Promise.all(this.multicodecs.map(n=>r.unhandle(n))),e.forEach(n=>r.unregister(n)),this.outboundInflightQueue.end();for(let n of this.streamsOutbound.values())n.close();this.streamsOutbound.clear();for(let n of this.streamsInbound.values())n.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:r}){if(!this.isStarted())return;let n=r.remotePeer;this.addPeer(n,r.stat.direction,r.remoteAddr),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:r})}onPeerConnected(e,r){this.metrics?.newConnectionCount.inc({status:r.stat.status}),!(!this.isStarted()||r.stat.status!=="OPEN")&&(this.addPeer(e,r.stat.direction,r.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:r}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(this.peers.has(n)&&!this.streamsOutbound.has(n))try{let i=new _o(await r.newStream(this.multicodecs),o=>this.log.error("outbound pipe error",o),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(n,i);let s=i.protocol;s===ja&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(i){this.log.error("createOutboundStream error",i)}}async createInboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!this.peers.has(n))return;let i=this.streamsInbound.get(n);i!==void 0&&(this.log("replacing existing inbound steam %s",n),i.close()),this.log("create inbound stream %s",n);let s=new Ao(r,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(n,s),this.pipePeerReadStream(e,s.source).catch(o=>this.log(o))}addPeer(e,r,n){let i=e.toString();if(!this.peers.has(i)){this.log("new peer %p",e),this.peers.add(i),this.score.addPeer(i);let s=ad(n);s!==null?this.score.addIP(i,s):this.log("Added peer has no IP in current address %s %s",i,n.toString()),this.outbound.has(i)||this.outbound.set(i,r==="outbound")}}removePeer(e){let r=e.toString();if(!this.peers.has(r))return;this.log("delete peer %p",e),this.peers.delete(r);let n=this.streamsOutbound.get(r),i=this.streamsInbound.get(r);n&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close(),i?.close(),this.streamsOutbound.delete(r),this.streamsInbound.delete(r);for(let s of this.topics.values())s.delete(r);for(let[s,o]of this.mesh)o.delete(r)===!0&&this.metrics?.onRemoveFromMesh(s,ln.Dc,1);for(let s of this.fanout.values())s.delete(r);this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r)}get started(){return this.status.code===ht.started}getMeshPeers(e){let r=this.mesh.get(e);return r?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return(r?Array.from(r):[]).map(n=>Wr(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await xn(r,async n=>{for await(let i of n)try{let s=i.subarray(),o=Cr.decode(s);if(this.metrics?.onRpcRecv(o,s.length),this.opts.awaitRpcHandler)try{await this.handleReceivedRpc(e,o)}catch(a){this.metrics?.onRpcRecvError(),this.log(a)}else this.handleReceivedRpc(e,o).catch(a=>{this.metrics?.onRpcRecvError(),this.log(a)})}catch(s){this.metrics?.onRpcDataError(),this.log(s)}})}catch(n){this.metrics?.onPeerReadStreamError(),this.handlePeerReadStreamError(n,e)}}handlePeerReadStreamError(e,r){this.log.error(e),this.onPeerDisconnected(r)}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}let n=r.subscriptions.length,i=r.messages.length,s=0,o=0,a=0,c=0;if(r.control&&(s=r.control.ihave.length,o=r.control.iwant.length,a=r.control.graft.length,c=r.control.prune.length),this.log(`rpc.from ${e.toString()} subscriptions ${n} messages ${i} ihave ${s} iwant ${o} graft ${a} prune ${c}`),r.subscriptions.length>0){let u=[];r.subscriptions.forEach(f=>{let h=f.topic,l=f.subscribe===!0;if(h!=null){if(this.allowedTopics&&!this.allowedTopics.has(h))return;this.handleReceivedSubscription(e,h,l),u.push({topic:h,subscribe:l})}}),this.dispatchEvent(new Sr("subscription-change",{detail:{peerId:e,subscriptions:u}}))}for(let u of r.messages){if(this.allowedTopics&&!this.allowedTopics.has(u.topic))continue;let f=this.handleReceivedMessage(e,u).catch(h=>{this.metrics?.onMsgRecvError(u.topic),this.log(h)});this.opts.awaitRpcMessageHandler&&await f}r.control&&await this.handleControlMessage(e.toString(),r.control)}handleReceivedSubscription(e,r,n){this.log("subscription update from %p topic %s",e,r);let i=this.topics.get(r);i==null&&(i=new Set,this.topics.set(r,i)),n?i.add(e.toString()):i.delete(e.toString())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(e,r);switch(this.metrics?.onMsgRecvResult(r.topic,n.code),n.code){case wt.duplicate:this.score.duplicateMessage(e.toString(),n.msgIdStr,r.topic),this.gossipTracer.deliverMessage(n.msgIdStr,!0),this.mcache.observeDuplicate(n.msgIdStr,e.toString());return;case wt.invalid:if(n.msgIdStr){let i=n.msgIdStr;this.score.rejectMessage(e.toString(),i,r.topic,n.reason),this.gossipTracer.rejectMessage(i,n.reason)}else this.score.rejectInvalidMessage(e.toString(),r.topic);this.metrics?.onMsgRecvInvalid(r.topic,n);return;case wt.valid:this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,r,!this.opts.asyncValidation),this.subscriptions.has(r.topic)&&(!this.components.peerId.equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new Sr("gossipsub:message",{detail:{propagationSource:e,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new Sr("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,r,e.toString())}}async validateReceivedMessage(e,r){let n=this.fastMsgIdFn?.(r),i=n!==void 0?this.fastMsgIdCache?.get(n):void 0;if(i)return{code:wt.duplicate,msgIdStr:i};let s=await Pp(this.globalSignaturePolicy,r);if(!s.valid)return{code:wt.invalid,reason:Je.Error,error:s.error};let o=s.message;try{this.dataTransform&&(o.data=this.dataTransform.inboundTransform(r.topic,o.data))}catch(h){return this.log("Invalid message, transform failed",h),{code:wt.invalid,reason:Je.Error,error:We.TransformFailed}}let a=await this.msgIdFn(o),c=this.msgIdToStrFn(a),u={msgId:a,msgIdStr:c};if(n!==void 0&&this.fastMsgIdCache&&this.fastMsgIdCache.put(n,c)&&this.metrics?.fastMsgIdCacheCollision.inc(),this.seenCache.has(c))return{code:wt.duplicate,msgIdStr:c};this.seenCache.put(c);let f=this.topicValidators.get(r.topic);if(f!=null){let h;try{h=await f(e,o)}catch(l){let d=l.code;d===$h&&(h=Ot.Ignore),d===Wh?h=Ot.Reject:h=Ot.Ignore}if(h!==Ot.Accept)return{code:wt.invalid,reason:ru(h),msgIdStr:c}}return{code:wt.valid,messageId:u,msg:o}}getScore(e){return this.score.score(e)}sendSubscriptions(e,r,n){this.sendRpc(e,{subscriptions:r.map(i=>({topic:i,subscribe:n})),messages:[]})}async handleControlMessage(e,r){if(r===void 0)return;let n=this.handleIHave(e,r.ihave),i=this.handleIWant(e,r.iwant),s=await this.handleGraft(e,r.graft);if(await this.handlePrune(e,r.prune),!n.length&&!i.length&&!s.length)return;let o=this.sendRpc(e,nr(i,{iwant:n,prune:s})),a=n[0]?.messageIDs;o?this.gossipTracer.addPromise(e,a):this.metrics?.iwantPromiseUntracked.inc(1)}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let i=this.score.score(e);return i>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(e),i>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:si.LowScore}),[];let i=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,i),i>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:si.MaxIhave}),[];let s=this.iasked.get(e)??0;if(s>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:si.MaxIasked}),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:f})=>{if(!u||!this.mesh.has(u))return;let h=0;f.forEach(l=>{let d=this.msgIdToStrFn(l);this.seenCache.has(d)||(o.set(d,l),h++)}),this.metrics?.onIhaveRcv(u,f.length,h)}),!o.size)return[];let a=o.size;a+s>5e3&&(a=5e3-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Ht(c),c=c.slice(0,a),this.iasked.set(e,s+a),[{messageIDs:c}]}handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let i=new Map,s=new Map,o=0;return r.forEach(({messageIDs:a})=>{a.forEach(c=>{let u=this.msgIdToStrFn(c),f=this.mcache.getWithIWantCount(u,e);if(f==null){o++;return}if(s.set(f.msg.topic,1+(s.get(f.msg.topic)??0)),f.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,c);return}i.set(u,f.msg)})}),this.metrics?.onIwantRcv(s,o),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,r){let n=[],i=this.score.score(e),s=Date.now(),o=this.opts.doPX;if(r.forEach(({topicID:c})=>{if(!c)return;let u=this.mesh.get(c);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(c),o=!1;return}let f=this.backoff.get(c)?.get(e);if(typeof f=="number"&&s<f){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,ii.GraftBackoff),o=!1;let h=f+this.opts.graftFloodThreshold-this.opts.pruneBackoff;s<h&&this.score.addPenalty(e,1,ii.GraftBackoff),this.addBackoff(e,c),n.push(c);return}if(i<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,c),n.push(c),o=!1,this.addBackoff(e,c);return}if(u.size>=this.opts.Dhi&&!this.outbound.get(e)){n.push(c),this.addBackoff(e,c);return}this.log("GRAFT: Add mesh link from %s in %s",e,c),this.score.graft(e,c),u.add(e),this.metrics?.onAddToMesh(c,mr.Subscribed,1)}),!n.length)return[];let a=!1;return await Promise.all(n.map(c=>this.makePrune(e,c,o,a)))}async handlePrune(e,r){let n=this.score.score(e);for(let{topicID:i,backoff:s,peers:o}of r){if(i==null)continue;let a=this.mesh.get(i);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(i,ln.Prune,1)),typeof s=="number"&&s>0?this.doAddBackoff(e,i,s*1e3):this.addBackoff(e,i),o.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);continue}await this.pxConnect(o)}}}addBackoff(e,r){this.doAddBackoff(e,r,this.opts.pruneBackoff)}doAddBackoff(e,r,n){let i=this.backoff.get(r);i||(i=new Map,this.backoff.set(r,i));let s=Date.now()+n;(i.get(e)??0)<s&&i.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,ii.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((r,n)=>{r.forEach((i,s)=>{i+1*this.opts.heartbeatInterval<e&&r.delete(s)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let e=[];this.direct.forEach(r=>{this.streamsOutbound.has(r)||e.push(r)}),await Promise.all(e.map(async r=>await this.connect(r)))}async pxConnect(e){e.length>this.opts.prunePeers&&(Ht(e),e=e.slice(0,this.opts.prunePeers));let r=[];await Promise.all(e.map(async n=>{if(!n.peerID)return;let i=Bn(n.peerID),s=i.toString();if(!this.peers.has(s)){if(!n.signedPeerRecord){r.push(s);return}try{if(!await this.components.peerStore.consumePeerRecord(n.signedPeerRecord,i)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length&&await Promise.all(r.map(async n=>await this.connect(n)))}async connect(e){this.log("Initiating connection with %s",e);let r=Wr(e),n=await this.components.connectionManager.openConnection(r);for(let i of this.multicodecs)for(let s of this.components.registrar.getTopologies(i))s.onConnect(r,n)}subscribe(e){if(this.status.code!==ht.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==ht.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e)}join(e){if(this.status.code!==ht.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,n=this.backoff.get(e),i=this.fanout.get(e);if(i&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),i.forEach(s=>{!this.direct.has(s)&&this.score.score(s)>=0&&(!n||!n.has(s))&&r.add(s)}),this.metrics?.onAddToMesh(e,mr.Fanout,r.size)),r.size<this.opts.D){let s=r.size;this.getRandomGossipPeers(e,this.opts.D,a=>!r.has(a)&&!this.direct.has(a)&&this.score.score(a)>=0&&(!n||!n.has(a))).forEach(a=>{r.add(a)}),this.metrics?.onAddToMesh(e,mr.Random,r.size-s)}this.mesh.set(e,r),r.forEach(s=>{this.log("JOIN: Add mesh link to %s in %s",s,e),this.sendGraft(s,e)})}leave(e){if(this.status.code!==ht.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r&&(Promise.all(Array.from(r).map(async n=>(this.log("LEAVE: Remove mesh link to %s in %s",n,e),await this.sendPrune(n,e)))).catch(n=>{this.log("Error sending prunes to mesh peers",n)}),this.mesh.delete(e))}selectPeersToForward(e,r,n){let i=new Set,s=this.topics.get(e);s&&(this.direct.forEach(a=>{s.has(a)&&r!==a&&!n?.has(a)&&i.add(a)}),this.floodsubPeers.forEach(a=>{s.has(a)&&r!==a&&!n?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&i.add(a)}));let o=this.mesh.get(e);return o&&o.size>0&&o.forEach(a=>{r!==a&&!n?.has(a)&&i.add(a)}),i}selectPeersToPublish(e){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},i=this.topics.get(e);if(i)if(this.opts.floodPublish)i.forEach(s=>{this.direct.has(s)?(r.add(s),n.direct++):this.score.score(s)>=this.opts.scoreThresholds.publishThreshold&&(r.add(s),n.floodsub++)});else{this.direct.forEach(o=>{i.has(o)&&(r.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{i.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});let s=this.mesh.get(e);if(s&&s.size>0)s.forEach(o=>{r.add(o),n.mesh++});else{let o=this.fanout.get(e);if(o&&o.size>0)o.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,c=>this.score.score(c)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(c=>{r.add(c),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(e,r,n,i){n&&this.score.deliverMessage(n,e,r.topic);let s=this.selectPeersToForward(r.topic,n,i);s.forEach(o=>{this.sendRpc(o,nr([r]))}),this.metrics?.onForwardMsg(r.topic,s.size)}async publish(e,r,n){let i=Date.now(),s=this.dataTransform?this.dataTransform.outboundTransform(e,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let{raw:o,msg:a}=await Rp(this.publishConfig,e,r,s),c=await this.msgIdFn(a),u=this.msgIdToStrFn(c),f=n?.ignoreDuplicatePublishError??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(u)){if(f)return this.metrics?.onPublishDuplicateMsg(e),{recipients:[]};throw Error("PublishError.Duplicate")}let{tosend:h,tosendCount:l}=this.selectPeersToPublish(e),d=this.opts.emitSelf===!0&&this.subscriptions.has(e),p=n?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(h.size===0&&!p&&!d)throw Error("PublishError.InsufficientPeers");this.seenCache.put(u),this.mcache.put({msgId:c,msgIdStr:u},o,!0),this.publishedMessageIds.put(u);for(let y of h)this.sendRpc(y,nr([o]))||h.delete(y);let g=Date.now()-i;return this.metrics?.onPublishMsg(e,l,h.size,o.data!=null?o.data.length:0,g),d&&(h.add(this.components.peerId.toString()),super.dispatchEvent(new Sr("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:u,msg:a}})),super.dispatchEvent(new Sr("message",{detail:a}))),{recipients:Array.from(h.values()).map(y=>Wr(y))}}reportMessageValidationResult(e,r,n){let i;if(n===Ot.Accept){if(i=this.mcache.validate(e),i!=null){let{message:o,originatingPeers:a}=i;this.score.deliverMessage(r,e,o.topic),this.forwardMessage(e,i.message,r,a)}}else if(i=this.mcache.remove(e),i){let o=ru(n),{message:a,originatingPeers:c}=i;this.score.rejectMessage(r,e,a.topic,o);for(let u of c)this.score.rejectMessage(u,e,a.topic,o)}let s=this.score.messageFirstSeenTimestampMs(e);this.metrics?.onReportValidation(i,n,s)}sendGraft(e,r){let i=nr([],{graft:[{topicID:r}]});this.sendRpc(e,i)}async sendPrune(e,r){let i=[await this.makePrune(e,r,this.opts.doPX,!0)],s=nr([],{prune:i});this.sendRpc(e,s)}sendRpc(e,r){let n=this.streamsOutbound.get(e);if(!n)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let i=this.control.get(e);i&&(this.piggybackControl(e,r,i),this.control.delete(e));let s=this.gossip.get(e);s&&(this.piggybackGossip(e,r,s),this.gossip.delete(e));let o=Cr.encode(r);try{n.push(o)}catch(a){return this.log.error(`Cannot send rpc to ${e}`,a),i&&this.control.set(e,i),s&&this.gossip.set(e,s),!1}return this.metrics?.onRpcSent(r,o.length),!0}piggybackControl(e,r,n){let i=lu(r);for(let s of n.graft)s.topicID&&this.mesh.get(s.topicID)?.has(e)&&i.control.graft.push(s);for(let s of n.prune)s.topicID&&!this.mesh.get(s.topicID)?.has(e)&&i.control.prune.push(s)}piggybackGossip(e,r,n){let i=lu(r);i.control.ihave=n}async sendGraftPrune(e,r,n){let i=this.opts.doPX,s=!1;for(let[o,a]of e){let c=a.map(h=>({topicID:h})),u=[],f=r.get(o);f&&(u=await Promise.all(f.map(async h=>await this.makePrune(o,h,i&&!(n.get(o)??!1),s))),r.delete(o)),this.sendRpc(o,nr([],{graft:c,prune:u}))}for(let[o,a]of r){let c=await Promise.all(a.map(async u=>await this.makePrune(o,u,i&&!(n.get(o)??!1),s)));this.sendRpc(o,nr([],{prune:c}))}}emitGossip(e){let r=this.mcache.getGossipIDs(new Set(e.keys()));for(let[n,i]of e)this.doEmitGossip(n,i,r.get(n)??[])}doEmitGossip(e,r,n){if(!n.length||(Ht(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!r.size))return;let i=this.opts.Dlazy,s=.25*r.size,o=r;s>i&&(i=s),i>o.size?i=o.size:o=Ht(Array.from(o)).slice(0,i),o.forEach(a=>{let c=n;n.length>5e3&&(c=Ht(c.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:e,messageIDs:c})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,nr([],{ihave:r}));for(let[e,r]of this.control.entries()){this.control.delete(e);let n=nr([],{graft:r.graft,prune:r.prune});this.sendRpc(e,n)}}pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}async makePrune(e,r,n,i){if(this.score.prune(e,r),this.streamsOutbound.get(e).protocol===ec)return{topicID:r,peers:[]};let s=i?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,o=BigInt(s/1e3);if(this.doAddBackoff(e,r,s),!n)return{topicID:r,peers:[],backoff:o};let a=this.getRandomGossipPeers(r,this.opts.prunePeers,u=>u!==e&&this.score.score(u)>=0),c=await Promise.all(Array.from(a).map(async u=>{let f=Wr(u),h;try{h=await this.components.peerStore.get(f)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}return{peerID:f.toBytes(),signedPeerRecord:h?.peerRecordEnvelope}}));return{topicID:r,peers:c,backoff:o}}async heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:i,Dout:s,fanoutTTL:o}=this.opts;this.heartbeatTicks++;let a=new Map,c=p=>{let g=a.get(p);return g===void 0&&(g=this.score.score(p),a.set(p,g)),g},u=new Map,f=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((p,g)=>{let y=this.topics.get(g),v=new Set,x=new Set;if(l.set(g,x),y){let w=Ht(Array.from(y)),S=this.backoff.get(g);for(let P of w){let O=this.streamsOutbound.get(P);if(O&&this.multicodecs.includes(O.protocol)&&!p.has(P)&&!this.direct.has(P)){let K=c(P);(!S||!S.has(P))&&K>=0&&v.add(P),K>=this.opts.scoreThresholds.gossipThreshold&&x.add(P)}}}let A=(w,S)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",w,g),this.addBackoff(w,g),p.delete(w),c(w)>=this.opts.scoreThresholds.gossipThreshold&&x.add(w),this.metrics?.onRemoveFromMesh(g,S,1);let P=f.get(w);P?P.push(g):f.set(w,[g])},_=(w,S)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",w,g),this.score.graft(w,g),p.add(w),x.delete(w),this.metrics?.onAddToMesh(g,S,1);let P=u.get(w);P?P.push(g):u.set(w,[g])};if(p.forEach(w=>{let S=c(w);S<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",w,S,g),A(w,ln.BadScore),h.set(w,!0))}),p.size<r){let w=e-p.size;Ip(v,w).forEach(P=>{_(P,mr.NotEnough)})}if(p.size>n){let w=Array.from(p);w.sort((P,O)=>c(O)-c(P)),w=w.slice(0,i).concat(Ht(w.slice(i)));let S=0;if(w.slice(0,e).forEach(P=>{this.outbound.get(P)&&S++}),S<s){let P=K=>{let $=w[K];for(let ue=K;ue>0;ue--)w[ue]=w[ue-1];w[0]=$};if(S>0){let K=S;for(let $=1;$<e&&K>0;$++)this.outbound.get(w[$])&&(P($),K--)}let O=e-S;for(let K=e;K<w.length&&O>0;K++)this.outbound.get(w[K])&&(P(K),O--)}w.slice(e).forEach(P=>{A(P,ln.Excess)})}if(p.size>=r){let w=0;if(p.forEach(S=>{this.outbound.get(S)&&w++}),w<s){let S=s-w;yo(v,S,O=>this.outbound.get(O)===!0).forEach(O=>{_(O,mr.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let w=Array.from(p).sort((O,K)=>c(O)-c(K)),S=Math.floor(p.size/2),P=c(w[S]);if(P<this.opts.scoreThresholds.opportunisticGraftThreshold){let O=this.opts.opportunisticGraftPeers,K=yo(v,O,$=>c($)>P);for(let $ of K)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",$,g),_($,mr.Opportunistic)}}});let d=Date.now();this.fanoutLastpub.forEach((p,g)=>{p+o<d&&(this.fanout.delete(g),this.fanoutLastpub.delete(g))}),this.fanout.forEach((p,g)=>{let y=this.topics.get(g);p.forEach(_=>{(!y.has(_)||c(_)<this.opts.scoreThresholds.publishThreshold)&&p.delete(_)});let v=this.topics.get(g),x=[],A=new Set;if(l.set(g,A),v){let _=Ht(Array.from(v));for(let w of _){let S=this.streamsOutbound.get(w);if(S&&this.multicodecs.includes(S.protocol)&&!p.has(w)&&!this.direct.has(w)){let P=c(w);P>=this.opts.scoreThresholds.publishThreshold&&x.push(w),P>=this.opts.scoreThresholds.gossipThreshold&&A.add(w)}}}if(p.size<e){let _=e-p.size;x.slice(0,_).forEach(w=>{p.add(w),A?.delete(w)})}}),this.emitGossip(l),await this.sendGraftPrune(u,f,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new Sr("gossipsub:heartbeat"))}getRandomGossipPeers(e,r,n=()=>!0){let i=this.topics.get(e);if(!i)return new Set;let s=[];return i.forEach(o=>{let a=this.streamsOutbound.get(o);a&&this.multicodecs.includes(a.protocol)&&n(o)&&s.push(o)}),s=Ht(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0,n=Date.now();e.connectedPeersBackoffSec.reset();for(let a of this.backoff.values()){r+=a.size;for(let[c,u]of a.entries())this.peers.has(c)&&e.connectedPeersBackoffSec.observe(Math.max(0,u-n)/1e3)}e.cacheSize.set({cache:"backoff"},r);for(let[a,c]of this.topics)e.topicPeersCount.set({topicStr:a},c.size);for(let[a,c]of this.mesh)e.meshPeerCounts.set({topicStr:a},c.size);let i=[],s=new Map;e.behaviourPenalty.reset();for(let a of this.peers.keys()){let c=this.score.score(a);i.push(c),s.set(a,c),e.behaviourPenalty.observe(this.score.peerStats.get(a)?.behaviourPenalty??0)}e.registerScores(i,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,s);let o=Np(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(o)}};ji.multicodec=Rs;function sx(t={}){return e=>new ji(e,t)}return vd(ox);})();
/*! Bundled license information:

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PGossipsub}));
