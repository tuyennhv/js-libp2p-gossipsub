"use strict";(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
var ChainsafeLibp2PGossipsub=(()=>{var vy=Object.create;var gs=Object.defineProperty;var wy=Object.getOwnPropertyDescriptor;var xy=Object.getOwnPropertyNames;var Ey=Object.getPrototypeOf,Sy=Object.prototype.hasOwnProperty;var ju=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var B=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ye=(t,e)=>{for(var r in e)gs(t,r,{get:e[r],enumerable:!0})},$u=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xy(e))!Sy.call(t,i)&&i!==r&&gs(t,i,{get:()=>e[i],enumerable:!(n=wy(e,i))||n.enumerable});return t};var F=(t,e,r)=>(r=t!=null?vy(Ey(t)):{},$u(e||!t||!t.__esModule?gs(r,"default",{value:t,enumerable:!0}):r,t)),_y=t=>$u(gs({},"__esModule",{value:!0}),t);var Xu=B((rI,Zu)=>{Zu.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var ef=B((iI,Ju)=>{var Qu=Xu();Ju.exports=class{constructor(e){this.hwm=e||16,this.head=new Qu(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new Qu(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var rf=B((sI,tf)=>{var sa=ef();tf.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new sa,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let g,m=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;m.push(g.value)}return{done:g.done,value:m}}let p=r.shift();if(p.error)throw p.error;return p}return s?{done:!0}:new Promise((p,g)=>{i=m=>(i=null,m.error?g(m.error):t.writev&&!m.done?p({done:m.done,value:[m.value]}):p(m),n)})},a=p=>i?i(p):(r.push(p),n),f=p=>(r=new sa,i?i({error:p}):(r.push({error:p}),n)),u=p=>s?n:a({done:!1,value:p}),c=p=>s?n:(s=!0,p?f(p):a({done:!0})),h=()=>(r=new sa,c(),{done:!0}),l=p=>(c(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:h,throw:l,push:u,end:c},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(p){return d.throw(p),e&&(e(p),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(p){return d.end(p),e&&(e(p),e=null),n}},n}});var sf=B((oI,nf)=>{"use strict";var Ay=rf(),Cy=async function*(...t){let e=Ay();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};nf.exports=Cy});var De=B((uI,uf)=>{"use strict";function cf(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Ry(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return cf(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),cf(new i,r)}}uf.exports=Ry});var fe=B((JA,qf)=>{qf.exports={options:{usePureJavaScript:!1}}});var Gf=B((e3,zf)=>{var Ta={};zf.exports=Ta;var Kf={};Ta.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=F1(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var f=0,u=t[i];f<a.length;++f)u+=a[f]<<8,a[f]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};Ta.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Kf[e];if(!r){r=Kf[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var f=0,u=a;f<o.length;++f)u+=o[f]*i,o[f]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var c=0;t[c]===s&&c<t.length-1;++c)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function F1(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=e[s[r]];return f}});var Me=B((t3,$f)=>{var Hf=fe(),Wf=Gf(),y=$f.exports=Hf.util=Hf.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(a){return setImmediate(a)};return}if(y.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(c){c()})}};var o=a,t="forge.setImmediate",e=[];y.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Ci(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=Ba;function Ba(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ba||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=Ba;var V1=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>V1&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){Ci(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){Ci(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function q1(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=q1;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){Ci(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return Ci(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){Ci(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var xr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Er=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],jf="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=xr.charAt(i>>2),r+=xr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=xr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":xr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=Er[t.charCodeAt(o++)-43],n=Er[t.charCodeAt(o++)-43],i=Er[t.charCodeAt(o++)-43],s=Er[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Wf.encode,decode:Wf.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=xr.charAt(i>>2),r+=xr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=xr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":xr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,f=0,u=r;f<t.length;)i=Er[t.charCodeAt(f++)-43],s=Er[t.charCodeAt(f++)-43],o=Er[t.charCodeAt(f++)-43],a=Er[t.charCodeAt(f++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,jf,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,jf,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var Ra=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Da=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},K1=function(t,e,r,n){var i=Da(t,e);i===null&&(i={}),i[r]=n,Ra(t,e,i)},z1=function(t,e,r){var n=Da(t,e);return n!==null&&(n=r in n?n[r]:null),n},G1=function(t,e,r){var n=Da(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Ra(t,e,n)}},H1=function(t,e){Ra(t,e,null)},Ts=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(f){o=f}if(s)break}if(!s)throw o;return n};y.setItem=function(t,e,r,n,i){Ts(K1,arguments,i)};y.getItem=function(t,e,r,n){return Ts(z1,arguments,n)};y.removeItem=function(t,e,r,n){Ts(G1,arguments,n)};y.clearItems=function(t,e,r){Ts(H1,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};y.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,f=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",c=u.length>3?u.length%3:0;return f+(c?u.substr(0,c)+a:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=y.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=y.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),f=a+4;Date.now()<f;);self.postMessage({st:a,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,f){if(a===0){var u=Math.floor(o.reduce(function(c,h){return c+h},0)/o.length);return y.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,y.cores)}i(f,function(c,h){o.push(s(f,h)),n(o,a-1,f)})}function i(o,a){for(var f=[],u=[],c=0;c<o;++c){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===o){for(var d=0;d<o;++d)f[d].terminate();a(null,u)}}),f.push(h)}for(var c=0;c<o;++c)f[c].postMessage(c)}function s(o,a){for(var f=[],u=0;u<o;++u)for(var c=a[u],h=f[u]=[],l=0;l<o;++l)if(u!==l){var d=a[l];(c.st>d.st&&c.st<d.et||d.st>c.st&&d.st<c.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Bs=B((r3,Yf)=>{var Ti=fe();Ti.pki=Ti.pki||{};var Pa=Yf.exports=Ti.pki.oids=Ti.oids=Ti.oids||{};function T(t,e){Pa[t]=e,Pa[e]=t}function ce(t,e){Pa[t]=e}T("1.2.840.113549.1.1.1","rsaEncryption");T("1.2.840.113549.1.1.4","md5WithRSAEncryption");T("1.2.840.113549.1.1.5","sha1WithRSAEncryption");T("1.2.840.113549.1.1.7","RSAES-OAEP");T("1.2.840.113549.1.1.8","mgf1");T("1.2.840.113549.1.1.9","pSpecified");T("1.2.840.113549.1.1.10","RSASSA-PSS");T("1.2.840.113549.1.1.11","sha256WithRSAEncryption");T("1.2.840.113549.1.1.12","sha384WithRSAEncryption");T("1.2.840.113549.1.1.13","sha512WithRSAEncryption");T("1.3.101.112","EdDSA25519");T("1.2.840.10040.4.3","dsa-with-sha1");T("1.3.14.3.2.7","desCBC");T("1.3.14.3.2.26","sha1");T("1.3.14.3.2.29","sha1WithRSASignature");T("2.16.840.1.101.3.4.2.1","sha256");T("2.16.840.1.101.3.4.2.2","sha384");T("2.16.840.1.101.3.4.2.3","sha512");T("2.16.840.1.101.3.4.2.4","sha224");T("2.16.840.1.101.3.4.2.5","sha512-224");T("2.16.840.1.101.3.4.2.6","sha512-256");T("1.2.840.113549.2.2","md2");T("1.2.840.113549.2.5","md5");T("1.2.840.113549.1.7.1","data");T("1.2.840.113549.1.7.2","signedData");T("1.2.840.113549.1.7.3","envelopedData");T("1.2.840.113549.1.7.4","signedAndEnvelopedData");T("1.2.840.113549.1.7.5","digestedData");T("1.2.840.113549.1.7.6","encryptedData");T("1.2.840.113549.1.9.1","emailAddress");T("1.2.840.113549.1.9.2","unstructuredName");T("1.2.840.113549.1.9.3","contentType");T("1.2.840.113549.1.9.4","messageDigest");T("1.2.840.113549.1.9.5","signingTime");T("1.2.840.113549.1.9.6","counterSignature");T("1.2.840.113549.1.9.7","challengePassword");T("1.2.840.113549.1.9.8","unstructuredAddress");T("1.2.840.113549.1.9.14","extensionRequest");T("1.2.840.113549.1.9.20","friendlyName");T("1.2.840.113549.1.9.21","localKeyId");T("1.2.840.113549.1.9.22.1","x509Certificate");T("1.2.840.113549.1.12.10.1.1","keyBag");T("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");T("1.2.840.113549.1.12.10.1.3","certBag");T("1.2.840.113549.1.12.10.1.4","crlBag");T("1.2.840.113549.1.12.10.1.5","secretBag");T("1.2.840.113549.1.12.10.1.6","safeContentsBag");T("1.2.840.113549.1.5.13","pkcs5PBES2");T("1.2.840.113549.1.5.12","pkcs5PBKDF2");T("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");T("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");T("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");T("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");T("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");T("1.2.840.113549.2.7","hmacWithSHA1");T("1.2.840.113549.2.8","hmacWithSHA224");T("1.2.840.113549.2.9","hmacWithSHA256");T("1.2.840.113549.2.10","hmacWithSHA384");T("1.2.840.113549.2.11","hmacWithSHA512");T("1.2.840.113549.3.7","des-EDE3-CBC");T("2.16.840.1.101.3.4.1.2","aes128-CBC");T("2.16.840.1.101.3.4.1.22","aes192-CBC");T("2.16.840.1.101.3.4.1.42","aes256-CBC");T("2.5.4.3","commonName");T("2.5.4.4","surname");T("2.5.4.5","serialNumber");T("2.5.4.6","countryName");T("2.5.4.7","localityName");T("2.5.4.8","stateOrProvinceName");T("2.5.4.9","streetAddress");T("2.5.4.10","organizationName");T("2.5.4.11","organizationalUnitName");T("2.5.4.12","title");T("2.5.4.13","description");T("2.5.4.15","businessCategory");T("2.5.4.17","postalCode");T("2.5.4.42","givenName");T("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");T("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");T("2.16.840.1.113730.1.1","nsCertType");T("2.16.840.1.113730.1.13","nsComment");ce("2.5.29.1","authorityKeyIdentifier");ce("2.5.29.2","keyAttributes");ce("2.5.29.3","certificatePolicies");ce("2.5.29.4","keyUsageRestriction");ce("2.5.29.5","policyMapping");ce("2.5.29.6","subtreesConstraint");ce("2.5.29.7","subjectAltName");ce("2.5.29.8","issuerAltName");ce("2.5.29.9","subjectDirectoryAttributes");ce("2.5.29.10","basicConstraints");ce("2.5.29.11","nameConstraints");ce("2.5.29.12","policyConstraints");ce("2.5.29.13","basicConstraints");T("2.5.29.14","subjectKeyIdentifier");T("2.5.29.15","keyUsage");ce("2.5.29.16","privateKeyUsagePeriod");T("2.5.29.17","subjectAltName");T("2.5.29.18","issuerAltName");T("2.5.29.19","basicConstraints");ce("2.5.29.20","cRLNumber");ce("2.5.29.21","cRLReason");ce("2.5.29.22","expirationDate");ce("2.5.29.23","instructionCode");ce("2.5.29.24","invalidityDate");ce("2.5.29.25","cRLDistributionPoints");ce("2.5.29.26","issuingDistributionPoint");ce("2.5.29.27","deltaCRLIndicator");ce("2.5.29.28","issuingDistributionPoint");ce("2.5.29.29","certificateIssuer");ce("2.5.29.30","nameConstraints");T("2.5.29.31","cRLDistributionPoints");T("2.5.29.32","certificatePolicies");ce("2.5.29.33","policyMappings");ce("2.5.29.34","policyConstraints");T("2.5.29.35","authorityKeyIdentifier");ce("2.5.29.36","policyConstraints");T("2.5.29.37","extKeyUsage");ce("2.5.29.46","freshestCRL");ce("2.5.29.54","inhibitAnyPolicy");T("1.3.6.1.4.1.11129.2.4.2","timestampList");T("1.3.6.1.5.5.7.1.1","authorityInfoAccess");T("1.3.6.1.5.5.7.3.1","serverAuth");T("1.3.6.1.5.5.7.3.2","clientAuth");T("1.3.6.1.5.5.7.3.3","codeSigning");T("1.3.6.1.5.5.7.3.4","emailProtection");T("1.3.6.1.5.5.7.3.8","timeStamping")});var Ri=B((n3,Xf)=>{var we=fe();Me();Bs();var R=Xf.exports=we.asn1=we.asn1||{};R.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};R.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};R.create=function(t,e,r,n,i){if(we.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||we.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=R.copy(a)),a};R.copy=function(t,e){var r;if(we.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(R.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:R.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};R.equals=function(t,e,r){if(we.util.isArray(t)){if(!we.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!R.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&R.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};R.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Bi(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var W1=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Bi(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};R.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=we.util.createBuffer(t));var r=t.length(),n=Rs(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Rs(t,e,r,n){var i;Bi(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var f=W1(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=f,u}f=e}var c,h,l=(s&32)===32;if(l)if(c=[],f===void 0)for(;;){if(Bi(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),c.push(Rs(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),c.push(Rs(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(c===void 0&&o===R.Class.UNIVERSAL&&a===R.Type.BITSTRING&&(h=t.bytes(f)),c===void 0&&n.decodeBitStrings&&o===R.Class.UNIVERSAL&&a===R.Type.BITSTRING&&f>1){var d=t.read,p=e,g=0;if(a===R.Type.BITSTRING&&(Bi(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var m={strict:!0,decodeBitStrings:!0},v=Rs(t,e,r+1,m),S=i-t.length();e-=S,a==R.Type.BITSTRING&&S++;var C=v.tagClass;S===f&&(C===R.Class.UNIVERSAL||C===R.Class.CONTEXT_SPECIFIC)&&(c=[v])}catch{}c===void 0&&(t.read=d,e=p)}if(c===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(a===R.Type.BMPSTRING)for(c="";f>0;f-=2)Bi(t,e,2),c+=String.fromCharCode(t.getInt16()),e-=2;else c=t.getBytes(f),e-=f}var D=h===void 0?null:{bitStringContents:h};return R.create(o,a,l,c,D)}R.toDer=function(t){var e=we.util.createBuffer(),r=t.tagClass|t.type,n=we.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=R.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(R.toDer(t.value[s]))}else if(t.type===R.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===R.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};R.oidToDer=function(t){var e=t.split("."),r=we.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};R.derToOid=function(t){var e;typeof t=="string"&&(t=we.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};R.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var f=t.charAt(10),u=10;f!=="+"&&f!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),u&&(f=t.charAt(u),f==="+"||f==="-")){var c=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),l=c*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};R.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),f=0,u=0,c=!1;t.charAt(t.length-1)==="Z"&&(c=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);u=d*60+p,u*=6e4,l==="+"&&(u*=-1),c=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),c?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,f),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,a,f)),e};R.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};R.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};R.integerToDer=function(t){var e=we.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};R.derToInteger=function(t){typeof t=="string"&&(t=we.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};R.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&we.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=R.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Zf=/[^\\u0000-\\u00ff]/;R.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case R.Class.UNIVERSAL:n+="Universal:";break;case R.Class.APPLICATION:n+="Application:";break;case R.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case R.Class.PRIVATE:n+="Private:";break}if(t.tagClass===R.Class.UNIVERSAL)switch(n+=t.type,t.type){case R.Type.NONE:n+=" (None)";break;case R.Type.BOOLEAN:n+=" (Boolean)";break;case R.Type.INTEGER:n+=" (Integer)";break;case R.Type.BITSTRING:n+=" (Bit string)";break;case R.Type.OCTETSTRING:n+=" (Octet string)";break;case R.Type.NULL:n+=" (Null)";break;case R.Type.OID:n+=" (Object Identifier)";break;case R.Type.ODESC:n+=" (Object Descriptor)";break;case R.Type.EXTERNAL:n+=" (External or Instance of)";break;case R.Type.REAL:n+=" (Real)";break;case R.Type.ENUMERATED:n+=" (Enumerated)";break;case R.Type.EMBEDDED:n+=" (Embedded PDV)";break;case R.Type.UTF8:n+=" (UTF8)";break;case R.Type.ROID:n+=" (Relative Object Identifier)";break;case R.Type.SEQUENCE:n+=" (Sequence)";break;case R.Type.SET:n+=" (Set)";break;case R.Type.PRINTABLESTRING:n+=" (Printable String)";break;case R.Type.IA5String:n+=" (IA5String (ASCII))";break;case R.Type.UTCTIME:n+=" (UTC time)";break;case R.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case R.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=R.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===R.Type.OID){var f=R.derToOid(t.value);n+=f,we.pki&&we.pki.oids&&f in we.pki.oids&&(n+=" ("+we.pki.oids[f]+") ")}if(t.type===R.Type.INTEGER)try{n+=R.derToInteger(t.value)}catch{n+="0x"+we.util.bytesToHex(t.value)}else if(t.type===R.Type.BITSTRING){if(t.value.length>1?n+="0x"+we.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===R.Type.OCTETSTRING)Zf.test(t.value)||(n+="("+t.value+") "),n+="0x"+we.util.bytesToHex(t.value);else if(t.type===R.Type.UTF8)try{n+=we.util.decodeUtf8(t.value)}catch(c){if(c.message==="URI malformed")n+="0x"+we.util.bytesToHex(t.value)+" (malformed UTF8)";else throw c}else t.type===R.Type.PRINTABLESTRING||t.type===R.Type.IA5String?n+=t.value:Zf.test(t.value)?n+="0x"+we.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Ma=B((i3,Qf)=>{var ze=fe();Me();Qf.exports=ze.cipher=ze.cipher||{};ze.cipher.algorithms=ze.cipher.algorithms||{};ze.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=ze.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new ze.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};ze.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=ze.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new ze.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};ze.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),ze.cipher.algorithms[t]=e};ze.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in ze.cipher.algorithms?ze.cipher.algorithms[t]:null};var La=ze.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};La.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=ze.util.createBuffer(),this.output=t.output||ze.util.createBuffer(),this.mode.start(e)};La.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};La.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var ka=B((s3,Jf)=>{var Ge=fe();Me();Ge.cipher=Ge.cipher||{};var Y=Jf.exports=Ge.cipher.modes=Ge.cipher.modes||{};Y.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Y.ecb.prototype.start=function(t){};Y.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Y.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Y.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Y.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Y.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Y.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Ds(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Y.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Y.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Y.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Y.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Y.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ge.util.createBuffer(),this._partialBytes=0};Y.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ds(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Y.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Y.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Y.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ge.util.createBuffer(),this._partialBytes=0};Y.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ds(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Y.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Y.ofb.prototype.decrypt=Y.ofb.prototype.encrypt;Y.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ge.util.createBuffer(),this._partialBytes=0};Y.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ds(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Y.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Ps(this._inBlock)};Y.ctr.prototype.decrypt=Y.ctr.prototype.encrypt;Y.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ge.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Y.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Ge.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Ge.util.createBuffer(t.additionalData):r=Ge.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Ge.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Na(n*8)))}this._inBlock=this._j0.slice(0),Ps(this._inBlock),this._partialBytes=0,r=Ge.util.createBuffer(r),this._aDataLength=Na(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Y.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ps(this._inBlock)};Y.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ps(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Y.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Ge.util.createBuffer();var n=this._aDataLength.concat(Na(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Y.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Y.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Y.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Y.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Y.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],f=o/n|0,u=(n-1-o%n)*e;a[f]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};Y.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],f=i[o];i[s+o]=[a[0]^f[0],a[1]^f[1],a[2]^f[2],a[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function Ds(t,e){if(typeof t=="string"&&(t=Ge.util.createBuffer(t)),Ge.util.isArray(t)&&t.length>4){var r=t;t=Ge.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Ge.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function Ps(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Na(t){return[t/4294967296|0,t&4294967295]}});var Ms=B((o3,nh)=>{var me=fe();Ma();ka();Me();nh.exports=me.aes=me.aes||{};me.aes.startEncrypting=function(t,e,r,n){var i=Ls({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};me.aes.createEncryptionCipher=function(t,e){return Ls({key:t,output:null,decrypt:!1,mode:e})};me.aes.startDecrypting=function(t,e,r,n){var i=Ls({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};me.aes.createDecryptionCipher=function(t,e){return Ls({key:t,output:null,decrypt:!0,mode:e})};me.aes.Algorithm=function(t,e){Fa||th();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Ua(r._w,n,i,!1)},decrypt:function(n,i){return Ua(r._w,n,i,!0)}}}),r._init=!1};me.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=me.util.createBuffer(e);else if(me.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=me.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!me.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!me.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=rh(e,t.decrypt&&!o),this._init=!0}};me.aes._expandKey=function(t,e){return Fa||th(),rh(t,e)};me.aes._updateBlock=Ua;Dn("AES-ECB",me.cipher.modes.ecb);Dn("AES-CBC",me.cipher.modes.cbc);Dn("AES-CFB",me.cipher.modes.cfb);Dn("AES-OFB",me.cipher.modes.ofb);Dn("AES-CTR",me.cipher.modes.ctr);Dn("AES-GCM",me.cipher.modes.gcm);function Dn(t,e){var r=function(){return new me.aes.Algorithm(t,e)};me.cipher.registerAlgorithm(t,r)}var Fa=!1,Rn=4,Qe,Oa,eh,zr,Tt;function th(){Fa=!0,eh=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Qe=new Array(256),Oa=new Array(256),zr=new Array(4),Tt=new Array(4);for(var e=0;e<4;++e)zr[e]=new Array(256),Tt[e]=new Array(256);for(var r=0,n=0,i,s,o,a,f,u,c,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Qe[r]=a,Oa[a]=r,f=t[a],i=t[r],s=t[i],o=t[s],u=f<<24^a<<16^a<<8^(a^f),c=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)zr[h][r]=u,Tt[h][a]=c,u=u<<24|u>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function rh(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=Rn*o,f=s;f<a;++f)n=r[f-1],f%s===0?(n=Qe[n>>>16&255]<<24^Qe[n>>>8&255]<<16^Qe[n&255]<<8^Qe[n>>>24]^eh[i]<<24,i++):s>6&&f%s===4&&(n=Qe[n>>>24]<<24^Qe[n>>>16&255]<<16^Qe[n>>>8&255]<<8^Qe[n&255]),r[f]=r[f-s]^n;if(e){var u,c=Tt[0],h=Tt[1],l=Tt[2],d=Tt[3],p=r.slice(0);a=r.length;for(var f=0,g=a-Rn;f<a;f+=Rn,g-=Rn)if(f===0||f===a-Rn)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var m=0;m<Rn;++m)u=r[g+m],p[f+(3&-m)]=c[Qe[u>>>24]]^h[Qe[u>>>16&255]]^l[Qe[u>>>8&255]]^d[Qe[u&255]];r=p}return r}function Ua(t,e,r,n){var i=t.length/4-1,s,o,a,f,u;n?(s=Tt[0],o=Tt[1],a=Tt[2],f=Tt[3],u=Oa):(s=zr[0],o=zr[1],a=zr[2],f=zr[3],u=Qe);var c,h,l,d,p,g,m;c=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var v=3,S=1;S<i;++S)p=s[c>>>24]^o[h>>>16&255]^a[l>>>8&255]^f[d&255]^t[++v],g=s[h>>>24]^o[l>>>16&255]^a[d>>>8&255]^f[c&255]^t[++v],m=s[l>>>24]^o[d>>>16&255]^a[c>>>8&255]^f[h&255]^t[++v],d=s[d>>>24]^o[c>>>16&255]^a[h>>>8&255]^f[l&255]^t[++v],c=p,h=g,l=m;r[0]=u[c>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^t[++v],r[n?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[c&255]^t[++v],r[2]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[c>>>8&255]<<8^u[h&255]^t[++v],r[n?1:3]=u[d>>>24]<<24^u[c>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^t[++v]}function Ls(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=me.cipher.createDecipher(r,t.key):n=me.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof me.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var oh=B((a3,sh)=>{var Ie=fe();Ma();ka();Me();sh.exports=Ie.des=Ie.des||{};Ie.des.startEncrypting=function(t,e,r,n){var i=Ns({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Ie.des.createEncryptionCipher=function(t,e){return Ns({key:t,output:null,decrypt:!1,mode:e})};Ie.des.startDecrypting=function(t,e,r,n){var i=Ns({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Ie.des.createDecryptionCipher=function(t,e){return Ns({key:t,output:null,decrypt:!0,mode:e})};Ie.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return ih(r._keys,n,i,!1)},decrypt:function(n,i){return ih(r._keys,n,i,!0)}}}),r._init=!1};Ie.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Ie.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=tb(e),this._init=!0}};Ut("DES-ECB",Ie.cipher.modes.ecb);Ut("DES-CBC",Ie.cipher.modes.cbc);Ut("DES-CFB",Ie.cipher.modes.cfb);Ut("DES-OFB",Ie.cipher.modes.ofb);Ut("DES-CTR",Ie.cipher.modes.ctr);Ut("3DES-ECB",Ie.cipher.modes.ecb);Ut("3DES-CBC",Ie.cipher.modes.cbc);Ut("3DES-CFB",Ie.cipher.modes.cfb);Ut("3DES-OFB",Ie.cipher.modes.ofb);Ut("3DES-CTR",Ie.cipher.modes.ctr);function Ut(t,e){var r=function(){return new Ie.des.Algorithm(t,e)};Ie.cipher.registerAlgorithm(t,r)}var j1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],$1=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Y1=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Z1=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],X1=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Q1=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],J1=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],eb=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function tb(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],S=0,C,D=0;D<g;D++){var w=t.getInt32(),A=t.getInt32();C=(w>>>4^A)&252645135,A^=C,w^=C<<4,C=(A>>>-16^w)&65535,w^=C,A^=C<<-16,C=(w>>>2^A)&858993459,A^=C,w^=C<<2,C=(A>>>-16^w)&65535,w^=C,A^=C<<-16,C=(w>>>1^A)&1431655765,A^=C,w^=C<<1,C=(A>>>8^w)&16711935,w^=C,A^=C<<8,C=(w>>>1^A)&1431655765,A^=C,w^=C<<1,C=w<<8|A>>>20&240,w=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=C;for(var L=0;L<v.length;++L){v[L]?(w=w<<2|w>>>26,A=A<<2|A>>>26):(w=w<<1|w>>>27,A=A<<1|A>>>27),w&=-15,A&=-15;var O=e[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|s[w>>>12&15]|o[w>>>8&15]|a[w>>>4&15],G=f[A>>>28]|u[A>>>24&15]|c[A>>>20&15]|h[A>>>16&15]|l[A>>>12&15]|d[A>>>8&15]|p[A>>>4&15];C=(G>>>16^O)&65535,m[S++]=O^C,m[S++]=G^C<<16}}return m}function ih(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],f=e[1];o=(a>>>4^f)&252645135,f^=o,a^=o<<4,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,a=a<<1|a>>>31,f=f<<1|f>>>31;for(var u=0;u<i;u+=3){for(var c=s[u+1],h=s[u+2],l=s[u];l!=c;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];o=a,a=f,f=o^($1[d>>>24&63]|Z1[d>>>16&63]|Q1[d>>>8&63]|eb[d&63]|j1[p>>>24&63]|Y1[p>>>16&63]|X1[p>>>8&63]|J1[p&63])}o=a,a=f,f=o}a=a>>>1|a<<31,f=f>>>1|f<<31,o=(a>>>1^f)&1431655765,f^=o,a^=o<<1,o=(f>>>8^a)&16711935,a^=o,f^=o<<8,o=(f>>>2^a)&858993459,a^=o,f^=o<<2,o=(a>>>16^f)&65535,f^=o,a^=o<<16,o=(a>>>4^f)&252645135,f^=o,a^=o<<4,r[0]=a,r[1]=f}function Ns(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=Ie.cipher.createDecipher(r,t.key):n=Ie.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof Ie.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Gr=B((c3,ah)=>{var ks=fe();ah.exports=ks.md=ks.md||{};ks.md.algorithms=ks.md.algorithms||{}});var uh=B((u3,ch)=>{var sr=fe();Gr();Me();var rb=ch.exports=sr.hmac=sr.hmac||{};rb.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in sr.md.algorithms)e=sr.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=sr.util.createBuffer(o);else if(sr.util.isArray(o)){var a=o;o=sr.util.createBuffer();for(var f=0;f<a.length;++f)o.putByte(a[f])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=sr.util.createBuffer(),n=sr.util.createBuffer(),u=o.length();for(var f=0;f<u;++f){var a=o.at(f);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,f=0;f<a;++f)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Pn=B(()=>{});var Va=B((l3,fh)=>{var Je=fe();uh();Gr();Me();var nb=Je.pkcs5=Je.pkcs5||{},or;Je.util.isNodejs&&!Je.options.usePureJavaScript&&(or=Pn());fh.exports=Je.pbkdf2=nb.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Je.util.isNodejs&&!Je.options.usePureJavaScript&&or.pbkdf2&&(i===null||typeof i!="object")&&(or.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?or.pbkdf2Sync.length===4?or.pbkdf2(t,e,r,n,function(C,D){if(C)return s(C);s(null,D.toString("binary"))}):or.pbkdf2(t,e,r,n,i,function(C,D){if(C)return s(C);s(null,D.toString("binary"))}):or.pbkdf2Sync.length===4?or.pbkdf2Sync(t,e,r,n).toString("binary"):or.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Je.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Je.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var f=Math.ceil(n/o),u=n-(f-1)*o,c=Je.hmac.create();c.start(i,t);var h="",l,d,p;if(!s){for(var g=1;g<=f;++g){c.start(null,null),c.update(e),c.update(Je.util.int32ToBytes(g)),l=p=c.digest().getBytes();for(var m=2;m<=r;++m)c.start(null,null),c.update(p),d=c.digest().getBytes(),l=Je.util.xorBytes(l,d,o),p=d;h+=g<f?l:l.substr(0,u)}return h}var g=1,m;function v(){if(g>f)return s(null,h);c.start(null,null),c.update(e),c.update(Je.util.int32ToBytes(g)),l=p=c.digest().getBytes(),m=2,S()}function S(){if(m<=r)return c.start(null,null),c.update(p),d=c.digest().getBytes(),l=Je.util.xorBytes(l,d,o),p=d,++m,Je.util.setImmediate(S);h+=g<f?l:l.substr(0,u),++g,v()}v()}});var ph=B((p3,lh)=>{var Us=fe();Me();var hh=lh.exports=Us.pem=Us.pem||{};hh.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Os(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Os(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Os(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Os(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Us.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};hh.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Us.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var f=s[2].split(i),u=0;s&&u<f.length;){for(var c=f[u].replace(/\s+$/,""),h=u+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;c+=l,u=h}if(s=c.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)d.values.push(ib(p[g]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Os(t){for(var e=t.name+": ",r=[],n=function(f,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function ib(t){return t.replace(/^\s+/,"")}});var vh=B((d3,bh)=>{var Ft=fe();Gr();Me();var gh=bh.exports=Ft.sha256=Ft.sha256||{};Ft.md.sha256=Ft.md.algorithms.sha256=gh;gh.create=function(){yh||sb();var t=null,e=Ft.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Ft.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Ft.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),dh(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Ft.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(qa.substr(0,n.blockLength-o));for(var a,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,f=a/4294967296>>>0,u+=f,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};dh(h,r,i);var l=Ft.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var qa=null,yh=!1,mh=null;function sb(){qa=String.fromCharCode(128),qa+=Ft.util.fillString(String.fromCharCode(0),64),mh=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],yh=!0}function dh(t,e,r){for(var n,i,s,o,a,f,u,c,h,l,d,p,g,m,v,S=r.length();S>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(c=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,m=t.h6,v=t.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=m^p&(g^m),s=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),f=c&h|l&(c^h),n=v+o+a+mh[u]+e[u],i=s+f,v=m,m=g,g=p,p=d+n>>>0,d=l,l=h,h=c,c=n+i>>>0;t.h0=t.h0+c|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+m|0,t.h7=t.h7+v|0,S-=64}}});var xh=B((g3,wh)=>{var Vt=fe();Me();var Fs=null;Vt.util.isNodejs&&!Vt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Fs=Pn());var ob=wh.exports=Vt.prng=Vt.prng||{};ob.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,c){if(!c)return e.generateSync(u);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=Vt.util.createBuffer();e.key=null,m();function m(v){if(v)return c(v);if(g.length()>=u)return c(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Vt.util.nextTick(function(){s(m)});var S=h(e.key,e.seed);e.generated+=S.length,g.putBytes(S),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Vt.util.setImmediate(m)}},e.generateSync=function(u){var c=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Vt.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=c(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(c(e.key,h(e.seed))),e.seed=d(c(e.key,e.seed))}return p.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var c=32-e.pools[0].messageLength<<5;e.seedFile(c,function(h,l){if(h)return u(h);e.collect(l),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var c=1,h=0;h<32;++h)e.reseeds%c===0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),c=c<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var l=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(u){var c=null,h=Vt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(c=function(w){return l.getRandomValues(w)});var d=Vt.util.createBuffer();if(c)for(;d.length()<u;){var p=Math.max(1,Math.min(u-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{c(g);for(var m=0;m<g.length;++m)d.putInt32(g[m])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(d.length()<u)for(var v,S,C,D=Math.floor(Math.random()*65536);d.length()<u;){S=16807*(D&65535),v=16807*(D>>16),S+=(v&32767)<<16,S+=v>>15,S=(S&2147483647)+(S>>31),D=S&4294967295;for(var m=0;m<3;++m)C=D>>>(m<<3),C^=Math.floor(Math.random()*256),d.putByte(C&255)}return d.getBytes(u)}return Fs?(e.seedFile=function(u,c){Fs.randomBytes(u,function(h,l){if(h)return c(h);c(null,l.toString())})},e.seedFileSync=function(u){return Fs.randomBytes(u).toString()}):(e.seedFile=function(u,c){try{c(null,f(u))}catch(h){c(h)}},e.seedFileSync=f),e.collect=function(u){for(var c=u.length,h=0;h<c;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,c){for(var h="",l=0;l<c;l+=8)h+=String.fromCharCode(u>>l&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var c=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){u.postMessage({forge:{prng:{err:d,bytes:p}}})})};u.addEventListener("message",c)}},e}});var Di=B((y3,Ka)=>{var He=fe();Ms();vh();xh();Me();(function(){if(He.random&&He.random.getBytes){Ka.exports=He.random;return}(function(t){var e={},r=new Array(4),n=He.util.createBuffer();e.formatKey=function(h){var l=He.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),He.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=He.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return He.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=He.md.sha256;function i(){var h=He.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,a=He.util.globalScope,f=a.crypto||a.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),He.options.usePureJavaScript||!He.util.isNodejs&&!o){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var c in navigator)try{typeof navigator[c]=="string"&&(u+=navigator[c])}catch{}s.collect(u),u=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!He.random)He.random=s;else for(var c in s)He.random[c]=s[c];He.random.createInstance=i,Ka.exports=He.random})(typeof jQuery<"u"?jQuery:null)})()});var Ih=B((m3,_h)=>{var it=fe();Me();var za=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Eh=[1,2,3,5],ab=function(t,e){return t<<e&65535|(t&65535)>>16-e},cb=function(t,e){return(t&65535)>>e|t<<16-e&65535};_h.exports=it.rc2=it.rc2||{};it.rc2.expandKey=function(t,e){typeof t=="string"&&(t=it.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(za[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,za[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,za[r.at(a+1)^r.at(a+s)]);return r};var Sh=function(t,e,r){var n=!1,i=null,s=null,o=null,a,f,u,c,h=[];for(t=it.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(a=function(p){for(u=0;u<4;u++)p[u]+=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=ab(p[u],Eh[u]),c++},f=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(a=function(p){for(u=3;u>=0;u--)p[u]=cb(p[u],Eh[u]),p[u]-=h[c]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),c--},f=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var g=[];for(u=0;u<4;u++){var m=i.getInt16Le();o!==null&&(r?m^=o.getInt16Le():o.putInt16Le(m)),g.push(m&65535)}c=r?0:63;for(var v=0;v<p.length;v++)for(var S=0;S<p[v][0];S++)p[v][1](g);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=it.util.createBuffer(p)),n=!1,i=it.util.createBuffer(),s=g||new it.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,a],[1,f],[6,a],[1,f],[5,a]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var m=i.length()===8?8:8-i.length();i.fillWithByte(m,m)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,s,!r);else{var v=s.length(),S=s.at(v-1);S>v?g=!1:s.truncate(S)}return g}},d};it.rc2.startEncrypting=function(t,e,r){var n=it.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};it.rc2.createEncryptionCipher=function(t,e){return Sh(t,e,!0)};it.rc2.startDecrypting=function(t,e,r){var n=it.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};it.rc2.createDecryptionCipher=function(t,e){return Sh(t,e,!1)}});var Ks=B((b3,Lh)=>{var Ga=fe();Lh.exports=Ga.jsbn=Ga.jsbn||{};var ar,ub=0xdeadbeefcafe,Ah=(ub&16777215)==15715070;function _(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Ga.jsbn.BigInteger=_;function ee(){return new _(null)}function fb(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function hb(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var f=this.data[t]&32767,u=this.data[t++]>>15,c=a*f+u*o;f=o*f+((c&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(c>>>15)+a*u+(i>>>30),r.data[n++]=f&1073741823}return i}function Ch(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var f=this.data[t]&16383,u=this.data[t++]>>14,c=a*f+u*o;f=o*f+((c&16383)<<14)+r.data[n]+i,i=(f>>28)+(c>>14)+a*u,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(_.prototype.am=Ch,ar=28):Ah&&navigator.appName=="Microsoft Internet Explorer"?(_.prototype.am=hb,ar=30):Ah&&navigator.appName!="Netscape"?(_.prototype.am=fb,ar=26):(_.prototype.am=Ch,ar=28);_.prototype.DB=ar;_.prototype.DM=(1<<ar)-1;_.prototype.DV=1<<ar;var Ha=52;_.prototype.FV=Math.pow(2,Ha);_.prototype.F1=Ha-ar;_.prototype.F2=2*ar-Ha;var lb="0123456789abcdefghijklmnopqrstuvwxyz",Vs=new Array,Ln,mt;Ln="0".charCodeAt(0);for(mt=0;mt<=9;++mt)Vs[Ln++]=mt;Ln="a".charCodeAt(0);for(mt=10;mt<36;++mt)Vs[Ln++]=mt;Ln="A".charCodeAt(0);for(mt=10;mt<36;++mt)Vs[Ln++]=mt;function Th(t){return lb.charAt(t)}function Bh(t,e){var r=Vs[t.charCodeAt(e)];return r??-1}function pb(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function db(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Sr(t){var e=ee();return e.fromInt(t),e}function gb(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:Bh(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&_.ZERO.subTo(this,this)}function yb(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function mb(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Th(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Th(n));return i?s:"0"}function bb(){var t=ee();return _.ZERO.subTo(this,t),t}function vb(){return this.s<0?this.negate():this}function wb(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function qs(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function xb(){return this.t<=0?0:this.DB*(this.t-1)+qs(this.data[this.t-1]^this.s&this.DM)}function Eb(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Sb(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function _b(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Ib(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function Ab(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Cb(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&_.ZERO.subTo(e,e)}function Tb(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Bb(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ee());var s=ee(),o=this.s,a=t.s,f=this.DB-qs(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,c=s.data[u-1];if(c!=0){var h=c*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,m=g-u,v=e??ee();for(s.dlShiftTo(m,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),_.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--m>=0;){var S=r.data[--g]==c?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=s.am(0,S,r,m,0,u))<S)for(s.dlShiftTo(m,v),r.subTo(v,r);r.data[g]<--S;)r.subTo(v,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&_.ZERO.subTo(e,e)),r.t=u,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&_.ZERO.subTo(r,r)}}}function Rb(t){var e=ee();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(_.ZERO)>0&&t.subTo(e,e),e}function Hr(t){this.m=t}function Db(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Pb(t){return t}function Lb(t){t.divRemTo(this.m,null,t)}function Mb(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Nb(t,e){t.squareTo(e),this.reduce(e)}Hr.prototype.convert=Db;Hr.prototype.revert=Pb;Hr.prototype.reduce=Lb;Hr.prototype.mulTo=Mb;Hr.prototype.sqrTo=Nb;function kb(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Wr(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Ob(t){var e=ee();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(_.ZERO)>0&&this.m.subTo(e,e),e}function Ub(t){var e=ee();return t.copyTo(e),this.reduce(e),e}function Fb(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Vb(t,e){t.squareTo(e),this.reduce(e)}function qb(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Wr.prototype.convert=Ob;Wr.prototype.revert=Ub;Wr.prototype.reduce=Fb;Wr.prototype.mulTo=qb;Wr.prototype.sqrTo=Vb;function Kb(){return(this.t>0?this.data[0]&1:this.s)==0}function zb(t,e){if(t>4294967295||t<1)return _.ONE;var r=ee(),n=ee(),i=e.convert(this),s=qs(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function Gb(t,e){var r;return t<256||e.isEven()?r=new Hr(e):r=new Wr(e),this.exp(t,r)}_.prototype.copyTo=pb;_.prototype.fromInt=db;_.prototype.fromString=gb;_.prototype.clamp=yb;_.prototype.dlShiftTo=Eb;_.prototype.drShiftTo=Sb;_.prototype.lShiftTo=_b;_.prototype.rShiftTo=Ib;_.prototype.subTo=Ab;_.prototype.multiplyTo=Cb;_.prototype.squareTo=Tb;_.prototype.divRemTo=Bb;_.prototype.invDigit=kb;_.prototype.isEven=Kb;_.prototype.exp=zb;_.prototype.toString=mb;_.prototype.negate=bb;_.prototype.abs=vb;_.prototype.compareTo=wb;_.prototype.bitLength=xb;_.prototype.mod=Rb;_.prototype.modPowInt=Gb;_.ZERO=Sr(0);_.ONE=Sr(1);function Hb(){var t=ee();return this.copyTo(t),t}function Wb(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function jb(){return this.t==0?this.s:this.data[0]<<24>>24}function $b(){return this.t==0?this.s:this.data[0]<<16>>16}function Yb(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Zb(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Xb(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Sr(r),i=ee(),s=ee(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function Qb(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var f=Bh(t,a);if(f<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&_.ZERO.subTo(this,this)}function Jb(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(_.ONE.shiftLeft(t-1),Wa,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(_.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ev(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function tv(t){return this.compareTo(t)==0}function rv(t){return this.compareTo(t)<0?this:t}function nv(t){return this.compareTo(t)>0?this:t}function iv(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function sv(t,e){return t&e}function ov(t){var e=ee();return this.bitwiseTo(t,sv,e),e}function Wa(t,e){return t|e}function av(t){var e=ee();return this.bitwiseTo(t,Wa,e),e}function Rh(t,e){return t^e}function cv(t){var e=ee();return this.bitwiseTo(t,Rh,e),e}function Dh(t,e){return t&~e}function uv(t){var e=ee();return this.bitwiseTo(t,Dh,e),e}function fv(){for(var t=ee(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function hv(t){var e=ee();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function lv(t){var e=ee();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function pv(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function dv(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+pv(this.data[t]);return this.s<0?this.t*this.DB:-1}function gv(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function yv(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=gv(this.data[r]^e);return t}function mv(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function bv(t,e){var r=_.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function vv(t){return this.changeBit(t,Wa)}function wv(t){return this.changeBit(t,Dh)}function xv(t){return this.changeBit(t,Rh)}function Ev(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Sv(t){var e=ee();return this.addTo(t,e),e}function _v(t){var e=ee();return this.subTo(t,e),e}function Iv(t){var e=ee();return this.multiplyTo(t,e),e}function Av(t){var e=ee();return this.divRemTo(t,e,null),e}function Cv(t){var e=ee();return this.divRemTo(t,null,e),e}function Tv(t){var e=ee(),r=ee();return this.divRemTo(t,e,r),new Array(e,r)}function Bv(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Rv(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Pi(){}function Ph(t){return t}function Dv(t,e,r){t.multiplyTo(e,r)}function Pv(t,e){t.squareTo(e)}Pi.prototype.convert=Ph;Pi.prototype.revert=Ph;Pi.prototype.mulTo=Dv;Pi.prototype.sqrTo=Pv;function Lv(t){return this.exp(t,new Pi)}function Mv(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Nv(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Mn(t){this.r2=ee(),this.q3=ee(),_.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function kv(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ee();return t.copyTo(e),this.reduce(e),e}function Ov(t){return t}function Uv(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Fv(t,e){t.squareTo(e),this.reduce(e)}function Vv(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Mn.prototype.convert=kv;Mn.prototype.revert=Ov;Mn.prototype.reduce=Uv;Mn.prototype.mulTo=Vv;Mn.prototype.sqrTo=Fv;function qv(t,e){var r=t.bitLength(),n,i=Sr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Hr(e):e.isEven()?s=new Mn(e):s=new Wr(e);var o=new Array,a=3,f=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var c=ee();for(s.sqrTo(o[1],c);a<=u;)o[a]=ee(),s.mulTo(c,o[a-2],o[a]),a+=2}var h=t.t-1,l,d=!0,p=ee(),g;for(r=qs(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&u:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),a=n;(l&1)==0;)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;a>1;)s.sqrTo(i,p),s.sqrTo(p,i),a-=2;a>0?s.sqrTo(i,p):(g=i,i=p,p=g),s.mulTo(p,o[l],i)}for(;h>=0&&(t.data[h]&1<<r)==0;)s.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function Kv(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function zv(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Gv(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return _.ZERO;for(var r=t.clone(),n=this.clone(),i=Sr(1),s=Sr(0),o=Sr(0),a=Sr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(_.ONE)!=0)return _.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Bt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Hv=(1<<26)/Bt[Bt.length-1];function Wv(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Bt[Bt.length-1]){for(e=0;e<Bt.length;++e)if(r.data[0]==Bt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Bt.length;){for(var n=Bt[e],i=e+1;i<Bt.length&&n<Hv;)n*=Bt[i++];for(n=r.modInt(n);e<i;)if(n%Bt[e++]==0)return!1}return r.millerRabin(t)}function jv(t){var e=this.subtract(_.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=$v(),s,o=0;o<t;++o){do s=new _(this.bitLength(),i);while(s.compareTo(_.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(_.ONE)!=0&&a.compareTo(e)!=0){for(var f=1;f++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(_.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function $v(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}_.prototype.chunkSize=Yb;_.prototype.toRadix=Xb;_.prototype.fromRadix=Qb;_.prototype.fromNumber=Jb;_.prototype.bitwiseTo=iv;_.prototype.changeBit=bv;_.prototype.addTo=Ev;_.prototype.dMultiply=Bv;_.prototype.dAddOffset=Rv;_.prototype.multiplyLowerTo=Mv;_.prototype.multiplyUpperTo=Nv;_.prototype.modInt=zv;_.prototype.millerRabin=jv;_.prototype.clone=Hb;_.prototype.intValue=Wb;_.prototype.byteValue=jb;_.prototype.shortValue=$b;_.prototype.signum=Zb;_.prototype.toByteArray=ev;_.prototype.equals=tv;_.prototype.min=rv;_.prototype.max=nv;_.prototype.and=ov;_.prototype.or=av;_.prototype.xor=cv;_.prototype.andNot=uv;_.prototype.not=fv;_.prototype.shiftLeft=hv;_.prototype.shiftRight=lv;_.prototype.getLowestSetBit=dv;_.prototype.bitCount=yv;_.prototype.testBit=mv;_.prototype.setBit=vv;_.prototype.clearBit=wv;_.prototype.flipBit=xv;_.prototype.add=Sv;_.prototype.subtract=_v;_.prototype.multiply=Iv;_.prototype.divide=Av;_.prototype.remainder=Cv;_.prototype.divideAndRemainder=Tv;_.prototype.modPow=qv;_.prototype.modInverse=Gv;_.prototype.pow=Lv;_.prototype.gcd=Kv;_.prototype.isProbablePrime=Wv});var Uh=B((v3,Oh)=>{var qt=fe();Gr();Me();var Nh=Oh.exports=qt.sha1=qt.sha1||{};qt.md.sha1=qt.md.algorithms.sha1=Nh;Nh.create=function(){kh||Yv();var t=null,e=qt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=qt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=qt.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Mh(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=qt.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(ja.substr(0,n.blockLength-o));for(var a,f,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)a=n.fullMessageLength[c+1]*8,f=a/4294967296>>>0,u+=f,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Mh(h,r,i);var l=qt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ja=null,kh=!1;function Yv(){ja=String.fromCharCode(128),ja+=qt.util.fillString(String.fromCharCode(0),64),kh=!0}function Mh(t,e,r){for(var n,i,s,o,a,f,u,c,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,f=t.h4,c=0;c<16;++c)n=r.getInt32(),e[c]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+f+1518500249+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<20;++c)n=e[c-3]^e[c-8]^e[c-14]^e[c-16],n=n<<1|n>>>31,e[c]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+f+1518500249+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<32;++c)n=e[c-3]^e[c-8]^e[c-14]^e[c-16],n=n<<1|n>>>31,e[c]=n,u=s^o^a,n=(i<<5|i>>>27)+u+f+1859775393+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<40;++c)n=e[c-6]^e[c-16]^e[c-28]^e[c-32],n=n<<2|n>>>30,e[c]=n,u=s^o^a,n=(i<<5|i>>>27)+u+f+1859775393+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<60;++c)n=e[c-6]^e[c-16]^e[c-28]^e[c-32],n=n<<2|n>>>30,e[c]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+f+2400959708+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<80;++c)n=e[c-6]^e[c-16]^e[c-28]^e[c-32],n=n<<2|n>>>30,e[c]=n,u=s^o^a,n=(i<<5|i>>>27)+u+f+3395469782+n,f=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+f|0,h-=64}}});var qh=B((w3,Vh)=>{var Kt=fe();Me();Di();Uh();var Fh=Vh.exports=Kt.pkcs1=Kt.pkcs1||{};Fh.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Kt.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),f=a-2*s.digestLength-2;if(e.length>f){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=f,u}n||(n=""),s.update(n,"raw");for(var c=s.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=c.getBytes()+h+""+e;if(!i)i=Kt.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var g=zs(i,a-s.digestLength-1,o),m=Kt.util.xorBytes(p,g,p.length),v=zs(m,s.digestLength,o),S=Kt.util.xorBytes(i,v,i.length);return"\0"+S+m};Fh.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var m=new Error("RSAES-OAEP encoded message length is invalid.");throw m.length=e.length,m.expectedLength=o,m}if(i===void 0?i=Kt.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),f=e.charAt(0),u=e.substring(1,i.digestLength+1),c=e.substring(1+i.digestLength),h=zs(c,i.digestLength,s),l=Kt.util.xorBytes(u,h,u.length),d=zs(l,o-i.digestLength-1,s),p=Kt.util.xorBytes(c,d,c.length),g=p.substring(0,i.digestLength),m=f!=="\0",v=0;v<i.digestLength;++v)m|=a.charAt(v)!==g.charAt(v);for(var S=1,C=i.digestLength,D=i.digestLength;D<p.length;D++){var w=p.charCodeAt(D),A=w&1^1,L=S?65534:0;m|=w&L,S=S&A,C+=S}if(m||p.charCodeAt(C)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(C+1)};function zs(t,e,r){r||(r=Kt.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var Kh=B((x3,$a)=>{var _r=fe();Me();Ks();Di();(function(){if(_r.prime){$a.exports=_r.prime;return}var t=$a.exports=_r.prime=_r.prime||{},e=_r.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||_r.random,m={nextBytes:function(v){for(var S=g.getBytesSync(v.length),C=0;C<v.length;++C)v[C]=S.charCodeAt(C)}};if(p.name==="PRIMEINC")return s(h,m,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var g=u(h,l),m=0,v=c(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var S=10;"maxBlockTime"in d&&(S=d.maxBlockTime),a(g,h,l,m,v,S,p)}function a(h,l,d,p,g,m,v){var S=+new Date;do{if(h.bitLength()>l&&(h=u(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(m<0||+new Date-S<m);_r.util.setImmediate(function(){a(h,l,d,p,g,m,v)})}function f(h,l,d,p){if(typeof Worker>"u")return o(h,l,d,p);var g=u(h,l),m=d.workers,v=d.workLoad||100,S=v*30/8,C=d.workerScript||"forge/prime.worker.js";if(m===-1)return _r.util.estimateCores(function(w,A){w&&(A=2),m=A-1,D()});D();function D(){m=Math.max(1,m);for(var w=[],A=0;A<m;++A)w[A]=new Worker(C);for(var L=m,A=0;A<m;++A)w[A].addEventListener("message",G);var O=!1;function G(_e){if(!O){--L;var Ke=_e.data;if(Ke.found){for(var Xe=0;Xe<w.length;++Xe)w[Xe].terminate();return O=!0,p(null,new e(Ke.prime,16))}g.bitLength()>h&&(g=u(h,l));var wn=g.toString(16);_e.target.postMessage({hex:wn,workLoad:v}),g.dAddOffset(S,0)}}}}function u(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function c(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Hs=B((E3,Yh)=>{var k=fe();Ri();Ks();Bs();qh();Kh();Di();Me();typeof X>"u"&&(X=k.jsbn.BigInteger);var X,Ya=k.util.isNodejs?Pn():null,b=k.asn1,bt=k.util;k.pki=k.pki||{};Yh.exports=k.pki.rsa=k.rsa=k.rsa||{};var q=k.pki,Zv=[6,4,2,4,2,4,6,2],Xv={name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Qv={name:"RSAPrivateKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Jv={name:"RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ew=k.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},tw={name:"DigestInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},rw=function(t){var e;if(t.algorithm in q.oids)e=q.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=b.oidToDer(e).getBytes(),i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),s=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);s.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,n)),s.value.push(b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,""));var o=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),b.toDer(i).getBytes()},jh=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(X.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(X.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new X(k.util.bytesToHex(k.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(X.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};q.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=$h(t,e,r)):(i=k.util.createBuffer(),i.putBytes(t));for(var o=new X(i.toHex(),16),a=jh(o,e,n),f=a.toString(16),u=k.util.createBuffer(),c=s-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(k.util.hexToBytes(f)),u.getBytes()};q.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new X(k.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=jh(o,e,r),f=a.toString(16),u=k.util.createBuffer(),c=i-Math.ceil(f.length/2);c>0;)u.putByte(0),--c;return u.putBytes(k.util.hexToBytes(f)),n!==!1?Gs(u.getBytes(),e,r):u.getBytes()};q.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||k.random,i={nextBytes:function(a){for(var f=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=f.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new X(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};q.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new X(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,u=f-1;t.pqState===0?(t.num=new X(f,t.rng),t.num.testBit(u)||t.num.bitwiseTo(X.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(iw(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Zv[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(X.ONE).gcd(t.e).compareTo(X.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(X.ONE),t.q1=t.q.subtract(X.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(X.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var c=t.e.modInverse(t.phi);t.keys={privateKey:q.rsa.setPrivateKey(t.n,t.e,c,t.p,t.q,c.mod(t.p1),c.mod(t.q1),t.q.modInverse(t.p)),publicKey:q.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};q.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!k.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(zh("generateKeyPair"))return Ya.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,f,u){if(a)return n(a);n(null,{privateKey:q.privateKeyFromPem(u),publicKey:q.publicKeyFromPem(f)})});if(Gh("generateKey")&&Gh("exportKey"))return bt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Wh(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return bt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var f=q.privateKeyFromAsn1(b.fromDer(k.util.createBuffer(a)));n(null,{privateKey:f,publicKey:q.setRsaPublicKey(f.n,f.e)})}});if(Hh("generateKey")&&Hh("exportKey")){var i=bt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Wh(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var f=a.target.result,u=bt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);u.oncomplete=function(c){var h=c.target.result,l=q.privateKeyFromAsn1(b.fromDer(k.util.createBuffer(h)));n(null,{privateKey:l,publicKey:q.setRsaPublicKey(l.n,l.e)})},u.onerror=function(c){n(c)}},i.onerror=function(a){n(a)};return}}else if(zh("generateKeyPairSync")){var s=Ya.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:q.privateKeyFromPem(s.privateKey),publicKey:q.publicKeyFromPem(s.publicKey)}}}var o=q.rsa.createKeyPairGenerationState(t,e,r);if(!n)return q.rsa.stepKeyPairGenerationState(o,0),o.keys;nw(o,r,n)};q.setRsaPublicKey=q.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,f,u){return $h(a,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,f){return k.pkcs1.encode_rsa_oaep(f,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return q.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(f,u){u=Gs(u,r,!0);var c=b.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!b.validate(c,tw,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=b.derToOid(h.algorithmIdentifier);if(!(p===k.oids.md2||p===k.oids.md5||p===k.oids.sha1||p===k.oids.sha224||p===k.oids.sha256||p===k.oids.sha384||p===k.oids.sha512||p===k.oids["sha512-224"]||p===k.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===k.oids.md2||p===k.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(f,u){return u=Gs(u,r,!0),f===u}});var a=q.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};q.setRsaPrivateKey=q.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var f={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return f.decrypt=function(u,c,h){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var l=q.rsa.decrypt(u,f,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:Gs};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(d,p){return k.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(l,f,!1)},f.sign=function(u,c){var h=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:rw},h=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return u}},h=1);var l=c.encode(u,f.n.bitLength());return q.rsa.encrypt(l,f,h)},f};q.wrapRsaPrivateKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(q.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(t).getBytes())])};q.privateKeyFromAsn1=function(t){var e={},r=[];if(b.validate(t,Xv,e,r)&&(t=b.fromDer(k.util.createBuffer(e.privateKey))),e={},r=[],!b.validate(t,Qv,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,f,u,c,h;return i=k.util.createBuffer(e.privateKeyModulus).toHex(),s=k.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=k.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=k.util.createBuffer(e.privateKeyPrime1).toHex(),f=k.util.createBuffer(e.privateKeyPrime2).toHex(),u=k.util.createBuffer(e.privateKeyExponent1).toHex(),c=k.util.createBuffer(e.privateKeyExponent2).toHex(),h=k.util.createBuffer(e.privateKeyCoefficient).toHex(),q.setRsaPrivateKey(new X(i,16),new X(s,16),new X(o,16),new X(a,16),new X(f,16),new X(u,16),new X(c,16),new X(h,16))};q.privateKeyToAsn1=q.privateKeyToRSAPrivateKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.e)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.d)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.p)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.q)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.dP)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.dQ)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.qInv))])};q.publicKeyFromAsn1=function(t){var e={},r=[];if(b.validate(t,ew,e,r)){var n=b.derToOid(e.publicKeyOid);if(n!==q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!b.validate(t,Jv,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=k.util.createBuffer(e.publicKeyModulus).toHex(),o=k.util.createBuffer(e.publicKeyExponent).toHex();return q.setRsaPublicKey(new X(s,16),new X(o,16))};q.publicKeyToAsn1=q.publicKeyToSubjectPublicKeyInfo=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(q.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,[q.publicKeyToRSAPublicKey(t)])])};q.publicKeyToRSAPublicKey=function(t){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,zt(t.e))])};function $h(t,e,r){var n=k.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var f=0;f<o;++f)n.putByte(a)}else for(;o>0;){for(var u=0,c=k.random.getBytes(o),f=0;f<o;++f)a=c.charCodeAt(f),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function Gs(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=k.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(a===0){f=i-3-n;for(var u=0;u<f;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(a===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var c=s.getByte();if(c!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function nw(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,f){if(a)return r(a);if(t.p=f,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,f){k.prime.generateProbablePrime(a,n,f)}function o(a,f){if(a)return r(a);if(t.q=f,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(X.ONE).gcd(t.e).compareTo(X.ONE)!==0){t.p=null,i();return}if(t.q.subtract(X.ONE).gcd(t.e).compareTo(X.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(X.ONE),t.q1=t.q.subtract(X.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(X.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var c=t.e.modInverse(t.phi);t.keys={privateKey:q.rsa.setPrivateKey(t.n,t.e,c,t.p,t.q,c.mod(t.p1),c.mod(t.q1),t.q.modInverse(t.p)),publicKey:q.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function zt(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=k.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function iw(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function zh(t){return k.util.isNodejs&&typeof Ya[t]=="function"}function Gh(t){return typeof bt.globalScope<"u"&&typeof bt.globalScope.crypto=="object"&&typeof bt.globalScope.crypto.subtle=="object"&&typeof bt.globalScope.crypto.subtle[t]=="function"}function Hh(t){return typeof bt.globalScope<"u"&&typeof bt.globalScope.msCrypto=="object"&&typeof bt.globalScope.msCrypto.subtle=="object"&&typeof bt.globalScope.msCrypto.subtle[t]=="function"}function Wh(t){for(var e=k.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var tl=B((S3,el)=>{var P=fe();Ms();Ri();oh();Gr();Bs();Va();ph();Di();Ih();Hs();Me();typeof Zh>"u"&&(Zh=P.jsbn.BigInteger);var Zh,x=P.asn1,H=P.pki=P.pki||{};el.exports=H.pbe=P.pbe=P.pbe||{};var jr=H.oids,sw={name:"EncryptedPrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},ow={name:"PBES2Algorithms",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},aw={name:"pkcs-12PbeParams",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"iterations"}]};H.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=P.random.getBytesSync(r.saltSize),i=r.count,s=x.integerToDer(i),o,a,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,c,h;switch(r.algorithm){case"aes128":o=16,u=16,c=jr["aes128-CBC"],h=P.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,c=jr["aes192-CBC"],h=P.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,c=jr["aes256-CBC"],h=P.aes.createEncryptionCipher;break;case"des":o=8,u=8,c=jr.desCBC,h=P.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Jh(d),g=P.pkcs5.pbkdf2(e,n,i,o,p),m=P.random.getBytesSync(u),v=h(g);v.start(m),v.update(x.toDer(t)),v.finish(),f=v.output.getBytes();var S=cw(n,s,o,d);a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(jr.pkcs5PBES2).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(jr.pkcs5PBKDF2).getBytes()),S]),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(c).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,m)])])])}else if(r.algorithm==="3des"){o=24;var C=new P.util.ByteBuffer(n),g=H.pbe.generatePkcs12Key(e,C,1,i,o),m=H.pbe.generatePkcs12Key(e,C,2,i,o),v=P.des.createEncryptionCipher(g);v.start(m),v.update(x.toDer(t)),v.finish(),f=v.output.getBytes(),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(jr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,n),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var D=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[a,x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,f)]);return D};H.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!x.validate(t,sw,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=x.derToOid(n.encryptionOid),a=H.pbe.getCipher(o,n.encryptionParams,e),f=P.util.createBuffer(n.encryptedData);return a.update(f),a.finish()&&(r=x.fromDer(a.output)),r};H.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:x.toDer(t).getBytes()};return P.pem.encode(r,{maxline:e})};H.encryptedPrivateKeyFromPem=function(t){var e=P.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return x.fromDer(e.body)};H.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=H.wrapRsaPrivateKey(H.privateKeyToAsn1(t));return n=H.encryptPrivateKeyInfo(n,e,r),H.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=P.random.getBytesSync(16),a=P.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=P.random.getBytesSync(16),a=P.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=P.random.getBytesSync(16),a=P.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=P.random.getBytesSync(8),a=P.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=P.random.getBytesSync(8),a=P.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var u=P.pbe.opensslDeriveBytes(e,s.substr(0,8),o),c=a(u);c.start(s),c.update(x.toDer(H.privateKeyToAsn1(t))),c.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:P.util.bytesToHex(s).toUpperCase()},body:c.output.getBytes()};return P.pem.encode(h)};H.decryptRsaPrivateKey=function(t,e){var r=null,n=P.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=P.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=P.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=P.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=P.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=P.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return P.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return P.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return P.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=P.util.hexToBytes(n.dekInfo.parameters),f=P.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(f);if(u.start(a),u.update(P.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=H.decryptPrivateKeyInfo(x.fromDer(r),e):r=x.fromDer(r),r!==null&&(r=H.privateKeyFromAsn1(r)),r};H.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s>"u"||s===null){if(!("sha1"in P.md))throw new Error('"sha1" hash algorithm unavailable.');s=P.md.sha1.create()}var f=s.digestLength,u=s.blockLength,c=new P.util.ByteBuffer,h=new P.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),d=e.length(),p=new P.util.ByteBuffer;p.fillWithByte(r,u);var g=u*Math.ceil(d/u),m=new P.util.ByteBuffer;for(a=0;a<g;a++)m.putByte(e.at(a%d));var v=u*Math.ceil(l/u),S=new P.util.ByteBuffer;for(a=0;a<v;a++)S.putByte(h.at(a%l));var C=m;C.putBuffer(S);for(var D=Math.ceil(i/f),w=1;w<=D;w++){var A=new P.util.ByteBuffer;A.putBytes(p.bytes()),A.putBytes(C.bytes());for(var L=0;L<n;L++)s.start(),s.update(A.getBytes()),A=s.digest();var O=new P.util.ByteBuffer;for(a=0;a<u;a++)O.putByte(A.at(a%f));var G=Math.ceil(d/u)+Math.ceil(l/u),_e=new P.util.ByteBuffer;for(o=0;o<G;o++){var Ke=new P.util.ByteBuffer(C.getBytes(u)),Xe=511;for(a=O.length()-1;a>=0;a--)Xe=Xe>>8,Xe+=O.at(a)+Ke.at(a),Ke.setAt(a,Xe&255);_e.putBuffer(Ke)}C=_e,c.putBuffer(A)}return c.truncate(c.length()-i),c};H.pbe.getCipher=function(t,e,r){switch(t){case H.oids.pkcs5PBES2:return H.pbe.getCipherForPBES2(t,e,r);case H.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case H.oids["pbewithSHAAnd40BitRC2-CBC"]:return H.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};H.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!x.validate(e,ow,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=x.derToOid(n.kdfOid),t!==H.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=x.derToOid(n.encOid),t!==H.oids["aes128-CBC"]&&t!==H.oids["aes192-CBC"]&&t!==H.oids["aes256-CBC"]&&t!==H.oids["des-EDE3-CBC"]&&t!==H.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=P.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var f,u;switch(H.oids[t]){case"aes128-CBC":f=16,u=P.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,u=P.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,u=P.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,u=P.des.createDecryptionCipher;break;case"desCBC":f=8,u=P.des.createDecryptionCipher;break}var c=Qh(n.prfOid),h=P.pkcs5.pbkdf2(r,o,a,f,c),l=n.encIv,d=u(h);return d.start(l),d};H.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!x.validate(e,aw,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=P.util.createBuffer(n.salt),a=P.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var f,u,c;switch(t){case H.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,u=8,c=P.des.startDecrypting;break;case H.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,u=8,c=function(g,m){var v=P.rc2.createDecryptionCipher(g,40);return v.start(m,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=Qh(n.prfOid),l=H.pbe.generatePkcs12Key(r,o,1,a,f,h);h.start();var d=H.pbe.generatePkcs12Key(r,o,2,a,u,h);return c(l,d)};H.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in P.md))throw new Error('"md5" hash algorithm unavailable.');n=P.md.md5.create()}e===null&&(e="");for(var i=[Xh(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(Xh(n,i[o-1]+t+e));return i.join("").substr(0,r)};function Xh(t,e){return t.start().update(e).digest().getBytes()}function Qh(t){var e;if(!t)e="hmacWithSHA1";else if(e=H.oids[x.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Jh(e)}function Jh(t){var e=P.md;switch(t){case"hmacWithSHA224":e=P.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function cw(t,e,r,n){var i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,P.util.hexToBytes(r.toString(16))),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(H.oids[n]).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")])),i}});var fl=B((eC,ul)=>{var xe=fe();Gr();Me();var Li=ul.exports=xe.sha512=xe.sha512||{};xe.md.sha512=xe.md.algorithms.sha512=Li;var al=xe.sha384=xe.sha512.sha384=xe.sha512.sha384||{};al.create=function(){return Li.create("SHA-384")};xe.md.sha384=xe.md.algorithms.sha384=al;xe.sha512.sha256=xe.sha512.sha256||{create:function(){return Li.create("SHA-512/256")}};xe.md["sha512/256"]=xe.md.algorithms["sha512/256"]=xe.sha512.sha256;xe.sha512.sha224=xe.sha512.sha224||{create:function(){return Li.create("SHA-512/224")}};xe.md["sha512/224"]=xe.md.algorithms["sha512/224"]=xe.sha512.sha224;Li.create=function(t){if(cl||pw(),typeof t>"u"&&(t="SHA-512"),!(t in $r))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=$r[t],r=null,n=xe.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var f=a.messageLengthSize/4,u=0;u<f;++u)a.fullMessageLength.push(0);n=xe.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(f,u){u==="utf8"&&(f=xe.util.encodeUtf8(f));var c=f.length;a.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=c[1],c[1]=c[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(f),ol(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var f=xe.util.createBuffer();f.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,c=u&a.blockLength-1;f.putBytes(Xa.substr(0,a.blockLength-c));for(var h,l,d=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);ol(g,i,f);var m=xe.util.createBuffer(),v;t==="SHA-512"?v=g.length:t==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)m.putInt32(g[p][0]),(p!==v-1||t!=="SHA-512/224")&&m.putInt32(g[p][1]);return m},a};var Xa=null,cl=!1,Qa=null,$r=null;function pw(){Xa=String.fromCharCode(128),Xa+=xe.util.fillString(String.fromCharCode(0),128),Qa=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],$r={},$r["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],$r["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],$r["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],$r["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],cl=!0}function ol(t,e,r){for(var n,i,s,o,a,f,u,c,h,l,d,p,g,m,v,S,C,D,w,A,L,O,G,_e,Ke,Xe,wn,ds,Oe,nt,U,ta,ra,na,ia,Wu=r.length();Wu>=128;){for(Oe=0;Oe<16;++Oe)e[Oe][0]=r.getInt32()>>>0,e[Oe][1]=r.getInt32()>>>0;for(;Oe<80;++Oe)ta=e[Oe-2],nt=ta[0],U=ta[1],n=((nt>>>19|U<<13)^(U>>>29|nt<<3)^nt>>>6)>>>0,i=((nt<<13|U>>>19)^(U<<3|nt>>>29)^(nt<<26|U>>>6))>>>0,na=e[Oe-15],nt=na[0],U=na[1],s=((nt>>>1|U<<31)^(nt>>>8|U<<24)^nt>>>7)>>>0,o=((nt<<31|U>>>1)^(nt<<24|U>>>8)^(nt<<25|U>>>7))>>>0,ra=e[Oe-7],ia=e[Oe-16],U=i+ra[1]+o+ia[1],e[Oe][0]=n+ra[0]+s+ia[0]+(U/4294967296>>>0)>>>0,e[Oe][1]=U>>>0;for(g=t[0][0],m=t[0][1],v=t[1][0],S=t[1][1],C=t[2][0],D=t[2][1],w=t[3][0],A=t[3][1],L=t[4][0],O=t[4][1],G=t[5][0],_e=t[5][1],Ke=t[6][0],Xe=t[6][1],wn=t[7][0],ds=t[7][1],Oe=0;Oe<80;++Oe)u=((L>>>14|O<<18)^(L>>>18|O<<14)^(O>>>9|L<<23))>>>0,c=((L<<18|O>>>14)^(L<<14|O>>>18)^(O<<23|L>>>9))>>>0,h=(Ke^L&(G^Ke))>>>0,l=(Xe^O&(_e^Xe))>>>0,a=((g>>>28|m<<4)^(m>>>2|g<<30)^(m>>>7|g<<25))>>>0,f=((g<<4|m>>>28)^(m<<30|g>>>2)^(m<<25|g>>>7))>>>0,d=(g&v|C&(g^v))>>>0,p=(m&S|D&(m^S))>>>0,U=ds+c+l+Qa[Oe][1]+e[Oe][1],n=wn+u+h+Qa[Oe][0]+e[Oe][0]+(U/4294967296>>>0)>>>0,i=U>>>0,U=f+p,s=a+d+(U/4294967296>>>0)>>>0,o=U>>>0,wn=Ke,ds=Xe,Ke=G,Xe=_e,G=L,_e=O,U=A+i,L=w+n+(U/4294967296>>>0)>>>0,O=U>>>0,w=C,A=D,C=v,D=S,v=g,S=m,U=i+o,g=n+s+(U/4294967296>>>0)>>>0,m=U>>>0;U=t[0][1]+m,t[0][0]=t[0][0]+g+(U/4294967296>>>0)>>>0,t[0][1]=U>>>0,U=t[1][1]+S,t[1][0]=t[1][0]+v+(U/4294967296>>>0)>>>0,t[1][1]=U>>>0,U=t[2][1]+D,t[2][0]=t[2][0]+C+(U/4294967296>>>0)>>>0,t[2][1]=U>>>0,U=t[3][1]+A,t[3][0]=t[3][0]+w+(U/4294967296>>>0)>>>0,t[3][1]=U>>>0,U=t[4][1]+O,t[4][0]=t[4][0]+L+(U/4294967296>>>0)>>>0,t[4][1]=U>>>0,U=t[5][1]+_e,t[5][0]=t[5][0]+G+(U/4294967296>>>0)>>>0,t[5][1]=U>>>0,U=t[6][1]+Xe,t[6][0]=t[6][0]+Ke+(U/4294967296>>>0)>>>0,t[6][1]=U>>>0,U=t[7][1]+ds,t[7][0]=t[7][0]+wn+(U/4294967296>>>0)>>>0,t[7][1]=U>>>0,Wu-=128}}});var Ja=B((tC,hl)=>{"use strict";function dw(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>65536)for(;r<t;)r+65536>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+65536)),r+=65536);else crypto.getRandomValues(e);return e}hl.exports=dw});var f0=B((zC,u0)=>{u0.exports=Ec;var c0=128,s2=127,o2=~s2,a2=Math.pow(2,31);function Ec(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Ec.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=a2;)e[r++]=t&255|c0,t/=128;for(;t&o2;)e[r++]=t&255|c0,t>>>=7;return e[r]=t|0,Ec.bytes=r-n+1,e}});var p0=B((GC,l0)=>{l0.exports=Sc;var c2=128,h0=127;function Sc(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a||i>49)throw Sc.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&h0)<<i:(o&h0)*Math.pow(2,i),i+=7}while(o>=c2);return Sc.bytes=s-n,r}});var g0=B((HC,d0)=>{var u2=Math.pow(2,7),f2=Math.pow(2,14),h2=Math.pow(2,21),l2=Math.pow(2,28),p2=Math.pow(2,35),d2=Math.pow(2,42),g2=Math.pow(2,49),y2=Math.pow(2,56),m2=Math.pow(2,63);d0.exports=function(t){return t<u2?1:t<f2?2:t<h2?3:t<l2?4:t<p2?5:t<d2?6:t<g2?7:t<y2?8:t<m2?9:10}});var rn=B((WC,y0)=>{y0.exports={encode:f0(),decode:p0(),encodingLength:g0()}});var ap=B((kR,op)=>{var Xn=1e3,Qn=Xn*60,Jn=Qn*60,sn=Jn*24,Yx=sn*7,Zx=sn*365.25;op.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Xx(t);if(r==="number"&&isFinite(t))return e.long?Jx(t):Qx(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Xx(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Zx;case"weeks":case"week":case"w":return r*Yx;case"days":case"day":case"d":return r*sn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Jn;case"minutes":case"minute":case"mins":case"min":case"m":return r*Qn;case"seconds":case"second":case"secs":case"sec":case"s":return r*Xn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Qx(t){var e=Math.abs(t);return e>=sn?Math.round(t/sn)+"d":e>=Jn?Math.round(t/Jn)+"h":e>=Qn?Math.round(t/Qn)+"m":e>=Xn?Math.round(t/Xn)+"s":t+"ms"}function Jx(t){var e=Math.abs(t);return e>=sn?go(t,e,sn,"day"):e>=Jn?go(t,e,Jn,"hour"):e>=Qn?go(t,e,Qn,"minute"):e>=Xn?go(t,e,Xn,"second"):t+" ms"}function go(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var up=B((OR,cp)=>{function eE(t){r.debug=r,r.default=r,r.coerce=f,r.disable=s,r.enable=i,r.enabled=o,r.humanize=ap(),r.destroy=u,Object.keys(t).forEach(c=>{r[c]=t[c]}),r.names=[],r.skips=[],r.formatters={};function e(c){let h=0;for(let l=0;l<c.length;l++)h=(h<<5)-h+c.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(c){let h,l=null,d,p;function g(...m){if(!g.enabled)return;let v=g,S=Number(new Date),C=S-(h||S);v.diff=C,v.prev=h,v.curr=S,h=S,m[0]=r.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let D=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(A,L)=>{if(A==="%%")return"%";D++;let O=r.formatters[L];if(typeof O=="function"){let G=m[D];A=O.call(v,G),m.splice(D,1),D--}return A}),r.formatArgs.call(v,m),(v.log||r.log).apply(v,m)}return g.namespace=c,g.useColors=r.useColors(),g.color=r.selectColor(c),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(c)),p),set:m=>{l=m}}),typeof r.init=="function"&&r.init(g),g}function n(c,h){let l=r(this.namespace+(typeof h>"u"?":":h)+c);return l.log=this.log,l}function i(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let h,l=(typeof c=="string"?c:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)!l[h]||(c=l[h].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function s(){let c=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(c))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function f(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}cp.exports=eE});var fp=B((gt,yo)=>{gt.formatArgs=rE;gt.save=nE;gt.load=iE;gt.useColors=tE;gt.storage=sE();gt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();gt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function tE(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function rE(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+yo.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}gt.log=console.debug||console.log||(()=>{});function nE(t){try{t?gt.storage.setItem("debug",t):gt.storage.removeItem("debug")}catch{}}function iE(){let t;try{t=gt.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function sE(){try{return localStorage}catch{}}yo.exports=up()(gt);var{formatters:oE}=yo.exports;oE.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var dp=B((jR,pp)=>{"use strict";pp.exports=aE;function aE(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,f){r[n]=function(c){if(s)if(s=!1,c)f(c);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,f(u))}})}});var bp=B(mp=>{"use strict";var wo=mp;wo.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var ei=new Array(64),yp=new Array(123);for(Lt=0;Lt<64;)yp[ei[Lt]=Lt<26?Lt+65:Lt<52?Lt+71:Lt<62?Lt-4:Lt-59|43]=Lt++;var Lt;wo.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,f;r<n;){var u=e[r++];switch(a){case 0:s[o++]=ei[u>>2],f=(u&3)<<4,a=1;break;case 1:s[o++]=ei[f|u>>4],f=(u&15)<<2,a=2;break;case 2:s[o++]=ei[f|u>>6],s[o++]=ei[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=ei[f],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var gp="invalid encoding";wo.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var f=e.charCodeAt(a++);if(f===61&&s>1)break;if((f=yp[f])===void 0)throw Error(gp);switch(s){case 0:o=f,s=1;break;case 1:r[n++]=o<<2|(f&48)>>4,o=f,s=2;break;case 2:r[n++]=(o&15)<<4|(f&60)>>2,o=f,s=3;break;case 3:r[n++]=(o&3)<<6|f,s=0;break}}if(s===1)throw Error(gp);return n-i};wo.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var wp=B((YR,vp)=>{"use strict";vp.exports=xo;function xo(){this._listeners={}}xo.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};xo.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};xo.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Cp=B((ZR,Ap)=>{"use strict";Ap.exports=xp(xp);function xp(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,u,c){e[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3]}function s(f,u,c){e[0]=f,u[c]=r[3],u[c+1]=r[2],u[c+2]=r[1],u[c+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],e[0]}function a(f,u){return r[3]=f[u],r[2]=f[u+1],r[1]=f[u+2],r[0]=f[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var f=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((a<<31|f+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,Ep),t.writeFloatBE=e.bind(null,Sp);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,f=o>>>23&255,u=o&8388607;return f===255?u?NaN:a*(1/0):f===0?a*1401298464324817e-60*u:a*Math.pow(2,f-150)*(u+8388608)}t.readFloatLE=r.bind(null,_p),t.readFloatBE=r.bind(null,Ip)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,u,c){e[0]=f,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3],u[c+4]=r[4],u[c+5]=r[5],u[c+6]=r[6],u[c+7]=r[7]}function s(f,u,c){e[0]=f,u[c]=r[7],u[c+1]=r[6],u[c+2]=r[5],u[c+3]=r[4],u[c+4]=r[3],u[c+5]=r[2],u[c+6]=r[1],u[c+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],r[4]=f[u+4],r[5]=f[u+5],r[6]=f[u+6],r[7]=f[u+7],e[0]}function a(f,u){return r[7]=f[u],r[6]=f[u+1],r[5]=f[u+2],r[4]=f[u+3],r[3]=f[u+4],r[2]=f[u+5],r[1]=f[u+6],r[0]=f[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,f){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,f+i),n(1/o>0?0:2147483648,a,f+s);else if(isNaN(o))n(0,a,f+i),n(2146959360,a,f+s);else if(o>17976931348623157e292)n(0,a,f+i),n((u<<31|2146435072)>>>0,a,f+s);else{var c;if(o<22250738585072014e-324)c=o/5e-324,n(c>>>0,a,f+i),n((u<<31|c/4294967296)>>>0,a,f+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),c=o*Math.pow(2,-h),n(c*4503599627370496>>>0,a,f+i),n((u<<31|h+1023<<20|c*1048576&1048575)>>>0,a,f+s)}}}t.writeDoubleLE=e.bind(null,Ep,0,4),t.writeDoubleBE=e.bind(null,Sp,4,0);function r(n,i,s,o,a){var f=n(o,a+i),u=n(o,a+s),c=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+f;return h===2047?l?NaN:c*(1/0):h===0?c*5e-324*l:c*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,_p,0,4),t.readDoubleBE=r.bind(null,Ip,4,0)}(),t}function Ep(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Sp(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function _p(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Ip(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Tp=B((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Rp=B(Bp=>{"use strict";var Fc=Bp;Fc.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Fc.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,f;r<n;)f=e[r++],f<128?o[a++]=f:f>191&&f<224?o[a++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(f>>10),o[a++]=56320+(f&1023)):o[a++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Fc.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var Pp=B((QR,Dp)=>{"use strict";Dp.exports=cE;function cE(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(f){if(f<1||f>i)return t(f);o+f>n&&(s=t(n),o=0);var u=e.call(s,o,o+=f);return o&7&&(o=(o|7)+1),u}}});var Mp=B((JR,Lp)=>{"use strict";Lp.exports=je;var Qi=Lr();function je(t,e){this.lo=t>>>0,this.hi=e>>>0}var cn=je.zero=new je(0,0);cn.toNumber=function(){return 0};cn.zzEncode=cn.zzDecode=function(){return this};cn.length=function(){return 1};var uE=je.zeroHash="\0\0\0\0\0\0\0\0";je.fromNumber=function(e){if(e===0)return cn;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new je(n,i)};je.from=function(e){if(typeof e=="number")return je.fromNumber(e);if(Qi.isString(e))if(Qi.Long)e=Qi.Long.fromString(e);else return je.fromNumber(parseInt(e,10));return e.low||e.high?new je(e.low>>>0,e.high>>>0):cn};je.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};je.prototype.toLong=function(e){return Qi.Long?new Qi.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Pr=String.prototype.charCodeAt;je.fromHash=function(e){return e===uE?cn:new je((Pr.call(e,0)|Pr.call(e,1)<<8|Pr.call(e,2)<<16|Pr.call(e,3)<<24)>>>0,(Pr.call(e,4)|Pr.call(e,5)<<8|Pr.call(e,6)<<16|Pr.call(e,7)<<24)>>>0)};je.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};je.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};je.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};je.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Lr=B(Vc=>{"use strict";var N=Vc;N.asPromise=dp();N.base64=bp();N.EventEmitter=wp();N.float=Cp();N.inquire=Tp();N.utf8=Rp();N.pool=Pp();N.LongBits=Mp();N.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);N.global=N.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Vc;N.emptyArray=Object.freeze?Object.freeze([]):[];N.emptyObject=Object.freeze?Object.freeze({}):{};N.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};N.isString=function(e){return typeof e=="string"||e instanceof String};N.isObject=function(e){return e&&typeof e=="object"};N.isset=N.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};N.Buffer=function(){try{var t=N.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();N._Buffer_from=null;N._Buffer_allocUnsafe=null;N.newBuffer=function(e){return typeof e=="number"?N.Buffer?N._Buffer_allocUnsafe(e):new N.Array(e):N.Buffer?N._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};N.Array=typeof Uint8Array<"u"?Uint8Array:Array;N.Long=N.global.dcodeIO&&N.global.dcodeIO.Long||N.global.Long||N.inquire("long");N.key2Re=/^true|false|0|1$/;N.key32Re=/^-?(?:0|[1-9][0-9]*)$/;N.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;N.longToHash=function(e){return e?N.LongBits.from(e).toHash():N.LongBits.zeroHash};N.longFromHash=function(e,r){var n=N.LongBits.fromHash(e);return N.Long?N.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Np(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}N.merge=Np;N.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function kp(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Np(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}N.newError=kp;N.ProtocolError=kp("ProtocolError");N.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};N.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};N.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};N._configure=function(){var t=N.Buffer;if(!t){N._Buffer_from=N._Buffer_allocUnsafe=null;return}N._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},N._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var jc=B((t6,Vp)=>{"use strict";Vp.exports=re;var xt=Lr(),qc,Eo=xt.LongBits,Op=xt.base64,Up=xt.utf8;function Ji(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function zc(){}function fE(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function re(){this.len=0,this.head=new Ji(zc,0,0),this.tail=this.head,this.states=null}var Fp=function(){return xt.Buffer?function(){return(re.create=function(){return new qc})()}:function(){return new re}};re.create=Fp();re.alloc=function(e){return new xt.Array(e)};xt.Array!==Array&&(re.alloc=xt.pool(re.alloc,xt.Array.prototype.subarray));re.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Ji(e,r,n),this.len+=r,this};function Gc(t,e,r){e[r]=t&255}function hE(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Hc(t,e){this.len=t,this.next=void 0,this.val=e}Hc.prototype=Object.create(Ji.prototype);Hc.prototype.fn=hE;re.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Hc((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};re.prototype.int32=function(e){return e<0?this._push(Wc,10,Eo.fromNumber(e)):this.uint32(e)};re.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Wc(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}re.prototype.uint64=function(e){var r=Eo.from(e);return this._push(Wc,r.length(),r)};re.prototype.int64=re.prototype.uint64;re.prototype.sint64=function(e){var r=Eo.from(e).zzEncode();return this._push(Wc,r.length(),r)};re.prototype.bool=function(e){return this._push(Gc,1,e?1:0)};function Kc(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}re.prototype.fixed32=function(e){return this._push(Kc,4,e>>>0)};re.prototype.sfixed32=re.prototype.fixed32;re.prototype.fixed64=function(e){var r=Eo.from(e);return this._push(Kc,4,r.lo)._push(Kc,4,r.hi)};re.prototype.sfixed64=re.prototype.fixed64;re.prototype.float=function(e){return this._push(xt.float.writeFloatLE,4,e)};re.prototype.double=function(e){return this._push(xt.float.writeDoubleLE,8,e)};var lE=xt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};re.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Gc,1,0);if(xt.isString(e)){var n=re.alloc(r=Op.length(e));Op.decode(e,n,0),e=n}return this.uint32(r)._push(lE,r,e)};re.prototype.string=function(e){var r=Up.length(e);return r?this.uint32(r)._push(Up.write,r,e):this._push(Gc,1,0)};re.prototype.fork=function(){return this.states=new fE(this),this.head=this.tail=new Ji(zc,0,0),this.len=0,this};re.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ji(zc,0,0),this.len=0),this};re.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};re.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};re._configure=function(t){qc=t,re.create=Fp(),qc._configure()}});var zp=B((r6,Kp)=>{"use strict";Kp.exports=Zt;var qp=jc();(Zt.prototype=Object.create(qp.prototype)).constructor=Zt;var Mr=Lr();function Zt(){qp.call(this)}Zt._configure=function(){Zt.alloc=Mr._Buffer_allocUnsafe,Zt.writeBytesBuffer=Mr.Buffer&&Mr.Buffer.prototype instanceof Uint8Array&&Mr.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Zt.prototype.bytes=function(e){Mr.isString(e)&&(e=Mr._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Zt.writeBytesBuffer,r,e),this};function pE(t,e,r){t.length<40?Mr.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Zt.prototype.string=function(e){var r=Mr.Buffer.byteLength(e);return this.uint32(r),r&&this._push(pE,r,e),this};Zt._configure()});var Zc=B((n6,$p)=>{"use strict";$p.exports=ke;var Xt=Lr(),Yc,Wp=Xt.LongBits,dE=Xt.utf8;function Mt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ke(t){this.buf=t,this.pos=0,this.len=t.length}var Gp=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ke(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ke(e);throw Error("illegal buffer")},jp=function(){return Xt.Buffer?function(r){return(ke.create=function(i){return Xt.Buffer.isBuffer(i)?new Yc(i):Gp(i)})(r)}:Gp};ke.create=jp();ke.prototype._slice=Xt.Array.prototype.subarray||Xt.Array.prototype.slice;ke.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Mt(this,10);return e}}();ke.prototype.int32=function(){return this.uint32()|0};ke.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function $c(){var t=new Wp(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Mt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Mt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ke.prototype.bool=function(){return this.uint32()!==0};function So(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ke.prototype.fixed32=function(){if(this.pos+4>this.len)throw Mt(this,4);return So(this.buf,this.pos+=4)};ke.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Mt(this,4);return So(this.buf,this.pos+=4)|0};function Hp(){if(this.pos+8>this.len)throw Mt(this,8);return new Wp(So(this.buf,this.pos+=4),So(this.buf,this.pos+=4))}ke.prototype.float=function(){if(this.pos+4>this.len)throw Mt(this,4);var e=Xt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ke.prototype.double=function(){if(this.pos+8>this.len)throw Mt(this,4);var e=Xt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ke.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Mt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};ke.prototype.string=function(){var e=this.bytes();return dE.read(e,0,e.length)};ke.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Mt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Mt(this);while(this.buf[this.pos++]&128);return this};ke.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ke._configure=function(t){Yc=t,ke.create=jp(),Yc._configure();var e=Xt.Long?"toLong":"toNumber";Xt.merge(ke.prototype,{int64:function(){return $c.call(this)[e](!1)},uint64:function(){return $c.call(this)[e](!0)},sint64:function(){return $c.call(this).zzDecode()[e](!1)},fixed64:function(){return Hp.call(this)[e](!0)},sfixed64:function(){return Hp.call(this)[e](!1)}})}});var Qp=B((i6,Xp)=>{"use strict";Xp.exports=un;var Zp=Zc();(un.prototype=Object.create(Zp.prototype)).constructor=un;var Yp=Lr();function un(t){Zp.call(this,t)}un._configure=function(){Yp.Buffer&&(un.prototype._slice=Yp.Buffer.prototype.slice)};un.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};un._configure()});var ed=B((s6,Jp)=>{"use strict";Jp.exports=es;var Xc=Lr();(es.prototype=Object.create(Xc.EventEmitter.prototype)).constructor=es;function es(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Xc.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}es.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Xc.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(f,u){if(f)return o.emit("error",f,e),s(f);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(c){return o.emit("error",c,e),s(c)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};es.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var rd=B(td=>{"use strict";var gE=td;gE.Service=ed()});var id=B((a6,nd)=>{"use strict";nd.exports={}});var ad=B(od=>{"use strict";var ct=od;ct.build="minimal";ct.Writer=jc();ct.BufferWriter=zp();ct.Reader=Zc();ct.BufferReader=Qp();ct.util=Lr();ct.rpc=rd();ct.roots=id();ct.configure=sd;function sd(){ct.util._configure(),ct.Writer._configure(ct.BufferWriter),ct.Reader._configure(ct.BufferReader)}sd()});var ud=B((u6,cd)=>{"use strict";cd.exports=ad()});var hd=B((fd,ts)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof ju=="function"&&typeof ts=="object"&&ts&&ts.exports&&(ts.exports=e(ud()))})(fd,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,i=t.roots.default||(t.roots.default={});return i.RPC=function(){function s(a){if(this.subscriptions=[],this.messages=[],a)for(var f=Object.keys(a),u=0;u<f.length;++u)a[f[u]]!=null&&(this[f[u]]=a[f[u]])}s.prototype.subscriptions=n.emptyArray,s.prototype.messages=n.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),s.encode=function(f,u){if(u||(u=r.create()),f.subscriptions!=null&&f.subscriptions.length)for(var c=0;c<f.subscriptions.length;++c)i.RPC.SubOpts.encode(f.subscriptions[c],u.uint32(10).fork()).ldelim();if(f.messages!=null&&f.messages.length)for(var c=0;c<f.messages.length;++c)i.RPC.Message.encode(f.messages[c],u.uint32(18).fork()).ldelim();return f.control!=null&&Object.hasOwnProperty.call(f,"control")&&i.RPC.ControlMessage.encode(f.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(f,u){f instanceof e||(f=e.create(f));for(var c=u===void 0?f.len:f.pos+u,h=new i.RPC;f.pos<c;){var l=f.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(i.RPC.SubOpts.decode(f,f.uint32()));break;case 2:h.messages&&h.messages.length||(h.messages=[]),h.messages.push(i.RPC.Message.decode(f,f.uint32()));break;case 3:h.control=i.RPC.ControlMessage.decode(f,f.uint32());break;default:f.skipType(l&7);break}}return h},s.fromObject=function(f){if(f instanceof i.RPC)return f;var u=new i.RPC;if(f.subscriptions){if(!Array.isArray(f.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var c=0;c<f.subscriptions.length;++c){if(typeof f.subscriptions[c]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[c]=i.RPC.SubOpts.fromObject(f.subscriptions[c])}}if(f.messages){if(!Array.isArray(f.messages))throw TypeError(".RPC.messages: array expected");u.messages=[];for(var c=0;c<f.messages.length;++c){if(typeof f.messages[c]!="object")throw TypeError(".RPC.messages: object expected");u.messages[c]=i.RPC.Message.fromObject(f.messages[c])}}if(f.control!=null){if(typeof f.control!="object")throw TypeError(".RPC.control: object expected");u.control=i.RPC.ControlMessage.fromObject(f.control)}return u},s.toObject=function(f,u){u||(u={});var c={};if((u.arrays||u.defaults)&&(c.subscriptions=[],c.messages=[]),f.subscriptions&&f.subscriptions.length){c.subscriptions=[];for(var h=0;h<f.subscriptions.length;++h)c.subscriptions[h]=i.RPC.SubOpts.toObject(f.subscriptions[h],u)}if(f.messages&&f.messages.length){c.messages=[];for(var h=0;h<f.messages.length;++h)c.messages[h]=i.RPC.Message.toObject(f.messages[h],u)}return f.control!=null&&f.hasOwnProperty("control")&&(c.control=i.RPC.ControlMessage.toObject(f.control,u),u.oneofs&&(c._control="control")),c},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.subscribe=null,a.prototype.topic=null;var f;return Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(f=["subscribe"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_topic",{get:n.oneOfGetter(f=["topic"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.subscribe!=null&&Object.hasOwnProperty.call(c,"subscribe")&&h.uint32(8).bool(c.subscribe),c.topic!=null&&Object.hasOwnProperty.call(c,"topic")&&h.uint32(18).string(c.topic),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,d=new i.RPC.SubOpts;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:d.subscribe=c.bool();break;case 2:d.topic=c.string();break;default:c.skipType(p&7);break}}return d},a.fromObject=function(c){if(c instanceof i.RPC.SubOpts)return c;var h=new i.RPC.SubOpts;return c.subscribe!=null&&(h.subscribe=Boolean(c.subscribe)),c.topic!=null&&(h.topic=String(c.topic)),h},a.toObject=function(c,h){h||(h={});var l={};return c.subscribe!=null&&c.hasOwnProperty("subscribe")&&(l.subscribe=c.subscribe,h.oneofs&&(l._subscribe="subscribe")),c.topic!=null&&c.hasOwnProperty("topic")&&(l.topic=c.topic,h.oneofs&&(l._topic="topic")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topic="",a.prototype.signature=null,a.prototype.key=null;var f;return Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(f=["from"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(f=["data"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(f=["seqno"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(f=["signature"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(f=["key"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.from!=null&&Object.hasOwnProperty.call(c,"from")&&h.uint32(10).bytes(c.from),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&h.uint32(18).bytes(c.data),c.seqno!=null&&Object.hasOwnProperty.call(c,"seqno")&&h.uint32(26).bytes(c.seqno),h.uint32(34).string(c.topic),c.signature!=null&&Object.hasOwnProperty.call(c,"signature")&&h.uint32(42).bytes(c.signature),c.key!=null&&Object.hasOwnProperty.call(c,"key")&&h.uint32(50).bytes(c.key),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,d=new i.RPC.Message;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:d.from=c.bytes();break;case 2:d.data=c.bytes();break;case 3:d.seqno=c.bytes();break;case 4:d.topic=c.string();break;case 5:d.signature=c.bytes();break;case 6:d.key=c.bytes();break;default:c.skipType(p&7);break}}if(!d.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:d});return d},a.fromObject=function(c){if(c instanceof i.RPC.Message)return c;var h=new i.RPC.Message;return c.from!=null&&(typeof c.from=="string"?n.base64.decode(c.from,h.from=n.newBuffer(n.base64.length(c.from)),0):c.from.length&&(h.from=c.from)),c.data!=null&&(typeof c.data=="string"?n.base64.decode(c.data,h.data=n.newBuffer(n.base64.length(c.data)),0):c.data.length&&(h.data=c.data)),c.seqno!=null&&(typeof c.seqno=="string"?n.base64.decode(c.seqno,h.seqno=n.newBuffer(n.base64.length(c.seqno)),0):c.seqno.length&&(h.seqno=c.seqno)),c.topic!=null&&(h.topic=String(c.topic)),c.signature!=null&&(typeof c.signature=="string"?n.base64.decode(c.signature,h.signature=n.newBuffer(n.base64.length(c.signature)),0):c.signature.length&&(h.signature=c.signature)),c.key!=null&&(typeof c.key=="string"?n.base64.decode(c.key,h.key=n.newBuffer(n.base64.length(c.key)),0):c.key.length&&(h.key=c.key)),h},a.toObject=function(c,h){h||(h={});var l={};return h.defaults&&(l.topic=""),c.from!=null&&c.hasOwnProperty("from")&&(l.from=h.bytes===String?n.base64.encode(c.from,0,c.from.length):h.bytes===Array?Array.prototype.slice.call(c.from):c.from,h.oneofs&&(l._from="from")),c.data!=null&&c.hasOwnProperty("data")&&(l.data=h.bytes===String?n.base64.encode(c.data,0,c.data.length):h.bytes===Array?Array.prototype.slice.call(c.data):c.data,h.oneofs&&(l._data="data")),c.seqno!=null&&c.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?n.base64.encode(c.seqno,0,c.seqno.length):h.bytes===Array?Array.prototype.slice.call(c.seqno):c.seqno,h.oneofs&&(l._seqno="seqno")),c.topic!=null&&c.hasOwnProperty("topic")&&(l.topic=c.topic),c.signature!=null&&c.hasOwnProperty("signature")&&(l.signature=h.bytes===String?n.base64.encode(c.signature,0,c.signature.length):h.bytes===Array?Array.prototype.slice.call(c.signature):c.signature,h.oneofs&&(l._signature="signature")),c.key!=null&&c.hasOwnProperty("key")&&(l.key=h.bytes===String?n.base64.encode(c.key,0,c.key.length):h.bytes===Array?Array.prototype.slice.call(c.key):c.key,h.oneofs&&(l._key="key")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(f){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],f)for(var u=Object.keys(f),c=0;c<u.length;++c)f[u[c]]!=null&&(this[u[c]]=f[u[c]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(u,c){if(c||(c=r.create()),u.ihave!=null&&u.ihave.length)for(var h=0;h<u.ihave.length;++h)i.RPC.ControlIHave.encode(u.ihave[h],c.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var h=0;h<u.iwant.length;++h)i.RPC.ControlIWant.encode(u.iwant[h],c.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var h=0;h<u.graft.length;++h)i.RPC.ControlGraft.encode(u.graft[h],c.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var h=0;h<u.prune.length;++h)i.RPC.ControlPrune.encode(u.prune[h],c.uint32(34).fork()).ldelim();return c},a.decode=function(u,c){u instanceof e||(u=e.create(u));for(var h=c===void 0?u.len:u.pos+c,l=new i.RPC.ControlMessage;u.pos<h;){var d=u.uint32();switch(d>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(i.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(i.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(i.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(i.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(d&7);break}}return l},a.fromObject=function(u){if(u instanceof i.RPC.ControlMessage)return u;var c=new i.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");c.ihave=[];for(var h=0;h<u.ihave.length;++h){if(typeof u.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");c.ihave[h]=i.RPC.ControlIHave.fromObject(u.ihave[h])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");c.iwant=[];for(var h=0;h<u.iwant.length;++h){if(typeof u.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");c.iwant[h]=i.RPC.ControlIWant.fromObject(u.iwant[h])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");c.graft=[];for(var h=0;h<u.graft.length;++h){if(typeof u.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");c.graft[h]=i.RPC.ControlGraft.fromObject(u.graft[h])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");c.prune=[];for(var h=0;h<u.prune.length;++h){if(typeof u.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");c.prune[h]=i.RPC.ControlPrune.fromObject(u.prune[h])}}return c},a.toObject=function(u,c){c||(c={});var h={};if((c.arrays||c.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),u.ihave&&u.ihave.length){h.ihave=[];for(var l=0;l<u.ihave.length;++l)h.ihave[l]=i.RPC.ControlIHave.toObject(u.ihave[l],c)}if(u.iwant&&u.iwant.length){h.iwant=[];for(var l=0;l<u.iwant.length;++l)h.iwant[l]=i.RPC.ControlIWant.toObject(u.iwant[l],c)}if(u.graft&&u.graft.length){h.graft=[];for(var l=0;l<u.graft.length;++l)h.graft[l]=i.RPC.ControlGraft.toObject(u.graft[l],c)}if(u.prune&&u.prune.length){h.prune=[];for(var l=0;l<u.prune.length;++l)h.prune[l]=i.RPC.ControlPrune.toObject(u.prune[l],c)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){if(h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),c.messageIDs!=null&&c.messageIDs.length)for(var l=0;l<c.messageIDs.length;++l)h.uint32(18).bytes(c.messageIDs[l]);return h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,d=new i.RPC.ControlIHave;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:d.topicID=c.string();break;case 2:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(c.bytes());break;default:c.skipType(p&7);break}}return d},a.fromObject=function(c){if(c instanceof i.RPC.ControlIHave)return c;var h=new i.RPC.ControlIHave;if(c.topicID!=null&&(h.topicID=String(c.topicID)),c.messageIDs){if(!Array.isArray(c.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<c.messageIDs.length;++l)typeof c.messageIDs[l]=="string"?n.base64.decode(c.messageIDs[l],h.messageIDs[l]=n.newBuffer(n.base64.length(c.messageIDs[l])),0):c.messageIDs[l].length&&(h.messageIDs[l]=c.messageIDs[l])}return h},a.toObject=function(c,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),c.messageIDs&&c.messageIDs.length){l.messageIDs=[];for(var d=0;d<c.messageIDs.length;++d)l.messageIDs[d]=h.bytes===String?n.base64.encode(c.messageIDs[d],0,c.messageIDs[d].length):h.bytes===Array?Array.prototype.slice.call(c.messageIDs[d]):c.messageIDs[d]}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),c=0;c<u.length;++c)f[u[c]]!=null&&(this[u[c]]=f[u[c]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(u,c){if(c||(c=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var h=0;h<u.messageIDs.length;++h)c.uint32(10).bytes(u.messageIDs[h]);return c},a.decode=function(u,c){u instanceof e||(u=e.create(u));for(var h=c===void 0?u.len:u.pos+c,l=new i.RPC.ControlIWant;u.pos<h;){var d=u.uint32();switch(d>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(u.bytes());break;default:u.skipType(d&7);break}}return l},a.fromObject=function(u){if(u instanceof i.RPC.ControlIWant)return u;var c=new i.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");c.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)typeof u.messageIDs[h]=="string"?n.base64.decode(u.messageIDs[h],c.messageIDs[h]=n.newBuffer(n.base64.length(u.messageIDs[h])),0):u.messageIDs[h].length&&(c.messageIDs[h]=u.messageIDs[h])}return c},a.toObject=function(u,c){c||(c={});var h={};if((c.arrays||c.defaults)&&(h.messageIDs=[]),u.messageIDs&&u.messageIDs.length){h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)h.messageIDs[l]=c.bytes===String?n.base64.encode(u.messageIDs[l],0,u.messageIDs[l].length):c.bytes===Array?Array.prototype.slice.call(u.messageIDs[l]):u.messageIDs[l]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,d=new i.RPC.ControlGraft;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:d.topicID=c.string();break;default:c.skipType(p&7);break}}return d},a.fromObject=function(c){if(c instanceof i.RPC.ControlGraft)return c;var h=new i.RPC.ControlGraft;return c.topicID!=null&&(h.topicID=String(c.topicID)),h},a.toObject=function(c,h){h||(h={});var l={};return c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null;var f;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(f=["backoff"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){if(h||(h=r.create()),c.topicID!=null&&Object.hasOwnProperty.call(c,"topicID")&&h.uint32(10).string(c.topicID),c.peers!=null&&c.peers.length)for(var l=0;l<c.peers.length;++l)i.RPC.PeerInfo.encode(c.peers[l],h.uint32(18).fork()).ldelim();return c.backoff!=null&&Object.hasOwnProperty.call(c,"backoff")&&h.uint32(24).uint64(c.backoff),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,d=new i.RPC.ControlPrune;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:d.topicID=c.string();break;case 2:d.peers&&d.peers.length||(d.peers=[]),d.peers.push(i.RPC.PeerInfo.decode(c,c.uint32()));break;case 3:d.backoff=c.uint64();break;default:c.skipType(p&7);break}}return d},a.fromObject=function(c){if(c instanceof i.RPC.ControlPrune)return c;var h=new i.RPC.ControlPrune;if(c.topicID!=null&&(h.topicID=String(c.topicID)),c.peers){if(!Array.isArray(c.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<c.peers.length;++l){if(typeof c.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=i.RPC.PeerInfo.fromObject(c.peers[l])}}return c.backoff!=null&&(n.Long?(h.backoff=n.Long.fromValue(c.backoff)).unsigned=!0:typeof c.backoff=="string"?h.backoff=parseInt(c.backoff,10):typeof c.backoff=="number"?h.backoff=c.backoff:typeof c.backoff=="object"&&(h.backoff=new n.LongBits(c.backoff.low>>>0,c.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(c,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),c.topicID!=null&&c.hasOwnProperty("topicID")&&(l.topicID=c.topicID,h.oneofs&&(l._topicID="topicID")),c.peers&&c.peers.length){l.peers=[];for(var d=0;d<c.peers.length;++d)l.peers[d]=i.RPC.PeerInfo.toObject(c.peers[d],h)}return c.backoff!=null&&c.hasOwnProperty("backoff")&&(typeof c.backoff=="number"?l.backoff=h.longs===String?String(c.backoff):c.backoff:l.backoff=h.longs===String?n.Long.prototype.toString.call(c.backoff):h.longs===Number?new n.LongBits(c.backoff.low>>>0,c.backoff.high>>>0).toNumber(!0):c.backoff,h.oneofs&&(l._backoff="backoff")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var c=Object.keys(u),h=0;h<c.length;++h)u[c[h]]!=null&&(this[c[h]]=u[c[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var f;return Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(f=["peerID"]),set:n.oneOfSetter(f)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(f=["signedPeerRecord"]),set:n.oneOfSetter(f)}),a.encode=function(c,h){return h||(h=r.create()),c.peerID!=null&&Object.hasOwnProperty.call(c,"peerID")&&h.uint32(10).bytes(c.peerID),c.signedPeerRecord!=null&&Object.hasOwnProperty.call(c,"signedPeerRecord")&&h.uint32(18).bytes(c.signedPeerRecord),h},a.decode=function(c,h){c instanceof e||(c=e.create(c));for(var l=h===void 0?c.len:c.pos+h,d=new i.RPC.PeerInfo;c.pos<l;){var p=c.uint32();switch(p>>>3){case 1:d.peerID=c.bytes();break;case 2:d.signedPeerRecord=c.bytes();break;default:c.skipType(p&7);break}}return d},a.fromObject=function(c){if(c instanceof i.RPC.PeerInfo)return c;var h=new i.RPC.PeerInfo;return c.peerID!=null&&(typeof c.peerID=="string"?n.base64.decode(c.peerID,h.peerID=n.newBuffer(n.base64.length(c.peerID)),0):c.peerID.length&&(h.peerID=c.peerID)),c.signedPeerRecord!=null&&(typeof c.signedPeerRecord=="string"?n.base64.decode(c.signedPeerRecord,h.signedPeerRecord=n.newBuffer(n.base64.length(c.signedPeerRecord)),0):c.signedPeerRecord.length&&(h.signedPeerRecord=c.signedPeerRecord)),h},a.toObject=function(c,h){h||(h={});var l={};return c.peerID!=null&&c.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?n.base64.encode(c.peerID,0,c.peerID.length):h.bytes===Array?Array.prototype.slice.call(c.peerID):c.peerID,h.oneofs&&(l._peerID="peerID")),c.signedPeerRecord!=null&&c.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?n.base64.encode(c.signedPeerRecord,0,c.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(c.signedPeerRecord):c.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),s}(),i})});var Ed=B((L6,xd)=>{"use strict";function Be(t,r){var r=r||{};this._head=0,this._tail=0,this._capacity=r.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}Be.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};Be.prototype.get=function(e){return this.peekAt(e)};Be.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Be.prototype.peekFront=function(){return this.peek()};Be.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Be.prototype,"length",{get:function(){return this.size()}});Be.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Be.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Be.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Be.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Be.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};Be.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return s}}};Be.prototype.remove=function(e,r){var n=e,i,s=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return i=new Array(1),i[0]=this.removeOne(n),i;if(n===0&&n+r>=o)return i=this.toArray(),this.clear(),i;n+r>o&&(r=o-n);var f;for(i=new Array(r),f=0;f<r;f++)i[f]=this._list[this._head+n+f&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,f=r;f>0;f--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+r+a&this._capacityMask,f=r-1;f>0;f--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(n<o/2){for(this._head=this._head+e+r+a&this._capacityMask,f=e;f>0;f--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;s>0;)this._list[n=n-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,f=o-(r+e);f>0;f--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),i}}};Be.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var i=this.size();if(n<0&&(n+=i),!(n>i))if(arguments.length>2){var s,o,a,f=arguments.length,u=this._list.length,c=2;if(!i||n<i/2){for(o=new Array(n),s=0;s<n;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);f>c;)this.unshift(arguments[--f]);for(s=n;s>0;s--)this.unshift(o[s-1])}else{o=new Array(i-(n+r));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+n+r+s&this._capacityMask];for(r===0?(a=[],n!=i&&(this._tail=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+u&this._capacityMask);c<f;)this.push(arguments[c++]);for(s=0;s<h;s++)this.push(o[s])}return a}else return this.remove(n,r)}};Be.prototype.clear=function(){this._head=0,this._tail=0};Be.prototype.isEmpty=function(){return this._head===this._tail};Be.prototype.toArray=function(){return this._copyArray(!1)};Be.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};Be.prototype._copyArray=function(e){var r=[],n=this._list,i=n.length,s;if(e||this._head>this._tail){for(s=this._head;s<i;s++)r.push(n[s]);for(s=0;s<this._tail;s++)r.push(n[s])}else for(s=this._head;s<this._tail;s++)r.push(n[s]);return r};Be.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};Be.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};xd.exports=Be});var nu=B((ID,ru)=>{"use strict";var ui=typeof Reflect=="object"?Reflect:null,Bd=ui&&typeof ui.apply=="function"?ui.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},To;ui&&typeof ui.ownKeys=="function"?To=ui.ownKeys:Object.getOwnPropertySymbols?To=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:To=function(e){return Object.getOwnPropertyNames(e)};function DE(t){console&&console.warn&&console.warn(t)}var Dd=Number.isNaN||function(e){return e!==e};function pe(){pe.init.call(this)}ru.exports=pe;ru.exports.once=NE;pe.EventEmitter=pe;pe.prototype._events=void 0;pe.prototype._eventsCount=0;pe.prototype._maxListeners=void 0;var Rd=10;function Bo(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(pe,"defaultMaxListeners",{enumerable:!0,get:function(){return Rd},set:function(t){if(typeof t!="number"||t<0||Dd(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Rd=t}});pe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Dd(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Pd(t){return t._maxListeners===void 0?pe.defaultMaxListeners:t._maxListeners}pe.prototype.getMaxListeners=function(){return Pd(this)};pe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Bd(f,this,r);else for(var u=f.length,c=Od(f,u),n=0;n<u;++n)Bd(c[n],this,r);return!0};function Ld(t,e,r,n){var i,s,o;if(Bo(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Pd(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,DE(a)}return t}pe.prototype.addListener=function(e,r){return Ld(this,e,r,!1)};pe.prototype.on=pe.prototype.addListener;pe.prototype.prependListener=function(e,r){return Ld(this,e,r,!0)};function PE(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Md(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=PE.bind(n);return i.listener=r,n.wrapFn=i,i}pe.prototype.once=function(e,r){return Bo(r),this.on(e,Md(this,e,r)),this};pe.prototype.prependOnceListener=function(e,r){return Bo(r),this.prependListener(e,Md(this,e,r)),this};pe.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Bo(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():LE(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};pe.prototype.off=pe.prototype.removeListener;pe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Nd(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?ME(i):Od(i,i.length)}pe.prototype.listeners=function(e){return Nd(this,e,!0)};pe.prototype.rawListeners=function(e){return Nd(this,e,!1)};pe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):kd.call(t,e)};pe.prototype.listenerCount=kd;function kd(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}pe.prototype.eventNames=function(){return this._eventsCount>0?To(this._events):[]};function Od(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function LE(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function ME(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function NE(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Ud(t,e,s,{once:!0}),e!=="error"&&kE(t,i,{once:!0})})}function kE(t,e,r){typeof t.on=="function"&&Ud(t,"error",e,r)}function Ud(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var iu=B((AD,Fd)=>{Fd.exports=nu().EventEmitter});var Kd=B(Ro=>{"use strict";Ro.byteLength=UE;Ro.toByteArray=VE;Ro.fromByteArray=zE;var tr=[],St=[],OE=typeof Uint8Array<"u"?Uint8Array:Array,su="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(pn=0,Vd=su.length;pn<Vd;++pn)tr[pn]=su[pn],St[su.charCodeAt(pn)]=pn;var pn,Vd;St["-".charCodeAt(0)]=62;St["_".charCodeAt(0)]=63;function qd(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function UE(t){var e=qd(t),r=e[0],n=e[1];return(r+n)*3/4-n}function FE(t,e,r){return(e+r)*3/4-r}function VE(t){var e,r=qd(t),n=r[0],i=r[1],s=new OE(FE(t,n,i)),o=0,a=i>0?n-4:n,f;for(f=0;f<a;f+=4)e=St[t.charCodeAt(f)]<<18|St[t.charCodeAt(f+1)]<<12|St[t.charCodeAt(f+2)]<<6|St[t.charCodeAt(f+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=St[t.charCodeAt(f)]<<2|St[t.charCodeAt(f+1)]>>4,s[o++]=e&255),i===1&&(e=St[t.charCodeAt(f)]<<10|St[t.charCodeAt(f+1)]<<4|St[t.charCodeAt(f+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function qE(t){return tr[t>>18&63]+tr[t>>12&63]+tr[t>>6&63]+tr[t&63]}function KE(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(qE(n));return i.join("")}function zE(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(KE(t,o,o+s>a?a:o+s));return n===1?(e=t[r-1],i.push(tr[e>>2]+tr[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(tr[e>>10]+tr[e>>4&63]+tr[e<<2&63]+"=")),i.join("")}});var zd=B(ou=>{ou.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,f=(1<<a)-1,u=f>>1,c=-7,h=r?i-1:0,l=r?-1:1,d=t[e+h];for(h+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=s*256+t[e+h],h+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=n;c>0;o=o*256+t[e+h],h+=l,c-=8);if(s===0)s=1-u;else{if(s===f)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(d?-1:1)*o*Math.pow(2,s-n)};ou.write=function(t,e,r,n,i,s){var o,a,f,u=s*8-i-1,c=(1<<u)-1,h=c>>1,l=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+h>=1?e+=l/f:e+=l*Math.pow(2,1-h),e*f>=2&&(o++,f/=2),o+h>=c?(a=0,o=c):o+h>=1?(a=(e*f-1)*Math.pow(2,i),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=a&255,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+d]=o&255,d+=p,o/=256,u-=8);t[r+d-p]|=g*128}});var rs=B(hi=>{"use strict";var au=Kd(),fi=zd(),Gd=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;hi.Buffer=E;hi.SlowBuffer=YE;hi.INSPECT_MAX_BYTES=50;var Do=2147483647;hi.kMaxLength=Do;E.TYPED_ARRAY_SUPPORT=GE();!E.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function GE(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(E.prototype,"parent",{enumerable:!0,get:function(){if(!!E.isBuffer(this))return this.buffer}});Object.defineProperty(E.prototype,"offset",{enumerable:!0,get:function(){if(!!E.isBuffer(this))return this.byteOffset}});function gr(t){if(t>Do)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,E.prototype),e}function E(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return hu(t)}return jd(t,e,r)}E.poolSize=8192;function jd(t,e,r){if(typeof t=="string")return WE(t,e);if(ArrayBuffer.isView(t))return jE(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(rr(t,ArrayBuffer)||t&&rr(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(rr(t,SharedArrayBuffer)||t&&rr(t.buffer,SharedArrayBuffer)))return uu(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return E.from(n,e,r);var i=$E(t);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return E.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}E.from=function(t,e,r){return jd(t,e,r)};Object.setPrototypeOf(E.prototype,Uint8Array.prototype);Object.setPrototypeOf(E,Uint8Array);function $d(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function HE(t,e,r){return $d(t),t<=0?gr(t):e!==void 0?typeof r=="string"?gr(t).fill(e,r):gr(t).fill(e):gr(t)}E.alloc=function(t,e,r){return HE(t,e,r)};function hu(t){return $d(t),gr(t<0?0:lu(t)|0)}E.allocUnsafe=function(t){return hu(t)};E.allocUnsafeSlow=function(t){return hu(t)};function WE(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!E.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=Yd(t,e)|0,n=gr(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function cu(t){for(var e=t.length<0?0:lu(t.length)|0,r=gr(e),n=0;n<e;n+=1)r[n]=t[n]&255;return r}function jE(t){if(rr(t,Uint8Array)){var e=new Uint8Array(t);return uu(e.buffer,e.byteOffset,e.byteLength)}return cu(t)}function uu(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,E.prototype),n}function $E(t){if(E.isBuffer(t)){var e=lu(t.length)|0,r=gr(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||pu(t.length)?gr(0):cu(t);if(t.type==="Buffer"&&Array.isArray(t.data))return cu(t.data)}function lu(t){if(t>=Do)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Do.toString(16)+" bytes");return t|0}function YE(t){return+t!=t&&(t=0),E.alloc(+t)}E.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==E.prototype};E.compare=function(e,r){if(rr(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),rr(r,Uint8Array)&&(r=E.from(r,r.offset,r.byteLength)),!E.isBuffer(e)||!E.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,i=r.length,s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0};E.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};E.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return E.alloc(0);var n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=E.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){var o=e[n];if(rr(o,Uint8Array))s+o.length>i.length?E.from(o).copy(i,s):Uint8Array.prototype.set.call(i,o,s);else if(E.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function Yd(t,e){if(E.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||rr(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return fu(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return tg(t).length;default:if(i)return n?-1:fu(t).length;e=(""+e).toLowerCase(),i=!0}}E.byteLength=Yd;function ZE(t,e,r){var n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return oS(this,e,r);case"utf8":case"utf-8":return Xd(this,e,r);case"ascii":return iS(this,e,r);case"latin1":case"binary":return sS(this,e,r);case"base64":return rS(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return aS(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}E.prototype._isBuffer=!0;function dn(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}E.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)dn(this,r,r+1);return this};E.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)dn(this,r,r+3),dn(this,r+1,r+2);return this};E.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)dn(this,r,r+7),dn(this,r+1,r+6),dn(this,r+2,r+5),dn(this,r+3,r+4);return this};E.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?Xd(this,0,e):ZE.apply(this,arguments)};E.prototype.toLocaleString=E.prototype.toString;E.prototype.equals=function(e){if(!E.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:E.compare(this,e)===0};E.prototype.inspect=function(){var e="",r=hi.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Gd&&(E.prototype[Gd]=E.prototype.inspect);E.prototype.compare=function(e,r,n,i,s){if(rr(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),!E.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;for(var o=s-i,a=n-r,f=Math.min(o,a),u=this.slice(i,s),c=e.slice(r,n),h=0;h<f;++h)if(u[h]!==c[h]){o=u[h],a=c[h];break}return o<a?-1:a<o?1:0};function Zd(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,pu(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=E.from(e,n)),E.isBuffer(e))return e.length===0?-1:Hd(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Hd(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Hd(t,e,r,n,i){var s=1,o=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function f(d,p){return s===1?d[p]:d.readUInt16BE(p*s)}var u;if(i){var c=-1;for(u=r;u<o;u++)if(f(t,u)===f(e,c===-1?0:u-c)){if(c===-1&&(c=u),u-c+1===a)return c*s}else c!==-1&&(u-=u-c),c=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){for(var h=!0,l=0;l<a;l++)if(f(t,u+l)!==f(e,l)){h=!1;break}if(h)return u}return-1}E.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};E.prototype.indexOf=function(e,r,n){return Zd(this,e,r,n,!0)};E.prototype.lastIndexOf=function(e,r,n){return Zd(this,e,r,n,!1)};function XE(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var s=e.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(o*2,2),16);if(pu(a))return o;t[r+o]=a}return o}function QE(t,e,r,n){return Po(fu(e,t.length-r),t,r,n)}function JE(t,e,r,n){return Po(fS(e),t,r,n)}function eS(t,e,r,n){return Po(tg(e),t,r,n)}function tS(t,e,r,n){return Po(hS(e,t.length-r),t,r,n)}E.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-r;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return XE(this,e,r,n);case"utf8":case"utf-8":return QE(this,e,r,n);case"ascii":case"latin1":case"binary":return JE(this,e,r,n);case"base64":return eS(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tS(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};E.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function rS(t,e,r){return e===0&&r===t.length?au.fromByteArray(t):au.fromByteArray(t.slice(e,r))}function Xd(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=r){var f,u,c,h;switch(a){case 1:s<128&&(o=s);break;case 2:f=t[i+1],(f&192)===128&&(h=(s&31)<<6|f&63,h>127&&(o=h));break;case 3:f=t[i+1],u=t[i+2],(f&192)===128&&(u&192)===128&&(h=(s&15)<<12|(f&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:f=t[i+1],u=t[i+2],c=t[i+3],(f&192)===128&&(u&192)===128&&(c&192)===128&&(h=(s&15)<<18|(f&63)<<12|(u&63)<<6|c&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=a}return nS(n)}var Wd=4096;function nS(t){var e=t.length;if(e<=Wd)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Wd));return r}function iS(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function sS(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function oS(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=lS[t[s]];return i}function aS(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}E.prototype.slice=function(e,r){var n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i=this.subarray(e,r);return Object.setPrototypeOf(i,E.prototype),i};function $e(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}E.prototype.readUintLE=E.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||$e(e,r,this.length);for(var i=this[e],s=1,o=0;++o<r&&(s*=256);)i+=this[e+o]*s;return i};E.prototype.readUintBE=E.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||$e(e,r,this.length);for(var i=this[e+--r],s=1;r>0&&(s*=256);)i+=this[e+--r]*s;return i};E.prototype.readUint8=E.prototype.readUInt8=function(e,r){return e=e>>>0,r||$e(e,1,this.length),this[e]};E.prototype.readUint16LE=E.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||$e(e,2,this.length),this[e]|this[e+1]<<8};E.prototype.readUint16BE=E.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||$e(e,2,this.length),this[e]<<8|this[e+1]};E.prototype.readUint32LE=E.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||$e(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};E.prototype.readUint32BE=E.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||$e(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};E.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||$e(e,r,this.length);for(var i=this[e],s=1,o=0;++o<r&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*r)),i};E.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||$e(e,r,this.length);for(var i=r,s=1,o=this[e+--i];i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};E.prototype.readInt8=function(e,r){return e=e>>>0,r||$e(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};E.prototype.readInt16LE=function(e,r){e=e>>>0,r||$e(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};E.prototype.readInt16BE=function(e,r){e=e>>>0,r||$e(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};E.prototype.readInt32LE=function(e,r){return e=e>>>0,r||$e(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};E.prototype.readInt32BE=function(e,r){return e=e>>>0,r||$e(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};E.prototype.readFloatLE=function(e,r){return e=e>>>0,r||$e(e,4,this.length),fi.read(this,e,!0,23,4)};E.prototype.readFloatBE=function(e,r){return e=e>>>0,r||$e(e,4,this.length),fi.read(this,e,!1,23,4)};E.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||$e(e,8,this.length),fi.read(this,e,!0,52,8)};E.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||$e(e,8,this.length),fi.read(this,e,!1,52,8)};function ht(t,e,r,n,i,s){if(!E.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}E.prototype.writeUintLE=E.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){var s=Math.pow(2,8*n)-1;ht(this,e,r,n,s,0)}var o=1,a=0;for(this[r]=e&255;++a<n&&(o*=256);)this[r+a]=e/o&255;return r+n};E.prototype.writeUintBE=E.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){var s=Math.pow(2,8*n)-1;ht(this,e,r,n,s,0)}var o=n-1,a=1;for(this[r+o]=e&255;--o>=0&&(a*=256);)this[r+o]=e/a&255;return r+n};E.prototype.writeUint8=E.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,1,255,0),this[r]=e&255,r+1};E.prototype.writeUint16LE=E.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};E.prototype.writeUint16BE=E.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};E.prototype.writeUint32LE=E.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};E.prototype.writeUint32BE=E.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};E.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){var s=Math.pow(2,8*n-1);ht(this,e,r,n,s-1,-s)}var o=0,a=1,f=0;for(this[r]=e&255;++o<n&&(a*=256);)e<0&&f===0&&this[r+o-1]!==0&&(f=1),this[r+o]=(e/a>>0)-f&255;return r+n};E.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){var s=Math.pow(2,8*n-1);ht(this,e,r,n,s-1,-s)}var o=n-1,a=1,f=0;for(this[r+o]=e&255;--o>=0&&(a*=256);)e<0&&f===0&&this[r+o+1]!==0&&(f=1),this[r+o]=(e/a>>0)-f&255;return r+n};E.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};E.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};E.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};E.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};E.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||ht(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Qd(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Jd(t,e,r,n,i){return e=+e,r=r>>>0,i||Qd(t,e,r,4,34028234663852886e22,-34028234663852886e22),fi.write(t,e,r,n,23,4),r+4}E.prototype.writeFloatLE=function(e,r,n){return Jd(this,e,r,!0,n)};E.prototype.writeFloatBE=function(e,r,n){return Jd(this,e,r,!1,n)};function eg(t,e,r,n,i){return e=+e,r=r>>>0,i||Qd(t,e,r,8,17976931348623157e292,-17976931348623157e292),fi.write(t,e,r,n,52,8),r+8}E.prototype.writeDoubleLE=function(e,r,n){return eg(this,e,r,!0,n)};E.prototype.writeDoubleBE=function(e,r,n){return eg(this,e,r,!1,n)};E.prototype.copy=function(e,r,n,i){if(!E.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),s};E.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!E.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){var s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);var o;if(typeof e=="number")for(o=r;o<n;++o)this[o]=e;else{var a=E.isBuffer(e)?e:E.from(e,i),f=a.length;if(f===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=a[o%f]}return this};var cS=/[^+/0-9A-Za-z-_]/g;function uS(t){if(t=t.split("=")[0],t=t.trim().replace(cS,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function fu(t,e){e=e||1/0;for(var r,n=t.length,i=null,s=[],o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function fS(t){for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function hS(t,e){for(var r,n,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}function tg(t){return au.toByteArray(uS(t))}function Po(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function rr(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function pu(t){return t!==t}var lS=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=r*16,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()});var du=B(()=>{});var sg=B((PD,ig)=>{"use strict";function rg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rg(Object(r),!0).forEach(function(n){dS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dS(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ng(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yS(t,e,r){return e&&ng(t.prototype,e),r&&ng(t,r),t}var mS=rs(),Lo=mS.Buffer,bS=du(),gu=bS.inspect,vS=gu&&gu.custom||"inspect";function wS(t,e,r){Lo.prototype.copy.call(t,e,r)}ig.exports=function(){function t(){gS(this,t),this.head=null,this.tail=null,this.length=0}return yS(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return Lo.alloc(0);for(var n=Lo.allocUnsafe(r>>>0),i=this.head,s=0;i;)wS(i.data,n,s),s+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,s=n.data;for(r-=s.length;n=n.next;){var o=n.data,a=r>o.length?o.length:r;if(a===o.length?s+=o:s+=o.slice(0,r),r-=a,r===0){a===o.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++i}return this.length-=i,s}},{key:"_getBuffer",value:function(r){var n=Lo.allocUnsafe(r),i=this.head,s=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var o=i.data,a=r>o.length?o.length:r;if(o.copy(n,n.length-r,0,a),r-=a,r===0){a===o.length?(++s,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++s}return this.length-=s,n}},{key:vS,value:function(r,n){return gu(this,pS({},n,{depth:0,customInspect:!1}))}}]),t}()});var mu=B((LD,ag)=>{"use strict";function xS(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(yu,this,t)):process.nextTick(yu,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(Mo,r):(r._writableState.errorEmitted=!0,process.nextTick(og,r,s)):process.nextTick(og,r,s):e?(process.nextTick(Mo,r),e(s)):process.nextTick(Mo,r)}),this)}function og(t,e){yu(t,e),Mo(t)}function Mo(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function ES(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function yu(t,e){t.emit("error",e)}function SS(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}ag.exports={destroy:xS,undestroy:ES,errorOrDestroy:SS}});var gn=B((MD,fg)=>{"use strict";function _S(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var ug={};function _t(t,e,r){r||(r=Error);function n(s,o,a){return typeof e=="string"?e:e(s,o,a)}var i=function(s){_S(o,s);function o(a,f,u){return s.call(this,n(a,f,u))||this}return o}(r);i.prototype.name=r.name,i.prototype.code=t,ug[t]=i}function cg(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function IS(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function AS(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function CS(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}_t("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);_t("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&IS(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(AS(t," argument"))i="The ".concat(t," ").concat(n," ").concat(cg(e,"type"));else{var s=CS(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(s," ").concat(n," ").concat(cg(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);_t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");_t("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});_t("ERR_STREAM_PREMATURE_CLOSE","Premature close");_t("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});_t("ERR_MULTIPLE_CALLBACK","Callback called multiple times");_t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");_t("ERR_STREAM_WRITE_AFTER_END","write after end");_t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);_t("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);_t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");fg.exports.codes=ug});var bu=B((ND,hg)=>{"use strict";var TS=gn().codes.ERR_INVALID_OPT_VALUE;function BS(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function RS(t,e,r,n){var i=BS(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var s=n?r:"highWaterMark";throw new TS(s,i)}return Math.floor(i)}return t.objectMode?16:16*1024}hg.exports={getHighWaterMark:RS}});var li=B((kD,vu)=>{typeof Object.create=="function"?vu.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:vu.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var pg=B((OD,lg)=>{lg.exports=DS;function DS(t,e){if(wu("noDeprecation"))return t;var r=!1;function n(){if(!r){if(wu("throwDeprecation"))throw new Error(e);wu("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return n}function wu(t){try{if(!globalThis.localStorage)return!1}catch{return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var Su=B((UD,vg)=>{"use strict";vg.exports=Re;function gg(t){var e=this;this.next=null,this.entry=null,this.finish=function(){i_(e,t)}}var pi;Re.WritableState=is;var PS={deprecate:pg()},yg=iu(),ko=rs().Buffer,LS=globalThis.Uint8Array||function(){};function MS(t){return ko.from(t)}function NS(t){return ko.isBuffer(t)||t instanceof LS}var Eu=mu(),kS=bu(),OS=kS.getHighWaterMark,Nr=gn().codes,US=Nr.ERR_INVALID_ARG_TYPE,FS=Nr.ERR_METHOD_NOT_IMPLEMENTED,VS=Nr.ERR_MULTIPLE_CALLBACK,qS=Nr.ERR_STREAM_CANNOT_PIPE,KS=Nr.ERR_STREAM_DESTROYED,zS=Nr.ERR_STREAM_NULL_VALUES,GS=Nr.ERR_STREAM_WRITE_AFTER_END,HS=Nr.ERR_UNKNOWN_ENCODING,di=Eu.errorOrDestroy;li()(Re,yg);function WS(){}function is(t,e,r){pi=pi||yn(),t=t||{},typeof r!="boolean"&&(r=e instanceof pi),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=OS(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){JS(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new gg(this)}is.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(is.prototype,"buffer",{get:PS.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var No;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(No=Function.prototype[Symbol.hasInstance],Object.defineProperty(Re,Symbol.hasInstance,{value:function(e){return No.call(this,e)?!0:this!==Re?!1:e&&e._writableState instanceof is}})):No=function(e){return e instanceof this};function Re(t){pi=pi||yn();var e=this instanceof pi;if(!e&&!No.call(Re,this))return new Re(t);this._writableState=new is(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),yg.call(this)}Re.prototype.pipe=function(){di(this,new qS)};function jS(t,e){var r=new GS;di(t,r),process.nextTick(e,r)}function $S(t,e,r,n){var i;return r===null?i=new zS:typeof r!="string"&&!e.objectMode&&(i=new US("chunk",["string","Buffer"],r)),i?(di(t,i),process.nextTick(n,i),!1):!0}Re.prototype.write=function(t,e,r){var n=this._writableState,i=!1,s=!n.objectMode&&NS(t);return s&&!ko.isBuffer(t)&&(t=MS(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=WS),n.ending?jS(this,r):(s||$S(this,n,t,r))&&(n.pendingcb++,i=ZS(this,n,s,t,e,r)),i};Re.prototype.cork=function(){this._writableState.corked++};Re.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&mg(this,t))};Re.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new HS(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Re.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function YS(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=ko.from(e,r)),e}Object.defineProperty(Re.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ZS(t,e,r,n,i,s){if(!r){var o=YS(e,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=e.objectMode?1:n.length;e.length+=a;var f=e.length<e.highWaterMark;if(f||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else xu(t,e,!1,a,n,i,s);return f}function xu(t,e,r,n,i,s,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new KS("write")):r?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}function XS(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(ns,t,e),t._writableState.errorEmitted=!0,di(t,n)):(i(n),t._writableState.errorEmitted=!0,di(t,n),ns(t,e))}function QS(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function JS(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new VS;if(QS(r),e)XS(t,r,n,e,i);else{var s=bg(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&mg(t,r),n?process.nextTick(dg,t,r,s,i):dg(t,r,s,i)}}function dg(t,e,r,n){r||e_(t,e),e.pendingcb--,n(),ns(t,e)}function e_(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function mg(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),s=e.corkedRequestsFree;s.entry=r;for(var o=0,a=!0;r;)i[o]=r,r.isBuf||(a=!1),r=r.next,o+=1;i.allBuffers=a,xu(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new gg(e),e.bufferedRequestCount=0}else{for(;r;){var f=r.chunk,u=r.encoding,c=r.callback,h=e.objectMode?1:f.length;if(xu(t,e,!1,h,f,u,c),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Re.prototype._write=function(t,e,r){r(new FS("_write()"))};Re.prototype._writev=null;Re.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n_(this,n,r),this};Object.defineProperty(Re.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function bg(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function t_(t,e){t._final(function(r){e.pendingcb--,r&&di(t,r),e.prefinished=!0,t.emit("prefinish"),ns(t,e)})}function r_(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(t_,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function ns(t,e){var r=bg(e);if(r&&(r_(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function n_(t,e,r){e.ending=!0,ns(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function i_(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(Re.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Re.prototype.destroy=Eu.destroy;Re.prototype._undestroy=Eu.undestroy;Re.prototype._destroy=function(t,e){e(t)}});var yn=B((FD,xg)=>{"use strict";var s_=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};xg.exports=nr;var wg=Au(),Iu=Su();li()(nr,wg);for(_u=s_(Iu.prototype),Oo=0;Oo<_u.length;Oo++)Uo=_u[Oo],nr.prototype[Uo]||(nr.prototype[Uo]=Iu.prototype[Uo]);var _u,Uo,Oo;function nr(t){if(!(this instanceof nr))return new nr(t);wg.call(this,t),Iu.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o_)))}Object.defineProperty(nr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(nr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(nr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o_(){this._writableState.ended||process.nextTick(a_,this)}function a_(t){t.end()}Object.defineProperty(nr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var _g=B((Cu,Sg)=>{var Fo=rs(),yr=Fo.Buffer;function Eg(t,e){for(var r in t)e[r]=t[r]}yr.from&&yr.alloc&&yr.allocUnsafe&&yr.allocUnsafeSlow?Sg.exports=Fo:(Eg(Fo,Cu),Cu.Buffer=gi);function gi(t,e,r){return yr(t,e,r)}Eg(yr,gi);gi.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return yr(t,e,r)};gi.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=yr(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};gi.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return yr(t)};gi.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Fo.SlowBuffer(t)}});var Ru=B(Ag=>{"use strict";var Bu=_g().Buffer,Ig=Bu.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function c_(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function u_(t){var e=c_(t);if(typeof e!="string"&&(Bu.isEncoding===Ig||!Ig(t)))throw new Error("Unknown encoding: "+t);return e||t}Ag.StringDecoder=ss;function ss(t){this.encoding=u_(t);var e;switch(this.encoding){case"utf16le":this.text=g_,this.end=y_,e=4;break;case"utf8":this.fillLast=l_,e=4;break;case"base64":this.text=m_,this.end=b_,e=3;break;default:this.write=v_,this.end=w_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Bu.allocUnsafe(e)}ss.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};ss.prototype.end=d_;ss.prototype.text=p_;ss.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Tu(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function f_(t,e,r){var n=e.length-1;if(n<r)return 0;var i=Tu(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=Tu(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=Tu(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function h_(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function l_(t){var e=this.lastTotal-this.lastNeed,r=h_(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function p_(t,e){var r=f_(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function d_(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function g_(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function y_(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function m_(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function b_(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function v_(t){return t.toString(this.encoding)}function w_(t){return t&&t.length?this.write(t):""}});var Vo=B((qD,Bg)=>{"use strict";var Cg=gn().codes.ERR_STREAM_PREMATURE_CLOSE;function x_(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function E_(){}function S_(t){return t.setHeader&&typeof t.abort=="function"}function Tg(t,e,r){if(typeof e=="function")return Tg(t,null,e);e||(e={}),r=x_(r||E_);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||a()},o=t._writableState&&t._writableState.finished,a=function(){i=!1,o=!0,n||r.call(t)},f=t._readableState&&t._readableState.endEmitted,u=function(){n=!1,f=!0,i||r.call(t)},c=function(p){r.call(t,p)},h=function(){var p;if(n&&!f)return(!t._readableState||!t._readableState.ended)&&(p=new Cg),r.call(t,p);if(i&&!o)return(!t._writableState||!t._writableState.ended)&&(p=new Cg),r.call(t,p)},l=function(){t.req.on("finish",a)};return S_(t)?(t.on("complete",a),t.on("abort",h),t.req?l():t.on("request",l)):i&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",c),t.on("close",h),function(){t.removeListener("complete",a),t.removeListener("abort",h),t.removeListener("request",l),t.req&&t.req.removeListener("finish",a),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",c),t.removeListener("close",h)}}Bg.exports=Tg});var Dg=B((KD,Rg)=>{"use strict";var qo;function kr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var __=Vo(),Or=Symbol("lastResolve"),mn=Symbol("lastReject"),os=Symbol("error"),Ko=Symbol("ended"),bn=Symbol("lastPromise"),Du=Symbol("handlePromise"),vn=Symbol("stream");function Ur(t,e){return{value:t,done:e}}function I_(t){var e=t[Or];if(e!==null){var r=t[vn].read();r!==null&&(t[bn]=null,t[Or]=null,t[mn]=null,e(Ur(r,!1)))}}function A_(t){process.nextTick(I_,t)}function C_(t,e){return function(r,n){t.then(function(){if(e[Ko]){r(Ur(void 0,!0));return}e[Du](r,n)},n)}}var T_=Object.getPrototypeOf(function(){}),B_=Object.setPrototypeOf((qo={get stream(){return this[vn]},next:function(){var e=this,r=this[os];if(r!==null)return Promise.reject(r);if(this[Ko])return Promise.resolve(Ur(void 0,!0));if(this[vn].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[os]?a(e[os]):o(Ur(void 0,!0))})});var n=this[bn],i;if(n)i=new Promise(C_(n,this));else{var s=this[vn].read();if(s!==null)return Promise.resolve(Ur(s,!1));i=new Promise(this[Du])}return this[bn]=i,i}},kr(qo,Symbol.asyncIterator,function(){return this}),kr(qo,"return",function(){var e=this;return new Promise(function(r,n){e[vn].destroy(null,function(i){if(i){n(i);return}r(Ur(void 0,!0))})})}),qo),T_),R_=function(e){var r,n=Object.create(B_,(r={},kr(r,vn,{value:e,writable:!0}),kr(r,Or,{value:null,writable:!0}),kr(r,mn,{value:null,writable:!0}),kr(r,os,{value:null,writable:!0}),kr(r,Ko,{value:e._readableState.endEmitted,writable:!0}),kr(r,Du,{value:function(s,o){var a=n[vn].read();a?(n[bn]=null,n[Or]=null,n[mn]=null,s(Ur(a,!1))):(n[Or]=s,n[mn]=o)},writable:!0}),r));return n[bn]=null,__(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=n[mn];s!==null&&(n[bn]=null,n[Or]=null,n[mn]=null,s(i)),n[os]=i;return}var o=n[Or];o!==null&&(n[bn]=null,n[Or]=null,n[mn]=null,o(Ur(void 0,!0))),n[Ko]=!0}),e.on("readable",A_.bind(null,n)),n};Rg.exports=R_});var Lg=B((zD,Pg)=>{Pg.exports=function(){throw new Error("Readable.from is not available in the browser")}});var Au=B((HD,zg)=>{"use strict";zg.exports=ne;var yi;ne.ReadableState=Og;var GD=nu().EventEmitter,kg=function(e,r){return e.listeners(r).length},cs=iu(),zo=rs().Buffer,D_=globalThis.Uint8Array||function(){};function P_(t){return zo.from(t)}function L_(t){return zo.isBuffer(t)||t instanceof D_}var Pu=du(),$;Pu&&Pu.debuglog?$=Pu.debuglog("stream"):$=function(){};var M_=sg(),Fu=mu(),N_=bu(),k_=N_.getHighWaterMark,Go=gn().codes,O_=Go.ERR_INVALID_ARG_TYPE,U_=Go.ERR_STREAM_PUSH_AFTER_EOF,F_=Go.ERR_METHOD_NOT_IMPLEMENTED,V_=Go.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,mi,Lu,Mu;li()(ne,cs);var as=Fu.errorOrDestroy,Nu=["error","close","destroy","pause","resume"];function q_(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function Og(t,e,r){yi=yi||yn(),t=t||{},typeof r!="boolean"&&(r=e instanceof yi),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=k_(this,t,"readableHighWaterMark",r),this.buffer=new M_,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(mi||(mi=Ru().StringDecoder),this.decoder=new mi(t.encoding),this.encoding=t.encoding)}function ne(t){if(yi=yi||yn(),!(this instanceof ne))return new ne(t);var e=this instanceof yi;this._readableState=new Og(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),cs.call(this)}Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});ne.prototype.destroy=Fu.destroy;ne.prototype._undestroy=Fu.undestroy;ne.prototype._destroy=function(t,e){e(t)};ne.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=zo.from(t,e),e=""),n=!0),Ug(this,t,e,!1,n)};ne.prototype.unshift=function(t){return Ug(this,t,null,!0,!1)};function Ug(t,e,r,n,i){$("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,G_(t,s);else{var o;if(i||(o=K_(s,e)),o)as(t,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==zo.prototype&&(e=P_(e)),n)s.endEmitted?as(t,new V_):ku(t,s,e,!0);else if(s.ended)as(t,new U_);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?ku(t,s,e,!1):Uu(t,s)):ku(t,s,e,!1)}else n||(s.reading=!1,Uu(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function ku(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Ho(t)),Uu(t,e)}function K_(t,e){var r;return!L_(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new O_("chunk",["string","Buffer","Uint8Array"],e)),r}ne.prototype.isPaused=function(){return this._readableState.flowing===!1};ne.prototype.setEncoding=function(t){mi||(mi=Ru().StringDecoder);var e=new mi(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var Mg=1073741824;function z_(t){return t>=Mg?t=Mg:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function Ng(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=z_(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}ne.prototype.read=function(t){$("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return $("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Ou(this):Ho(this),null;if(t=Ng(t,e),t===0&&e.ended)return e.length===0&&Ou(this),null;var n=e.needReadable;$("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,$("length less than watermark",n)),e.ended||e.reading?(n=!1,$("reading or ended",n)):n&&($("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Ng(r,e)));var i;return t>0?i=qg(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Ou(this)),i!==null&&this.emit("data",i),i};function G_(t,e){if($("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Ho(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Fg(t)))}}function Ho(t){var e=t._readableState;$("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||($("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Fg,t))}function Fg(t){var e=t._readableState;$("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Vu(t)}function Uu(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(H_,t,e))}function H_(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if($("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}ne.prototype._read=function(t){as(this,new F_("_read()"))};ne.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,$("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=i?a:g;n.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",o);function o(m,v){$("onunpipe"),m===r&&v&&v.hasUnpiped===!1&&(v.hasUnpiped=!0,c())}function a(){$("onend"),t.end()}var f=W_(r);t.on("drain",f);var u=!1;function c(){$("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",f),t.removeListener("error",l),t.removeListener("unpipe",o),r.removeListener("end",a),r.removeListener("end",g),r.removeListener("data",h),u=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&f()}r.on("data",h);function h(m){$("ondata");var v=t.write(m);$("dest.write",v),v===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&Kg(n.pipes,t)!==-1)&&!u&&($("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function l(m){$("onerror",m),g(),t.removeListener("error",l),kg(t,"error")===0&&as(t,m)}q_(t,"error",l);function d(){t.removeListener("finish",p),g()}t.once("close",d);function p(){$("onfinish"),t.removeListener("close",d),g()}t.once("finish",p);function g(){$("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||($("pipe resume"),r.resume()),t};function W_(t){return function(){var r=t._readableState;$("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&kg(t,"data")&&(r.flowing=!0,Vu(t))}}ne.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Kg(e.pipes,t);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};ne.prototype.on=function(t,e){var r=cs.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,$("on readable",n.length,n.reading),n.length?Ho(this):n.reading||process.nextTick(j_,this)),r};ne.prototype.addListener=ne.prototype.on;ne.prototype.removeListener=function(t,e){var r=cs.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(Vg,this),r};ne.prototype.removeAllListeners=function(t){var e=cs.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(Vg,this),e};function Vg(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function j_(t){$("readable nexttick read 0"),t.read(0)}ne.prototype.resume=function(){var t=this._readableState;return t.flowing||($("resume"),t.flowing=!t.readableListening,$_(this,t)),t.paused=!1,this};function $_(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(Y_,t,e))}function Y_(t,e){$("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Vu(t),e.flowing&&!e.reading&&t.read(0)}ne.prototype.pause=function(){return $("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&($("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Vu(t){var e=t._readableState;for($("flow",e.flowing);e.flowing&&t.read()!==null;);}ne.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if($("wrapped end"),r.decoder&&!r.ended){var o=r.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),t.on("data",function(o){if($("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!(r.objectMode&&o==null)&&!(!r.objectMode&&(!o||!o.length))){var a=e.push(o);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var s=0;s<Nu.length;s++)t.on(Nu[s],this.emit.bind(this,Nu[s]));return this._read=function(o){$("wrapped _read",o),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(ne.prototype[Symbol.asyncIterator]=function(){return Lu===void 0&&(Lu=Dg()),Lu(this)});Object.defineProperty(ne.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(ne.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(ne.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});ne._fromList=qg;Object.defineProperty(ne.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function qg(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function Ou(t){var e=t._readableState;$("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(Z_,e,t))}function Z_(t,e){if($("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(ne.from=function(t,e){return Mu===void 0&&(Mu=Lg()),Mu(ne,t,e)});function Kg(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var qu=B((WD,Hg)=>{"use strict";Hg.exports=mr;var Wo=gn().codes,X_=Wo.ERR_METHOD_NOT_IMPLEMENTED,Q_=Wo.ERR_MULTIPLE_CALLBACK,J_=Wo.ERR_TRANSFORM_ALREADY_TRANSFORMING,e4=Wo.ERR_TRANSFORM_WITH_LENGTH_0,jo=yn();li()(mr,jo);function t4(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new Q_);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function mr(t){if(!(this instanceof mr))return new mr(t);jo.call(this,t),this._transformState={afterTransform:t4.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",r4)}function r4(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){Gg(t,e,r)}):Gg(this,null,null)}mr.prototype.push=function(t,e){return this._transformState.needTransform=!1,jo.prototype.push.call(this,t,e)};mr.prototype._transform=function(t,e,r){r(new X_("_transform()"))};mr.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};mr.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};mr.prototype._destroy=function(t,e){jo.prototype._destroy.call(this,t,function(r){e(r)})};function Gg(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new e4;if(t._transformState.transforming)throw new J_;return t.push(null)}});var $g=B((jD,jg)=>{"use strict";jg.exports=us;var Wg=qu();li()(us,Wg);function us(t){if(!(this instanceof us))return new us(t);Wg.call(this,t)}us.prototype._transform=function(t,e,r){r(null,t)}});var Jg=B(($D,Qg)=>{"use strict";var Ku;function n4(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var Xg=gn().codes,i4=Xg.ERR_MISSING_ARGS,s4=Xg.ERR_STREAM_DESTROYED;function Yg(t){if(t)throw t}function o4(t){return t.setHeader&&typeof t.abort=="function"}function a4(t,e,r,n){n=n4(n);var i=!1;t.on("close",function(){i=!0}),Ku===void 0&&(Ku=Vo()),Ku(t,{readable:e,writable:r},function(o){if(o)return n(o);i=!0,n()});var s=!1;return function(o){if(!i&&!s){if(s=!0,o4(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(o||new s4("pipe"))}}}function Zg(t){t()}function c4(t,e){return t.pipe(e)}function u4(t){return!t.length||typeof t[t.length-1]!="function"?Yg:t.pop()}function f4(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=u4(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new i4("streams");var i,s=e.map(function(o,a){var f=a<e.length-1,u=a>0;return a4(o,f,u,function(c){i||(i=c),c&&s.forEach(Zg),!f&&(s.forEach(Zg),n(i))})});return e.reduce(c4)}Qg.exports=f4});var ty=B((It,ey)=>{It=ey.exports=Au();It.Stream=It;It.Readable=It;It.Writable=Su();It.Duplex=yn();It.Transform=qu();It.PassThrough=$g();It.finished=Vo();It.pipeline=Jg()});var iy=B((YD,ny)=>{"use strict";var{Readable:h4}=ty(),ry=Ja(),l4=(t=1/0)=>{let e=0;return new h4({read(r){if(e>=t)return this.push(null);e+r>=t&&(r=t-e),e+=r,this.push(ry(r))}})};ny.exports={randomStream:l4,randomBytes:ry}});var Z4={};Ye(Z4,{GossipSub:()=>ea,multicodec:()=>Y4});var ys=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},xn=class{constructor(e){this.hwm=e??16,this.head=new ys(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new ys(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}};function Yu(t){return Iy(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function Iy(t,e){e=e??{};let r=e.onEnd,n=new xn,i,s,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((g,m)=>{s=v=>{s=null,n.push(v);try{g(t(n))}catch(S){m(S)}return i}}):t(n),f=g=>s!=null?s(g):(n.push(g),i),u=g=>(n=new xn,s!=null?s({error:g}):(n.push({error:g}),i)),c=g=>o?i:f({done:!1,value:g}),h=g=>o?i:(o=!0,g!=null?u(g):f({done:!0})),l=()=>(n=new xn,h(),{done:!0}),d=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:l,throw:d,push:c,end:h},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(g){return p.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:c,end(g){return p.end(g),r!=null&&(r(g),r=void 0),i}},i}var of=F(sf(),1),Ty=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},af=t=>t!=null&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),oa=t=>t!=null&&typeof t.sink=="function"&&af(t.source),By=t=>e=>{let r=t.sink(e);if(r.then!=null){let n=Yu();return r.then(()=>{n.end()},s=>{n.end(s)}),(0,of.default)(n,async function*(){yield*t.source,n.end()}())}return t.source};function En(t,...e){if(oa(t)){let n=t;t=()=>n.source}else if(af(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&oa(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)oa(r[n])&&(r[n]=By(r[n]));return Ty(...r)}var F0=F(De(),1);function ae(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var ha={};Ye(ha,{identity:()=>ky});function Dy(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,f=t.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,S=p.length;v!==S&&p[v]===0;)v++,g++;for(var C=(S-v)*c+1>>>0,D=new Uint8Array(C);v!==S;){for(var w=p[v],A=0,L=C-1;(w!==0||A<m)&&L!==-1;L--,A++)w+=256*D[L]>>>0,D[L]=w%a>>>0,w=w/a>>>0;if(w!==0)throw new Error("Non-zero carry");m=A,v++}for(var O=C-m;O!==C&&D[O]===0;)O++;for(var G=f.repeat(g);O<C;++O)G+=t.charAt(D[O]);return G}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===f;)m++,g++;for(var S=(p.length-g)*u+1>>>0,C=new Uint8Array(S);p[g];){var D=r[p.charCodeAt(g)];if(D===255)return;for(var w=0,A=S-1;(D!==0||w<v)&&A!==-1;A--,w++)D+=a*C[A]>>>0,C[A]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");v=w,g++}if(p[g]!==" "){for(var L=S-v;L!==S&&C[L]===0;)L++;for(var O=new Uint8Array(m+(S-L)),G=m;L!==S;)O[G++]=C[L++];return O}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Py=Dy,Ly=Py,ff=Ly;var lI=new Uint8Array(0);var hf=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ir=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var lf=t=>new TextEncoder().encode(t),pf=t=>new TextDecoder().decode(t);var aa=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ca=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return gf(this,e)}},ua=class{constructor(e){this.decoders=e}or(e){return gf(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},gf=(t,e)=>new ua({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),fa=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new aa(e,r,n),this.decoder=new ca(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ms=({name:t,prefix:e,encode:r,decode:n})=>new fa(t,e,r,n),br=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=ff(r,e);return ms({prefix:t,name:e,encode:n,decode:s=>ir(i(s))})},My=(t,e,r,n)=>{let i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,f=0,u=0;for(let c=0;c<s;++c){let h=i[t[c]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,a+=r,a>=8&&(a-=8,o[u++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ny=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},Ce=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ms({prefix:e,name:t,encode(i){return Ny(i,n,r)},decode(i){return My(i,n,r,t)}});var ky=ms({prefix:"\0",name:"identity",encode:t=>pf(t),decode:t=>lf(t)});var la={};Ye(la,{base2:()=>Oy});var Oy=Ce({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var pa={};Ye(pa,{base8:()=>Uy});var Uy=Ce({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var da={};Ye(da,{base10:()=>Fy});var Fy=br({prefix:"9",name:"base10",alphabet:"0123456789"});var ga={};Ye(ga,{base16:()=>Vy,base16upper:()=>qy});var Vy=Ce({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qy=Ce({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ya={};Ye(ya,{base32:()=>Ct,base32hex:()=>Hy,base32hexpad:()=>jy,base32hexpadupper:()=>$y,base32hexupper:()=>Wy,base32pad:()=>zy,base32padupper:()=>Gy,base32upper:()=>Ky,base32z:()=>Yy});var Ct=Ce({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ky=Ce({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),zy=Ce({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Gy=Ce({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Hy=Ce({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Wy=Ce({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jy=Ce({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$y=Ce({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yy=Ce({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ma={};Ye(ma,{base36:()=>Zy,base36upper:()=>Xy});var Zy=br({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xy=br({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ba={};Ye(ba,{base58btc:()=>Pe,base58flickr:()=>Qy});var Pe=br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qy=br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var va={};Ye(va,{base64:()=>Sn,base64pad:()=>Jy,base64url:()=>em,base64urlpad:()=>tm});var Sn=Ce({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Jy=Ce({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),em=Ce({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tm=Ce({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Sa={};Ye(Sa,{sha256:()=>Ue,sha512:()=>wm});var rm=bf,yf=128,nm=127,im=~nm,sm=Math.pow(2,31);function bf(t,e,r){e=e||[],r=r||0;for(var n=r;t>=sm;)e[r++]=t&255|yf,t/=128;for(;t&im;)e[r++]=t&255|yf,t>>>=7;return e[r]=t|0,bf.bytes=r-n+1,e}var om=wa,am=128,mf=127;function wa(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw wa.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&mf)<<i:(o&mf)*Math.pow(2,i),i+=7}while(o>=am);return wa.bytes=s-n,r}var cm=Math.pow(2,7),um=Math.pow(2,14),fm=Math.pow(2,21),hm=Math.pow(2,28),lm=Math.pow(2,35),pm=Math.pow(2,42),dm=Math.pow(2,49),gm=Math.pow(2,56),ym=Math.pow(2,63),mm=function(t){return t<cm?1:t<um?2:t<fm?3:t<hm?4:t<lm?5:t<pm?6:t<dm?7:t<gm?8:t<ym?9:10},bm={encode:rm,decode:om,encodingLength:mm},vm=bm,xi=vm;var Ei=t=>[xi.decode(t),xi.decode.bytes],_n=(t,e,r=0)=>(xi.encode(t,e,r),e),In=t=>xi.encodingLength(t);var Nt=(t,e)=>{let r=e.byteLength,n=In(t),i=n+In(r),s=new Uint8Array(i+r);return _n(t,s,0),_n(r,s,n),s.set(e,i),new An(t,r,e,s)},Vr=t=>{let e=ir(t),[r,n]=Ei(e),[i,s]=Ei(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new An(r,i,o,e)},vf=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&hf(t.bytes,e.bytes),An=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var Ea=({name:t,code:e,encode:r})=>new xa(t,e,r),xa=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Nt(this.code,r):r.then(n=>Nt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var xf=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Ue=Ea({name:"sha2-256",code:18,encode:xf("SHA-256")}),wm=Ea({name:"sha2-512",code:19,encode:xf("SHA-512")});var _a={};Ye(_a,{identity:()=>vr});var Ef=0,xm="identity",Sf=ir,Em=t=>Nt(Ef,Sf(t)),vr={code:Ef,name:xm,encode:Sf,digest:Em};var PI=new TextEncoder,LI=new TextDecoder;var ye=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ws,byteLength:ws,code:vs,version:vs,multihash:vs,bytes:vs,_baseCache:ws,asCID:ws})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Si)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Tm)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ye.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Nt(e,r);return ye.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&vf(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return Am(r,i,e||Pe.encoder);default:return Cm(r,i,e||Ct.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Rm(/^0\.0/,Dm),!!(e&&(e[If]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof ye)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new ye(r,n,i,s||_f(r,n,i.bytes))}else if(e!=null&&e[If]===!0){let{version:r,multihash:n,code:i}=e,s=Vr(n);return ye.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Si)throw new Error(`Version 0 CID must use dag-pb (code: ${Si}) block encoding`);return new ye(e,r,n,n.bytes)}case 1:{let i=_f(e,r,n.bytes);return new ye(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return ye.create(0,Si,e)}static createV1(e,r){return ye.create(1,e,r)}static decode(e){let[r,n]=ye.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ye.inspectBytes(e),n=r.size-r.multihashSize,i=ir(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new An(r.multihashCode,r.digestSize,s,i);return[r.version===0?ye.createV0(o):ye.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Ei(e.subarray(r));return r+=l,h},i=n(),s=Si;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),f=n(),u=r+f,c=u-o;return{version:i,codec:s,multihashCode:a,digestSize:f,multihashSize:c,size:u}}static parse(e,r){let[n,i]=Im(e,r),s=ye.decode(i);return s._baseCache.set(n,e),s}},Im=(t,e)=>{switch(t[0]){case"Q":{let r=e||Pe;return[Pe.prefix,r.decode(`${Pe.prefix}${t}`)]}case Pe.prefix:{let r=e||Pe;return[Pe.prefix,r.decode(t)]}case Ct.prefix:{let r=e||Ct;return[Ct.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Am=(t,e,r)=>{let{prefix:n}=r;if(n!==Pe.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},Cm=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},Si=112,Tm=18,_f=(t,e,r)=>{let n=In(t),i=n+In(e),s=new Uint8Array(i+r.byteLength);return _n(t,s,0),_n(e,s,n),s.set(r,i),s},If=Symbol.for("@ipld/js-cid/CID"),vs={writable:!1,configurable:!1,enumerable:!0},ws={writable:!1,enumerable:!1,configurable:!1},Bm="0.0.0-dev",Rm=(t,e)=>{if(t.test(Bm))console.warn(e);else throw new Error(e)},Dm=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var Cn={...ha,...la,...pa,...da,...ga,...ya,...ma,...ba,...va},qI={...Sa,..._a};function Cf(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Af=Cf("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Ia=Cf("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Pm={utf8:Af,"utf-8":Af,hex:Cn.base16,latin1:Ia,ascii:Ia,binary:Ia,...Cn},xs=Pm;function ue(t,e="utf8"){let r=xs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}function Fe(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function j(t,e="utf8"){let r=xs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var Rf=Symbol.for("@achingbrain/uint8arraylist");function Tf(t,e,r){if(e==null||e<0||e>=r)throw new RangeError("index is out of bounds");let n=0;for(let i of t){let s=n+i.byteLength;if(e<s)return{buf:i,index:e-n};n=s}throw new RangeError("index is out of bounds")}function Bf(t){return Boolean(t?.[Rf])}var de=class{constructor(...e){Object.defineProperty(this,Rf,{value:!0}),this.bufs=[],this.length=0,this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Bf(n))r+=n.length,this.bufs=this.bufs.concat(n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=Tf(this.bufs,e,this.length);return r.buf[r.index]}set(e,r){let n=Tf(this.bufs,e,this.length);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(Bf(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return ae(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:ae(n,i)}sublist(e,r){let{bufs:n}=this._subList(e,r),i=new de;return i.appendAll(n),i}_subList(e,r){if(e==null&&r==null)return{bufs:this.bufs,length:this.length};if(e=e??0,r=r??(this.length>0?this.length:0),e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index out of bounds");if(e===r)return{bufs:[],length:0};let n=[],i=0;for(let s of this.bufs){let o=i,a=o+s.byteLength,f=e>=o&&e<a,u=r>o&&r<=a,c=e<o&&r>=a;i=a;let h,l;if(f&&(h=e-o,l=s.byteLength),u&&(l=r-o,h==null&&(h=0)),c&&(h=0,l=s.byteLength),h!=null&&l!=null&&n.push(s.subarray(h,l)),u)break}return{bufs:n,length:r-e}}getInt8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}};function Tn(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var Df=4294967296,Le=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new Le(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new Le(r,n)}toBytes(e,r=0){let n=Tn(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new Le;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Df&&(i=0,++n>Df&&(n=0))),new Le(n,i)}static fromNumber(e){if(e===0)return new Le;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Le(i,n)}static fromBytes(e,r=0){let n=Tn(e),i=new Le,s=0;if(e.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(e.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<e.byteLength)for(;s<5;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};function Kr(t){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}var Lm=Math.pow(2,7),Mm=Math.pow(2,14),Nm=Math.pow(2,21),km=Math.pow(2,28),Om=Math.pow(2,35),Um=Math.pow(2,42),Fm=Math.pow(2,49),Vm=Math.pow(2,56),qm=Math.pow(2,63),V={encodingLength(t){return t<Lm?1:t<Mm?2:t<Nm?3:t<km?4:t<Om?5:t<Um?6:t<Fm?7:t<Vm?8:t<qm?9:10},encode(t,e,r=0){if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=Kr(V.encodingLength(t))),Le.fromNumber(t).toBytes(e,r),e},decode(t,e=0){return Le.fromBytes(t,e).toNumber(!0)}},_i={encodingLength(t){return t<0?10:V.encodingLength(t)},encode(t,e,r=0){return e==null&&(e=Kr(_i.encodingLength(t))),t<0?(Le.fromNumber(t).toBytes(e,r),e):V.encode(t,e)},decode(t,e=0){return Le.fromBytes(t,e).toNumber(!1)}},Es={encodingLength(t){return V.encodingLength(t>=0?t*2:t*-2-1)},encode(t,e,r=0){return t=t>=0?t*2:t*-2-1,V.encode(t,e,r)},decode(t,e=0){let r=V.decode(t,e);return(r&1)!==0?(r+1)/-2:r/2}};function Bn(t){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ss(t,e){let r=Bn(V.encodingLength(t.byteLength));return V.encode(t.byteLength,r),e.decode(new de(r,t),0)}function _s(t,e){let r=e.encode(t),n=V.encodingLength(V.decode(r));return r instanceof Uint8Array?new de(r.subarray(n)):r.sublist(n)}var z;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(z||(z={}));function Z(t,e,r,n,i){return{name:t,type:e,encode:r,decode:n,encodingLength:i}}var Km=function(){return 1},zm=function(e){return Uint8Array.from([e?1:0])},Gm=function(e,r){return e.get(r)>0},Hm=Z("bool",z.VARINT,zm,Gm,Km);var Wm=function(e){let r=e.byteLength;return V.encodingLength(r)+r},jm=function(e){return new de(V.encode(e.byteLength),e)},$m=function(e,r){let n=V.decode(e,r);return r+=V.encodingLength(n),e.subarray(r,r+n)},Is=Z("bytes",z.LENGTH_DELIMITED,jm,$m,Wm);var Pf=function(){return 8},Ym=function(e){let r=new de(new Uint8Array(Pf(e)));return r.setFloat64(0,e,!0),r},Zm=function(e,r){return e.getFloat64(r,!0)},Xm=Z("double",z.BIT64,Ym,Zm,Pf);function Aa(t){function e(s){if(t[s.toString()]==null)throw new Error("Invalid enum value");return typeof s=="number"?s:t[s]}let r=function(o){return V.encodingLength(e(o))},n=function(o){let a=e(o),f=Bn(V.encodingLength(a));return V.encode(a,f),f},i=function(o,a){let u=V.decode(o,a).toString();if(t[u]==null)throw new Error("Invalid enum value");return t[u]};return Z("enum",z.VARINT,n,i,r)}var Lf=function(){return 4},Qm=function(e){let r=new de(new Uint8Array(Lf(e)));return r.setInt32(0,e,!0),r},Jm=function(e,r){return e.getInt32(r,!0)},e1=Z("fixed32",z.BIT32,Qm,Jm,Lf);var Mf=function(e){return 8},t1=function(e){let r=new de(new Uint8Array(Mf(e)));return r.setBigInt64(0,e,!0),r},r1=function(e,r){return e.getBigInt64(r,!0)},n1=Z("fixed64",z.BIT64,t1,r1,Mf);var Nf=function(){return 4},i1=function(e){let r=new de(new Uint8Array(Nf(1)));return r.setFloat32(0,e,!0),r},s1=function(e,r){return e.getFloat32(r,!0)},o1=Z("float",z.BIT32,i1,s1,Nf);var kf=function(e){return e<0?10:_i.encodingLength(e)},a1=function(e){let r=new Uint8Array(kf(e));return _i.encode(e,r)},c1=function(e,r){return _i.decode(e,r)|0},u1=Z("int32",z.VARINT,a1,c1,kf);var Of=0x7fn,wr={encodingLength(t){let e=0;for(;t>=0x80n;e++)t>>=7n;return e+1},encode(t,e,r=0){e==null&&(e=Kr(wr.encodingLength(t)));let n=Tn(e);for(;Of<t;)n.set(r++,Number(t&Of)|128),t>>=7n;return n.set(r,Number(t)),e},decode(t,e=0){return Le.fromBytes(t,e).toBigInt(!0)}},Ii={encodingLength(t){return t<0n?10:wr.encodingLength(t)},encode(t,e,r=0){return e==null&&(e=Kr(Ii.encodingLength(t))),t<0n?(Le.fromBigInt(t).toBytes(e,r),e):wr.encode(t,e,r)},decode(t,e=0){return Le.fromBytes(t,e).toBigInt(!1)}},Ai={encodingLength(t){return wr.encodingLength(t>=0?t*2n:t*-2n-1n)},encode(t,e,r=0){return e==null&&(e=Kr(Ai.encodingLength(t))),Le.fromBigInt(t).zzEncode().toBytes(e,r),e},decode(t,e=0){return Le.fromBytes(t,e).zzDecode().toBigInt(!1)}};var Uf=function(e){return e<0n?10:Ii.encodingLength(e)},f1=function(e){let r=new Uint8Array(Uf(e));return Ii.encode(e,r)},h1=function(e,r){return Ii.decode(e,r)|0n},l1=Z("int64",z.VARINT,f1,h1,Uf);function As(t){let e=function(s){let o=0;for(let a of Object.values(t))o+=a.codec.encodingLength(s[a.name]);return V.encodingLength(o)+o},r=function(s){let o=new de;function a(u,c,h){if(u==null){if(h.optional===!0)return;throw new Error(`Non optional field "${h.name}" was ${u===null?"null":"undefined"}`)}let l=c<<3|h.codec.type,d=Bn(V.encodingLength(l));V.encode(l,d);let p=h.codec.encode(u);o.append(d),o.append(p)}for(let[u,c]of Object.entries(t)){let h=parseInt(u);if(c.repeats===!0){if(!Array.isArray(s[c.name]))throw new Error(`Repeating field "${c.name}" was not an array`);for(let l of s[c.name])a(l,h,c)}else a(s[c.name],h,c)}let f=V.encode(o.length);return new de(f,o)},n=function(s,o){let a=V.decode(s,o);o+=V.encodingLength(a);let f=o+a,u={};for(;o<f;){let c=V.decode(s,o);o+=V.encodingLength(c);let h=c&7,l=c>>3,d=t[l],p=0;if(h===z.VARINT)if(d!=null){let g=d.codec.decode(s,o);p=d.codec.encodingLength(g)}else{let g=V.decode(s,o);p=V.encodingLength(g)}else if(h===z.BIT64)p=8;else if(h===z.LENGTH_DELIMITED){let g=V.decode(s,o);p=g+V.encodingLength(g)}else if(h===z.BIT32)p=4;else{if(h===z.START_GROUP)throw new Error("Unsupported wire type START_GROUP");if(h===z.END_GROUP)throw new Error("Unsupported wire type END_GROUP")}if(d!=null){let g=d.codec.decode(s,o);d.repeats===!0?(u[d.name]==null&&(u[d.name]=[]),u[d.name].push(g)):u[d.name]=g}o+=p}for(let c of Object.values(t))c.repeats===!0&&u[c.name]==null&&(u[c.name]=[]);return u};return Z("message",z.LENGTH_DELIMITED,r,n,e)}var Ff=function(){return 4},p1=function(e){let r=new de(new Uint8Array(Ff(e)));return r.setInt32(0,e,!0),r},d1=function(e,r){return e.getInt32(r,!0)},g1=Z("sfixed32",z.BIT32,p1,d1,Ff);var Vf=function(){return 8},y1=function(e){let r=new de(new Uint8Array(Vf(e)));return r.setBigInt64(0,e,!0),r},m1=function(e,r){return e.getBigInt64(r,!0)},b1=Z("sfixed64",z.BIT64,y1,m1,Vf);var v1=function(e){return Es.encodingLength(e)},w1=function(e){return Es.encode(e)},x1=function(e,r){return Es.decode(e,r)},E1=Z("sint32",z.VARINT,w1,x1,v1);var S1=function(e){return Ai.encodingLength(e)},_1=function(e){return Ai.encode(e)},I1=function(e,r){return Ai.decode(e,r)},A1=Z("sint64",z.VARINT,_1,I1,S1);var C1=function(e){let r=ue(e).byteLength;return V.encodingLength(r)+r},T1=function(e){let r=ue(e);return new de(V.encode(r.byteLength),r)},B1=function(e,r){let n=V.decode(e,r);return r+=V.encodingLength(n),j(e.subarray(r,r+n))},R1=Z("string",z.LENGTH_DELIMITED,T1,B1,C1);var D1=function(e){return V.encodingLength(e)},P1=function(e){return V.encode(e)},L1=function(e,r){return V.decode(e,r)},M1=Z("uint32",z.VARINT,P1,L1,D1);var N1=function(e){return wr.encodingLength(e)},k1=function(e){return wr.encode(e)},O1=function(e,r){return wr.decode(e,r)},U1=Z("uint64",z.VARINT,k1,O1,N1);var Te;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(Te||(Te={}));var Ca;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ca||(Ca={}));(function(t){t.codec=()=>Aa(Ca)})(Te||(Te={}));var kt;(function(t){t.codec=()=>As({1:{name:"Type",codec:Te.codec()},2:{name:"Data",codec:Is}}),t.encode=e=>_s(e,t.codec()),t.decode=e=>Ss(e,t.codec())})(kt||(kt={}));var Ot;(function(t){t.codec=()=>As({1:{name:"Type",codec:Te.codec()},2:{name:"Data",codec:Is}}),t.encode=e=>_s(e,t.codec()),t.decode=e=>Ss(e,t.codec())})(Ot||(Ot={}));var OC=F(Ri(),1),UC=F(tl(),1),n2=F(fe(),1),o0=F(De(),1);var uw=F(De(),1);var st={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var fw=F(De(),1);var L3=F(Me(),1),M3=F(Ks(),1),nl=F(fe(),1);function Rt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ae([new Uint8Array(e-r.length),r])}return j(r,"base64url")}function lt(t){let e=il(t);return new nl.default.jsbn.BigInteger(j(e,"base16"),16)}function il(t,e){let r=ue(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ae([new Uint8Array(e-r.length),r])}return r}var hw={"P-256":256,"P-384":384,"P-521":521},lw=Object.keys(hw),G3=lw.join(" / ");function Za(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",s=t?.saltLength??16,o=t?.iterations??32767,a=st.get();r*=8;async function f(h,l){let d=a.getRandomValues(new Uint8Array(s)),p=a.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=ue(l));let m={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},v=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),S=await a.subtle.deriveKey(m,v,{name:e,length:r},!0,["encrypt"]),C=await a.subtle.encrypt(g,S,h);return ae([d,g.iv,new Uint8Array(C)])}async function u(h,l){let d=h.slice(0,s),p=h.slice(s,s+n),g=h.slice(s+n),m={name:e,iv:p};typeof l=="string"&&(l=ue(l));let v={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},S=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),C=await a.subtle.deriveKey(v,S,{name:e,length:r},!0,["decrypt"]),D=await a.subtle.decrypt(m,C,g);return new Uint8Array(D)}return{encrypt:f,decrypt:u}}var ic={};Ye(ic,{RsaPrivateKey:()=>kn,RsaPublicKey:()=>Ni,fromJwk:()=>Sw,generateKeyPair:()=>_w,unmarshalRsaPrivateKey:()=>xw,unmarshalRsaPublicKey:()=>Ew});var nc=F(De(),1);var xC=F(fl(),1),Mi=F(fe(),1);var ll=F(Ja(),1),pl=F(De(),1);function Ir(t){if(isNaN(t)||t<=0)throw(0,pl.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return(0,ll.default)(t)}var Yr={};Ye(Yr,{jwkToPkcs1:()=>yw,jwkToPkix:()=>bw,pkcs1ToJwk:()=>gw,pkixToJwk:()=>mw});var nC=F(Ri(),1),iC=F(Hs(),1),cr=F(fe(),1);var ec=F(De(),1);function gw(t){let e=cr.default.asn1.fromDer(j(t,"ascii")),r=cr.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Rt(r.n),e:Rt(r.e),d:Rt(r.d),p:Rt(r.p),q:Rt(r.q),dp:Rt(r.dP),dq:Rt(r.dQ),qi:Rt(r.qInv),alg:"RS256"}}function yw(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw(0,ec.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=cr.default.pki.privateKeyToAsn1({n:lt(t.n),e:lt(t.e),d:lt(t.d),p:lt(t.p),q:lt(t.q),dP:lt(t.dp),dQ:lt(t.dq),qInv:lt(t.qi)});return ue(cr.default.asn1.toDer(e).getBytes(),"ascii")}function mw(t){let e=cr.default.asn1.fromDer(j(t,"ascii")),r=cr.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Rt(r.n),e:Rt(r.e)}}function bw(t){if(t.n==null||t.e==null)throw(0,ec.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=cr.default.pki.publicKeyToAsn1({n:lt(t.n),e:lt(t.e)});return ue(cr.default.asn1.toDer(e).getBytes(),"ascii")}var cC=F(Hs(),1),tc=F(fe(),1);function dl(t,e){return e.map(r=>lt(t[r]))}function gl(t){return tc.default.pki.setRsaPrivateKey(...dl(t,["n","e","d","p","q","dp","dq","qi"]))}function yl(t){return tc.default.pki.setRsaPublicKey(...dl(t,["n","e"]))}var ml=F(De(),1);async function bl(t){let e=await st.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await xl(e);return{privateKey:r[0],publicKey:r[1]}}async function rc(t){let r=[await st.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await vw(t)],n=await xl({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function vl(t,e){let r=await st.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await st.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function wl(t,e,r){let n=await st.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await st.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function xl(t){if(t.privateKey==null||t.publicKey==null)throw(0,ml.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([st.get().subtle.exportKey("jwk",t.privateKey),st.get().subtle.exportKey("jwk",t.publicKey)])}async function vw(t){return await st.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function El(t,e,r,n){let i=e?yl(t):gl(t),s=j(Uint8Array.from(r),"ascii"),o=n(s,i);return ue(o,"ascii")}function Sl(t,e){return El(t,!0,e,(r,n)=>n.encrypt(r))}function _l(t,e){return El(t,!1,e,(r,n)=>n.decrypt(r))}async function Nn(t,e){let n=await Za().encrypt(t,e);return Sn.encode(n)}var Ni=class{constructor(e){this._key=e}async verify(e,r){return await wl(this._key,r,e)}marshal(){return Yr.jwkToPkix(this._key)}get bytes(){return kt.encode({Type:Te.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Sl(this._key,e)}equals(e){return Fe(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ue.digest(this.bytes);return e}},kn=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ir(16)}async sign(e){return await vl(this._key,e)}get public(){if(this._publicKey==null)throw(0,nc.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Ni(this._publicKey)}decrypt(e){return _l(this._key,e)}marshal(){return Yr.jwkToPkcs1(this._key)}get bytes(){return Ot.encode({Type:Te.RSA,Data:this.marshal()}).subarray()}equals(e){return Fe(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ue.digest(this.bytes);return e}async id(){let e=await this.public.hash();return j(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Mi.default.util.ByteBuffer(this.marshal()),i=Mi.default.asn1.fromDer(n),s=Mi.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Mi.default.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return await Nn(this.bytes,e);throw(0,nc.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function xw(t){let e=Yr.pkcs1ToJwk(t),r=await rc(e);return new kn(r.privateKey,r.publicKey)}function Ew(t){let e=Yr.pkixToJwk(t);return new Ni(e)}async function Sw(t){let e=await rc(t);return new kn(e.privateKey,e.publicKey)}async function _w(t){let e=await bl(t);return new kn(e.privateKey,e.publicKey)}var pc={};Ye(pc,{Ed25519PrivateKey:()=>Xr,Ed25519PublicKey:()=>Vi,generateKeyPair:()=>Fw,generateKeyPairFromSeed:()=>Vl,unmarshalEd25519PrivateKey:()=>Ow,unmarshalEd25519PublicKey:()=>Uw});var lc=F(De(),1);var Tl=F(Pn(),1);var qe=BigInt(0),J=BigInt(1),et=BigInt(2),Bl=BigInt(255),Il=et**BigInt(252)+BigInt("27742317777372353535851937790883648493"),Ee={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:et**Bl-BigInt(19),l:Il,n:Il,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};var Rl=et**BigInt(256),ki=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),SC=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Iw=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Aw=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Cw=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Tw=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Q=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof Ae))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Ae.ZERO)?Q.ZERO:new Q(e.x,e.y,J,I(e.x*e.y))}static toAffineBatch(e){let r=Dw(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Al(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,f=I(r*a),u=I(s*i),c=I(n*a),h=I(o*i);return f===u&&c===h}negate(){return new Q(I(-this.x),this.y,this.z,I(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=Ee,s=I(e**et),o=I(r**et),a=I(et*I(n**et)),f=I(i*s),u=I(I((e+r)**et)-s-o),c=f+o,h=c-a,l=f-o,d=I(u*h),p=I(c*l),g=I(u*l),m=I(h*c);return new Q(d,p,m,g)}add(e){Al(e);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:f,t:u}=e,c=I((n-r)*(a+o)),h=I((n+r)*(a-o)),l=I(h-c);if(l===qe)return this.double();let d=I(i*et*u),p=I(s*et*f),g=p+d,m=h+c,v=p-d,S=I(g*l),C=I(m*v),D=I(g*v),w=I(l*m);return new Q(S,C,w,D)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Q.BASE)&&(r=Ae.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&cc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Q.normalizeZ(i),cc.set(r,i)));let s=Q.ZERO,o=Q.ZERO,a=1+256/n,f=2**(n-1),u=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*f,p=Number(e&u);if(e>>=h,p>f&&(p-=c,e+=J),p===0){let g=i[d];l%2&&(g=g.negate()),o=o.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),s=s.add(g)}}return Q.normalizeZ([s,o])[0]}multiply(e,r){return this.wNAF(Ws(e,Ee.l),r)}multiplyUnsafe(e){let r=Ws(e,Ee.l,!1),n=Q.BASE,i=Q.ZERO;if(r===qe)return i;if(this.equals(i)||r===J)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>qe;)r&J&&(s=s.add(o)),o=o.double(),r>>=J;return s}isSmallOrder(){return this.multiplyUnsafe(Ee.h).equals(Q.ZERO)}isTorsionFree(){return this.multiplyUnsafe(Ee.l).equals(Q.ZERO)}toAffine(e=js(this.z)){let{x:r,y:n,z:i}=this,s=I(r*e),o=I(n*e);if(I(i*e)!==J)throw new Error("invZ was invalid");return new Ae(s,o)}fromRistrettoBytes(){oc()}toRistrettoBytes(){oc()}fromRistrettoHash(){oc()}};Q.BASE=new Q(Ee.Gx,Ee.Gy,J,I(Ee.Gx*Ee.Gy));Q.ZERO=new Q(qe,J,J,qe);function Al(t){if(!(t instanceof Q))throw new TypeError("ExtendedPoint expected")}function sc(t){if(!(t instanceof ot))throw new TypeError("RistrettoPoint expected")}function oc(){throw new Error("Legacy method: switch to RistrettoPoint")}var ot=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=Ee,n=I(ki*e*e),i=I((n+J)*Cw),s=BigInt(-1),o=I((s-r*n)*I(n+r)),{isValid:a,value:f}=fc(i,o),u=I(f*e);Cr(u)||(u=I(-u)),a||(f=u),a||(s=n);let c=I(s*(n-J)*Tw-o),h=f*f,l=I((f+f)*o),d=I(c*Iw),p=I(J-h),g=I(J+h);return new Q(I(l*g),I(p*d),I(d*g),I(l*p))}static hashToCurve(e){e=Tr(e,64);let r=ac(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=ac(e.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new ot(n.add(s))}static fromHex(e){e=Tr(e,32);let{a:r,d:n}=Ee,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=ac(e);if(!Lw(Oi(s),e)||Cr(s))throw new Error(i);let o=I(s*s),a=I(J+r*o),f=I(J-r*o),u=I(a*a),c=I(f*f),h=I(r*n*u-c),{isValid:l,value:d}=Cl(I(h*c)),p=I(d*f),g=I(d*p*h),m=I((s+s)*p);Cr(m)&&(m=I(-m));let v=I(a*g),S=I(m*v);if(!l||Cr(S)||v===qe)throw new Error(i);return new ot(new Q(m,v,J,S))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,s=I(I(n+r)*I(n-r)),o=I(e*r),{value:a}=Cl(I(s*o**et)),f=I(a*s),u=I(a*o),c=I(f*u*i),h;if(Cr(i*c)){let d=I(r*ki),p=I(e*ki);e=d,r=p,h=I(f*Aw)}else h=u;Cr(e*c)&&(r=I(-r));let l=I((n-r)*h);return Cr(l)&&(l=I(-l)),Oi(l)}toHex(){return Ui(this.toRawBytes())}toString(){return this.toHex()}equals(e){sc(e);let r=this.ep,n=e.ep,i=I(r.x*n.y)===I(r.y*n.x),s=I(r.y*n.y)===I(r.x*n.x);return i||s}add(e){return sc(e),new ot(this.ep.add(e.ep))}subtract(e){return sc(e),new ot(this.ep.subtract(e.ep))}multiply(e){return new ot(this.ep.multiply(e))}multiplyUnsafe(e){return new ot(this.ep.multiplyUnsafe(e))}};ot.BASE=new ot(Q.BASE);ot.ZERO=new ot(Q.ZERO);var cc=new WeakMap,Ae=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,cc.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=Ee;e=Tr(e,32);let s=e.slice();s[31]=e[31]&-129;let o=On(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=Rl)throw new Error("Expected 0 < hex < 2**256");let a=I(o*o),f=I(a-J),u=I(n*a+J),{isValid:c,value:h}=fc(f,u);if(!c)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&J)===J;return(e[31]&128)!==0!==l&&(h=I(-h)),new Ae(h,o)}static async fromPrivateKey(e){return(await $s(e)).point}toRawBytes(){let e=Oi(this.y);return e[31]|=this.x&J?128:0,e}toHex(){return Ui(this.toRawBytes())}toX25519(){let{y:e}=this,r=I((J+e)*js(J-e));return Oi(r)}isTorsionFree(){return Q.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Ae(I(-this.x),this.y)}add(e){return Q.fromAffine(this).add(Q.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Q.fromAffine(this).multiply(e,this).toAffine()}};Ae.BASE=new Ae(Ee.Gx,Ee.Gy);Ae.ZERO=new Ae(qe,J);var Zr=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Tr(e,64),n=Ae.fromHex(r.slice(0,32),!1),i=On(r.slice(32,64));return new Zr(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Ae))throw new Error("Expected Point instance");return Ws(r,Ee.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Oi(this.s),32),e}toHex(){return Ui(this.toRawBytes())}};function Bw(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var Rw=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ui(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Rw[t[r]];return e}function Dl(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function Pl(t){let r=t.toString(16).padStart(64,"0");return Dl(r)}function Oi(t){return Pl(t).reverse()}function Cr(t){return(I(t)&J)===J}function On(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Ui(Uint8Array.from(t).reverse()))}function ac(t){return I(On(t)&et**Bl-J)}function I(t,e=Ee.P){let r=t%e;return r>=qe?r:e+r}function js(t,e=Ee.P){if(t===qe||e<=qe)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=I(t,e),n=e,i=qe,s=J,o=J,a=qe;for(;r!==qe;){let u=n/r,c=n%r,h=i-o*u,l=s-a*u;n=r,r=c,i=o,s=a,o=h,a=l}if(n!==J)throw new Error("invert: does not exist");return I(i,e)}function Dw(t,e=Ee.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===qe?s:(r[a]=s,I(s*o,e)),J),i=js(n,e);return t.reduceRight((s,o,a)=>o===qe?s:(r[a]=I(s*r[a],e),I(s*o,e)),i),r}function Gt(t,e){let{P:r}=Ee,n=t;for(;e-- >qe;)n*=n,n%=r;return n}function Pw(t){let{P:e}=Ee,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),f=t*t%e*t%e,u=Gt(f,et)*f%e,c=Gt(u,J)*t%e,h=Gt(c,r)*c%e,l=Gt(h,n)*h%e,d=Gt(l,i)*l%e,p=Gt(d,s)*d%e,g=Gt(p,o)*p%e,m=Gt(g,o)*p%e,v=Gt(m,n)*h%e;return{pow_p_5_8:Gt(v,et)*t%e,b2:f}}function fc(t,e){let r=I(e*e*e),n=I(r*r*e),i=Pw(t*n).pow_p_5_8,s=I(t*r*i),o=I(e*s*s),a=s,f=I(s*ki),u=o===t,c=o===I(-t),h=o===I(-t*ki);return u&&(s=a),(c||h)&&(s=f),Cr(s)&&(s=I(-s)),{isValid:u||c,value:s}}function Cl(t){return fc(J,t)}async function uc(...t){let e=await Fi.sha512(Bw(...t)),r=On(e);return I(r,Ee.l)}function Lw(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Tr(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):Dl(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Ws(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(qe<t)return t}else if(qe<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Mw(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}async function $s(t){if(t=typeof t=="bigint"||typeof t=="number"?Pl(Ws(t,Rl)):Tr(t),t.length!==32)throw new Error("Expected 32 bytes");let e=await Fi.sha512(t),r=Mw(e.slice(0,32)),n=e.slice(32,64),i=I(On(r),Ee.l),s=Ae.BASE.multiply(i),o=s.toRawBytes();return{head:r,prefix:n,scalar:i,point:s,pointBytes:o}}async function hc(t){return(await $s(t)).pointBytes}async function Ll(t,e){t=Tr(t);let{prefix:r,scalar:n,pointBytes:i}=await $s(e),s=await uc(r,t),o=Ae.BASE.multiply(s),a=await uc(o.toRawBytes(),i,t),f=I(s+a*n,Ee.l);return new Zr(o,f).toRawBytes()}async function Ml(t,e,r){e=Tr(e),r instanceof Ae||(r=Ae.fromHex(r,!1));let{r:n,s:i}=t instanceof Zr?t.assertValidity():Zr.fromHex(t),s=Q.BASE.multiplyUnsafe(i),o=await uc(n.toRawBytes(),r.toRawBytes(),e),a=Q.fromAffine(r).multiplyUnsafe(o);return Q.fromAffine(n).add(a).subtract(s).multiplyUnsafe(Ee.h).equals(Q.ZERO)}Ae.BASE._setWindowSize(8);var Ar={node:Tl.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Fi={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:Ui,getExtendedPublicKey:$s,mod:I,invert:js,hashToPrivateScalar:t=>{if(t=Tr(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=I(On(t),Ee.l);if(e===qe||e===J)throw new Error("Invalid private key");return e},randomBytes:(t=32)=>{if(Ar.web)return Ar.web.getRandomValues(new Uint8Array(t));if(Ar.node){let{randomBytes:e}=Ar.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Fi.randomBytes(32),sha512:async t=>{if(Ar.web){let e=await Ar.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(Ar.node)return Uint8Array.from(Ar.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Ae.BASE){let r=e.equals(Ae.BASE)?e:new Ae(e.x,e.y);return r._setWindowSize(t),r.multiply(et),r}};var Un=32,ur=64,Ys=32;async function Nl(){let t=Fi.randomPrivateKey(),e=await hc(t);return{privateKey:Fl(t,e),publicKey:e}}async function kl(t){if(t.length!==Ys)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await hc(e);return{privateKey:Fl(e,r),publicKey:r}}async function Ol(t,e){let r=t.slice(0,Ys);return await Ll(e,r)}async function Ul(t,e,r){return await Ml(e,r,t)}function Fl(t,e){let r=new Uint8Array(ur);for(let n=0;n<Ys;n++)r[n]=t[n],r[Ys+n]=e[n];return r}var Vi=class{constructor(e){this._key=Fn(e,Un)}async verify(e,r){return await Ul(this._key,r,e)}marshal(){return this._key}get bytes(){return kt.encode({Type:Te.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Fe(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ue.digest(this.bytes);return e}},Xr=class{constructor(e,r){this._key=Fn(e,ur),this._publicKey=Fn(r,Un)}async sign(e){return await Ol(this._key,e)}get public(){return new Vi(this._publicKey)}marshal(){return this._key}get bytes(){return Ot.encode({Type:Te.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Fe(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ue.digest(this.bytes);return e}async id(){let e=await vr.digest(this.public.bytes);return Pe.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await Nn(this.bytes,e);throw(0,lc.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function Ow(t){if(t.length>ur){t=Fn(t,ur+Un);let n=t.slice(0,ur),i=t.slice(ur,t.length);return new Xr(n,i)}t=Fn(t,ur);let e=t.slice(0,ur),r=t.slice(Un);return new Xr(e,r)}function Uw(t){return t=Fn(t,Un),new Vi(t)}async function Fw(){let{privateKey:t,publicKey:e}=await Nl();return new Xr(t,e)}async function Vl(t){let{privateKey:e,publicKey:r}=await kl(t);return new Xr(e,r)}function Fn(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw(0,lc.default)(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}var xc={};Ye(xc,{Secp256k1PrivateKey:()=>Hi,Secp256k1PublicKey:()=>Gi,generateKeyPair:()=>r2,unmarshalSecp256k1PrivateKey:()=>e2,unmarshalSecp256k1PublicKey:()=>t2});var s0=F(De(),1);var zn=F(De(),1);var Vw=F(Pn(),1);var ie=BigInt(0),ge=BigInt(1),Ne=BigInt(2),Ki=BigInt(3),qw=BigInt(8),yc=Ne**BigInt(256),be={a:ie,b:BigInt(7),P:yc-Ne**BigInt(32)-BigInt(977),n:yc-BigInt("432420386565659656852420866394968145599"),h:ge,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function ql(t){let{a:e,b:r}=be,n=M(t*t),i=M(n*t);return M(i+e*t+r)}var Zs=be.a===ie,oe=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof se))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new oe(e.x,e.y,ge)}static toAffineBatch(e){let r=Hw(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return oe.toAffineBatch(e).map(oe.fromAffine)}equals(e){if(!(e instanceof oe))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,f=M(i**Ne),u=M(a**Ne),c=M(r*u),h=M(s*f),l=M(M(n*a)*u),d=M(M(o*i)*f);return c===h&&l===d}negate(){return new oe(this.x,M(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=M(e**Ne),s=M(r**Ne),o=M(s**Ne),a=M(Ne*(M((e+s)**Ne)-i-o)),f=M(Ki*i),u=M(f**Ne),c=M(u-Ne*a),h=M(f*(a-c)-qw*o),l=M(Ne*r*n);return new oe(c,h,l)}add(e){if(!(e instanceof oe))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e;if(s===ie||o===ie)return this;if(r===ie||n===ie)return e;let f=M(i**Ne),u=M(a**Ne),c=M(r*u),h=M(s*f),l=M(M(n*a)*u),d=M(M(o*i)*f),p=M(h-c),g=M(d-l);if(p===ie)return g===ie?this.double():oe.ZERO;let m=M(p**Ne),v=M(p*m),S=M(c*m),C=M(g**Ne-v-Ne*S),D=M(g*(S-C)-l*v),w=M(i*a*p);return new oe(C,D,w)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=oe.ZERO;if(typeof e=="bigint"&&e===ie)return r;let n=Gl(e);if(n===ge)return this;if(!Zs){let h=r,l=this;for(;n>ie;)n&ge&&(h=h.add(l)),l=l.double(),n>>=ge;return h}let{k1neg:i,k1:s,k2neg:o,k2:a}=Wl(n),f=r,u=r,c=this;for(;s>ie||a>ie;)s&ge&&(f=f.add(c)),a&ge&&(u=u.add(c)),c=c.double(),s>>=ge,a>>=ge;return i&&(f=f.negate()),o&&(u=u.negate()),u=new oe(M(u.x*be.beta),u.y,u.z),f.add(u)}precomputeWindow(e){let r=Zs?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(oe.BASE)&&(r=se.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&mc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=oe.normalizeZ(i),mc.set(r,i)));let s=oe.ZERO,o=oe.ZERO,a=1+(Zs?128/n:256/n),f=2**(n-1),u=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let l=0;l<a;l++){let d=l*f,p=Number(e&u);if(e>>=h,p>f&&(p-=c,e+=ge),p===0){let g=i[d];l%2&&(g=g.negate()),o=o.add(g)}else{let g=i[d+Math.abs(p)-1];p<0&&(g=g.negate()),s=s.add(g)}}return{p:s,f:o}}multiply(e,r){let n=Gl(e),i,s;if(Zs){let{k1neg:o,k1:a,k2neg:f,k2:u}=Wl(n),{p:c,f:h}=this.wNAF(a,r),{p:l,f:d}=this.wNAF(u,r);o&&(c=c.negate()),f&&(l=l.negate()),l=new oe(M(l.x*be.beta),l.y,l.z),i=c.add(l),s=h.add(d)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return oe.normalizeZ([i,s])[0]}toAffine(e=Kn(this.z)){let{x:r,y:n,z:i}=this,s=e,o=M(s*s),a=M(o*s),f=M(r*o),u=M(n*a);if(M(i*s)!==ge)throw new Error("invZ was invalid");return new se(f,u)}};oe.BASE=new oe(be.Gx,be.Gy,ge);oe.ZERO=new oe(ie,ge,ie);var mc=new WeakMap,se=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,mc.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=Wt(r?e:e.subarray(1));if(!gc(n))throw new Error("Point is not on curve");let i=ql(n),s=Gw(i),o=(s&ge)===ge;r?o&&(s=M(-s)):(e[0]&1)===1!==o&&(s=M(-s));let a=new se(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=Wt(e.subarray(1,33)),n=Wt(e.subarray(33,65)),i=new se(r,n);return i.assertValidity(),i}static fromHex(e){let r=en(e),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return se.BASE.multiply(Qr(e))}static fromSignature(e,r,n){e=en(e);let i=jl(e),{r:s,s:o}=$l(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let a=n&1?"03":"02",f=se.fromHex(a+Jr(s)),{n:u}=be,c=Kn(s,u),h=M(-i*c,u),l=M(o*c,u),d=se.BASE.multiplyAndAddUnsafe(f,h,l);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return Br(this.toHex(e))}toHex(e=!1){let r=Jr(this.x);return e?`${this.y&ge?"03":"02"}${r}`:`04${r}${Jr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!gc(r)||!gc(n))throw new Error(e);let i=M(n*n),s=ql(r);if(M(i-s)!==ie)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new se(this.x,M(-this.y))}double(){return oe.fromAffine(this).double().toAffine()}add(e){return oe.fromAffine(this).add(oe.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return oe.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=oe.fromAffine(this),s=r===ie||r===ge||this!==se.BASE?i.multiplyUnsafe(r):i.multiply(r),o=oe.fromAffine(e).multiplyUnsafe(n),a=s.add(o);return a.equals(oe.ZERO)?void 0:a.toAffine()}};se.BASE=new se(be.Gx,be.Gy);se.ZERO=new se(ie,ie);function Kl(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function zl(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${qn(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Wt(r),left:t.subarray(e+2)}}function Kw(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${qn(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=zl(t.subarray(2)),{data:n,left:i}=zl(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${qn(i)}`);return{r:e,s:n}}var Ht=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=Js(e),n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?qn(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Ht(eo(i.slice(0,64)),eo(i.slice(64,128)))}static fromDER(e){let r=Js(e);if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Kw(r?e:Br(e));return new Ht(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!zi(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!zi(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=be.n>>ge;return this.s>e}normalizeS(){return this.hasHighS()?new Ht(this.r,be.n-this.s):this}toDERRawBytes(e=!1){return Br(this.toDERHex(e))}toDERHex(e=!1){let r=Kl(qi(this.s));if(e)return r;let n=Kl(qi(this.r)),i=qi(n.length/2),s=qi(r.length/2);return`30${qi(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Br(this.toCompactHex())}toCompactHex(){return Jr(this.r)+Jr(this.s)}};function Vn(...t){if(!t.every(Js))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function Js(t){return t instanceof Uint8Array}var zw=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function qn(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=zw[t[r]];return e}function Jr(t){if(t>yc)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function dc(t){return Br(Jr(t))}function qi(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function eo(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Br(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function Wt(t){return eo(qn(t))}function en(t){return t instanceof Uint8Array?Uint8Array.from(t):Br(t)}function Gl(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&zi(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function M(t,e=be.P){let r=t%e;return r>=ie?r:e+r}function vt(t,e){let{P:r}=be,n=t;for(;e-- >ie;)n*=n,n%=r;return n}function Gw(t){let{P:e}=be,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),f=t*t*t%e,u=f*f*t%e,c=vt(u,Ki)*u%e,h=vt(c,Ki)*u%e,l=vt(h,Ne)*f%e,d=vt(l,n)*l%e,p=vt(d,i)*d%e,g=vt(p,o)*p%e,m=vt(g,a)*g%e,v=vt(m,o)*p%e,S=vt(v,Ki)*u%e,C=vt(S,s)*d%e,D=vt(C,r)*f%e;return vt(D,Ne)}function Kn(t,e=be.P){if(t===ie||e<=ie)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=M(t,e),n=e,i=ie,s=ge,o=ge,a=ie;for(;r!==ie;){let u=n/r,c=n%r,h=i-o*u,l=s-a*u;n=r,r=c,i=o,s=a,o=h,a=l}if(n!==ge)throw new Error("invert: does not exist");return M(i,e)}function Hw(t,e=be.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===ie?s:(r[a]=s,M(s*o,e)),ge),i=Kn(n,e);return t.reduceRight((s,o,a)=>o===ie?s:(r[a]=M(s*r[a],e),M(s*o,e)),i),r}var Hl=(t,e)=>(t+e/Ne)/e,Xs=Ne**BigInt(128);function Wl(t){let{n:e}=be,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ge*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=Hl(s*t,e),a=Hl(-n*t,e),f=M(t-o*r-a*i,e),u=M(-o*n-a*s,e),c=f>Xs,h=u>Xs;if(c&&(f=e-f),h&&(u=e-u),f>Xs||u>Xs)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:c,k1:f,k2neg:h,k2:u}}function jl(t){let{n:e}=be,n=t.length*8-256,i=Wt(t);return n>0&&(i=i>>BigInt(n)),i>=e&&(i-=e),i}var bc=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return dt.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof dt.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=dt.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function zi(t){return ie<t&&t<be.n}function gc(t){return ie<t&&t<be.P}function Ww(t,e,r){let n=Wt(t);if(!zi(n))return;let{n:i}=be,s=se.BASE.multiply(n),o=M(s.x,i);if(o===ie)return;let a=M(Kn(n,i)*M(e+r*o,i),i);if(a===ie)return;let f=new Ht(o,a),u=(s.x===f.r?0:2)|Number(s.y&ge);return{sig:f,recovery:u}}function Qr(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=eo(t)}else if(Js(t)){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=Wt(t)}else throw new TypeError("Expected valid private key");if(!zi(e))throw new Error("Expected private key: 0 < key < n");return e}function jw(t){return t instanceof se?(t.assertValidity(),t):se.fromHex(t)}function $l(t){if(t instanceof Ht)return t.assertValidity(),t;try{return Ht.fromDER(t)}catch{return Ht.fromCompact(t)}}function vc(t,e=!1){return se.fromPrivateKey(t).toRawBytes(e)}function Yl(t){let e=t.length>32?t.slice(0,32):t;return Wt(e)}function $w(t){let e=Yl(t),r=M(e,be.n);return Zl(r<ie?e:r)}function Zl(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=Jr(t);return Br(e)}function Yw(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=en(t),i=Qr(e),s=[Zl(i),$w(n)];if(r!=null){r===!0&&(r=dt.randomBytes(32));let f=en(r);if(f.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(f)}let o=Vn(...s),a=Yl(n);return{seed:o,m:a,d:i}}function Zw(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let a=s?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function Xl(t,e,r={}){let{seed:n,m:i,d:s}=Yw(t,e,r.extraEntropy),o,a=new bc;for(await a.reseed(n);!(o=Ww(await a.generate(),i,s));)await a.reseed();return Zw(o,r)}var Xw={strict:!0};function Ql(t,e,r,n=Xw){let i;try{i=$l(t),e=en(e)}catch{return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=jl(e),f;try{f=jw(r)}catch{return!1}let{n:u}=be,c=Kn(o,u),h=M(a*c,u),l=M(s*c,u),d=se.BASE.multiplyAndAddUnsafe(f,h,l);return d?M(d.x,u)===s:!1}se.BASE._setWindowSize(8);var pt={node:Vw,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Qs={},dt={isValidPrivateKey(t){try{return Qr(t),!0}catch{return!1}},privateAdd:(t,e)=>{let r=Qr(t),n=Qr(e);return dc(M(r+n,be.n))},privateNegate:t=>{let e=Qr(t);return dc(be.n-e)},pointAddScalar:(t,e,r)=>{let n=se.fromHex(t),i=Qr(e),s=se.BASE.multiplyAndAddUnsafe(n,i,ge);if(!s)throw new Error("Tweaked point at infinity");return s.toRawBytes(r)},pointMultiply:(t,e,r)=>{let n=se.fromHex(t),i=Wt(en(e));return n.multiply(i).toRawBytes(r)},hashToPrivateKey:t=>{if(t=en(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=M(Wt(t),be.n-ge)+ge;return dc(e)},randomBytes:(t=32)=>{if(pt.web)return pt.web.getRandomValues(new Uint8Array(t));if(pt.node){let{randomBytes:e}=pt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>dt.hashToPrivateKey(dt.randomBytes(40)),bytesToHex:qn,hexToBytes:Br,concatBytes:Vn,mod:M,invert:Kn,sha256:async(...t)=>{if(pt.web){let e=await pt.web.subtle.digest("SHA-256",Vn(...t));return new Uint8Array(e)}else if(pt.node){let{createHash:e}=pt.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(pt.web){let r=await pt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Vn(...e),i=await pt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(pt.node){let{createHmac:r}=pt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Qs[t];if(r===void 0){let n=await dt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Vn(n,n),Qs[t]=r}return dt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof dt.sha256Sync!="function")throw new Error("utils.sha256Sync is undefined, you need to set it");let r=Qs[t];if(r===void 0){let n=dt.sha256Sync(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Vn(n,n),Qs[t]=r}return dt.sha256Sync(r,...e)},precompute(t=8,e=se.BASE){let r=e===se.BASE?e:new se(e.x,e.y);return r._setWindowSize(t),r.multiply(Ki),r}};function Jl(){return dt.randomPrivateKey()}async function e0(t,e){let{digest:r}=await Ue.digest(e);try{return await Xl(r,t)}catch(n){throw(0,zn.default)(n,"ERR_INVALID_INPUT")}}async function t0(t,e,r){try{let{digest:n}=await Ue.digest(r);return Ql(e,n,t)}catch(n){throw(0,zn.default)(n,"ERR_INVALID_INPUT")}}function r0(t){return se.fromHex(t).toRawBytes(!0)}function n0(t){try{vc(t,!0)}catch(e){throw(0,zn.default)(e,"ERR_INVALID_PRIVATE_KEY")}}function wc(t){try{se.fromHex(t)}catch(e){throw(0,zn.default)(e,"ERR_INVALID_PUBLIC_KEY")}}function i0(t){try{return vc(t,!0)}catch(e){throw(0,zn.default)(e,"ERR_INVALID_PRIVATE_KEY")}}var Gi=class{constructor(e){wc(e),this._key=e}async verify(e,r){return await t0(this._key,r,e)}marshal(){return r0(this._key)}get bytes(){return kt.encode({Type:Te.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Fe(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ue.digest(this.bytes);return e}},Hi=class{constructor(e,r){this._key=e,this._publicKey=r??i0(e),n0(this._key),wc(this._publicKey)}async sign(e){return await e0(this._key,e)}get public(){return new Gi(this._publicKey)}marshal(){return this._key}get bytes(){return Ot.encode({Type:Te.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Fe(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ue.digest(this.bytes);return e}async id(){let e=await this.public.hash();return j(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await Nn(this.bytes,e);throw(0,s0.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function e2(t){return new Hi(t)}function t2(t){return new Gi(t)}async function r2(){let t=await Jl();return new Hi(t)}var tn={rsa:ic,ed25519:pc,secp256k1:xc};function a0(t){let e=Object.keys(tn).join(" / ");return(0,o0.default)(new Error(`invalid or unsupported key type ${t}. Must be ${e}`),"ERR_UNSUPPORTED_KEY_TYPE")}function Wi(t){let e=kt.decode(t),r=e.Data;switch(e.Type){case Te.RSA:return tn.rsa.unmarshalRsaPublicKey(r);case Te.Ed25519:return tn.ed25519.unmarshalEd25519PublicKey(r);case Te.Secp256k1:return tn.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw a0(e.Type)}}async function to(t){let e=Ot.decode(t),r=e.Data;switch(e.Type){case Te.RSA:return await tn.rsa.unmarshalRsaPrivateKey(r);case Te.Ed25519:return tn.ed25519.unmarshalEd25519PrivateKey(r);case Te.Secp256k1:return tn.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw a0(e.Type)}}var oo=F(rn(),1);var m0={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var w0=Symbol.for("@achingbrain/uint8arraylist");function b0(t,e,r){if(e==null||e<0||e>=r)throw new RangeError("index is out of bounds");let n=0;for(let i of t){let s=n+i.byteLength;if(e<s)return{buf:i,index:e-n};n=s}throw new RangeError("index is out of bounds")}function v0(t){return Boolean(t?.[w0])}var Se=class{constructor(...e){Object.defineProperty(this,w0,{value:!0}),this.bufs=[],this.length=0,this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(v0(n))r+=n.length,this.bufs=this.bufs.concat(n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=b0(this.bufs,e,this.length);return r.buf[r.index]}set(e,r){let n=b0(this.bufs,e,this.length);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(v0(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return ae(n,i)}subarray(e,r){let{bufs:n}=this._subList(e,r),i=new Se;return i.appendAll(n),i}_subList(e,r){if(e==null&&r==null)return{bufs:this.bufs,length:this.length};if(e=e??0,r=r??(this.length>0?this.length:0),e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index out of bounds");if(e===r)return{bufs:[],length:0};let n=[],i=0;for(let s of this.bufs){let o=i,a=o+s.byteLength,f=e>=o&&e<a,u=r>o&&r<=a,c=e<o&&r>=a;i=a;let h,l;if(f&&(h=e-o,l=s.byteLength),u&&(l=r-o,h==null&&(h=0)),c&&(h=0,l=s.byteLength),h!=null&&l!=null&&n.push(s.subarray(h,l)),u)break}return{bufs:n,length:r-e}}getInt8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}};function jt(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var x0=4294967296,We=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new We(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new We(r,n)}toBytes(e,r=0){let n=jt(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new We;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>x0&&(i=0,++n>x0&&(n=0))),new We(n,i)}static fromNumber(e){if(e===0)return new We;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new We(i,n)}static fromBytes(e,r){let n=jt(e),i=new We,s=0;if(e.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else{for(;s<3;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}return i.lo=(i.lo|(n.get(r++)&127)<<s*7)>>>0,i}if(e.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else for(;s<5;++s){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw Error("invalid varint encoding")}};var E0=128,b2=127,v2=~b2,w2=Math.pow(2,31),x2=Math.pow(2,7),E2=Math.pow(2,14),S2=Math.pow(2,21),_2=Math.pow(2,28),I2=Math.pow(2,35),A2=Math.pow(2,42),C2=Math.pow(2,49),T2=Math.pow(2,56),B2=Math.pow(2,63),K={encodingLength(t){return t<x2?1:t<E2?2:t<S2?3:t<_2?4:t<I2?5:t<A2?6:t<C2?7:t<T2?8:t<B2?9:10},encode(t,e){let r=0,n=jt(e);for(;t>=w2;)n.set(r++,t&255|E0),t/=128;for(;(t&v2)>0;)n.set(r++,t&255|E0),t>>>=7;n.set(r,t|0)},decode(t,e=0){let r=jt(t),n=4294967295;if(n=(r.get(e)&127)>>>0,r.get(e++)<128||(n=(n|(r.get(e)&127)<<7)>>>0,r.get(e++)<128)||(n=(n|(r.get(e)&127)<<14)>>>0,r.get(e++)<128)||(n=(n|(r.get(e)&127)<<21)>>>0,r.get(e++)<128)||(n=(n|(r.get(e)&15)<<28)>>>0,r.get(e++)<128))return n;if((e+=5)>t.length)throw RangeError(`index out of range: ${e} > ${t.length}`);return n}},ro={encodingLength(t){return t<0?10:K.encodingLength(t)},encode(t,e){if(t<0){let r=0,n=jt(e),i=We.fromNumber(t);for(;i.hi>0;)n.set(r++,i.lo&127|128),i.lo=(i.lo>>>7|i.hi<<25)>>>0,i.hi>>>=7;for(;i.lo>127;)n.set(r++,i.lo&127|128),i.lo=i.lo>>>7;n.set(r++,i.lo);return}K.encode(t,e)},decode(t,e=0){return K.decode(t,e)|0}},no={encodingLength(t){return t=(t<<1^t>>31)>>>0,K.encodingLength(t)},encode(t,e,r=0){return t=(t<<1^t>>31)>>>0,K.encode(t,e)},decode(t,e=0){let r=K.decode(t,e);return r>>>1^-(r&1)|0}};function Gn(t,e){let r=new Uint8Array(K.encodingLength(t.length));return K.encode(t.length,r),e.decode(new Se(r,t),0)}function Hn(t,e){let r=e.encode(t),n=K.encodingLength(K.decode(r));return r.slice(n)}var W;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(W||(W={}));function te(t,e,r,n,i){return{name:t,type:e,encode:r,decode:n,encodingLength:i}}var R2=function(){return 1},D2=function(e){return Uint8Array.from([e?1:0])},P2=function(e,r){return e.get(r)>0},L2=te("bool",W.VARINT,D2,P2,R2);var M2=function(e){let r=e.byteLength;return K.encodingLength(r)+r},N2=function(e){let r=new Uint8Array(K.encodingLength(e.byteLength));return K.encode(e.byteLength,r),new Se(r,e)},k2=function(e,r){let n=K.decode(e,r);return r+=K.encodingLength(n),e.slice(r,r+n)},fr=te("bytes",W.LENGTH_DELIMITED,N2,k2,M2);var S0=function(){return 8},O2=function(e){let r=new Se(new Uint8Array(S0(e)));return r.setFloat64(0,e,!0),r},U2=function(e,r){return e.getFloat64(r,!0)},F2=te("double",W.BIT64,O2,U2,S0);var _0=function(){return 4},V2=function(e){let r=new Se(new Uint8Array(_0(e)));return r.setInt32(0,e,!0),r},q2=function(e,r){return e.getInt32(r,!0)},K2=te("fixed32",W.BIT32,V2,q2,_0);var I0=function(e){return 8},z2=function(e){let r=new Se(new Uint8Array(I0(e)));return r.setBigInt64(0,e,!0),r},G2=function(e,r){return e.getBigInt64(r,!0)},H2=te("fixed64",W.BIT64,z2,G2,I0);var A0=function(){return 4},W2=function(e){let r=new Se(new Uint8Array(A0(1)));return r.setFloat32(0,e,!0),r},j2=function(e,r){return e.getFloat32(r,!0)},$2=te("float",W.BIT32,W2,j2,A0);var C0=function(e){return ro.encodingLength(e)},Y2=function(e){let r=new Uint8Array(C0(e));return ro.encode(e,r),r},Z2=function(e,r){return ro.decode(e,r)},X2=te("int32",W.VARINT,Y2,Z2,C0);var T0=0x7fn,Rr={encodingLength(t){let e=0;for(;t>=0x80n;e++)t>>=7n;return e+1},encode(t,e){let r=jt(e),n=0;for(;T0<t;)r.set(n++,Number(t&T0)|128),t>>=7n;r.set(n,Number(t))},decode(t,e=0){return We.fromBytes(t,e).toBigInt(!0)}},io={encodingLength(t){return t<0n?10:Rr.encodingLength(t)},encode(t,e,r=0){if(t<0n){We.fromBigInt(t).toBytes(e,r);return}return Rr.encode(t,e)},decode(t,e=0){return We.fromBytes(t,e).toBigInt(!1)}},so={encodingLength(t){return Rr.encodingLength(t>=0?t*2n:t*-2n-1n)},encode(t,e,r=0){We.fromBigInt(t).zzEncode().toBytes(e,r)},decode(t,e=0){return We.fromBytes(t,e).zzDecode().toBigInt(!1)}};var B0=function(e){return io.encodingLength(e)},Q2=function(e){let r=new Uint8Array(B0(e));return io.encode(e,r),r},J2=function(e,r){return io.decode(e,r)|0n},ex=te("int64",W.VARINT,Q2,J2,B0);function Wn(t){let e=function(s){let o=0;for(let a of Object.values(t))o+=a.codec.encodingLength(s[a.name]);return K.encodingLength(o)+o},r=function(s){let o=new Se;function a(u,c,h){if(u==null){if(h.optional===!0)return;throw new Error(`Non optional field "${h.name}" was ${u===null?"null":"undefined"}`)}let l=c<<3|h.codec.type,d=new Uint8Array(K.encodingLength(l));K.encode(l,d);let p=h.codec.encode(u);o.append(d),o.append(p)}for(let[u,c]of Object.entries(t)){let h=parseInt(u);if(c.repeats===!0){if(!Array.isArray(s[c.name]))throw new Error(`Repeating field "${c.name}" was not an array`);for(let l of s[c.name])a(l,h,c)}else a(s[c.name],h,c)}let f=new Uint8Array(K.encodingLength(o.length));return K.encode(o.length,f),new Se(f,o)},n=function(s,o){let a=K.decode(s,o);o+=K.encodingLength(a);let f=o+a,u={};for(;o<f;){let c=K.decode(s,o);o+=K.encodingLength(c);let h=c&7,l=c>>3,d=t[l],p=0;if(h===W.VARINT)if(d!=null){let g=d.codec.decode(s,o);p=d.codec.encodingLength(g)}else{let g=K.decode(s,o);p=K.encodingLength(g)}else if(h===W.BIT64)p=8;else if(h===W.LENGTH_DELIMITED){let g=K.decode(s,o);p=g+K.encodingLength(g)}else if(h===W.BIT32)p=4;else{if(h===W.START_GROUP)throw new Error("Unsupported wire type START_GROUP");if(h===W.END_GROUP)throw new Error("Unsupported wire type END_GROUP")}if(d!=null){let g=d.codec.decode(s,o);d.repeats===!0?(u[d.name]==null&&(u[d.name]=[]),u[d.name].push(g)):u[d.name]=g}o+=p}for(let c of Object.values(t))c.repeats===!0&&u[c.name]==null&&(u[c.name]=[]);return u};return te("message",W.LENGTH_DELIMITED,r,n,e)}var R0=function(){return 4},tx=function(e){let r=new Se(new Uint8Array(R0(e)));return r.setInt32(0,e,!0),r},rx=function(e,r){return e.getInt32(r,!0)},nx=te("sfixed32",W.BIT32,tx,rx,R0);var D0=function(){return 8},ix=function(e){let r=new Se(new Uint8Array(D0(e)));return r.setBigInt64(0,e,!0),r},sx=function(e,r){return e.getBigInt64(r,!0)},ox=te("sfixed64",W.BIT64,ix,sx,D0);var P0=function(e){return no.encodingLength(e)},ax=function(e){let r=new Uint8Array(P0(e));return no.encode(e,r),r},cx=function(e,r){return no.decode(e,r)},ux=te("sint32",W.VARINT,ax,cx,P0);var L0=function(e){return so.encodingLength(e)},fx=function(e){let r=new Uint8Array(L0(e));return so.encode(e,r),r},hx=function(e,r){return so.decode(e,r)},lx=te("sint64",W.VARINT,fx,hx,L0);var px=function(e){let r=ue(e).byteLength;return K.encodingLength(r)+r},dx=function(e){let r=ue(e),n=new Uint8Array(K.encodingLength(r.byteLength));return K.encode(r.length,n),new Se(n,r)},gx=function(e,r){let n=K.decode(e,r);return r+=K.encodingLength(n),j(e.slice(r,r+n))},yx=te("string",W.LENGTH_DELIMITED,dx,gx,px);var M0=function(e){return K.encodingLength(e)},mx=function(e){let r=new Uint8Array(M0(e));return K.encode(e,r),r},bx=function(e,r){return K.decode(e,r)},vx=te("uint32",W.VARINT,mx,bx,M0);var wx=function(e){return Rr.encodingLength(e)},xx=function(e){let r=new Uint8Array(Rr.encodingLength(e));return Rr.encode(e,r),r},Ex=function(e,r){return Rr.decode(e,r)},_c=te("uint64",W.VARINT,xx,Ex,wx);var ji;(function(t){t.codec=()=>Wn({1:{name:"publicKey",codec:fr},2:{name:"payloadType",codec:fr},3:{name:"payload",codec:fr},5:{name:"signature",codec:fr}}),t.encode=e=>Hn(e,t.codec()),t.decode=e=>Gn(e,t.codec())})(ji||(ji={}));var Sx=F(De(),1);var N0=Symbol.for("@libp2p/peer-id");var k0=Object.values(Cn).map(t=>t.decoder).reduce((t,e)=>t.or(e),Cn.identity.decoder),O0=114,Ic=36,Ac=37,$i=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[N0](){return!0}toString(){return this.string==null&&(this.string=Pe.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return ye.createV1(O0,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Fe(this.multihash.bytes,e);if(typeof e=="string")return hr(e).equals(this);if(e?.multihash?.bytes!=null)return Fe(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},jn=class extends $i{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},$n=class extends $i{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},Yn=class extends $i{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function hr(t,e){if(e=e??k0,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Vr(Pe.decode(`z${t}`));return t.startsWith("12D")?new $n({multihash:r}):t.startsWith("16U")?new Yn({multihash:r}):new jn({multihash:r})}return $t(k0.decode(t))}function $t(t){try{let e=Vr(t);if(e.code===vr.code){if(e.digest.length===Ic)return new $n({multihash:e});if(e.digest.length===Ac)return new Yn({multihash:e})}if(e.code===Ue.code)return new jn({multihash:e})}catch{return _x(ye.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function _x(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==O0)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Ue.code)return new jn({multihash:t.multihash});if(e.code===vr.code){if(e.digest.length===Ic)return new $n({multihash:t.multihash});if(e.digest.length===Ac)return new Yn({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function U0(t,e){return t.length===Ic?new $n({multihash:Nt(vr.code,t),privateKey:e}):t.length===Ac?new Yn({multihash:Nt(vr.code,t),privateKey:e}):new jn({multihash:await Ue.digest(t),publicKey:t,privateKey:e})}var Ix,wt=class{constructor(e){let{peerId:r,payloadType:n,payload:i,signature:s}=e;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=ji.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload,signature:this.signature})),this.marshaled}equals(e){return Fe(this.marshal(),e.marshal())}async validate(e){let r=V0(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await Wi(this.peerId.publicKey).verify(r,this.signature)}};Ix=wt;wt.createFromProtobuf=async t=>{let e=ji.decode(t),r=await U0(e.publicKey);return new wt({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};wt.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),s=V0(r,n,i);if(e.privateKey==null)throw new Error("Missing private key");let a=await(await to(e.privateKey)).sign(s);return new wt({peerId:e,payloadType:n,payload:i,signature:a})};wt.openAndCertify=async(t,e)=>{let r=await wt.createFromProtobuf(t);if(!await r.validate(e))throw(0,F0.default)(new Error("envelope signature is not valid for the given domain"),m0.ERR_SIGNATURE_NOT_VALID);return r};var V0=(t,e,r)=>{let n=ue(t),i=oo.default.encode(n.byteLength),s=oo.default.encode(e.length),o=oo.default.encode(r.length);return ae([new Uint8Array(i),n,new Uint8Array(s),e,new Uint8Array(o),r])};var q0="[a-fA-F\\d:]",Dr=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${q0})|(?<=${q0})(?=\\s|$))`:"",Dt="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",Ve="[a-fA-F\\d]{1,4}",ao=`
(?:
(?:${Ve}:){7}(?:${Ve}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${Ve}:){6}(?:${Dt}|:${Ve}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${Ve}:){5}(?::${Dt}|(?::${Ve}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${Ve}:){4}(?:(?::${Ve}){0,1}:${Dt}|(?::${Ve}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${Ve}:){3}(?:(?::${Ve}){0,2}:${Dt}|(?::${Ve}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${Ve}:){2}(?:(?::${Ve}){0,3}:${Dt}|(?::${Ve}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${Ve}:){1}(?:(?::${Ve}){0,4}:${Dt}|(?::${Ve}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${Ve}){0,5}:${Dt}|(?::${Ve}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Ax=new RegExp(`(?:^${Dt}$)|(?:^${ao}$)`),Cx=new RegExp(`^${Dt}$`),Tx=new RegExp(`^${ao}$`),Cc=t=>t&&t.exact?Ax:new RegExp(`(?:${Dr(t)}${Dt}${Dr(t)})|(?:${Dr(t)}${ao}${Dr(t)})`,"g");Cc.v4=t=>t&&t.exact?Cx:new RegExp(`${Dr(t)}${Dt}${Dr(t)}`,"g");Cc.v6=t=>t&&t.exact?Tx:new RegExp(`${Dr(t)}${ao}${Dr(t)}`,"g");var co=Cc;function uo(t){return co({exact:!0}).test(t)}function K0(t){return co.v6({exact:!0}).test(t)}function z0(t){return co.v4({exact:!0}).test(t)}var G0=z0,Bx=K0,Tc=function(t){let e=0,r;if(G0(t))r=new Uint8Array(e+4),t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255});else if(Bx(t)){let n=t.split(":",8),i;for(i=0;i<n.length;i++){let s=G0(n[i]),o;s&&(o=Tc(n[i]),n[i]=j(o.slice(0,2),"base16")),o!=null&&++i<8&&n.splice(i,0,j(o.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(i=0;i<n.length&&n[i]!=="";i++);let s=[i,1];for(i=9-n.length;i>0;i--)s.push("0");n.splice.apply(n,s)}for(r=new Uint8Array(e+16),i=0;i<n.length;i++){let s=parseInt(n[i],16);r[e++]=s>>8&255,r[e++]=s&255}}if(r==null)throw Error("Invalid ip address: "+t);return r},H0=function(t,e,r){e=~~e,r=r??t.length-e;let n=[],i="",s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)n.push(t[e+o]);i=n.join(".")}else if(r===16){for(let o=0;o<r;o+=2)n.push(s.getUint16(e+o).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};var Yi={},Bc={},Dx=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Dx.forEach(t=>{let e=Px(...t);Bc[e.code]=e,Yi[e.name]=e});function Px(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}function ve(t){if(typeof t=="number"){if(Bc[t]!=null)return Bc[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(Yi[t]!=null)return Yi[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var nn=F(rn(),1);function $0(t,e){switch(ve(t).code){case 4:case 41:return Lx(e);case 6:case 273:case 33:case 132:return Z0(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return Nx(e);case 421:return Ox(e);case 444:return j0(e);case 445:return j0(e);default:return j(e,"base16")}}function Y0(t,e){switch(ve(t).code){case 4:return W0(e);case 41:return W0(e);case 6:case 273:case 33:case 132:return Rc(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return Mx(e);case 421:return kx(e);case 444:return Ux(e);case 445:return Fx(e);default:return ue(e,"base16")}}function W0(t){if(!uo(t))throw new Error("invalid ip address");return Tc(t)}function Lx(t){let e=H0(t,0,t.length);if(e==null||!uo(e))throw new Error("invalid ip address");return e}function Rc(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function Z0(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Mx(t){let e=ue(t),r=Uint8Array.from(nn.default.encode(e.length));return ae([r,e],r.length+e.length)}function Nx(t){let e=nn.default.decode(t);if(t=t.slice(nn.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return j(t)}function kx(t){let e;t[0]==="Q"||t[0]==="1"?e=Vr(Pe.decode(`z${t}`)).bytes:e=ye.parse(t).multihash.bytes;let r=Uint8Array.from(nn.default.encode(e.length));return ae([r,e],r.length+e.length)}function Ox(t){let e=nn.default.decode(t),r=t.slice(nn.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return j(r,"base58btc")}function Ux(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=Ct.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Rc(n);return ae([r,i],r.length+i.length)}function Fx(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=Ct.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Rc(n);return ae([r,i],r.length+i.length)}function j0(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=j(e,"base32"),i=Z0(r);return`${n}:${i}`}var Zn=F(rn(),1);function Vx(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=ve(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw Q0("invalid address: "+t);if(s.path===!0){e.push([i,Mc(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function qx(t){let e=[];return t.map(r=>{let n=lo(r);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),Mc(e.join("/"))}function Kx(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=lo(e);return e.length>1?[r.code,Y0(r.code,e[1])]:[r.code]})}function Dc(t){return t.map(e=>{let r=lo(e);return e[1]!=null?[r.code,$0(r.code,e[1])]:[r.code]})}function Pc(t){return ho(ae(t.map(e=>{let r=lo(e),n=Uint8Array.from(Zn.default.encode(r.code));return e.length>1&&e[1]!=null&&(n=ae([n,e[1]])),n})))}function Lc(t,e){return t.size>0?t.size/8:t.size===0?0:Zn.default.decode(e)+Zn.default.decode.bytes}function Zi(t){let e=[],r=0;for(;r<t.length;){let n=Zn.default.decode(t,r),i=Zn.default.decode.bytes,s=ve(n),o=Lc(s,t.slice(r+i));if(o===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+o);if(r+=o+i,r>t.length)throw Q0("Invalid address Uint8Array: "+j(t,"base16"));e.push([n,a])}return e}function fo(t){let e=Zi(t),r=Dc(e);return qx(r)}function zx(t){t=Mc(t);let e=Vx(t),r=Kx(e);return Pc(r)}function X0(t){return zx(t)}function ho(t){let e=Gx(t);if(e!=null)throw e;return Uint8Array.from(t)}function Gx(t){try{Zi(t)}catch(e){return e}}function Mc(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function Q0(t){return new Error("Error parsing address: "+t)}function lo(t){return ve(t[0])}var Nc=F(rn(),1);var tp=F(De(),1);var Wx=Symbol.for("nodejs.util.inspect.custom"),jx=[ve("ip4").code,ve("ip6").code],po=[ve("dns").code,ve("dns4").code,ve("dns6").code,ve("dnsaddr").code],J0=[ve("p2p").code,ve("ipfs").code],$x=[ve("tcp").code,ve("udp").code],rp=new Map,ep=Symbol.for("@multiformats/js-multiaddr/multiaddr"),at=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,ep,{value:!0}),e instanceof Uint8Array)this.bytes=ho(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=X0(e)}else if(at.isMultiaddr(e))this.bytes=ho(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return fo(this.bytes)}toJSON(){return this.toString()}toOptions(){let e=this.protoCodes(),r=this.toString().split("/").slice(1),n,i;if(r.length>2)po.includes(e[0])&&J0.includes(e[1])?(n=ve("tcp").name,i=443):(n=ve(r[2]).name,i=parseInt(r[3]));else if(po.includes(e[0]))n=ve("tcp").name,i=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e[0]===41||e[0]===55?6:4,host:r[1],transport:n,port:i}}protos(){return this.protoCodes().map(e=>Object.assign({},ve(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=Nc.default.decode(r,n),s=Nc.default.decode.bytes,o=ve(i);n+=Lc(o,r.slice(n+s))+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Zi(this.bytes)}stringTuples(){let e=Zi(this.bytes);return Dc(e)}encapsulate(e){return e=new at(e),new at(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new at(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new at(Pc(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===Yi.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?j(Pe.decode(`z${n}`),"base58btc"):j(ye.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>ve(r[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return Fe(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=rp.get(r.name);if(n==null)throw(0,tp.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new at(s))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1),i=ve(n[2]).code,s=parseInt(n[3]);if(po.includes(e[0])&&J0.includes(e[1])&&(i=ve("tcp").code,s=443),n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');if(!jx.includes(e[0])&&!po.includes(e[0]))throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns, dns4, dns6, dnsaddr}".`);if(!$x.includes(i))throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:s}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(e==null)throw new Error("requires node address object");if(r==null)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new at("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return at.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return Boolean(e?.[ep])}[Wx](){return"<Multiaddr "+j(this.bytes,"base16")+" - "+fo(this.bytes)+">"}inspect(){return"<Multiaddr "+j(this.bytes,"base16")+" - "+fo(this.bytes)+">"}};at.resolvers=rp;function np(t,e){let r=(n,i)=>n.toString().localeCompare(i.toString());return t.length===e.length&&e.sort(r)&&t.sort(r).every((n,i)=>e[i].equals(n))}var Xi;(function(t){let e;(function(r){r.codec=()=>Wn({1:{name:"multiaddr",codec:fr}}),r.encode=n=>Hn(n,r.codec()),r.decode=n=>Gn(n,r.codec())})(e=t.AddressInfo||(t.AddressInfo={})),t.codec=()=>Wn({1:{name:"peerId",codec:fr},2:{name:"seq",codec:_c},3:{name:"addresses",codec:t.AddressInfo.codec(),repeats:!0}}),t.encode=r=>Hn(r,t.codec()),t.decode=r=>Gn(r,t.codec())})(Xi||(Xi={}));var ip="libp2p-peer-record",sp=Uint8Array.from([3,1]);var Pt=class{constructor(e){this.domain=Pt.DOMAIN,this.codec=Pt.CODEC;let{peerId:r,multiaddrs:n,seqNumber:i}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Xi.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof Pt)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!np(this.multiaddrs,e.multiaddrs))}};Pt.createFromProtobuf=t=>{let e=Xi.decode(t),r=$t(e.peerId),n=(e.addresses??[]).map(s=>new at(s.multiaddr)),i=e.seq;return new Pt({peerId:r,multiaddrs:n,seqNumber:i})};Pt.DOMAIN=ip;Pt.CODEC=sp;var Yt=F(fp(),1);Yt.default.formatters.b=t=>t==null?"undefined":Pe.baseEncode(t);Yt.default.formatters.t=t=>t==null?"undefined":Ct.baseEncode(t);Yt.default.formatters.m=t=>t==null?"undefined":Sn.baseEncode(t);Yt.default.formatters.p=t=>t==null?"undefined":t.toString();Yt.default.formatters.c=t=>t==null?"undefined":t.toString();Yt.default.formatters.k=t=>t==null?"undefined":t.toString();function mo(t){return Object.assign((0,Yt.default)(t),{error:(0,Yt.default)(`${t}:error`),trace:(0,Yt.default)(`${t}:trace`)})}var kc=Symbol.for("@libp2p/topology");var hp=()=>{},Oc=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??hp,this.onDisconnect=e.onDisconnect??hp}get[Symbol.toStringTag](){return kc.toString()}get[kc](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function lp(t){return new Oc(t)}var on=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},lr,bo=class extends EventTarget{constructor(){super(...arguments),lr.set(this,new Map)}listenerCount(e){let r=on(this,lr,"f").get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let i=on(this,lr,"f").get(e);i==null&&(i=[],on(this,lr,"f").set(e,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e.toString(),r??null,n);let i=on(this,lr,"f").get(e);i!=null&&(i=i.filter(({callback:s})=>s!==r),on(this,lr,"f").set(e,i))}dispatchEvent(e){let r=super.dispatchEvent(e),n=on(this,lr,"f").get(e.type);return n==null||(n=n.filter(({once:i})=>!i),on(this,lr,"f").set(e.type,n)),r}};lr=new WeakMap;var Uc=class extends Event{constructor(e,r){super(e,r),this.detail=r?.detail}},an=globalThis.CustomEvent??Uc;var vo=class{constructor(e,r,n){this.gossip=e,this.msgs=new Map,this.history=[],this.msgIdToStrFn=n;for(let i=0;i<r;i++)this.history[i]=[]}get size(){return this.msgs.size}put(e,r,n=!1){let{msgIdStr:i}=e;return this.msgs.has(i)?!1:(this.msgs.set(i,{message:r,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:r.topic}),!0)}observeDuplicate(e,r){let n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(r)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,r){let n=this.msgs.get(e);if(!n)return null;let i=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,i),{msg:n.message,count:i}}getGossipIDs(e){let r=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(i=>{let s=this.msgs.get(i.msgIdStr);if(s&&s.validated&&e.has(i.topic)){let o=r.get(i.topic);o||(o=[],r.set(i.topic,o)),o.push(i.msgId)}});return r}validate(e){let r=this.msgs.get(e);if(!r)return null;let{message:n,originatingPeers:i}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:i}}shift(){this.history[this.history.length-1].forEach(r=>{this.msgs.delete(r.msgIdStr)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r?(this.msgs.delete(e),r):null}};var ld=F(hd(),1),{RPC:ti}=ld.default;var Qc="/floodsub/1.0.0",Jc="/meshsub/1.0.0",_o="/meshsub/1.1.0";var pd="ERR_TOPIC_VALIDATOR_REJECT",dd="ERR_TOPIC_VALIDATOR_IGNORE";function Qt(t=[],e){return{subscriptions:[],messages:t,control:e?{graft:e.graft||[],prune:e.prune||[],ihave:e.ihave||[],iwant:e.iwant||[]}:void 0}}function Jt(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),i=t[r];t[r]=t[n],t[n]=i}return t}function gd(t){return j(t,"base64")}var fn="StrictSign",ri="StrictNoSign";var yd;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(yd||(yd={}));var pr;(function(t){t[t.Signing=0]="Signing",t[t.Author=1]="Author",t[t.Anonymous=2]="Anonymous"})(pr||(pr={}));var er;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(er||(er={}));var tt;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(tt||(tt={}));var Ze;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(Ze||(Ze={}));var Et;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(Et||(Et={}));function eu(t){switch(t){case er.Ignore:return tt.Ignore;case er.Reject:return tt.Reject}}async function tu(t,e){switch(t){case fn:{if(!e)throw Error("Must provide PeerId");if(e.privateKey==null)throw Error("Cannot sign message, no private key present");if(e.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await to(e.privateKey);return{type:pr.Signing,author:e,key:e.publicKey,privateKey:r}}case ri:return{type:pr.Anonymous};default:throw new Error(`Unknown signature policy "${t}"`)}}var he="ERR_INVALID_PEER_SCORE_PARAMS";var le=F(De(),1),mE={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},bE={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function md(t={}){return{...mE,...t,topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=vE(n),e),{}):{}}}function vE(t={}){return{...bE,...t}}function bd(t){for(let[e,r]of Object.entries(t.topics))try{wE(r)}catch(n){throw(0,le.default)(new Error(`invalid score parameters for topic ${e}: ${n.message}`),he)}if(t.topicScoreCap<0)throw(0,le.default)(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),he);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw(0,le.default)(new Error("missing application specific score function"),he);if(t.IPColocationFactorWeight>0)throw(0,le.default)(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),he);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw(0,le.default)(new Error("invalid IPColocationFactorThreshold; must be at least 1"),he);if(t.behaviourPenaltyWeight>0)throw(0,le.default)(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),he);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw(0,le.default)(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),he);if(t.decayInterval<1e3)throw(0,le.default)(new Error("invalid DecayInterval; must be at least 1s"),he);if(t.decayToZero<=0||t.decayToZero>=1)throw(0,le.default)(new Error("invalid DecayToZero; must be between 0 and 1"),he)}function wE(t){if(t.topicWeight<0)throw(0,le.default)(new Error("invalid topic weight; must be >= 0"),he);if(t.timeInMeshQuantum===0)throw(0,le.default)(new Error("invalid TimeInMeshQuantum; must be non zero"),he);if(t.timeInMeshWeight<0)throw(0,le.default)(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),he);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw(0,le.default)(new Error("invalid TimeInMeshQuantum; must be positive"),he);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw(0,le.default)(new Error("invalid TimeInMeshCap; must be positive"),he);if(t.firstMessageDeliveriesWeight<0)throw(0,le.default)(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),he);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw(0,le.default)(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),he);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw(0,le.default)(new Error("invalid FirstMessageDeliveriesCap; must be positive"),he);if(t.meshMessageDeliveriesWeight>0)throw(0,le.default)(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),he);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw(0,le.default)(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),he);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw(0,le.default)(new Error("invalid MeshMessageDeliveriesCap; must be positive"),he);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw(0,le.default)(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),he);if(t.meshMessageDeliveriesWindow<0)throw(0,le.default)(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),he);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw(0,le.default)(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),he);if(t.meshFailurePenaltyWeight>0)throw(0,le.default)(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),he);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw(0,le.default)(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),he);if(t.invalidMessageDeliveriesWeight>0)throw(0,le.default)(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),he);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw(0,le.default)(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),he)}var xE=F(De(),1),EE={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function vd(t={}){return{...EE,...t}}function wd(t,e,r,n){let i=0;if(Object.entries(e.topics).forEach(([o,a])=>{let f=r.topics[o];if(f===void 0)return;let u=0;if(a.inMesh){let d=a.meshTime/f.timeInMeshQuantum;d>f.timeInMeshCap&&(d=f.timeInMeshCap),u+=d*f.timeInMeshWeight}let c=a.firstMessageDeliveries;if(c>f.firstMessageDeliveriesCap&&(c=f.firstMessageDeliveriesCap),u+=c*f.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<f.meshMessageDeliveriesThreshold){let d=f.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;u+=d*d*f.meshMessageDeliveriesWeight}u+=a.meshFailurePenalty*f.meshFailurePenaltyWeight,u+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*f.invalidMessageDeliveriesWeight,i+=u*f.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap),i+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(o=>{if(r.IPColocationFactorWhitelist.has(o))return;let a=n.get(o),f=a?a.size:0;if(f>r.IPColocationFactorThreshold){let u=f-r.IPColocationFactorThreshold;i+=u*u*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let o=e.behaviourPenalty-r.behaviourPenaltyThreshold;i+=o*o*r.behaviourPenaltyWeight}return i}var Sd=F(Ed(),1),rt;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(rt||(rt={}));var Io=class{constructor(){this.records=new Map,this.queue=new Sd.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:rt.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};var ft=F(De(),1);function hn(t){return t!=null&&typeof t.start=="function"&&typeof t.stop=="function"}function ut(t){return t!=null&&typeof t.init=="function"}var ni=class{constructor(e={}){this.started=!1,e.peerId!=null&&this.setPeerId(e.peerId),e.addressManager!=null&&this.setAddressManager(e.addressManager),e.peerStore!=null&&this.setPeerStore(e.peerStore),e.upgrader!=null&&this.setUpgrader(e.upgrader),e.metrics!=null&&this.setMetrics(e.metrics),e.registrar!=null&&this.setRegistrar(e.registrar),e.connectionManager!=null&&this.setConnectionManager(e.connectionManager),e.transportManager!=null&&this.setTransportManager(e.transportManager),e.connectionGater!=null&&this.setConnectionGater(e.connectionGater),e.contentRouting!=null&&this.setContentRouting(e.contentRouting),e.peerRouting!=null&&this.setPeerRouting(e.peerRouting),e.datastore!=null&&this.setDatastore(e.datastore),e.connectionProtector!=null&&this.setConnectionProtector(e.connectionProtector),e.dht!=null&&this.setDHT(e.dht),e.pubsub!=null&&this.setPubSub(e.pubsub)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(e=>hn(e)).map(async e=>{e.beforeStart!=null&&await e.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(e=>hn(e)).map(async e=>{await e.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(e=>hn(e)).map(async e=>{e.afterStart!=null&&await e.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(e=>hn(e)).map(async e=>{e.beforeStop!=null&&await e.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(e=>hn(e)).map(async e=>{await e.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(e=>hn(e)).map(async e=>{e.afterStop!=null&&await e.afterStop()}))}setPeerId(e){return this.peerId=e,e}getPeerId(){if(this.peerId==null)throw(0,ft.default)(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,ut(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,ut(e)&&e.init(this),e}getAddressManager(){if(this.addressManager==null)throw(0,ft.default)(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,ut(e)&&e.init(this),e}getPeerStore(){if(this.peerStore==null)throw(0,ft.default)(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,ut(e)&&e.init(this),e}getUpgrader(){if(this.upgrader==null)throw(0,ft.default)(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,ut(e)&&e.init(this),e}getRegistrar(){if(this.registrar==null)throw(0,ft.default)(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,ut(e)&&e.init(this),e}getConnectionManager(){if(this.connectionManager==null)throw(0,ft.default)(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,ut(e)&&e.init(this),e}getTransportManager(){if(this.transportManager==null)throw(0,ft.default)(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,ut(e)&&e.init(this),e}getConnectionGater(){if(this.connectionGater==null)throw(0,ft.default)(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,ut(e)&&e.init(this),e}getContentRouting(){if(this.contentRouting==null)throw(0,ft.default)(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,ut(e)&&e.init(this),e}getPeerRouting(){if(this.peerRouting==null)throw(0,ft.default)(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,ut(e)&&e.init(this),e}getDatastore(){if(this.datastore==null)throw(0,ft.default)(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,ut(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,ut(e)&&e.init(this),e}getDHT(){if(this.dht==null)throw(0,ft.default)(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,ut(e)&&e.init(this),e}getPubSub(){if(this.pubsub==null)throw(0,ft.default)(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}};var ii=mo("libp2p:gossipsub:score"),Ao=class{constructor(e,r,n){this.params=e,this.metrics=r,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new Io,this.components=new ni,bd(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??wd}init(e){this.components=e}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){ii("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),ii("started")}stop(){if(!this._backgroundInterval){ii("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),ii("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,i)=>{if(!n.connected){e>n.expire&&(this.removeIPs(i,n.ips),this.peerStats.delete(i),this.scoreCache.delete(i));return}Object.entries(n.topics).forEach(([s,o])=>{let a=this.params.topics[s];a!==void 0&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(!r)return 0;let n=Date.now(),i=this.scoreCache.get(e);if(i&&i.cacheUntil>n)return i.score;this.metrics?.scoreFnRuns.inc();let s=this.computeScore(e,r,this.params,this.peerIPs),o=n+this.scoreCacheValidityMs;return i?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-i.score)),i.score=s,i.cacheUntil=o):this.scoreCache.set(e,{score:s,cacheUntil:o}),s}addPenalty(e,r,n){let i=this.peerStats.get(e);i&&(i.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(e){let r={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,r);let n=this.getIPs(e);this.setIPs(e,n,r.ips),r.ips=n}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this.removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,i])=>{i.firstMessageDeliveries=0;let s=this.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1,i.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.inMesh=!0,i.graftTime=Date.now(),i.meshTime=0,i.meshMessageDeliveriesActive=!1)}}prune(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.meshMessageDeliveriesActive=!1,i.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,n){this.markFirstMessageDelivery(e,n);let i=this.deliveryRecords.ensureRecord(r),s=Date.now();if(i.status!==rt.unknown){ii("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,s-i.firstSeen,rt[i.status]);return}i.status=rt.valid,i.validated=s,i.peers.forEach(o=>{o!==e.toString()&&this.markDuplicateMessageDelivery(o,n)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,n,i){switch(i){case tt.Error:this.markInvalidMessageDelivery(e,n);return;case tt.Blacklisted:return}let s=this.deliveryRecords.ensureRecord(r);if(s.status!==rt.unknown){ii("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeen,rt[s.status]);return}if(i===tt.Ignore){s.status=rt.ignored,s.peers.clear();return}s.status=rt.invalid,this.markInvalidMessageDelivery(e,n),s.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),s.peers.clear()}duplicateMessage(e,r,n){let i=this.deliveryRecords.ensureRecord(r);if(!i.peers.has(e))switch(i.status){case rt.unknown:i.peers.add(e);break;case rt.valid:i.peers.add(e),this.markDuplicateMessageDelivery(e,n,i.validated);break;case rt.invalid:this.markInvalidMessageDelivery(e,n);break;case rt.ignored:break}}markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let s=this.params.topics[r].firstMessageDeliveriesCap;i.firstMessageDeliveries=Math.min(s,i.firstMessageDeliveries+1),i.inMesh&&(s=this.params.topics[r].meshMessageDeliveriesCap,i.meshMessageDeliveries=Math.min(s,i.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,n){let i=this.peerStats.get(e);if(i){let s=n!==void 0?Date.now():0,o=this.getPtopicStats(i,r);if(o&&o.inMesh){let a=this.params.topics[r];if(n!==void 0){let u=s-n,c=u>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,u,c),c)return}let f=a.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(f,o.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections(hr(e)).map(r=>r.remoteAddr.toOptions().host)}setIPs(e,r,n){e:for(let i of r){for(let o of n)if(i===o)continue e;let s=this.peerIPs.get(i);s||(s=new Set,this.peerIPs.set(i,s)),s.add(e)}e:for(let i of n){for(let o of r)if(i===o)continue e;let s=this.peerIPs.get(i);!s||(s.delete(e),s.size||this.peerIPs.delete(i))}}removeIPs(e,r){r.forEach(n=>{let i=this.peerIPs.get(n);!i||(i.delete(e),i.size||this.peerIPs.delete(n))})}updateIPs(){this.peerStats.forEach((e,r)=>{let n=this.getIPs(r);this.setIPs(r,n,e.ips),e.ips=n})}getPtopicStats(e,r){let n=e.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=n,n):null}};var Co=class{constructor(e,r,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=r,this.metrics=n,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let n=Math.floor(Math.random()*r.length),i=r[n],s=this.msgIdToStrFn(i),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o));let a=Date.now();o.has(e)||(o.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(s)||this.requestMsByMsg.set(s,a)))}getBrokenPromises(){let e=Date.now(),r=new Map,n=0;return this.promises.forEach((i,s)=>{i.forEach((o,a)=>{o<e&&(r.set(a,(r.get(a)??0)+1),i.delete(a),n++)}),i.size||this.promises.delete(s)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(e){this.trackMessage(e);let r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case tt.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire;for(let[r,n]of this.requestMsByMsg.entries())if(n<e)this.requestMsByMsg.delete(r);else break}trackMessage(e){if(this.metrics){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};var si=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs})}prune(){let e=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};var _d;(function(t){t.forward="forward",t.publish="publish"})(_d||(_d={}));var dr;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(dr||(dr={}));var ln;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Unsub="unsubscribed",t.Excess="excess"})(ln||(ln={}));var ai;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(ai||(ai={}));var ci;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(ci||(ci={}));var oi;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(oi||(oi={}));function Id(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:t.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:t.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:t.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:t.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:e,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,i,s){let o=this.toTopic(n);this.meshPeerInclusionEvents.inc({topic:o,reason:i},s)},onRemoveFromMesh(n,i,s){let o=this.toTopic(n);this.meshPeerChurnEvents.inc({topic:o,reason:i},s)},onReportValidationMcacheHit(n){this.asyncValidationMcacheHit.inc({hit:n?"hit":"miss"})},onReportValidation(n,i){let s=this.toTopic(n);this.asyncValidationResult.inc({topic:s,acceptance:i})},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,i,s){let o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},i),this.ihaveRcvNotSeenMsgids.inc({topic:o},s)},onIwantRcv(n,i){for(let[s,o]of n){let a=this.toTopic(s);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(i)},onForwardMsg(n,i){let s=this.toTopic(n);this.msgForwardCount.inc({topic:s},1),this.msgForwardPeers.inc({topic:s},i)},onPublishMsg(n,i,s,o){let a=this.toTopic(n);this.msgPublishCount.inc({topic:a},1),this.msgPublishBytes.inc({topic:a},s*o),this.msgPublishPeers.inc({topic:a},s),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"direct"},i.direct),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"floodsub"},i.floodsub),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"mesh"},i.mesh),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"fanout"},i.fanout)},onMsgRecvPreValidation(n){let i=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:i},1)},onMsgRecvResult(n,i){let s=this.toTopic(n);this.msgReceivedStatus.inc({topic:s,status:i})},onMsgRecvInvalid(n,i){let s=this.toTopic(n),o=i.reason===tt.Error?i.error:i.reason;this.msgReceivedInvalid.inc({topic:s,error:o},1)},onDuplicateMsgDelivery(n,i,s){if(this.duplicateMsgDeliveryDelay.observe(i/1e3),s){let o=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:o},1)}},onRpcRecv(n,i){this.rpcRecvBytes.inc(i),this.rpcRecvCount.inc(1),n.subscriptions&&this.rpcRecvSubscription.inc(n.subscriptions.length),n.messages&&this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),n.control.ihave&&this.rpcRecvIHave.inc(n.control.ihave.length),n.control.iwant&&this.rpcRecvIWant.inc(n.control.iwant.length),n.control.graft&&this.rpcRecvGraft.inc(n.control.graft.length),n.control.prune&&this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,i){if(this.rpcSentBytes.inc(i),this.rpcSentCount.inc(1),n.subscriptions&&this.rpcSentSubscription.inc(n.subscriptions.length),n.messages&&this.rpcSentMessage.inc(n.messages.length),n.control){let s=n.control.ihave?.length??0,o=n.control.iwant?.length??0,a=n.control.graft?.length??0,f=n.control.prune?.length??0;s>0&&this.rpcSentIHave.inc(s),o>0&&this.rpcSentIWant.inc(o),a>0&&this.rpcSentGraft.inc(a),f>0&&this.rpcSentPrune.inc(f),(s>0||o>0||a>0||f>0)&&this.rpcSentControl.inc(1)}},registerScores(n,i){let s=0,o=0,a=0,f=0;for(let u of n)u>=i.graylistThreshold&&s++,u>=i.publishThreshold&&o++,u>=i.gossipThreshold&&a++,u>=0&&f++;this.peersByScoreThreshold.set({threshold:oi.graylist},s),this.peersByScoreThreshold.set({threshold:oi.publish},o),this.peersByScoreThreshold.set({threshold:oi.gossip},a),this.peersByScoreThreshold.set({threshold:oi.mesh},f),this.score.set(n)},registerScoreWeights(n){for(let[i,s]of n.byTopic)this.scoreWeights.set({topic:i,p:"p1"},s.p1w),this.scoreWeights.set({topic:i,p:"p2"},s.p2w),this.scoreWeights.set({topic:i,p:"p3"},s.p3w),this.scoreWeights.set({topic:i,p:"p3b"},s.p3bw),this.scoreWeights.set({topic:i,p:"p4"},s.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,i){let s=new Map;n.forEach((o,a)=>{let f=this.topicStrToLabel.get(a)??"unknown",u=s.get(f);u||(u=new Set,s.set(f,u)),o.forEach(c=>u?.add(c))});for(let[o,a]of s){let f=[];a.forEach(u=>{f.push(i.get(u)??0)}),this.scorePerMesh.set({topic:o},f)}}}}var rD=F(Ms(),1),_E=F(fe(),1);var AE=F(De(),1);var TE=F(Va(),1),BE=F(Me(),1),RE=F(De(),1);var Ad=ue("libp2p-pubsub:");async function Cd(t,e,r){switch(t.type){case pr.Signing:{let n={from:t.author.toBytes(),data:r,seqno:Ir(8),topic:e,signature:void 0,key:void 0},i=ae([Ad,ti.Message.encode(n).finish()]);return n.signature=await t.privateKey.sign(i),n.key=t.key,n}case pr.Author:return{from:t.author.toBytes(),data:r,seqno:Ir(8),topic:e,signature:void 0,key:void 0};case pr.Anonymous:return{from:void 0,data:r,seqno:void 0,topic:e,signature:void 0,key:void 0}}}async function Td(t,e){switch(t){case ri:return e.signature!=null?{valid:!1,error:Ze.SignaturePresent}:e.seqno!=null?{valid:!1,error:Ze.SeqnoPresent}:e.key!=null?{valid:!1,error:Ze.FromPresent}:{valid:!0,fromPeerId:null};case fn:{if(e.seqno==null)return{valid:!1,error:Ze.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:Ze.InvalidSeqno};if(e.signature==null)return{valid:!1,error:Ze.InvalidSignature};if(e.from==null)return{valid:!1,error:Ze.InvalidPeerId};let r;try{r=$t(e.from)}catch{return{valid:!1,error:Ze.InvalidPeerId}}let n;if(e.key){if(n=Wi(e.key),r.publicKey!==void 0&&!Fe(n.bytes,r.publicKey))return{valid:!1,error:Ze.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:Ze.InvalidPeerId};n=Wi(r.publicKey)}let i={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},s=ae([Ad,ti.Message.encode(i).finish()]);return await n.verify(s,e.signature)?{valid:!0,fromPeerId:r}:{valid:!1,error:Ze.InvalidSignature}}}}var p4=F(iy(),1);var d4=F(De(),1);var sy=(t,e)=>{let r=ue(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(t.length+r.length);return n.set(t,0),n.set(r,t.length),n};function oy(t){if(t.sequenceNumber==null)throw Error("missing seqno field");return sy(t.from.toBytes(),t.sequenceNumber)}async function ay(t){return await Ue.encode(t.data)}function g4(t,e,r,n,i){let s=0,o=new Map;if(Object.entries(e.topics).forEach(([l,d])=>{let p=i.get(l)??"unknown",g=r.topics[l];if(g===void 0)return;let m=o.get(p);m||(m={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(p,m));let v=0,S=0,C=0,D=0,w=0;d.inMesh&&(v+=Math.max(d.meshTime/g.timeInMeshQuantum,g.timeInMeshCap)*g.timeInMeshWeight);let A=d.firstMessageDeliveries;if(A>g.firstMessageDeliveriesCap&&(A=g.firstMessageDeliveriesCap),S+=A*g.firstMessageDeliveriesWeight,d.meshMessageDeliveriesActive&&d.meshMessageDeliveries<g.meshMessageDeliveriesThreshold){let G=g.meshMessageDeliveriesThreshold-d.meshMessageDeliveries;C+=G*G*g.meshMessageDeliveriesWeight}D+=d.meshFailurePenalty*g.meshFailurePenaltyWeight,w+=d.invalidMessageDeliveries*d.invalidMessageDeliveries*g.invalidMessageDeliveriesWeight,s+=(v+S+C+D+w)*g.topicWeight,m.p1w+=v,m.p2w+=S,m.p3w+=C,m.p3bw+=D,m.p4w+=w}),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;let l=r.topicScoreCap/s;for(let d of o.values())d.p1w*=l,d.p2w*=l,d.p3w*=l,d.p3bw*=l,d.p4w*=l}let a=0,f=0,u=0;return a+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(l=>{if(r.IPColocationFactorWhitelist.has(l))return;let d=n.get(l),p=d?d.size:0;if(p>r.IPColocationFactorThreshold){let g=p-r.IPColocationFactorThreshold;f+=g*g*r.IPColocationFactorWeight}}),u+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,s+=a+f+u,{byTopic:o,p5w:a,p6w:f,p7w:u,score:s}}function cy(t,e,r,n,i){let s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let o of t){let a=e.get(o);if(a){let f=g4(o,a,r,n,i);for(let[u,c]of f.byTopic){let h=s.byTopic.get(u);h||(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(u,h)),h.p1w.push(c.p1w),h.p2w.push(c.p2w),h.p3w.push(c.p3w),h.p3bw.push(c.p3bw),h.p4w.push(c.p4w)}s.p5w.push(f.p5w),s.p6w.push(f.p6w),s.p7w.push(f.p7w),s.score.push(f.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}function $o(t,e,r=()=>!0){let n=new Set;if(e<=0)return n;for(let i of t){if(n.size>=e)break;r(i)&&(n.add(i),t.delete(i))}return n}function uy(t,e){return $o(t,e,()=>!0)}var Yo=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},bi=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Yo(this.hwm),this.tail=this.head,this.size=0,this.objectMode=Boolean(e.objectMode)}push(e){if(e?.value!=null)if(this.objectMode)e.value!=null&&this.size++;else if(e.value instanceof Uint8Array)this.size+=e.value.byteLength;else throw new Error("objectMode was false but tried to push non-Uint8Array value");if(!this.head.push(e)){let r=this.head;this.head=r.next=new Yo(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}if(e?.value!=null)if(this.objectMode)this.size--;else if(e.value instanceof Uint8Array)this.size-=e.value.byteLength;else throw new Error("objectMode was false but tried to shift non-Uint8Array value");return e}isEmpty(){return this.head.isEmpty()}};function fs(t={}){return y4(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function y4(t,e){e=e??{};let r=e.onEnd,n=new bi(e),i,s,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((g,m)=>{s=v=>{s=null,n.push(v);try{g(t(n))}catch(S){m(S)}return i}}):t(n),f=g=>s!=null?s(g):(n.push(g),i),u=g=>(n=new bi,s!=null?s({error:g}):(n.push({error:g}),i)),c=g=>o?i:f({done:!1,value:g}),h=g=>o?i:(o=!0,g!=null?u(g):f({done:!0})),l=()=>(n=new bi,h(),{done:!0}),d=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:l,throw:d,push:c,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(g){return p.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:c,end(g){return p.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return p.readableLength}},i}var hs=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function fy(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function zu(t,e,r){let n=r??{},i=fy(t);async function*s(){let o,a=()=>{o?.()};for(e.addEventListener("abort",a);;){let f;try{if(e.aborted){let{abortMessage:c,abortCode:h}=n;throw new hs(c,h)}let u=new Promise((c,h)=>{o=()=>{let{abortMessage:l,abortCode:d}=n;h(new hs(l,d))}});f=await Promise.race([u,i.next()]),o=null}catch(u){e.removeEventListener("abort",a);let c=u.type==="aborted"&&e.aborted;if(c&&n.onAbort!=null&&await n.onAbort(t),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(c&&n.returnOnAbort===!0)return;throw u}if(f.done===!0)break;yield f.value}e.removeEventListener("abort",a)}return s()}var py=Symbol.for("@achingbrain/uint8arraylist");function hy(t,e,r){if(e==null||e<0||e>=r)throw new RangeError("index is out of bounds");let n=0;for(let i of t){let s=n+i.byteLength;if(e<s)return{buf:i,index:e-n};n=s}throw new RangeError("index is out of bounds")}function ly(t){return Boolean(t?.[py])}var At=class{constructor(...e){Object.defineProperty(this,py,{value:!0}),this.bufs=[],this.length=0,this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ly(n))r+=n.length,this.bufs=this.bufs.concat(n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=hy(this.bufs,e,this.length);return r.buf[r.index]}set(e,r){let n=hy(this.bufs,e,this.length);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(ly(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return ae(n,i)}subarray(e,r){let{bufs:n}=this._subList(e,r),i=new At;return i.appendAll(n),i}_subList(e,r){if(e==null&&r==null)return{bufs:this.bufs,length:this.length};if(e=e??0,r=r??(this.length>0?this.length:0),e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index out of bounds");if(e===r)return{bufs:[],length:0};let n=[],i=0;for(let s of this.bufs){let o=i,a=o+s.byteLength,f=e>=o&&e<a,u=r>o&&r<=a,c=e<o&&r>=a;i=a;let h,l;if(f&&(h=e-o,l=s.byteLength),u&&(l=r-o,h==null&&(h=0)),c&&(h=0,l=s.byteLength),h!=null&&l!=null&&n.push(s.subarray(h,l)),u)break}return{bufs:n,length:r-e}}getInt8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}};var Gu=F(rn(),1),vi=(t,e,r)=>{let n=Gu.default.encode(t,e,r);return vi.bytes=Gu.default.encode.bytes,e??Uint8Array.from(n)};vi.bytes=0;var dy=8,m4=10*1024;function Zo(t){t=t??{};let e=Math.max(t.poolSize??m4,t.minPoolSize??dy),r=t.lengthEncoder??vi;return async function*(i){let s=new Uint8Array(e),o=0;for await(let a of i){r(a.length,s,o);let f=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<dy&&(s=new Uint8Array(e),o=0),yield ae([f,a.slice()],f.length+a.length)}}}Zo.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??vi;return new At(r(t.length),t.slice())};var Hu=F(rn(),1),ls=t=>{let e=Hu.default.decode(t);return ls.bytes=Hu.default.decode.bytes,e};ls.bytes=0;var Xo=F(De(),1),b4=8,v4=1024*1024*4,w4=new At,Fr={LENGTH:"readLength",DATA:"readData"},x4={[Fr.LENGTH]:(t,e,r,n)=>{let i=n?.lengthDecoder??ls,s=n?.maxLengthLength??b4,o=n?.maxDataLength??v4;e.append(t);let a;try{a=i(e.slice())}catch(f){if(e.length>s)throw(0,Xo.default)(new Error("message length too long"),"ERR_MSG_LENGTH_TOO_LONG");if(f instanceof RangeError)return{mode:Fr.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw f}if(a>o)throw(0,Xo.default)(new Error("message data too long"),"ERR_MSG_DATA_TOO_LONG");return t=e.subarray(i.bytes),e=new At,n?.onLength!=null&&n.onLength(a),a<=0?{mode:Fr.LENGTH,chunk:t,buffer:e,data:w4}:{mode:Fr.DATA,chunk:t,buffer:e,state:{dataLength:a},data:void 0}},[Fr.DATA]:(t,e,r,n)=>{if(e.append(t),r==null)throw new Error("state is required");if(e.length<r.dataLength)return{mode:Fr.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=e.subarray(0,i),o=e.length>i?e.subarray(i):void 0;return e=new At,{mode:Fr.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function ps(t){return async function*(r){let n=new At,i=Fr.LENGTH,s;for await(let o of r){let a=new At(o);for(;a!=null;){let f=x4[i](a,n,s,t);if(i=f.mode,a=f.chunk,n=f.buffer,s=f.state,f.data!=null){let u=f.data.slice();t?.onData!=null&&t.onData(u),yield u}}}if(n.length>0)throw(0,Xo.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}ps.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:o}=await t.next(r);if(s===!0)return;o!=null&&(yield o)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return ps({...e??{},onLength:s=>{r=s}})(n)};function gy(t){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}var yy=(t,e,r)=>(e=e??gy(4),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(r??0,t,!1),e);yy.bytes=4;var my=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(0,!1)};my.bytes=4;var Qo=class{constructor(e,r){this.rawStream=e,this.pushable=fs(),this.closeController=new AbortController,En(zu(this.pushable,this.closeController.signal,{returnOnAbort:!0}),Zo(),this.rawStream).catch(r)}get protocol(){return this.rawStream.stat.protocol}push(e){this.pushable.push(e)}close(){this.closeController.abort(),this.rawStream.close()}},Jo=class{constructor(e){this.rawStream=e,this.closeController=new AbortController,this.source=zu(En(this.rawStream,ps()),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}};var Y4=_o,yt;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(yt||(yt={}));var ea=class extends bo{constructor(e={}){super(),this.multicodecs=[_o,Jc],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=fs({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new ni,this.directPeerInitial=null,this.status={code:yt.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let n=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(i=>{this.log("Error running heartbeat",i)}).finally(()=>{if(n?.(),this.status.code===yt.started){clearTimeout(this.status.heartbeatTimeout);let i=(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;i<this.opts.heartbeatInterval*.25&&(i+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,i)}})};let r={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...e,scoreParams:md(e.scoreParams),scoreThresholds:vd(e.scoreThresholds)};if(this.globalSignaturePolicy=r.globalSignaturePolicy??fn,r.fallbackToFloodsub&&this.multicodecs.push(Qc),this.log=mo(r.debugName??"libp2p:gossipsub"),this.opts=r,this.direct=new Set(r.directPeers.map(n=>n.id.toString())),this.seenCache=new si({validityMs:r.seenTTL}),this.publishedMessageIds=new si({validityMs:r.seenTTL}),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case fn:this.msgIdFn=oy;break;case ri:this.msgIdFn=ay;break}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new si({validityMs:r.seenTTL})),this.msgIdToStrFn=e.msgIdToStrFn??gd,this.mcache=e.messageCache||new vo(r.mcacheGossip,r.mcacheLength,this.msgIdToStrFn),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let n=Math.max(...Object.values(r.scoreParams.topics).map(s=>s.meshMessageDeliveriesWindow),1e3),i=Id(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:r.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:n/1e3});i.mcacheSize.addCollect(()=>this.onScrapeMetrics(i));for(let s of this.multicodecs)i.protocolsEnabled.set({protocol:s},1);this.metrics=i}else this.metrics=null;this.gossipTracer=new Co(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new Ao(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:r.heartbeatInterval}),this.maxInboundStreams=e.maxInboundStreams,this.maxOutboundStreams=e.maxOutboundStreams}getPeers(){return[...this.peers.keys()].map(e=>hr(e))}isStarted(){return this.status.code===yt.started}async init(e){this.components=e,this.score.init(e)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await tu(this.globalSignaturePolicy,this.components.getPeerId()),this.outboundInflightQueue=fs({objectMode:!0}),En(this.outboundInflightQueue,async s=>{for await(let{peerId:o,connection:a}of s)await this.createOutboundStream(o,a)}).catch(s=>this.log.error("outbound inflight queue error",s)),await Promise.all(this.opts.directPeers.map(async s=>{await this.components.getPeerStore().addressBook.add(s.id,s.addrs)}));let e=this.components.getRegistrar();await Promise.all(this.multicodecs.map(s=>e.handle(s,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r=lp({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),n=await Promise.all(this.multicodecs.map(s=>e.register(s,r))),i=setTimeout(this.runHeartbeat,100);this.status={code:yt.started,registrarTopologyIds:n,heartbeatTimeout:i,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async s=>await this.connect(s)))}).catch(s=>{this.log(s)})},1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==yt.started)return;let{registrarTopologyIds:e}=this.status;this.status={code:yt.stopped};let r=this.components.getRegistrar();e.forEach(n=>r.unregister(n)),this.outboundInflightQueue.end();for(let n of this.streamsOutbound.values())n.close();this.streamsOutbound.clear();for(let n of this.streamsInbound.values())n.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:r}){if(!this.isStarted())return;let n=r.remotePeer;this.addPeer(n,r.stat.direction),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:r})}onPeerConnected(e,r){!this.isStarted()||(this.addPeer(e,r.stat.direction),this.outboundInflightQueue.push({peerId:e,connection:r}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!!this.peers.has(n)&&!this.streamsOutbound.has(n))try{let i=new Qo(await r.newStream(this.multicodecs),o=>this.log.error("outbound pipe error",o));this.log("create outbound stream %p",e),this.streamsOutbound.set(n,i);let s=i.protocol;s===Qc&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(i){this.log.error("createOutboundStream error",i)}}async createInboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!this.peers.has(n))return;let i=this.streamsInbound.get(n);i!==void 0&&(this.log("replacing existing inbound steam %s",n),i.close()),this.log("create inbound stream %s",n);let s=new Jo(r);this.streamsInbound.set(n,s),this.pipePeerReadStream(e,s.source).catch(o=>this.log(o))}addPeer(e,r){let n=e.toString();this.peers.has(n)||(this.log("new peer %p",e),this.peers.add(n),this.score.addPeer(n),this.outbound.has(n)||this.outbound.set(n,r==="outbound"))}removePeer(e){let r=e.toString();if(!this.peers.has(r))return;this.log("delete peer %p",e),this.peers.delete(r);let n=this.streamsOutbound.get(r),i=this.streamsInbound.get(r);n&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close(),i?.close(),this.streamsOutbound.delete(r),this.streamsInbound.delete(r);for(let s of this.topics.values())s.delete(r);for(let[s,o]of this.mesh)o.delete(r)===!0&&this.metrics?.onRemoveFromMesh(s,ln.Dc,1);for(let s of this.fanout.values())s.delete(r);this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r)}get started(){return this.status.code===yt.started}getMeshPeers(e){let r=this.mesh.get(e);return r?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return(r?Array.from(r):[]).map(n=>hr(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await En(r,async n=>{for await(let i of n)try{let s=i instanceof Uint8Array?i:i.slice(),o=ti.decode(s);this.metrics?.onRpcRecv(o,s.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,o):this.handleReceivedRpc(e,o).catch(a=>this.log(a))}catch(s){this.log(s)}})}catch(n){this.log.error(n),this.onPeerDisconnected(e)}}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}if(this.log("rpc from %p",e),r.subscriptions&&r.subscriptions.length>0&&(r.subscriptions.forEach(n=>{this.handleReceivedSubscription(e,n)}),this.dispatchEvent(new an("subscription-change",{detail:{peerId:e,subscriptions:r.subscriptions.filter(n=>n.topic!==null).map(n=>({topic:n.topic??"",subscribe:Boolean(n.subscribe)}))}}))),r.messages)for(let n of r.messages){let i=this.handleReceivedMessage(e,n).catch(s=>this.log(s));this.opts.awaitRpcMessageHandler&&await i}r.control&&await this.handleControlMessage(e.toString(),r.control)}handleReceivedSubscription(e,r){if(r.topic==null)return;this.log("subscription update from %p topic %s",e,r.topic);let n=this.topics.get(r.topic);n==null&&(n=new Set,this.topics.set(r.topic,n)),r.subscribe?n.add(e.toString()):n.delete(e.toString())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(e,r);switch(this.metrics?.onMsgRecvResult(r.topic,n.code),n.code){case Et.duplicate:this.score.duplicateMessage(e.toString(),n.msgIdStr,r.topic),this.mcache.observeDuplicate(n.msgIdStr,e.toString());return;case Et.invalid:if(n.msgIdStr){let i=n.msgIdStr;this.score.rejectMessage(e.toString(),i,r.topic,n.reason),this.gossipTracer.rejectMessage(i,n.reason)}else this.score.rejectInvalidMessage(e.toString(),r.topic);this.metrics?.onMsgRecvInvalid(r.topic,n);return;case Et.valid:this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,r,!this.opts.asyncValidation),this.subscriptions.has(r.topic)&&(!this.components.getPeerId().equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new an("gossipsub:message",{detail:{propagationSource:e,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new an("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,r,e.toString())}}async validateReceivedMessage(e,r){let n=this.fastMsgIdFn?.(r),i=n?this.fastMsgIdCache?.get(n):void 0;if(i)return{code:Et.duplicate,msgIdStr:i};let s=await Td(this.globalSignaturePolicy,r);if(!s.valid)return{code:Et.invalid,reason:tt.Error,error:s.error};let o;try{let l=r.data??new Uint8Array(0);o=this.dataTransform?this.dataTransform.inboundTransform(r.topic,l):l}catch(l){return this.log("Invalid message, transform failed",l),{code:Et.invalid,reason:tt.Error,error:Ze.TransformFailed}}let a={from:r.from==null?void 0:$t(r.from),data:o,sequenceNumber:r.seqno==null?void 0:BigInt(`0x${j(r.seqno,"base16")}`),topic:r.topic},f=await this.msgIdFn(a),u=this.msgIdToStrFn(f),c={msgId:f,msgIdStr:u};if(n&&this.fastMsgIdCache?.put(n,u),this.seenCache.has(u))return{code:Et.duplicate,msgIdStr:u};this.seenCache.put(u);let h=this.topicValidators.get(r.topic);if(h!=null){let l;try{l=await h(a.topic,a,e)}catch(d){let p=d.code;p===dd&&(l=er.Ignore),p===pd?l=er.Reject:l=er.Ignore}if(l!==er.Accept)return{code:Et.invalid,reason:eu(l),msgIdStr:u}}return{code:Et.valid,messageId:c,msg:a}}getScore(e){return this.score.score(e)}sendSubscriptions(e,r,n){this.sendRpc(e,{subscriptions:r.map(i=>({topic:i,subscribe:n})),messages:[]})}async handleControlMessage(e,r){if(r===void 0)return;let n=r.ihave?this.handleIHave(e,r.ihave):[],i=r.iwant?this.handleIWant(e,r.iwant):[],s=r.graft?await this.handleGraft(e,r.graft):[];r.prune&&await this.handlePrune(e,r.prune),!(!n.length&&!i.length&&!s.length)&&this.sendRpc(e,Qt(i,{iwant:n,prune:s}))}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let i=this.score.score(e);return i>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(e),i>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:ci.LowScore}),[];let i=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,i),i>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:ci.MaxIhave}),[];let s=this.iasked.get(e)??0;if(s>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:ci.MaxIasked}),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:c})=>{if(!u||!c||!this.mesh.has(u))return;let h=0;c.forEach(l=>{let d=this.msgIdToStrFn(l);this.seenCache.has(d)||(o.set(d,l),h++)}),this.metrics?.onIhaveRcv(u,c.length,h)}),!o.size)return[];let a=o.size;a+s>5e3&&(a=5e3-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let f=Array.from(o.values());return Jt(f),f=f.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,f),[{messageIDs:f}]}handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let i=new Map,s=new Map,o=0;return r.forEach(({messageIDs:a})=>{a&&a.forEach(f=>{let u=this.msgIdToStrFn(f),c=this.mcache.getWithIWantCount(u,e);if(c==null){o++;return}if(s.set(c.msg.topic,1+(s.get(c.msg.topic)??0)),c.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,f);return}i.set(u,c.msg)})}),this.metrics?.onIwantRcv(s,o),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,r){let n=[],i=this.score.score(e),s=Date.now(),o=this.opts.doPX;return r.forEach(({topicID:a})=>{if(!a)return;let f=this.mesh.get(a);if(!f){o=!1;return}if(f.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(a),o=!1;return}let u=this.backoff.get(a)?.get(e);if(typeof u=="number"&&s<u){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,ai.GraftBackoff),o=!1;let c=u+this.opts.graftFloodThreshold-this.opts.pruneBackoff;s<c&&this.score.addPenalty(e,1,ai.GraftBackoff),this.addBackoff(e,a),n.push(a);return}if(i<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,a),n.push(a),o=!1,this.addBackoff(e,a);return}if(f.size>=this.opts.Dhi&&!this.outbound.get(e)){n.push(a),this.addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),f.add(e),this.metrics?.onAddToMesh(a,dr.Subscribed,1)}),n.length?await Promise.all(n.map(a=>this.makePrune(e,a,o))):[]}async handlePrune(e,r){let n=this.score.score(e);for(let{topicID:i,backoff:s,peers:o}of r){if(i==null)continue;let a=this.mesh.get(i);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(i,ln.Unsub,1)),typeof s=="number"&&s>0?this.doAddBackoff(e,i,s*1e3):this.addBackoff(e,i),o&&o.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);continue}await this.pxConnect(o)}}}addBackoff(e,r){this.doAddBackoff(e,r,this.opts.pruneBackoff)}doAddBackoff(e,r,n){let i=this.backoff.get(r);i||(i=new Map,this.backoff.set(r,i));let s=Date.now()+n;(i.get(e)??0)<s&&i.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,ai.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((r,n)=>{r.forEach((i,s)=>{i<e&&r.delete(s)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let e=[];this.direct.forEach(r=>{this.streamsOutbound.has(r)||e.push(r)}),await Promise.all(e.map(async r=>await this.connect(r)))}async pxConnect(e){e.length>this.opts.prunePeers&&(Jt(e),e=e.slice(0,this.opts.prunePeers));let r=[];await Promise.all(e.map(async n=>{if(!n.peerID)return;let i=$t(n.peerID).toString();if(!this.peers.has(i)){if(!n.signedPeerRecord){r.push(i);return}try{let s=await wt.openAndCertify(n.signedPeerRecord,"libp2p-peer-record"),o=s.peerId;if(!s.peerId.equals(i)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",o,i);return}if(!await this.components.getPeerStore().addressBook.consumePeerRecord(s)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(i)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length&&await Promise.all(r.map(async n=>await this.connect(n)))}async connect(e){this.log("Initiating connection with %s",e);let r=hr(e),n=await this.components.getConnectionManager().openConnection(r);for(let i of this.multicodecs)for(let s of this.components.getRegistrar().getTopologies(i))s.onConnect(r,n)}subscribe(e){if(this.status.code!==yt.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==yt.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e).catch(n=>{this.log(n)})}join(e){if(this.status.code!==yt.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,n=this.fanout.get(e);if(n&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),n.forEach(i=>{!this.direct.has(i)&&this.score.score(i)>=0&&r.add(i)}),this.metrics?.onAddToMesh(e,dr.Fanout,r.size)),r.size<this.opts.D){let i=r.size;this.getRandomGossipPeers(e,this.opts.D,o=>!r.has(o)&&!this.direct.has(o)&&this.score.score(o)>=0).forEach(o=>{r.add(o)}),this.metrics?.onAddToMesh(e,dr.Random,r.size-i)}this.mesh.set(e,r),r.forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this.sendGraft(i,e)})}async leave(e){if(this.status.code!==yt.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r&&(await Promise.all(Array.from(r).map(async n=>(this.log("LEAVE: Remove mesh link to %s in %s",n,e),await this.sendPrune(n,e)))),this.mesh.delete(e))}selectPeersToForward(e,r,n){let i=new Set,s=this.topics.get(e);s&&(this.direct.forEach(a=>{s.has(a)&&r!==a&&!n?.has(a)&&i.add(a)}),this.floodsubPeers.forEach(a=>{s.has(a)&&r!==a&&!n?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&i.add(a)}));let o=this.mesh.get(e);return o&&o.size>0&&o.forEach(a=>{r!==a&&!n?.has(a)&&i.add(a)}),i}selectPeersToPublish(e){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},i=this.topics.get(e);if(i)if(this.opts.floodPublish)i.forEach(s=>{this.direct.has(s)?(r.add(s),n.direct++):this.score.score(s)>=this.opts.scoreThresholds.publishThreshold&&(r.add(s),n.floodsub++)});else{this.direct.forEach(o=>{i.has(o)&&(r.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{i.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});let s=this.mesh.get(e);if(s&&s.size>0)s.forEach(o=>{r.add(o),n.mesh++});else{let o=this.fanout.get(e);if(o&&o.size>0)o.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,f=>this.score.score(f)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(f=>{r.add(f),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(e,r,n,i){n&&this.score.deliverMessage(n,e,r.topic);let s=this.selectPeersToForward(r.topic,n,i),o=Qt([r]);s.forEach(a=>{this.sendRpc(a,o)}),this.metrics?.onForwardMsg(r.topic,s.size)}async publish(e,r){let n=this.dataTransform?this.dataTransform.outboundTransform(e,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let i=await Cd(this.publishConfig,e,n),s={from:i.from?$t(i.from):void 0,data:r,sequenceNumber:i.seqno==null?void 0:BigInt(`0x${j(i.seqno,"base16")}`),topic:e,signature:i.signature??void 0,key:i.key??void 0},o=await this.msgIdFn(s),a=this.msgIdToStrFn(o);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");let{tosend:f,tosendCount:u}=this.selectPeersToPublish(i.topic),c=this.opts.emitSelf===!0&&this.subscriptions.has(e);if(f.size===0&&!this.opts.allowPublishToZeroPeers&&!c)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:o,msgIdStr:a},i,!0),this.publishedMessageIds.put(a);let h=Qt([i]);for(let l of f)this.sendRpc(l,h)||f.delete(l);return this.metrics?.onPublishMsg(e,u,f.size,i.data!=null?i.data.length:0),c&&(f.add(this.components.getPeerId().toString()),super.dispatchEvent(new an("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:a,msg:s}})),super.dispatchEvent(new an("message",{detail:s}))),{recipients:Array.from(f.values()).map(l=>hr(l))}}reportMessageValidationResult(e,r,n){if(n===er.Accept){let i=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(i!==null),i!=null){let{message:s,originatingPeers:o}=i;this.score.deliverMessage(r.toString(),e,s.topic),this.forwardMessage(e,i.message,r.toString(),o),this.metrics?.onReportValidation(s.topic,n)}}else{let i=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(i!==null),i){let s=eu(n),{message:o,originatingPeers:a}=i;this.score.rejectMessage(r.toString(),e,o.topic,s);for(let f of a)this.score.rejectMessage(f,e,o.topic,s);this.metrics?.onReportValidation(o.topic,n)}}}sendGraft(e,r){let i=Qt([],{graft:[{topicID:r}]});this.sendRpc(e,i)}async sendPrune(e,r){let n=[await this.makePrune(e,r,this.opts.doPX)],i=Qt([],{prune:n});this.sendRpc(e,i)}sendRpc(e,r){let n=this.streamsOutbound.get(e);if(!n)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let i=this.control.get(e);i&&(this.piggybackControl(e,r,i),this.control.delete(e));let s=this.gossip.get(e);s&&(this.piggybackGossip(e,r,s),this.gossip.delete(e));let o=ti.encode(r).finish();return n.push(o),this.metrics?.onRpcSent(r,o.length),!0}piggybackControl(e,r,n){let i=(n.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(n.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!i.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(i),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={graft:i,prune:s,ihave:[],iwant:[]})}piggybackGossip(e,r,n){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=n}async sendGraftPrune(e,r,n){let i=this.opts.doPX;for(let[s,o]of e){let a=o.map(h=>({topicID:h})),f=[],u=r.get(s);u&&(f=await Promise.all(u.map(async h=>await this.makePrune(s,h,i&&!(n.get(s)??!1)))),r.delete(s));let c=Qt([],{graft:a,prune:f});this.sendRpc(s,c)}for(let[s,o]of r){let a=await Promise.all(o.map(async u=>await this.makePrune(s,u,i&&!(n.get(s)??!1)))),f=Qt([],{prune:a});this.sendRpc(s,f)}}emitGossip(e){let r=this.mcache.getGossipIDs(new Set(e.keys()));for(let[n,i]of e)this.doEmitGossip(n,i,r.get(n)??[])}doEmitGossip(e,r,n){if(!n.length||(Jt(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!r.size))return;let i=this.opts.Dlazy,s=.25*r.size,o=r;s>i&&(i=s),i>o.size?i=o.size:o=Jt(Array.from(o)).slice(0,i),o.forEach(a=>{let f=n;n.length>5e3&&(f=Jt(f.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:e,messageIDs:f})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,Qt([],{ihave:r}));for(let[e,r]of this.control.entries())this.control.delete(e),this.sendRpc(e,Qt([],{graft:r.graft,prune:r.prune}))}pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}async makePrune(e,r,n){if(this.score.prune(e,r),this.streamsOutbound.get(e).protocol===Jc)return{topicID:r,peers:[]};let i=this.opts.pruneBackoff/1e3;if(!n)return{topicID:r,peers:[],backoff:i};let s=this.getRandomGossipPeers(r,this.opts.prunePeers,a=>a!==e&&this.score.score(a)>=0),o=await Promise.all(Array.from(s).map(async a=>{let f=hr(a);return{peerID:f.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(f)}}));return{topicID:r,peers:o,backoff:i}}async heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:i,Dout:s,fanoutTTL:o}=this.opts;this.heartbeatTicks++;let a=new Map,f=p=>{let g=a.get(p);return g===void 0&&(g=this.score.score(p),a.set(p,g)),g},u=new Map,c=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((p,g)=>{let m=this.topics.get(g),v=new Set,S=new Set;if(l.set(g,S),m){let w=Jt(Array.from(m)),A=this.backoff.get(g);for(let L of w){let O=this.streamsOutbound.get(L);if(O&&this.multicodecs.includes(O.protocol)&&!p.has(L)&&!this.direct.has(L)){let G=f(L);(!A||!A.has(L))&&G>=0&&v.add(L),G>=this.opts.scoreThresholds.gossipThreshold&&S.add(L)}}}let C=(w,A)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",w,g),this.addBackoff(w,g),p.delete(w),f(w)>=this.opts.scoreThresholds.gossipThreshold&&S.add(w),this.metrics?.onRemoveFromMesh(g,A,1);let L=c.get(w);L?L.push(g):c.set(w,[g])},D=(w,A)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",w,g),this.score.graft(w,g),p.add(w),S.delete(w),this.metrics?.onAddToMesh(g,A,1);let L=u.get(w);L?L.push(g):u.set(w,[g])};if(p.forEach(w=>{let A=f(w);A<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",w,A,g),C(w,ln.BadScore),h.set(w,!0))}),p.size<r){let w=e-p.size;uy(v,w).forEach(L=>{D(L,dr.NotEnough)})}if(p.size>n){let w=Array.from(p);w.sort((L,O)=>f(O)-f(L)),w=w.slice(0,i).concat(Jt(w.slice(i)));let A=0;if(w.slice(0,e).forEach(L=>{this.outbound.get(L)&&A++}),A<s){let L=G=>{let _e=w[G];for(let Ke=G;Ke>0;Ke--)w[Ke]=w[Ke-1];w[0]=_e};if(A>0){let G=A;for(let _e=1;_e<e&&G>0;_e++)this.outbound.get(w[_e])&&(L(_e),G--)}let O=e-A;for(let G=e;G<w.length&&O>0;G++)this.outbound.get(w[G])&&(L(G),O--)}w.slice(e).forEach(L=>{C(L,ln.Excess)})}if(p.size>=r){let w=0;if(p.forEach(A=>{this.outbound.get(A)&&w++}),w<s){let A=s-w;$o(v,A,O=>this.outbound.get(O)===!0).forEach(O=>{D(O,dr.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let w=Array.from(p).sort((O,G)=>f(O)-f(G)),A=Math.floor(p.size/2),L=f(w[A]);if(L<this.opts.scoreThresholds.opportunisticGraftThreshold){let O=this.opts.opportunisticGraftPeers,G=$o(v,O,_e=>f(_e)>L);for(let _e of G)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",_e,g),D(_e,dr.Opportunistic)}}});let d=Date.now();this.fanoutLastpub.forEach((p,g)=>{p+o<d&&(this.fanout.delete(g),this.fanoutLastpub.delete(g))}),this.fanout.forEach((p,g)=>{let m=this.topics.get(g);p.forEach(D=>{(!m.has(D)||f(D)<this.opts.scoreThresholds.publishThreshold)&&p.delete(D)});let v=this.topics.get(g),S=[],C=new Set;if(l.set(g,C),v){let D=Jt(Array.from(v));for(let w of D){let A=this.streamsOutbound.get(w);if(A&&this.multicodecs.includes(A.protocol)&&!p.has(w)&&!this.direct.has(w)){let L=f(w);L>=this.opts.scoreThresholds.publishThreshold&&S.push(w),L>=this.opts.scoreThresholds.gossipThreshold&&C.add(w)}}}if(p.size<e){let D=e-p.size;S.slice(0,D).forEach(w=>{p.add(w),C?.delete(w)})}}),this.emitGossip(l),await this.sendGraftPrune(u,c,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new an("gossipsub:heartbeat"))}getRandomGossipPeers(e,r,n=()=>!0){let i=this.topics.get(e);if(!i)return new Set;let s=[];return i.forEach(o=>{let a=this.streamsOutbound.get(o);!a||this.multicodecs.includes(a.protocol)&&n(o)&&s.push(o)}),s=Jt(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0;for(let o of this.backoff.values())r+=o.size;e.cacheSize.set({cache:"backoff"},r);for(let[o,a]of this.topics)e.topicPeersCount.set({topicStr:o},a.size);for(let[o,a]of this.mesh)e.meshPeerCounts.set({topicStr:o},a.size);let n=[],i=new Map;e.behaviourPenalty.reset();for(let o of this.peers.keys()){let a=this.score.score(o);n.push(a),i.set(o,a),e.behaviourPenalty.observe(this.score.peerStats.get(o)?.behaviourPenalty??0)}e.registerScores(n,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,i);let s=cy(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}};ea.multicodec=_o;return _y(Z4);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return ChainsafeLibp2PGossipsub}));
