(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pGossipsub=(()=>{var e3=Object.create;var yl=Object.defineProperty;var t3=Object.getOwnPropertyDescriptor;var r3=Object.getOwnPropertyNames;var i3=Object.getPrototypeOf,n3=Object.prototype.hasOwnProperty;var Dm=t=>yl(t,"__esModule",{value:!0});var gl=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Ge=(t,e)=>()=>(t&&(e=t(t=0)),e);var b=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),tr=(t,e)=>{Dm(t);for(var r in e)yl(t,r,{get:e[r],enumerable:!0})},s3=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of r3(e))!n3.call(t,i)&&i!=="default"&&yl(t,i,{get:()=>e[i],enumerable:!(r=t3(e,i))||r.enumerable});return t},Oc=t=>s3(Dm(yl(t!=null?e3(i3(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var kr=b((J$,Xa)=>{var Om=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},Sh=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),ml=t=>t&&typeof t.sink=="function"&&Sh(t.source),a3=t=>e=>(t.sink(e),t.source),Nm=(...t)=>{if(ml(t[0])){let e=t[0];t[0]=()=>e.source}else if(Sh(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&ml(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)ml(t[e])&&(t[e]=a3(t[e]));return Om(...t)};Xa.exports=Nm;Xa.exports.pipe=Nm;Xa.exports.rawPipe=Om;Xa.exports.isIterable=Sh;Xa.exports.isDuplex=ml});var Lm=b((eY,km)=>{var Za=1e3,Ja=Za*60,eo=Ja*60,zs=eo*24,o3=zs*7,c3=zs*365.25;km.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return u3(t);if(r==="number"&&isFinite(t))return e.long?f3(t):l3(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function u3(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*c3;case"weeks":case"week":case"w":return r*o3;case"days":case"day":case"d":return r*zs;case"hours":case"hour":case"hrs":case"hr":case"h":return r*eo;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ja;case"seconds":case"second":case"secs":case"sec":case"s":return r*Za;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function l3(t){var e=Math.abs(t);return e>=zs?Math.round(t/zs)+"d":e>=eo?Math.round(t/eo)+"h":e>=Ja?Math.round(t/Ja)+"m":e>=Za?Math.round(t/Za)+"s":t+"ms"}function f3(t){var e=Math.abs(t);return e>=zs?vl(t,e,zs,"day"):e>=eo?vl(t,e,eo,"hour"):e>=Ja?vl(t,e,Ja,"minute"):e>=Za?vl(t,e,Za,"second"):t+" ms"}function vl(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var qm=b((tY,Mm)=>{function h3(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=n,r.enabled=a,r.humanize=Lm(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let f=0;for(let h=0;h<l.length;h++)f=(f<<5)-f+l.charCodeAt(h),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(l){let f,h=null,p,d;function y(...g){if(!y.enabled)return;let m=y,w=Number(new Date),C=w-(f||w);m.diff=C,m.prev=f,m.curr=w,f=w,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let V=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(A,te)=>{if(A==="%%")return"%";V++;let ie=r.formatters[te];if(typeof ie=="function"){let $=g[V];A=ie.call(m,$),g.splice(V,1),V--}return A}),r.formatArgs.call(m,g),(m.log||r.log).apply(m,g)}return y.namespace=l,y.useColors=r.useColors(),y.color=r.selectColor(l),y.extend=i,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==r.namespaces&&(p=r.namespaces,d=r.enabled(l)),d),set:g=>{h=g}}),typeof r.init=="function"&&r.init(y),y}function i(l,f){let h=r(this.namespace+(typeof f=="undefined"?":":f)+l);return h.log=this.log,h}function n(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,h=(typeof l=="string"?l:"").split(/[\s,]+/),p=h.length;for(f=0;f<p;f++)!h[f]||(l=h[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(o),...r.skips.map(o).map(f=>"-"+f)].join(",");return r.enable(""),l}function a(l){if(l[l.length-1]==="*")return!0;let f,h;for(f=0,h=r.skips.length;f<h;f++)if(r.skips[f].test(l))return!1;for(f=0,h=r.names.length;f<h;f++)if(r.names[f].test(l))return!0;return!1}function o(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Mm.exports=h3});var qe=b((Jr,bl)=>{Jr.formatArgs=p3;Jr.save=y3;Jr.load=g3;Jr.useColors=d3;Jr.storage=m3();Jr.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Jr.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function d3(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function p3(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+bl.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}Jr.log=console.debug||console.log||(()=>{});function y3(t){try{t?Jr.storage.setItem("debug",t):Jr.storage.removeItem("debug")}catch(e){}}function g3(){let t;try{t=Jr.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function m3(){try{return localStorage}catch(t){}}bl.exports=qm()(Jr);var{formatters:v3}=bl.exports;v3.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var _r=b((rY,xh)=>{"use strict";var to=typeof Reflect=="object"?Reflect:null,Um=to&&typeof to.apply=="function"?to.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},El;to&&typeof to.ownKeys=="function"?El=to.ownKeys:Object.getOwnPropertySymbols?El=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:El=function(e){return Object.getOwnPropertyNames(e)};function b3(t){console&&console.warn&&console.warn(t)}var Fm=Number.isNaN||function(e){return e!==e};function ht(){ht.init.call(this)}xh.exports=ht;xh.exports.once=S3;ht.EventEmitter=ht;ht.prototype._events=void 0;ht.prototype._eventsCount=0;ht.prototype._maxListeners=void 0;var Km=10;function wl(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ht,"defaultMaxListeners",{enumerable:!0,get:function(){return Km},set:function(t){if(typeof t!="number"||t<0||Fm(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Km=t}});ht.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ht.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Fm(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Vm(t){return t._maxListeners===void 0?ht.defaultMaxListeners:t._maxListeners}ht.prototype.getMaxListeners=function(){return Vm(this)};ht.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Um(c,this,r);else for(var u=c.length,l=Wm(c,u),i=0;i<u;++i)Um(l[i],this,r);return!0};function jm(t,e,r,i){var n,s,a;if(wl(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),a===void 0)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),n=Vm(t),n>0&&a.length>n&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,b3(o)}return t}ht.prototype.addListener=function(e,r){return jm(this,e,r,!1)};ht.prototype.on=ht.prototype.addListener;ht.prototype.prependListener=function(e,r){return jm(this,e,r,!0)};function E3(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Gm(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=E3.bind(i);return n.listener=r,i.wrapFn=n,n}ht.prototype.once=function(e,r){return wl(r),this.on(e,Gm(this,e,r)),this};ht.prototype.prependOnceListener=function(e,r){return wl(r),this.prependListener(e,Gm(this,e,r)),this};ht.prototype.removeListener=function(e,r){var i,n,s,a,o;if(wl(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===r||i[a].listener===r){o=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():w3(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,o||r)}return this};ht.prototype.off=ht.prototype.removeListener;ht.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(n=0;n<s.length;++n)a=s[n],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function Hm(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?_3(n):Wm(n,n.length)}ht.prototype.listeners=function(e){return Hm(this,e,!0)};ht.prototype.rawListeners=function(e){return Hm(this,e,!1)};ht.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):zm.call(t,e)};ht.prototype.listenerCount=zm;function zm(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ht.prototype.eventNames=function(){return this._eventsCount>0?El(this._events):[]};function Wm(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function w3(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function _3(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function S3(t,e){return new Promise(function(r,i){function n(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}$m(t,e,s,{once:!0}),e!=="error"&&x3(t,n,{once:!0})})}function x3(t,e,r){typeof t.on=="function"&&$m(t,"error",e,r)}function $m(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var Ae=b((iY,Qm)=>{"use strict";function Ym(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function C3(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Ym(t,r)}catch(i){r.message=t.message,r.stack=t.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),Ym(new n,r)}}Qm.exports=C3});function Zm(t,e,r){e=e||[],r=r||0;for(var i=r;t>=R3;)e[r++]=t&255|Xm,t/=128;for(;t&T3;)e[r++]=t&255|Xm,t>>>=7;return e[r]=t|0,Zm.bytes=r-i+1,e}function Ch(t,e){var r=0,e=e||0,i=0,n=e,s,a=t.length;do{if(n>=a)throw Ch.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Jm)<<i:(s&Jm)*Math.pow(2,i),i+=7}while(s>=B3);return Ch.bytes=n-e,r}var I3,Xm,A3,T3,R3,P3,B3,Jm,D3,O3,N3,k3,L3,M3,q3,U3,F3,K3,V3,j3,Nc,ev=Ge(()=>{I3=Zm,Xm=128,A3=127,T3=~A3,R3=Math.pow(2,31);P3=Ch,B3=128,Jm=127;D3=Math.pow(2,7),O3=Math.pow(2,14),N3=Math.pow(2,21),k3=Math.pow(2,28),L3=Math.pow(2,35),M3=Math.pow(2,42),q3=Math.pow(2,49),U3=Math.pow(2,56),F3=Math.pow(2,63),K3=function(t){return t<D3?1:t<O3?2:t<N3?3:t<k3?4:t<L3?5:t<M3?6:t<q3?7:t<U3?8:t<F3?9:10},V3={encode:I3,decode:P3,encodingLength:K3},j3=V3,Nc=j3});var kc,ro,io,_l=Ge(()=>{ev();kc=t=>[Nc.decode(t),Nc.decode.bytes],ro=(t,e,r=0)=>(Nc.encode(t,e,r),e),io=t=>Nc.encodingLength(t)});var aY,rv,Bn,iv,nv,rs=Ge(()=>{aY=new Uint8Array(0),rv=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Bn=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},iv=t=>new TextEncoder().encode(t),nv=t=>new TextDecoder().decode(t)});var Lc={};tr(Lc,{Digest:()=>no,create:()=>is,decode:()=>Ih,equals:()=>Ah});var is,Ih,Ah,no,Ws=Ge(()=>{rs();_l();is=(t,e)=>{let r=e.byteLength,i=io(t),n=i+io(r),s=new Uint8Array(n+r);return ro(t,s,0),ro(r,s,i),s.set(e,n),new no(t,r,e,s)},Ih=t=>{let e=Bn(t),[r,i]=kc(e),[n,s]=kc(e.subarray(i)),a=e.subarray(i+s);if(a.byteLength!==n)throw new Error("Incorrect length");return new no(r,n,a,e)},Ah=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&rv(t.bytes,e.bytes),no=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}});function G3(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var o=t.length,c=t.charAt(0),u=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function f(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var y=0,g=0,m=0,w=d.length;m!==w&&d[m]===0;)m++,y++;for(var C=(w-m)*l+1>>>0,V=new Uint8Array(C);m!==w;){for(var T=d[m],A=0,te=C-1;(T!==0||A<g)&&te!==-1;te--,A++)T+=256*V[te]>>>0,V[te]=T%o>>>0,T=T/o>>>0;if(T!==0)throw new Error("Non-zero carry");g=A,m++}for(var ie=C-g;ie!==C&&V[ie]===0;)ie++;for(var $=c.repeat(y);ie<C;++ie)$+=t.charAt(V[ie]);return $}function h(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var y=0;if(d[y]!==" "){for(var g=0,m=0;d[y]===c;)g++,y++;for(var w=(d.length-y)*u+1>>>0,C=new Uint8Array(w);d[y];){var V=r[d.charCodeAt(y)];if(V===255)return;for(var T=0,A=w-1;(V!==0||T<m)&&A!==-1;A--,T++)V+=o*C[A]>>>0,C[A]=V%256>>>0,V=V/256>>>0;if(V!==0)throw new Error("Non-zero carry");m=T,y++}if(d[y]!==" "){for(var te=w-m;te!==w&&C[te]===0;)te++;for(var ie=new Uint8Array(g+(w-te)),$=g;te!==w;)ie[$++]=C[te++];return ie}}}function p(d){var y=h(d);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:h,decode:p}}var H3,z3,av,ov=Ge(()=>{H3=G3,z3=H3,av=z3});var cv,uv,lv,fv,hv,Sl,ns,W3,$3,Ft,Xi=Ge(()=>{ov();rs();cv=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},uv=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return fv(this,e)}},lv=class{constructor(e){this.decoders=e}or(e){return fv(this,e)}decode(e){let r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},fv=(t,e)=>new lv({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),hv=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new cv(e,r,i),this.decoder=new uv(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Sl=({name:t,prefix:e,encode:r,decode:i})=>new hv(t,e,r,i),ns=({prefix:t,name:e,alphabet:r})=>{let{encode:i,decode:n}=av(r,e);return Sl({prefix:t,name:e,encode:i,decode:s=>Bn(n(s))})},W3=(t,e,r,i)=>{let n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,c=0,u=0;for(let l=0;l<s;++l){let f=n[t[l]];if(f===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|f,o+=r,o>=8&&(o-=8,a[u++]=255&c>>o)}if(o>=r||255&c<<8-o)throw new SyntaxError("Unexpected end of data");return a},$3=(t,e,r)=>{let i=e[e.length-1]==="=",n=(1<<r)-1,s="",a=0,o=0;for(let c=0;c<t.length;++c)for(o=o<<8|t[c],a+=8;a>r;)a-=r,s+=e[n&o>>a];if(a&&(s+=e[n&o<<r-a]),i)for(;s.length*r&7;)s+="=";return s},Ft=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Sl({prefix:e,name:t,encode(n){return $3(n,i,r)},decode(n){return W3(n,i,r,t)}})});var ss={};tr(ss,{base58btc:()=>Zi,base58flickr:()=>Y3});var Zi,Y3,as=Ge(()=>{Xi();Zi=ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Y3=ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var $s={};tr($s,{base32:()=>so,base32hex:()=>J3,base32hexpad:()=>tO,base32hexpadupper:()=>rO,base32hexupper:()=>eO,base32pad:()=>X3,base32padupper:()=>Z3,base32upper:()=>Q3,base32z:()=>iO});var so,Q3,X3,Z3,J3,eO,tO,rO,iO,Ys=Ge(()=>{Xi();so=Ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Q3=Ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),X3=Ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Z3=Ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),J3=Ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eO=Ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),tO=Ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rO=Ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),iO=Ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var qc={};tr(qc,{CID:()=>sr});var sr,nO,sO,aO,Mc,oO,dv,pv,xl,Cl,cO,uO,lO,ao=Ge(()=>{_l();Ws();as();Ys();rs();sr=class{constructor(e,r,i,n){this.code=r,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Cl,byteLength:Cl,code:xl,version:xl,multihash:xl,bytes:xl,_baseCache:Cl,asCID:Cl})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Mc)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==oO)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return sr.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,i=is(e,r);return sr.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ah(this.multihash,e.multihash)}toString(e){let{bytes:r,version:i,_baseCache:n}=this;switch(i){case 0:return sO(r,n,e||Zi.encoder);default:return aO(r,n,e||so.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return uO(/^0\.0/,lO),!!(e&&(e[pv]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof sr)return e;if(e!=null&&e.asCID===e){let{version:r,code:i,multihash:n,bytes:s}=e;return new sr(r,i,n,s||dv(r,i,n.bytes))}else if(e!=null&&e[pv]===!0){let{version:r,multihash:i,code:n}=e,s=Ih(i);return sr.create(r,n,s)}else return null}static create(e,r,i){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Mc)throw new Error(`Version 0 CID must use dag-pb (code: ${Mc}) block encoding`);return new sr(e,r,i,i.bytes)}case 1:{let n=dv(e,r,i.bytes);return new sr(e,r,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return sr.create(0,Mc,e)}static createV1(e,r){return sr.create(1,e,r)}static decode(e){let[r,i]=sr.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=sr.inspectBytes(e),i=r.size-r.multihashSize,n=Bn(e.subarray(i,i+r.multihashSize));if(n.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=n.subarray(r.multihashSize-r.digestSize),a=new no(r.multihashCode,r.digestSize,s,n);return[r.version===0?sr.createV0(a):sr.createV1(r.codec,a),e.subarray(r.size)]}static inspectBytes(e){let r=0,i=()=>{let[f,h]=kc(e.subarray(r));return r+=h,f},n=i(),s=Mc;if(n===18?(n=0,r=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let a=r,o=i(),c=i(),u=r+c,l=u-a;return{version:n,codec:s,multihashCode:o,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[i,n]=nO(e,r),s=sr.decode(n);return s._baseCache.set(i,e),s}},nO=(t,e)=>{switch(t[0]){case"Q":{let r=e||Zi;return[Zi.prefix,r.decode(`${Zi.prefix}${t}`)]}case Zi.prefix:{let r=e||Zi;return[Zi.prefix,r.decode(t)]}case so.prefix:{let r=e||so;return[so.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},sO=(t,e,r)=>{let{prefix:i}=r;if(i!==Zi.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let n=e.get(i);if(n==null){let s=r.encode(t).slice(1);return e.set(i,s),s}else return n},aO=(t,e,r)=>{let{prefix:i}=r,n=e.get(i);if(n==null){let s=r.encode(t);return e.set(i,s),s}else return n},Mc=112,oO=18,dv=(t,e,r)=>{let i=io(t),n=i+io(e),s=new Uint8Array(n+r.byteLength);return ro(t,s,0),ro(e,s,i),s.set(r,n),s},pv=Symbol.for("@ipld/js-cid/CID"),xl={writable:!1,configurable:!1,enumerable:!0},Cl={writable:!1,enumerable:!1,configurable:!1},cO="0.0.0-dev",uO=(t,e)=>{if(t.test(cO))console.warn(e);else throw new Error(e)},lO=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Il={};tr(Il,{base36:()=>fO,base36upper:()=>hO});var fO,hO,Th=Ge(()=>{Xi();fO=ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hO=ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var oo={};tr(oo,{base64:()=>dO,base64pad:()=>pO,base64url:()=>yO,base64urlpad:()=>gO});var dO,pO,yO,gO,Uc=Ge(()=>{Xi();dO=Ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pO=Ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yO=Ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),gO=Ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Al={};tr(Al,{base16:()=>mO,base16upper:()=>vO});var mO,vO,Rh=Ge(()=>{Xi();mO=Ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),vO=Ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var gv=b((SY,yv)=>{"use strict";yv.exports=bO;function bO(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(o,c){r[i]=function(l){if(s)if(s=!1,l)c(l);else{for(var f=new Array(arguments.length-1),h=0;h<f.length;)f[h++]=arguments[h];o.apply(null,f)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var Ev=b(bv=>{"use strict";var Tl=bv;Tl.length=function(e){var r=e.length;if(!r)return 0;for(var i=0;--r%4>1&&e.charAt(r)==="=";)++i;return Math.ceil(e.length*3)/4-i};var co=new Array(64),mv=new Array(123);for(Li=0;Li<64;)mv[co[Li]=Li<26?Li+65:Li<52?Li+71:Li<62?Li-4:Li-59|43]=Li++;var Li;Tl.encode=function(e,r,i){for(var n=null,s=[],a=0,o=0,c;r<i;){var u=e[r++];switch(o){case 0:s[a++]=co[u>>2],c=(u&3)<<4,o=1;break;case 1:s[a++]=co[c|u>>4],c=(u&15)<<2,o=2;break;case 2:s[a++]=co[c|u>>6],s[a++]=co[u&63],o=0;break}a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=co[c],s[a++]=61,o===1&&(s[a++]=61)),n?(a&&n.push(String.fromCharCode.apply(String,s.slice(0,a))),n.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var vv="invalid encoding";Tl.decode=function(e,r,i){for(var n=i,s=0,a,o=0;o<e.length;){var c=e.charCodeAt(o++);if(c===61&&s>1)break;if((c=mv[c])===void 0)throw Error(vv);switch(s){case 0:a=c,s=1;break;case 1:r[i++]=a<<2|(c&48)>>4,a=c,s=2;break;case 2:r[i++]=(a&15)<<4|(c&60)>>2,a=c,s=3;break;case 3:r[i++]=(a&3)<<6|c,s=0;break}}if(s===1)throw Error(vv);return i-n};Tl.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var _v=b((CY,wv)=>{"use strict";wv.exports=Rl;function Rl(){this._listeners={}}Rl.prototype.on=function(e,r,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:i||this}),this};Rl.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===r?i.splice(n,1):++n;return this};Rl.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}});var Rv=b((IY,Tv)=>{"use strict";Tv.exports=Sv(Sv);function Sv(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),i=r[3]===128;function n(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=i?n:s,t.writeFloatBE=i?s:n;function a(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function o(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=i?a:o,t.readFloatBE=i?o:a}():function(){function e(i,n,s,a){var o=n<0?1:0;if(o&&(n=-n),n===0)i(1/n>0?0:2147483648,s,a);else if(isNaN(n))i(2143289344,s,a);else if(n>34028234663852886e22)i((o<<31|2139095040)>>>0,s,a);else if(n<11754943508222875e-54)i((o<<31|Math.round(n/1401298464324817e-60))>>>0,s,a);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((o<<31|c+127<<23|u)>>>0,s,a)}}t.writeFloatLE=e.bind(null,xv),t.writeFloatBE=e.bind(null,Cv);function r(i,n,s){var a=i(n,s),o=(a>>31)*2+1,c=a>>>23&255,u=a&8388607;return c===255?u?NaN:o*(1/0):c===0?o*1401298464324817e-60*u:o*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,Iv),t.readFloatBE=r.bind(null,Av)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),i=r[7]===128;function n(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=i?n:s,t.writeDoubleBE=i?s:n;function a(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function o(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=i?a:o,t.readDoubleBE=i?o:a}():function(){function e(i,n,s,a,o,c){var u=a<0?1:0;if(u&&(a=-a),a===0)i(0,o,c+n),i(1/a>0?0:2147483648,o,c+s);else if(isNaN(a))i(0,o,c+n),i(2146959360,o,c+s);else if(a>17976931348623157e292)i(0,o,c+n),i((u<<31|2146435072)>>>0,o,c+s);else{var l;if(a<22250738585072014e-324)l=a/5e-324,i(l>>>0,o,c+n),i((u<<31|l/4294967296)>>>0,o,c+s);else{var f=Math.floor(Math.log(a)/Math.LN2);f===1024&&(f=1023),l=a*Math.pow(2,-f),i(l*4503599627370496>>>0,o,c+n),i((u<<31|f+1023<<20|l*1048576&1048575)>>>0,o,c+s)}}}t.writeDoubleLE=e.bind(null,xv,0,4),t.writeDoubleBE=e.bind(null,Cv,4,0);function r(i,n,s,a,o){var c=i(a,o+n),u=i(a,o+s),l=(u>>31)*2+1,f=u>>>20&2047,h=4294967296*(u&1048575)+c;return f===2047?h?NaN:l*(1/0):f===0?l*5e-324*h:l*Math.pow(2,f-1075)*(h+4503599627370496)}t.readDoubleLE=r.bind(null,Iv,0,4),t.readDoubleBE=r.bind(null,Av,4,0)}(),t}function xv(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Cv(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Iv(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Av(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Pv=b((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Dv=b(Bv=>{"use strict";var Ph=Bv;Ph.length=function(e){for(var r=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?r+=1:i<2048?r+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,r+=4):r+=3;return r};Ph.read=function(e,r,i){var n=i-r;if(n<1)return"";for(var s=null,a=[],o=0,c;r<i;)c=e[r++],c<128?a[o++]=c:c>191&&c<224?a[o++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,a[o++]=55296+(c>>10),a[o++]=56320+(c&1023)):a[o++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};Ph.write=function(e,r,i){for(var n=i,s,a,o=0;o<e.length;++o)s=e.charCodeAt(o),s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):(s&64512)==55296&&((a=e.charCodeAt(o+1))&64512)==56320?(s=65536+((s&1023)<<10)+(a&1023),++o,r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128);return i-n}});var Nv=b((TY,Ov)=>{"use strict";Ov.exports=EO;function EO(t,e,r){var i=r||8192,n=i>>>1,s=null,a=i;return function(c){if(c<1||c>n)return t(c);a+c>i&&(s=t(i),a=0);var u=e.call(s,a,a+=c);return a&7&&(a=(a|7)+1),u}}});var Lv=b((RY,kv)=>{"use strict";kv.exports=lr;var Fc=cs();function lr(t,e){this.lo=t>>>0,this.hi=e>>>0}var Qs=lr.zero=new lr(0,0);Qs.toNumber=function(){return 0};Qs.zzEncode=Qs.zzDecode=function(){return this};Qs.length=function(){return 1};var wO=lr.zeroHash="\0\0\0\0\0\0\0\0";lr.fromNumber=function(e){if(e===0)return Qs;var r=e<0;r&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return r&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new lr(i,n)};lr.from=function(e){if(typeof e=="number")return lr.fromNumber(e);if(Fc.isString(e))if(Fc.Long)e=Fc.Long.fromString(e);else return lr.fromNumber(parseInt(e,10));return e.low||e.high?new lr(e.low>>>0,e.high>>>0):Qs};lr.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;return r||(i=i+1>>>0),-(r+i*4294967296)}return this.lo+this.hi*4294967296};lr.prototype.toLong=function(e){return Fc.Long?new Fc.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var os=String.prototype.charCodeAt;lr.fromHash=function(e){return e===wO?Qs:new lr((os.call(e,0)|os.call(e,1)<<8|os.call(e,2)<<16|os.call(e,3)<<24)>>>0,(os.call(e,4)|os.call(e,5)<<8|os.call(e,6)<<16|os.call(e,7)<<24)>>>0)};lr.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};lr.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};lr.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};lr.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}});var cs=b(Bh=>{"use strict";var ve=Bh;ve.asPromise=gv();ve.base64=Ev();ve.EventEmitter=_v();ve.float=Rv();ve.inquire=Pv();ve.utf8=Dv();ve.pool=Nv();ve.LongBits=Lv();ve.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);ve.global=ve.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Bh;ve.emptyArray=Object.freeze?Object.freeze([]):[];ve.emptyObject=Object.freeze?Object.freeze({}):{};ve.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};ve.isString=function(e){return typeof e=="string"||e instanceof String};ve.isObject=function(e){return e&&typeof e=="object"};ve.isset=ve.isSet=function(e,r){var i=e[r];return i!=null&&e.hasOwnProperty(r)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};ve.Buffer=function(){try{var t=ve.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();ve._Buffer_from=null;ve._Buffer_allocUnsafe=null;ve.newBuffer=function(e){return typeof e=="number"?ve.Buffer?ve._Buffer_allocUnsafe(e):new ve.Array(e):ve.Buffer?ve._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};ve.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;ve.Long=ve.global.dcodeIO&&ve.global.dcodeIO.Long||ve.global.Long||ve.inquire("long");ve.key2Re=/^true|false|0|1$/;ve.key32Re=/^-?(?:0|[1-9][0-9]*)$/;ve.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;ve.longToHash=function(e){return e?ve.LongBits.from(e).toHash():ve.LongBits.zeroHash};ve.longFromHash=function(e,r){var i=ve.LongBits.fromHash(e);return ve.Long?ve.Long.fromBits(i.lo,i.hi,r):i.toNumber(Boolean(r))};function Mv(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)(t[i[n]]===void 0||!r)&&(t[i[n]]=e[i[n]]);return t}ve.merge=Mv;ve.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function qv(t){function e(r,i){if(!(this instanceof e))return new e(r,i);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&Mv(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}ve.newError=qv;ve.ProtocolError=qv("ProtocolError");ve.oneOfGetter=function(e){for(var r={},i=0;i<e.length;++i)r[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(r[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};ve.oneOfSetter=function(e){return function(r){for(var i=0;i<e.length;++i)e[i]!==r&&delete this[e[i]]}};ve.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};ve._configure=function(){var t=ve.Buffer;if(!t){ve._Buffer_from=ve._Buffer_allocUnsafe=null;return}ve._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,i){return new t(r,i)},ve._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var qh=b((BY,Vv)=>{"use strict";Vv.exports=Qe;var ui=cs(),Dh,Pl=ui.LongBits,Uv=ui.base64,Fv=ui.utf8;function Kc(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Oh(){}function _O(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Qe(){this.len=0,this.head=new Kc(Oh,0,0),this.tail=this.head,this.states=null}var Kv=function(){return ui.Buffer?function(){return(Qe.create=function(){return new Dh})()}:function(){return new Qe}};Qe.create=Kv();Qe.alloc=function(e){return new ui.Array(e)};ui.Array!==Array&&(Qe.alloc=ui.pool(Qe.alloc,ui.Array.prototype.subarray));Qe.prototype._push=function(e,r,i){return this.tail=this.tail.next=new Kc(e,r,i),this.len+=r,this};function Nh(t,e,r){e[r]=t&255}function SO(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function kh(t,e){this.len=t,this.next=void 0,this.val=e}kh.prototype=Object.create(Kc.prototype);kh.prototype.fn=SO;Qe.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new kh((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Qe.prototype.int32=function(e){return e<0?this._push(Lh,10,Pl.fromNumber(e)):this.uint32(e)};Qe.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Lh(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Qe.prototype.uint64=function(e){var r=Pl.from(e);return this._push(Lh,r.length(),r)};Qe.prototype.int64=Qe.prototype.uint64;Qe.prototype.sint64=function(e){var r=Pl.from(e).zzEncode();return this._push(Lh,r.length(),r)};Qe.prototype.bool=function(e){return this._push(Nh,1,e?1:0)};function Mh(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Qe.prototype.fixed32=function(e){return this._push(Mh,4,e>>>0)};Qe.prototype.sfixed32=Qe.prototype.fixed32;Qe.prototype.fixed64=function(e){var r=Pl.from(e);return this._push(Mh,4,r.lo)._push(Mh,4,r.hi)};Qe.prototype.sfixed64=Qe.prototype.fixed64;Qe.prototype.float=function(e){return this._push(ui.float.writeFloatLE,4,e)};Qe.prototype.double=function(e){return this._push(ui.float.writeDoubleLE,8,e)};var xO=ui.Array.prototype.set?function(e,r,i){r.set(e,i)}:function(e,r,i){for(var n=0;n<e.length;++n)r[i+n]=e[n]};Qe.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Nh,1,0);if(ui.isString(e)){var i=Qe.alloc(r=Uv.length(e));Uv.decode(e,i,0),e=i}return this.uint32(r)._push(xO,r,e)};Qe.prototype.string=function(e){var r=Fv.length(e);return r?this.uint32(r)._push(Fv.write,r,e):this._push(Nh,1,0)};Qe.prototype.fork=function(){return this.states=new _O(this),this.head=this.tail=new Kc(Oh,0,0),this.len=0,this};Qe.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Kc(Oh,0,0),this.len=0),this};Qe.prototype.ldelim=function(){var e=this.head,r=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=r,this.len+=i),this};Qe.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,r,i),i+=e.len,e=e.next;return r};Qe._configure=function(t){Dh=t,Qe.create=Kv(),Dh._configure()}});var Hv=b((DY,Gv)=>{"use strict";Gv.exports=Ji;var jv=qh();(Ji.prototype=Object.create(jv.prototype)).constructor=Ji;var us=cs();function Ji(){jv.call(this)}Ji._configure=function(){Ji.alloc=us._Buffer_allocUnsafe,Ji.writeBytesBuffer=us.Buffer&&us.Buffer.prototype instanceof Uint8Array&&us.Buffer.prototype.set.name==="set"?function(e,r,i){r.set(e,i)}:function(e,r,i){if(e.copy)e.copy(r,i,0,e.length);else for(var n=0;n<e.length;)r[i++]=e[n++]}};Ji.prototype.bytes=function(e){us.isString(e)&&(e=us._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Ji.writeBytesBuffer,r,e),this};function CO(t,e,r){t.length<40?us.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Ji.prototype.string=function(e){var r=us.Buffer.byteLength(e);return this.uint32(r),r&&this._push(CO,r,e),this};Ji._configure()});var Kh=b((OY,Qv)=>{"use strict";Qv.exports=Qt;var en=cs(),Uh,zv=en.LongBits,IO=en.utf8;function Mi(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Qt(t){this.buf=t,this.pos=0,this.len=t.length}var Wv=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Qt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Qt(e);throw Error("illegal buffer")},$v=function(){return en.Buffer?function(r){return(Qt.create=function(n){return en.Buffer.isBuffer(n)?new Uh(n):Wv(n)})(r)}:Wv};Qt.create=$v();Qt.prototype._slice=en.Array.prototype.subarray||en.Array.prototype.slice;Qt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Mi(this,10);return e}}();Qt.prototype.int32=function(){return this.uint32()|0};Qt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Fh(){var t=new zv(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Mi(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Mi(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Qt.prototype.bool=function(){return this.uint32()!==0};function Bl(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Qt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Mi(this,4);return Bl(this.buf,this.pos+=4)};Qt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Mi(this,4);return Bl(this.buf,this.pos+=4)|0};function Yv(){if(this.pos+8>this.len)throw Mi(this,8);return new zv(Bl(this.buf,this.pos+=4),Bl(this.buf,this.pos+=4))}Qt.prototype.float=function(){if(this.pos+4>this.len)throw Mi(this,4);var e=en.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Qt.prototype.double=function(){if(this.pos+8>this.len)throw Mi(this,4);var e=en.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Qt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,i=this.pos+e;if(i>this.len)throw Mi(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,i):r===i?new this.buf.constructor(0):this._slice.call(this.buf,r,i)};Qt.prototype.string=function(){var e=this.bytes();return IO.read(e,0,e.length)};Qt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Mi(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Mi(this);while(this.buf[this.pos++]&128);return this};Qt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Qt._configure=function(t){Uh=t,Qt.create=$v(),Uh._configure();var e=en.Long?"toLong":"toNumber";en.merge(Qt.prototype,{int64:function(){return Fh.call(this)[e](!1)},uint64:function(){return Fh.call(this)[e](!0)},sint64:function(){return Fh.call(this).zzDecode()[e](!1)},fixed64:function(){return Yv.call(this)[e](!0)},sfixed64:function(){return Yv.call(this)[e](!1)}})}});var e1=b((NY,Jv)=>{"use strict";Jv.exports=Xs;var Xv=Kh();(Xs.prototype=Object.create(Xv.prototype)).constructor=Xs;var Zv=cs();function Xs(t){Xv.call(this,t)}Xs._configure=function(){Zv.Buffer&&(Xs.prototype._slice=Zv.Buffer.prototype.slice)};Xs.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Xs._configure()});var r1=b((kY,t1)=>{"use strict";t1.exports=Vc;var Vh=cs();(Vc.prototype=Object.create(Vh.EventEmitter.prototype)).constructor=Vc;function Vc(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Vh.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Vc.prototype.rpcCall=function t(e,r,i,n,s){if(!n)throw TypeError("request must be specified");var a=this;if(!s)return Vh.asPromise(t,a,e,r,i,n);if(!a.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return a.rpcImpl(e,r[a.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return a.emit("error",c,e),s(c);if(u===null){a.end(!0);return}if(!(u instanceof i))try{u=i[a.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return a.emit("error",l,e),s(l)}return a.emit("data",u,e),s(null,u)})}catch(o){a.emit("error",o,e),setTimeout(function(){s(o)},0);return}};Vc.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var n1=b(i1=>{"use strict";var AO=i1;AO.Service=r1()});var a1=b((MY,s1)=>{"use strict";s1.exports={}});var u1=b(c1=>{"use strict";var Gr=c1;Gr.build="minimal";Gr.Writer=qh();Gr.BufferWriter=Hv();Gr.Reader=Kh();Gr.BufferReader=e1();Gr.util=cs();Gr.rpc=n1();Gr.roots=a1();Gr.configure=o1;function o1(){Gr.util._configure(),Gr.Writer._configure(Gr.BufferWriter),Gr.Reader._configure(Gr.BufferReader)}o1()});var tn=b((UY,l1)=>{"use strict";l1.exports=u1()});var Ol=b((FY,h1)=>{"use strict";var Zs=tn(),Dl=Zs.Reader,f1=Zs.Writer,Ar=Zs.util,li=Zs.roots["libp2p-crypto-keys"]||(Zs.roots["libp2p-crypto-keys"]={});li.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();li.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Ar.newBuffer([]),t.encode=function(r,i){return i||(i=f1.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Dl||(r=Dl.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new li.PublicKey;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(a&7);break}}if(!s.hasOwnProperty("Type"))throw Ar.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Ar.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof li.PublicKey)return r;var i=new li.PublicKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Ar.base64.decode(r.Data,i.Data=Ar.newBuffer(Ar.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Ar.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?li.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Ar.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zs.util.toJSONOptions)},t}();li.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.Type=0,t.prototype.Data=Ar.newBuffer([]),t.encode=function(r,i){return i||(i=f1.create()),i.uint32(8).int32(r.Type),i.uint32(18).bytes(r.Data),i},t.decode=function(r,i){r instanceof Dl||(r=Dl.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new li.PrivateKey;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(a&7);break}}if(!s.hasOwnProperty("Type"))throw Ar.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Ar.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof li.PrivateKey)return r;var i=new li.PrivateKey;switch(r.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Ar.base64.decode(r.Data,i.Data=Ar.newBuffer(Ar.base64.length(r.Data)),0):r.Data.length&&(i.Data=r.Data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Ar.newBuffer(n.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(n.Type=i.enums===String?li.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Ar.base64.encode(r.Data,0,r.Data.length):i.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zs.util.toJSONOptions)},t}();h1.exports=li});var lt=b((KY,d1)=>{d1.exports={options:{usePureJavaScript:!1}}});var g1=b((VY,y1)=>{var jh={};y1.exports=jh;var p1={};jh.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(t instanceof Uint8Array))i=TO(t,e);else{var n=0,s=e.length,a=e.charAt(0),o=[0];for(n=0;n<t.length;++n){for(var c=0,u=t[n];c<o.length;++c)u+=o[c]<<8,o[c]=u%s,u=u/s|0;for(;u>0;)o.push(u%s),u=u/s|0}for(n=0;t[n]===0&&n<t.length-1;++n)i+=a;for(n=o.length-1;n>=0;--n)i+=e[o[n]]}if(r){var l=new RegExp(".{1,"+r+"}","g");i=i.match(l).join(`\r
`)}return i};jh.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=p1[e];if(!r){r=p1[e]=[];for(var i=0;i<e.length;++i)r[e.charCodeAt(i)]=i}t=t.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),a=[0],i=0;i<t.length;i++){var o=r[t.charCodeAt(i)];if(o===void 0)return;for(var c=0,u=o;c<a.length;++c)u+=a[c]*n,a[c]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)a.push(0);return typeof Buffer!="undefined"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function TO(t,e){var r=0,i=e.length,n=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,o=t.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%i,o=o/i|0;for(;o>0;)s.push(o%i),o=o/i|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=n;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Xt=b((jY,E1)=>{var m1=lt(),v1=g1(),P=E1.exports=m1.util=m1.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){P.nextTick=process.nextTick,typeof setImmediate=="function"?P.setImmediate=setImmediate:P.setImmediate=P.nextTick;return}if(typeof setImmediate=="function"){P.setImmediate=function(){return setImmediate.apply(void 0,arguments)},P.nextTick=function(o){return setImmediate(o)};return}if(P.setImmediate=function(o){setTimeout(o,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let o=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var a=o,t="forge.setImmediate",e=[];P.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=P.setImmediate;P.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}P.nextTick=P.setImmediate})();P.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;P.globalScope=function(){return P.isNodejs?globalThis:typeof self=="undefined"?window:self}();P.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};P.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};P.isArrayBufferView=function(t){return t&&P.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function jc(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}P.ByteBuffer=Gh;function Gh(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(P.isArrayBuffer(t)||P.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Gh||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}P.ByteStringBuffer=Gh;var RO=4096;P.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>RO&&(this.data.substr(0,1),this._constructedStringLength=0)};P.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};P.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};P.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};P.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};P.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};P.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(P.encodeUtf8(t))};P.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};P.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};P.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};P.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};P.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};P.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};P.ByteStringBuffer.prototype.putInt=function(t,e){jc(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};P.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};P.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};P.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};P.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};P.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};P.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};P.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};P.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};P.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};P.ByteStringBuffer.prototype.getInt=function(t){jc(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};P.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};P.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};P.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};P.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};P.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};P.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};P.ByteStringBuffer.prototype.copy=function(){var t=P.createBuffer(this.data);return t.read=this.read,t};P.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};P.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};P.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};P.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};P.ByteStringBuffer.prototype.toString=function(){return P.decodeUtf8(this.bytes())};function PO(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=P.isArrayBuffer(t),i=P.isArrayBufferView(t);if(r||i){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}P.DataBuffer=PO;P.DataBuffer.prototype.length=function(){return this.write-this.read};P.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};P.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this};P.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};P.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};P.DataBuffer.prototype.putBytes=function(t,e){if(P.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(r),this.write+=i,this}if(P.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof P.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&P.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var n=new Uint8Array(t.data.byteLength,this.write);return n.set(r),this.write+=r.byteLength,this}if(t instanceof P.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=P.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=P.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=P.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=P.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=P.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};P.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};P.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};P.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};P.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};P.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};P.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};P.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};P.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};P.DataBuffer.prototype.putInt=function(t,e){jc(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};P.DataBuffer.prototype.putSignedInt=function(t,e){return jc(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};P.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};P.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};P.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};P.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};P.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};P.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};P.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};P.DataBuffer.prototype.getInt=function(t){jc(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};P.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};P.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};P.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};P.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};P.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};P.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};P.DataBuffer.prototype.copy=function(){return new P.DataBuffer(this)};P.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};P.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};P.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};P.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};P.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return P.binary.raw.encode(e);if(t==="hex")return P.binary.hex.encode(e);if(t==="base64")return P.binary.base64.encode(e);if(t==="utf8")return P.text.utf8.decode(e);if(t==="utf16")return P.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};P.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=P.encodeUtf8(t)),new P.ByteBuffer(t)};P.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};P.xorBytes=function(t,e,r){for(var i="",n="",s="",a=0,o=0;r>0;--r,++a)n=t.charCodeAt(a)^e.charCodeAt(a),o>=10&&(i+=s,s="",o=0),s+=String.fromCharCode(n),++o;return i+=s,i};P.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};P.bytesToHex=function(t){return P.createBuffer(t).toHex()};P.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",fs=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],b1="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";P.encode64=function(t,e){for(var r="",i="",n,s,a,o=0;o<t.length;)n=t.charCodeAt(o++),s=t.charCodeAt(o++),a=t.charCodeAt(o++),r+=ls.charAt(n>>2),r+=ls.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ls.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":ls.charAt(a&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};P.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,i,n,s,a=0;a<t.length;)r=fs[t.charCodeAt(a++)-43],i=fs[t.charCodeAt(a++)-43],n=fs[t.charCodeAt(a++)-43],s=fs[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};P.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};P.decodeUtf8=function(t){return decodeURIComponent(escape(t))};P.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:v1.encode,decode:v1.decode}};P.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};P.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};P.binary.hex.encode=P.bytesToHex;P.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,s=r;for(t.length&1&&(n=1,i[s++]=parseInt(t[0],16));n<t.length;n+=2)i[s++]=parseInt(t.substr(n,2),16);return e?s-r:i};P.binary.base64.encode=function(t,e){for(var r="",i="",n,s,a,o=0;o<t.byteLength;)n=t[o++],s=t[o++],a=t[o++],r+=ls.charAt(n>>2),r+=ls.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=ls.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":ls.charAt(a&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};P.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,s,a,o,c=0,u=r;c<t.length;)n=fs[t.charCodeAt(c++)-43],s=fs[t.charCodeAt(c++)-43],a=fs[t.charCodeAt(c++)-43],o=fs[t.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,a!==64&&(i[u++]=(s&15)<<4|a>>2,o!==64&&(i[u++]=(a&3)<<6|o));return e?u-r:i.subarray(0,u)};P.binary.base58.encode=function(t,e){return P.binary.baseN.encode(t,b1,e)};P.binary.base58.decode=function(t,e){return P.binary.baseN.decode(t,b1,e)};P.text={utf8:{},utf16:{}};P.text.utf8.encode=function(t,e,r){t=P.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};P.text.utf8.decode=function(t){return P.decodeUtf8(String.fromCharCode.apply(null,t))};P.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length*2));var n=new Uint16Array(i.buffer);r=r||0;for(var s=r,a=r,o=0;o<t.length;++o)n[a++]=t.charCodeAt(o),s+=2;return e?s-r:i};P.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};P.deflate=function(t,e,r){if(e=P.decode64(t.deflate(P.encode64(e)).rval),r){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};P.inflate=function(t,e,r){var i=t.inflate(P.encode64(e)).rval;return i===null?null:P.decode64(i)};var Hh=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(r===null?i=t.removeItem(e):(r=P.encode64(JSON.stringify(r)),i=t.setItem(e,r)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},zh=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(P.decode64(r))),r},BO=function(t,e,r,i){var n=zh(t,e);n===null&&(n={}),n[r]=i,Hh(t,e,n)},DO=function(t,e,r){var i=zh(t,e);return i!==null&&(i=r in i?i[r]:null),i},OO=function(t,e,r){var i=zh(t,e);if(i!==null&&r in i){delete i[r];var n=!0;for(var s in i){n=!1;break}n&&(i=null),Hh(t,e,i)}},NO=function(t,e){Hh(t,e,null)},Nl=function(t,e,r){var i=null;typeof r=="undefined"&&(r=["web","flash"]);var n,s=!1,a=null;for(var o in r){n=r[o];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=t.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=t.apply(this,e),s=!0)}catch(c){a=c}if(s)break}if(!s)throw a;return i};P.setItem=function(t,e,r,i,n){Nl(BO,arguments,n)};P.getItem=function(t,e,r,i){return Nl(DO,arguments,i)};P.removeItem=function(t,e,r,i){Nl(OO,arguments,i)};P.clearItems=function(t,e,r){Nl(NO,arguments,r)};P.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};P.format=function(t){for(var e=/%./g,r,i,n=0,s=[],a=0;r=e.exec(t);){i=t.substring(a,e.lastIndex-2),i.length>0&&s.push(i),a=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(t.substring(a)),s.join("")};P.formatNumber=function(t,e,r,i){var n=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,o=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+o:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(n-u).toFixed(s).slice(2):"")};P.formatSize=function(t){return t>=1073741824?t=P.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=P.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=P.formatNumber(t/1024,0)+" KiB":t=P.formatNumber(t,0)+" bytes",t};P.bytesFromIP=function(t){return t.indexOf(".")!==-1?P.bytesFromIPv4(t):t.indexOf(":")!==-1?P.bytesFromIPv6(t):null};P.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=P.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};P.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,i=P.createBuffer(),n=0;n<8;++n){if(!t[n]||t[n].length===0){i.fillWithByte(0,r),r=0;continue}var s=P.hexToBytes(t[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};P.bytesToIP=function(t){return t.length===4?P.bytesToIPv4(t):t.length===16?P.bytesToIPv6(t):null};P.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};P.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var s=P.bytesToHex(t[n]+t[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=e.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[i].end-r[i].start&&(i=r.length-1))}e.push(s)}if(r.length>0){var c=r[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};P.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in P&&!t.update)return e(null,P.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return P.cores=navigator.hardwareConcurrency,e(null,P.cores);if(typeof Worker=="undefined")return P.cores=1,e(null,P.cores);if(typeof Blob=="undefined")return P.cores=2,e(null,P.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),c=o+4;Date.now()<c;);self.postMessage({st:o,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(a,o,c){if(o===0){var u=Math.floor(a.reduce(function(l,f){return l+f},0)/a.length);return P.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,P.cores)}n(c,function(l,f){a.push(s(c,f)),i(a,o-1,c)})}function n(a,o){for(var c=[],u=[],l=0;l<a;++l){var f=new Worker(r);f.addEventListener("message",function(h){if(u.push(h.data),u.length===a){for(var p=0;p<a;++p)c[p].terminate();o(null,u)}}),c.push(f)}for(var l=0;l<a;++l)c[l].postMessage(l)}function s(a,o){for(var c=[],u=0;u<a;++u)for(var l=o[u],f=c[u]=[],h=0;h<a;++h)if(u!==h){var p=o[h];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&f.push(h)}return c.reduce(function(d,y){return Math.max(d,y.length)},0)}}});var kl=b((GY,w1)=>{var Gc=lt();Gc.pki=Gc.pki||{};var Wh=w1.exports=Gc.pki.oids=Gc.oids=Gc.oids||{};function J(t,e){Wh[t]=e,Wh[e]=t}function at(t,e){Wh[t]=e}J("1.2.840.113549.1.1.1","rsaEncryption");J("1.2.840.113549.1.1.4","md5WithRSAEncryption");J("1.2.840.113549.1.1.5","sha1WithRSAEncryption");J("1.2.840.113549.1.1.7","RSAES-OAEP");J("1.2.840.113549.1.1.8","mgf1");J("1.2.840.113549.1.1.9","pSpecified");J("1.2.840.113549.1.1.10","RSASSA-PSS");J("1.2.840.113549.1.1.11","sha256WithRSAEncryption");J("1.2.840.113549.1.1.12","sha384WithRSAEncryption");J("1.2.840.113549.1.1.13","sha512WithRSAEncryption");J("1.3.101.112","EdDSA25519");J("1.2.840.10040.4.3","dsa-with-sha1");J("1.3.14.3.2.7","desCBC");J("1.3.14.3.2.26","sha1");J("1.3.14.3.2.29","sha1WithRSASignature");J("2.16.840.1.101.3.4.2.1","sha256");J("2.16.840.1.101.3.4.2.2","sha384");J("2.16.840.1.101.3.4.2.3","sha512");J("2.16.840.1.101.3.4.2.4","sha224");J("2.16.840.1.101.3.4.2.5","sha512-224");J("2.16.840.1.101.3.4.2.6","sha512-256");J("1.2.840.113549.2.2","md2");J("1.2.840.113549.2.5","md5");J("1.2.840.113549.1.7.1","data");J("1.2.840.113549.1.7.2","signedData");J("1.2.840.113549.1.7.3","envelopedData");J("1.2.840.113549.1.7.4","signedAndEnvelopedData");J("1.2.840.113549.1.7.5","digestedData");J("1.2.840.113549.1.7.6","encryptedData");J("1.2.840.113549.1.9.1","emailAddress");J("1.2.840.113549.1.9.2","unstructuredName");J("1.2.840.113549.1.9.3","contentType");J("1.2.840.113549.1.9.4","messageDigest");J("1.2.840.113549.1.9.5","signingTime");J("1.2.840.113549.1.9.6","counterSignature");J("1.2.840.113549.1.9.7","challengePassword");J("1.2.840.113549.1.9.8","unstructuredAddress");J("1.2.840.113549.1.9.14","extensionRequest");J("1.2.840.113549.1.9.20","friendlyName");J("1.2.840.113549.1.9.21","localKeyId");J("1.2.840.113549.1.9.22.1","x509Certificate");J("1.2.840.113549.1.12.10.1.1","keyBag");J("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");J("1.2.840.113549.1.12.10.1.3","certBag");J("1.2.840.113549.1.12.10.1.4","crlBag");J("1.2.840.113549.1.12.10.1.5","secretBag");J("1.2.840.113549.1.12.10.1.6","safeContentsBag");J("1.2.840.113549.1.5.13","pkcs5PBES2");J("1.2.840.113549.1.5.12","pkcs5PBKDF2");J("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");J("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");J("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");J("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");J("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");J("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");J("1.2.840.113549.2.7","hmacWithSHA1");J("1.2.840.113549.2.8","hmacWithSHA224");J("1.2.840.113549.2.9","hmacWithSHA256");J("1.2.840.113549.2.10","hmacWithSHA384");J("1.2.840.113549.2.11","hmacWithSHA512");J("1.2.840.113549.3.7","des-EDE3-CBC");J("2.16.840.1.101.3.4.1.2","aes128-CBC");J("2.16.840.1.101.3.4.1.22","aes192-CBC");J("2.16.840.1.101.3.4.1.42","aes256-CBC");J("2.5.4.3","commonName");J("2.5.4.4","surname");J("2.5.4.5","serialNumber");J("2.5.4.6","countryName");J("2.5.4.7","localityName");J("2.5.4.8","stateOrProvinceName");J("2.5.4.9","streetAddress");J("2.5.4.10","organizationName");J("2.5.4.11","organizationalUnitName");J("2.5.4.12","title");J("2.5.4.13","description");J("2.5.4.15","businessCategory");J("2.5.4.17","postalCode");J("2.5.4.42","givenName");J("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");J("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");J("2.16.840.1.113730.1.1","nsCertType");J("2.16.840.1.113730.1.13","nsComment");at("2.5.29.1","authorityKeyIdentifier");at("2.5.29.2","keyAttributes");at("2.5.29.3","certificatePolicies");at("2.5.29.4","keyUsageRestriction");at("2.5.29.5","policyMapping");at("2.5.29.6","subtreesConstraint");at("2.5.29.7","subjectAltName");at("2.5.29.8","issuerAltName");at("2.5.29.9","subjectDirectoryAttributes");at("2.5.29.10","basicConstraints");at("2.5.29.11","nameConstraints");at("2.5.29.12","policyConstraints");at("2.5.29.13","basicConstraints");J("2.5.29.14","subjectKeyIdentifier");J("2.5.29.15","keyUsage");at("2.5.29.16","privateKeyUsagePeriod");J("2.5.29.17","subjectAltName");J("2.5.29.18","issuerAltName");J("2.5.29.19","basicConstraints");at("2.5.29.20","cRLNumber");at("2.5.29.21","cRLReason");at("2.5.29.22","expirationDate");at("2.5.29.23","instructionCode");at("2.5.29.24","invalidityDate");at("2.5.29.25","cRLDistributionPoints");at("2.5.29.26","issuingDistributionPoint");at("2.5.29.27","deltaCRLIndicator");at("2.5.29.28","issuingDistributionPoint");at("2.5.29.29","certificateIssuer");at("2.5.29.30","nameConstraints");J("2.5.29.31","cRLDistributionPoints");J("2.5.29.32","certificatePolicies");at("2.5.29.33","policyMappings");at("2.5.29.34","policyConstraints");J("2.5.29.35","authorityKeyIdentifier");at("2.5.29.36","policyConstraints");J("2.5.29.37","extKeyUsage");at("2.5.29.46","freshestCRL");at("2.5.29.54","inhibitAnyPolicy");J("1.3.6.1.4.1.11129.2.4.2","timestampList");J("1.3.6.1.5.5.7.1.1","authorityInfoAccess");J("1.3.6.1.5.5.7.3.1","serverAuth");J("1.3.6.1.5.5.7.3.2","clientAuth");J("1.3.6.1.5.5.7.3.3","codeSigning");J("1.3.6.1.5.5.7.3.4","emailProtection");J("1.3.6.1.5.5.7.3.8","timeStamping")});var zc=b((HY,S1)=>{var St=lt();Xt();kl();var oe=S1.exports=St.asn1=St.asn1||{};oe.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};oe.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};oe.create=function(t,e,r,i,n){if(St.util.isArray(i)){for(var s=[],a=0;a<i.length;++a)i[a]!==void 0&&s.push(i[a]);i=s}var o={tagClass:t,type:e,constructed:r,composed:r||St.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(o.bitStringContents=n.bitStringContents,o.original=oe.copy(o)),o};oe.copy=function(t,e){var r;if(St.util.isArray(t)){r=[];for(var i=0;i<t.length;++i)r.push(oe.copy(t[i],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:oe.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};oe.equals=function(t,e,r){if(St.util.isArray(t)){if(!St.util.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!oe.equals(t[i],e[i]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var n=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&oe.equals(t.value,e.value);return r&&r.includeBitStringContents&&(n=n&&t.bitStringContents===e.bitStringContents),n};oe.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,i=e&128;return i?r=t.getInt((e&127)<<3):r=e,r}};function Hc(t,e,r){if(r>e){var i=new Error("Too few bytes to parse DER.");throw i.available=t.length(),i.remaining=e,i.requested=r,i}}var kO=function(t,e){var r=t.getByte();if(e--,r!==128){var i,n=r&128;if(!n)i=r;else{var s=r&127;Hc(t,e,s),i=t.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};oe.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=St.util.createBuffer(t));var r=t.length(),i=Ll(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var n=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw n.byteCount=r,n.remaining=t.length(),n}return i};function Ll(t,e,r,i){var n;Hc(t,e,2);var s=t.getByte();e--;var a=s&192,o=s&31;n=t.length();var c=kO(t,e);if(e-=n-t.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,f,h=(s&32)==32;if(h)if(l=[],c===void 0)for(;;){if(Hc(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}n=t.length(),l.push(Ll(t,e,r+1,i)),e-=n-t.length()}else for(;c>0;)n=t.length(),l.push(Ll(t,c,r+1,i)),e-=n-t.length(),c-=n-t.length();if(l===void 0&&a===oe.Class.UNIVERSAL&&o===oe.Type.BITSTRING&&(f=t.bytes(c)),l===void 0&&i.decodeBitStrings&&a===oe.Class.UNIVERSAL&&o===oe.Type.BITSTRING&&c>1){var p=t.read,d=e,y=0;if(o===oe.Type.BITSTRING&&(Hc(t,e,1),y=t.getByte(),e--),y===0)try{n=t.length();var g={strict:!0,decodeBitStrings:!0},m=Ll(t,e,r+1,g),w=n-t.length();e-=w,o==oe.Type.BITSTRING&&w++;var C=m.tagClass;w===c&&(C===oe.Class.UNIVERSAL||C===oe.Class.CONTEXT_SPECIFIC)&&(l=[m])}catch(T){}l===void 0&&(t.read=p,e=d)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(o===oe.Type.BMPSTRING)for(l="";c>0;c-=2)Hc(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c),e-=c}var V=f===void 0?null:{bitStringContents:f};return oe.create(a,o,h,l,V)}oe.toDer=function(t){var e=St.util.createBuffer(),r=t.tagClass|t.type,i=St.util.createBuffer(),n=!1;if("bitStringContents"in t&&(n=!0,t.original&&(n=oe.equals(t,t.original))),n)i.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:i.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&i.putBuffer(oe.toDer(t.value[s]))}else if(t.type===oe.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)i.putInt16(t.value.charCodeAt(s));else t.type===oe.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?i.putBytes(t.value.substr(1)):i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(i.length()&127);else{var a=i.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)e.putByte(o.charCodeAt(s))}return e.putBuffer(i),e};oe.oidToDer=function(t){var e=t.split("."),r=St.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,a,o=2;o<e.length;++o){i=!0,n=[],s=parseInt(e[o],10);do a=s&127,s=s>>>7,i||(a|=128),n.push(a),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)r.putByte(n[c])}return r};oe.derToOid=function(t){var e;typeof t=="string"&&(t=St.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i=i<<7,r&128?i+=r&127:(e+="."+(i+r),i=0);return e};oe.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(o=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(s,a,o,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),f=parseInt(t.substr(u+4,2),10),h=l*60+f;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};oe.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var f=t.length-5,h=t.charAt(f);if(h==="+"||h==="-"){var p=parseInt(t.substr(f+1,2),10),d=parseInt(t.substr(f+4,2),10);u=p*60+d,u*=6e4,h==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,i,n),e.setUTCHours(s,a,o,c),e.setTime(+e+u)):(e.setFullYear(r,i,n),e.setHours(s,a,o,c)),e};oe.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};oe.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};oe.integerToDer=function(t){var e=St.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};oe.derToInteger=function(t){typeof t=="string"&&(t=St.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};oe.validate=function(t,e,r,i){var n=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&St.util.isArray(e.value))for(var s=0,a=0;n&&a<e.value.length;++a)n=e.value[a].optional||!1,t.value[s]&&(n=oe.validate(t.value[s],e.value[a],r,i),n?++s:e.value[a].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(n&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else i&&(t.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return n};var _1=/[^\\u0000-\\u00ff]/;oe.prettyPrint=function(t,e,r){var i="";e=e||0,r=r||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*r;++s)n+=" ";switch(i+=n+"Tag: ",t.tagClass){case oe.Class.UNIVERSAL:i+="Universal:";break;case oe.Class.APPLICATION:i+="Application:";break;case oe.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case oe.Class.PRIVATE:i+="Private:";break}if(t.tagClass===oe.Class.UNIVERSAL)switch(i+=t.type,t.type){case oe.Type.NONE:i+=" (None)";break;case oe.Type.BOOLEAN:i+=" (Boolean)";break;case oe.Type.INTEGER:i+=" (Integer)";break;case oe.Type.BITSTRING:i+=" (Bit string)";break;case oe.Type.OCTETSTRING:i+=" (Octet string)";break;case oe.Type.NULL:i+=" (Null)";break;case oe.Type.OID:i+=" (Object Identifier)";break;case oe.Type.ODESC:i+=" (Object Descriptor)";break;case oe.Type.EXTERNAL:i+=" (External or Instance of)";break;case oe.Type.REAL:i+=" (Real)";break;case oe.Type.ENUMERATED:i+=" (Enumerated)";break;case oe.Type.EMBEDDED:i+=" (Embedded PDV)";break;case oe.Type.UTF8:i+=" (UTF8)";break;case oe.Type.ROID:i+=" (Relative Object Identifier)";break;case oe.Type.SEQUENCE:i+=" (Sequence)";break;case oe.Type.SET:i+=" (Set)";break;case oe.Type.PRINTABLESTRING:i+=" (Printable String)";break;case oe.Type.IA5String:i+=" (IA5String (ASCII))";break;case oe.Type.UTCTIME:i+=" (UTC time)";break;case oe.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case oe.Type.BMPSTRING:i+=" (BMP String)";break}else i+=t.type;if(i+=`
`,i+=n+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,o="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,o+=oe.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(o+=","));i+=n+"Sub values: "+a+o}else{if(i+=n+"Value: ",t.type===oe.Type.OID){var c=oe.derToOid(t.value);i+=c,St.pki&&St.pki.oids&&c in St.pki.oids&&(i+=" ("+St.pki.oids[c]+") ")}if(t.type===oe.Type.INTEGER)try{i+=oe.derToInteger(t.value)}catch(l){i+="0x"+St.util.bytesToHex(t.value)}else if(t.type===oe.Type.BITSTRING){if(t.value.length>1?i+="0x"+St.util.bytesToHex(t.value.slice(1)):i+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else if(t.type===oe.Type.OCTETSTRING)_1.test(t.value)||(i+="("+t.value+") "),i+="0x"+St.util.bytesToHex(t.value);else if(t.type===oe.Type.UTF8)try{i+=St.util.decodeUtf8(t.value)}catch(l){if(l.message==="URI malformed")i+="0x"+St.util.bytesToHex(t.value)+" (malformed UTF8)";else throw l}else t.type===oe.Type.PRINTABLESTRING||t.type===oe.Type.IA5String?i+=t.value:_1.test(t.value)?i+="0x"+St.util.bytesToHex(t.value):t.value.length===0?i+="[null]":i+=t.value}return i}});var Yh=b((zY,x1)=>{var fr=lt();Xt();x1.exports=fr.cipher=fr.cipher||{};fr.cipher.algorithms=fr.cipher.algorithms||{};fr.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=fr.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new fr.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};fr.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=fr.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new fr.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};fr.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),fr.cipher.algorithms[t]=e};fr.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in fr.cipher.algorithms?fr.cipher.algorithms[t]:null};var $h=fr.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};$h.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=fr.util.createBuffer(),this.output=t.output||fr.util.createBuffer(),this.mode.start(e)};$h.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};$h.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Xh=b((WY,C1)=>{var hr=lt();Xt();hr.cipher=hr.cipher||{};var Ue=C1.exports=hr.cipher.modes=hr.cipher.modes||{};Ue.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ue.ecb.prototype.start=function(t){};Ue.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Ue.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Ue.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ue.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};Ue.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ue.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Ml(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ue.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};Ue.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};Ue.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ue.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};Ue.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=hr.util.createBuffer(),this._partialBytes=0};Ue.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ml(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ue.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ue.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ue.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=hr.util.createBuffer(),this._partialBytes=0};Ue.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ml(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ue.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ue.ofb.prototype.decrypt=Ue.ofb.prototype.encrypt;Ue.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=hr.util.createBuffer(),this._partialBytes=0};Ue.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ml(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ue.ctr.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}ql(this._inBlock)};Ue.ctr.prototype.decrypt=Ue.ctr.prototype.encrypt;Ue.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=hr.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ue.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=hr.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=hr.util.createBuffer(t.additionalData):r=hr.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=hr.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Qh(i*8)))}this._inBlock=this._j0.slice(0),ql(this._inBlock),this._partialBytes=0,r=hr.util.createBuffer(r),this._aDataLength=Qh(r.length()*8);var n=r.length()%this.blockSize;for(n&&r.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Ue.gcm.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s<=0||r){if(r){var a=i%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),ql(this._inBlock)};Ue.gcm.prototype.decrypt=function(t,e,r){var i=t.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),ql(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};Ue.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=hr.util.createBuffer();var i=this._aDataLength.concat(Qh(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Ue.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=t[n/32|0]&1<<31-n%32;s&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r};Ue.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,i=3;i>0;--i)e[i]=t[i]>>>1|(t[i-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Ue.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var i=r/8|0,n=t[i]>>>(7-r%8)*4&15,s=this._m[r][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Ue.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Ue.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,s=new Array(n),a=0;a<n;++a){var o=[0,0,0,0],c=a/i|0,u=(i-1-a%i)*e;o[c]=1<<e-1<<u,s[a]=this.generateSubHashTable(this.multiply(o,t),e)}return s};Ue.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var a=1;a<s;++a){var o=n[s],c=n[a];n[s+a]=[o[0]^c[0],o[1]^c[1],o[2]^c[2],o[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<r;++s){var u=n[s^i];n[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return n};function Ml(t,e){if(typeof t=="string"&&(t=hr.util.createBuffer(t)),hr.util.isArray(t)&&t.length>4){var r=t;t=hr.util.createBuffer();for(var i=0;i<r.length;++i)t.putByte(r[i])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!hr.util.isArray(t)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(t.getInt32());t=n}return t}function ql(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Qh(t){return[t/4294967296|0,t&4294967295]}});var Fl=b(($Y,R1)=>{var vt=lt();Yh();Xh();Xt();R1.exports=vt.aes=vt.aes||{};vt.aes.startEncrypting=function(t,e,r,i){var n=Ul({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n};vt.aes.createEncryptionCipher=function(t,e){return Ul({key:t,output:null,decrypt:!1,mode:e})};vt.aes.startDecrypting=function(t,e,r,i){var n=Ul({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n};vt.aes.createDecryptionCipher=function(t,e){return Ul({key:t,output:null,decrypt:!0,mode:e})};vt.aes.Algorithm=function(t,e){Zh||A1();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return ed(r._w,i,n,!1)},decrypt:function(i,n){return ed(r._w,i,n,!0)}}}),r._init=!1};vt.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=vt.util.createBuffer(e);else if(vt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=vt.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(!vt.util.isArray(e)){r=e,e=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(r.getInt32())}}if(!vt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=T1(e,t.decrypt&&!a),this._init=!0}};vt.aes._expandKey=function(t,e){return Zh||A1(),T1(t,e)};vt.aes._updateBlock=ed;uo("AES-ECB",vt.cipher.modes.ecb);uo("AES-CBC",vt.cipher.modes.cbc);uo("AES-CFB",vt.cipher.modes.cfb);uo("AES-OFB",vt.cipher.modes.ofb);uo("AES-CTR",vt.cipher.modes.ctr);uo("AES-GCM",vt.cipher.modes.gcm);function uo(t,e){var r=function(){return new vt.aes.Algorithm(t,e)};vt.cipher.registerAlgorithm(t,r)}var Zh=!1,lo=4,Lr,Jh,I1,Js,qi;function A1(){Zh=!0,I1=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Lr=new Array(256),Jh=new Array(256),Js=new Array(4),qi=new Array(4);for(var e=0;e<4;++e)Js[e]=new Array(256),qi[e]=new Array(256);for(var r=0,i=0,n,s,a,o,c,u,l,e=0;e<256;++e){o=i^i<<1^i<<2^i<<3^i<<4,o=o>>8^o&255^99,Lr[r]=o,Jh[o]=r,c=t[o],n=t[r],s=t[n],a=t[s],u=c<<24^o<<16^o<<8^(o^c),l=(n^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^n^a);for(var f=0;f<4;++f)Js[f][r]=u,qi[f][o]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=i=1:(r=n^t[t[t[n^a]]],i^=t[t[i]])}}function T1(t,e){for(var r=t.slice(0),i,n=1,s=r.length,a=s+6+1,o=lo*a,c=s;c<o;++c)i=r[c-1],c%s==0?(i=Lr[i>>>16&255]<<24^Lr[i>>>8&255]<<16^Lr[i&255]<<8^Lr[i>>>24]^I1[n]<<24,n++):s>6&&c%s==4&&(i=Lr[i>>>24]<<24^Lr[i>>>16&255]<<16^Lr[i>>>8&255]<<8^Lr[i&255]),r[c]=r[c-s]^i;if(e){var u,l=qi[0],f=qi[1],h=qi[2],p=qi[3],d=r.slice(0);o=r.length;for(var c=0,y=o-lo;c<o;c+=lo,y-=lo)if(c===0||c===o-lo)d[c]=r[y],d[c+1]=r[y+3],d[c+2]=r[y+2],d[c+3]=r[y+1];else for(var g=0;g<lo;++g)u=r[y+g],d[c+(3&-g)]=l[Lr[u>>>24]]^f[Lr[u>>>16&255]]^h[Lr[u>>>8&255]]^p[Lr[u&255]];r=d}return r}function ed(t,e,r,i){var n=t.length/4-1,s,a,o,c,u;i?(s=qi[0],a=qi[1],o=qi[2],c=qi[3],u=Jh):(s=Js[0],a=Js[1],o=Js[2],c=Js[3],u=Lr);var l,f,h,p,d,y,g;l=e[0]^t[0],f=e[i?3:1]^t[1],h=e[2]^t[2],p=e[i?1:3]^t[3];for(var m=3,w=1;w<n;++w)d=s[l>>>24]^a[f>>>16&255]^o[h>>>8&255]^c[p&255]^t[++m],y=s[f>>>24]^a[h>>>16&255]^o[p>>>8&255]^c[l&255]^t[++m],g=s[h>>>24]^a[p>>>16&255]^o[l>>>8&255]^c[f&255]^t[++m],p=s[p>>>24]^a[l>>>16&255]^o[f>>>8&255]^c[h&255]^t[++m],l=d,f=y,h=g;r[0]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^t[++m],r[i?3:1]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^t[++m],r[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[f&255]^t[++m],r[i?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[h&255]^t[++m]}function Ul(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,i;t.decrypt?i=vt.cipher.createDecipher(r,t.key):i=vt.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,a){var o=null;a instanceof vt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,n.call(i,a)},i}});var D1=b((YY,B1)=>{var Pt=lt();Yh();Xh();Xt();B1.exports=Pt.des=Pt.des||{};Pt.des.startEncrypting=function(t,e,r,i){var n=Kl({key:t,output:r,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Pt.des.createEncryptionCipher=function(t,e){return Kl({key:t,output:null,decrypt:!1,mode:e})};Pt.des.startDecrypting=function(t,e,r,i){var n=Kl({key:t,output:r,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Pt.des.createDecryptionCipher=function(t,e){return Kl({key:t,output:null,decrypt:!0,mode:e})};Pt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return P1(r._keys,i,n,!1)},decrypt:function(i,n){return P1(r._keys,i,n,!0)}}}),r._init=!1};Pt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Pt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=GO(e),this._init=!0}};rn("DES-ECB",Pt.cipher.modes.ecb);rn("DES-CBC",Pt.cipher.modes.cbc);rn("DES-CFB",Pt.cipher.modes.cfb);rn("DES-OFB",Pt.cipher.modes.ofb);rn("DES-CTR",Pt.cipher.modes.ctr);rn("3DES-ECB",Pt.cipher.modes.ecb);rn("3DES-CBC",Pt.cipher.modes.cbc);rn("3DES-CFB",Pt.cipher.modes.cfb);rn("3DES-OFB",Pt.cipher.modes.ofb);rn("3DES-CTR",Pt.cipher.modes.ctr);function rn(t,e){var r=function(){return new Pt.des.Algorithm(t,e)};Pt.cipher.registerAlgorithm(t,r)}var LO=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],MO=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],qO=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],UO=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],FO=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],KO=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],VO=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],jO=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function GO(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,g=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,C,V=0;V<y;V++){var T=t.getInt32(),A=t.getInt32();C=(T>>>4^A)&252645135,A^=C,T^=C<<4,C=(A>>>-16^T)&65535,T^=C,A^=C<<-16,C=(T>>>2^A)&858993459,A^=C,T^=C<<2,C=(A>>>-16^T)&65535,T^=C,A^=C<<-16,C=(T>>>1^A)&1431655765,A^=C,T^=C<<1,C=(A>>>8^T)&16711935,T^=C,A^=C<<8,C=(T>>>1^A)&1431655765,A^=C,T^=C<<1,C=T<<8|A>>>20&240,T=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=C;for(var te=0;te<m.length;++te){m[te]?(T=T<<2|T>>>26,A=A<<2|A>>>26):(T=T<<1|T>>>27,A=A<<1|A>>>27),T&=-15,A&=-15;var ie=e[T>>>28]|r[T>>>24&15]|i[T>>>20&15]|n[T>>>16&15]|s[T>>>12&15]|a[T>>>8&15]|o[T>>>4&15],$=c[A>>>28]|u[A>>>24&15]|l[A>>>20&15]|f[A>>>16&15]|h[A>>>12&15]|p[A>>>8&15]|d[A>>>4&15];C=($>>>16^ie)&65535,g[w++]=ie^C,g[w++]=$^C<<16}}return g}function P1(t,e,r,i){var n=t.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=e[0],c=e[1];a=(o>>>4^c)&252645135,c^=a,o^=a<<4,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,o=o<<1|o>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var l=s[u+1],f=s[u+2],h=s[u];h!=l;h+=f){var p=c^t[h],d=(c>>>4|c<<28)^t[h+1];a=o,o=c,c=a^(MO[p>>>24&63]|UO[p>>>16&63]|KO[p>>>8&63]|jO[p&63]|LO[d>>>24&63]|qO[d>>>16&63]|FO[d>>>8&63]|VO[d&63])}a=o,o=c,c=a}o=o>>>1|o<<31,c=c>>>1|c<<31,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(o>>>4^c)&252645135,c^=a,o^=a<<4,r[0]=o,r[1]=c}function Kl(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,i;t.decrypt?i=Pt.cipher.createDecipher(r,t.key):i=Pt.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,a){var o=null;a instanceof Pt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,n.call(i,a)},i}});var ea=b((QY,O1)=>{var Vl=lt();O1.exports=Vl.md=Vl.md||{};Vl.md.algorithms=Vl.md.algorithms||{}});var k1=b((XY,N1)=>{var Dn=lt();ea();Xt();var HO=N1.exports=Dn.hmac=Dn.hmac||{};HO.create=function(){var t=null,e=null,r=null,i=null,n={};return n.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Dn.md.algorithms)e=Dn.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=Dn.util.createBuffer(a);else if(Dn.util.isArray(a)){var o=a;a=Dn.util.createBuffer();for(var c=0;c<o.length;++c)a.putByte(o[c])}var u=a.length();u>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=Dn.util.createBuffer(),i=Dn.util.createBuffer(),u=a.length();for(var c=0;c<u;++c){var o=a.at(c);r.putByte(54^o),i.putByte(92^o)}if(u<e.blockLength)for(var o=e.blockLength-u,c=0;c<o;++c)r.putByte(54),i.putByte(92);t=a,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var On=b(()=>{});var td=b((eQ,L1)=>{var Mr=lt();k1();ea();Xt();var zO=Mr.pkcs5=Mr.pkcs5||{},Nn;Mr.util.isNodejs&&!Mr.options.usePureJavaScript&&(Nn=On());L1.exports=Mr.pbkdf2=zO.pbkdf2=function(t,e,r,i,n,s){if(typeof n=="function"&&(s=n,n=null),Mr.util.isNodejs&&!Mr.options.usePureJavaScript&&Nn.pbkdf2&&(n===null||typeof n!="object")&&(Nn.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Nn.pbkdf2Sync.length===4?Nn.pbkdf2(t,e,r,i,function(C,V){if(C)return s(C);s(null,V.toString("binary"))}):Nn.pbkdf2(t,e,r,i,n,function(C,V){if(C)return s(C);s(null,V.toString("binary"))}):Nn.pbkdf2Sync.length===4?Nn.pbkdf2Sync(t,e,r,i).toString("binary"):Nn.pbkdf2Sync(t,e,r,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Mr.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Mr.md[n].create()}var a=n.digestLength;if(i>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var c=Math.ceil(i/a),u=i-(c-1)*a,l=Mr.hmac.create();l.start(n,t);var f="",h,p,d;if(!s){for(var y=1;y<=c;++y){l.start(null,null),l.update(e),l.update(Mr.util.int32ToBytes(y)),h=d=l.digest().getBytes();for(var g=2;g<=r;++g)l.start(null,null),l.update(d),p=l.digest().getBytes(),h=Mr.util.xorBytes(h,p,a),d=p;f+=y<c?h:h.substr(0,u)}return f}var y=1,g;function m(){if(y>c)return s(null,f);l.start(null,null),l.update(e),l.update(Mr.util.int32ToBytes(y)),h=d=l.digest().getBytes(),g=2,w()}function w(){if(g<=r)return l.start(null,null),l.update(d),p=l.digest().getBytes(),h=Mr.util.xorBytes(h,p,a),d=p,++g,Mr.util.setImmediate(w);f+=y<c?h:h.substr(0,u),++y,m()}m()}});var U1=b((tQ,q1)=>{var jl=lt();Xt();var M1=q1.exports=jl.pem=jl.pem||{};M1.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,i;if(t.procType&&(i={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Gl(i)),t.contentDomain&&(i={name:"Content-Domain",values:[t.contentDomain]},r+=Gl(i)),t.dekInfo&&(i={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&i.values.push(t.dekInfo.parameters),r+=Gl(i)),t.headers)for(var n=0;n<t.headers.length;++n)r+=Gl(t.headers[n]);return t.procType&&(r+=`\r
`),r+=jl.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};M1.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:jl.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var c=s[2].split(n),u=0;s&&u<c.length;){for(var l=c[u].replace(/\s+$/,""),f=u+1;f<c.length;++f){var h=c[f];if(!/\s/.test(h[0]))break;l+=h,u=f}if(s=l.match(i),s){for(var p={name:s[1],values:[]},d=s[2].split(","),y=0;y<d.length;++y)p.values.push(WO(d[y]));if(o.procType)if(!o.contentDomain&&p.name==="Content-Domain")o.contentDomain=d[0]||"";else if(!o.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else o.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:d[0],type:d[1]}}}++u}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Gl(t){for(var e=t.name+": ",r=[],i=function(c,u){return" "+u},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+`\r
`;for(var s=0,a=-1,n=0;n<e.length;++n,++s)if(s>65&&a!==-1){var o=e[a];o===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+o+e.substr(a+1),s=n-a-1,a=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(a=n);return e}function WO(t){return t.replace(/^\s+/,"")}});var H1=b((rQ,G1)=>{var nn=lt();ea();Xt();var F1=G1.exports=nn.sha256=nn.sha256||{};nn.md.sha256=nn.md.algorithms.sha256=F1;F1.create=function(){K1||$O();var t=null,e=nn.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=nn.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=nn.util.encodeUtf8(n));var a=n.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=i.fullMessageLength.length-1;o>=0;--o)i.fullMessageLength[o]+=a[1],a[1]=a[0]+(i.fullMessageLength[o]/4294967296>>>0),i.fullMessageLength[o]=i.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(n),j1(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=nn.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,a=s&i.blockLength-1;n.putBytes(rd.substr(0,i.blockLength-a));for(var o,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)o=i.fullMessageLength[l+1]*8,c=o/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=o>>>0;n.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};j1(f,r,n);var h=nn.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h.putInt32(f.h5),h.putInt32(f.h6),h.putInt32(f.h7),h},i};var rd=null,K1=!1,V1=null;function $O(){rd=String.fromCharCode(128),rd+=nn.util.fillString(String.fromCharCode(0),64),V1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],K1=!0}function j1(t,e,r){for(var i,n,s,a,o,c,u,l,f,h,p,d,y,g,m,w=r.length();w>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(l=t.h0,f=t.h1,h=t.h2,p=t.h3,d=t.h4,y=t.h5,g=t.h6,m=t.h7,u=0;u<64;++u)a=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),o=g^d&(y^g),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|h&(l^f),i=m+a+o+V1[u]+e[u],n=s+c,m=g,g=y,y=d,d=p+i>>>0,p=h,h=f,f=l,l=i+n>>>0;t.h0=t.h0+l|0,t.h1=t.h1+f|0,t.h2=t.h2+h|0,t.h3=t.h3+p|0,t.h4=t.h4+d|0,t.h5=t.h5+y|0,t.h6=t.h6+g|0,t.h7=t.h7+m|0,w-=64}}});var W1=b((iQ,z1)=>{var sn=lt();Xt();var Hl=null;sn.util.isNodejs&&!sn.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Hl=On());var YO=z1.exports=sn.prng=sn.prng||{};YO.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();e.pools=i,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var f=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,d=e.plugin.formatSeed,y=sn.util.createBuffer();e.key=null,g();function g(m){if(m)return l(m);if(y.length()>=u)return l(null,y.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return sn.util.nextTick(function(){s(g)});var w=f(e.key,e.seed);e.generated+=w.length,y.putBytes(w),e.key=p(f(e.key,h(e.seed))),e.seed=d(f(e.key,e.seed)),sn.util.setImmediate(g)}},e.generateSync=function(u){var l=e.plugin.cipher,f=e.plugin.increment,h=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var d=sn.util.createBuffer();d.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&a();var y=l(e.key,e.seed);e.generated+=y.length,d.putBytes(y),e.key=h(l(e.key,f(e.seed))),e.seed=p(l(e.key,e.seed))}return d.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return o(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(f,h){if(f)return u(f);e.collect(h),o(),u()})}function a(){if(e.pools[0].messageLength>=32)return o();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,f=0;f<32;++f)e.reseeds%l==0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,f=sn.util.globalScope,h=f.crypto||f.msCrypto;h&&h.getRandomValues&&(l=function(T){return h.getRandomValues(T)});var p=sn.util.createBuffer();if(l)for(;p.length()<u;){var d=Math.max(1,Math.min(u-p.length(),65536)/4),y=new Uint32Array(Math.floor(d));try{l(y);for(var g=0;g<y.length;++g)p.putInt32(y[g])}catch(T){if(!(typeof QuotaExceededError!="undefined"&&T instanceof QuotaExceededError))throw T}}if(p.length()<u)for(var m,w,C,V=Math.floor(Math.random()*65536);p.length()<u;){w=16807*(V&65535),m=16807*(V>>16),w+=(m&32767)<<16,w+=m>>15,w=(w&2147483647)+(w>>31),V=w&4294967295;for(var g=0;g<3;++g)C=V>>>(g<<3),C^=Math.floor(Math.random()*256),p.putByte(C&255)}return p.getBytes(u)}return Hl?(e.seedFile=function(u,l){Hl.randomBytes(u,function(f,h){if(f)return l(f);l(null,h.toString())})},e.seedFileSync=function(u){return Hl.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(f){l(f)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,f=0;f<l;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var f="",h=0;h<l;h+=8)f+=String.fromCharCode(u>>h&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,h){function p(d){var y=d.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",p),h(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var h=f.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(p,d){u.postMessage({forge:{prng:{err:p,bytes:d}}})})};u.addEventListener("message",l)}},e}});var Wc=b((nQ,id)=>{var dr=lt();Fl();H1();W1();Xt();(function(){if(dr.random&&dr.random.getBytes){id.exports=dr.random;return}(function(t){var e={},r=new Array(4),i=dr.util.createBuffer();e.formatKey=function(f){var h=dr.util.createBuffer(f);return f=new Array(4),f[0]=h.getInt32(),f[1]=h.getInt32(),f[2]=h.getInt32(),f[3]=h.getInt32(),dr.aes._expandKey(f,!1)},e.formatSeed=function(f){var h=dr.util.createBuffer(f);return f=new Array(4),f[0]=h.getInt32(),f[1]=h.getInt32(),f[2]=h.getInt32(),f[3]=h.getInt32(),f},e.cipher=function(f,h){return dr.aes._updateBlock(f,h,r,!1),i.putInt32(r[0]),i.putInt32(r[1]),i.putInt32(r[2]),i.putInt32(r[3]),i.getBytes()},e.increment=function(f){return++f[3],f},e.md=dr.md.sha256;function n(){var f=dr.prng.create(e);return f.getBytes=function(h,p){return f.generate(h,p)},f.getBytesSync=function(h){return f.generate(h)},f}var s=n(),a=null,o=dr.util.globalScope,c=o.crypto||o.msCrypto;if(c&&c.getRandomValues&&(a=function(f){return c.getRandomValues(f)}),dr.options.usePureJavaScript||!dr.util.isNodejs&&!a){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(f){}s.collect(u),u=null}t&&(t().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),t().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!dr.random)dr.random=s;else for(var l in s)dr.random[l]=s[l];dr.random.createInstance=n,id.exports=dr.random})(typeof jQuery!="undefined"?jQuery:null)})()});var X1=b((sQ,Q1)=>{var Hr=lt();Xt();var nd=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],$1=[1,2,3,5],QO=function(t,e){return t<<e&65535|(t&65535)>>16-e},XO=function(t,e){return(t&65535)>>e|t<<16-e&65535};Q1.exports=Hr.rc2=Hr.rc2||{};Hr.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Hr.util.createBuffer(t)),e=e||128;var r=t,i=t.length(),n=e,s=Math.ceil(n/8),a=255>>(n&7),o;for(o=i;o<128;o++)r.putByte(nd[r.at(o-1)+r.at(o-i)&255]);for(r.setAt(128-s,nd[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,nd[r.at(o+1)^r.at(o+s)]);return r};var Y1=function(t,e,r){var i=!1,n=null,s=null,a=null,o,c,u,l,f=[];for(t=Hr.rc2.expandKey(t,e),u=0;u<64;u++)f.push(t.getInt16Le());r?(o=function(d){for(u=0;u<4;u++)d[u]+=f[l]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),d[u]=QO(d[u],$1[u]),l++},c=function(d){for(u=0;u<4;u++)d[u]+=f[d[(u+3)%4]&63]}):(o=function(d){for(u=3;u>=0;u--)d[u]=XO(d[u],$1[u]),d[u]-=f[l]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),l--},c=function(d){for(u=3;u>=0;u--)d[u]-=f[d[(u+3)%4]&63]});var h=function(d){var y=[];for(u=0;u<4;u++){var g=n.getInt16Le();a!==null&&(r?g^=a.getInt16Le():a.putInt16Le(g)),y.push(g&65535)}l=r?0:63;for(var m=0;m<d.length;m++)for(var w=0;w<d[m][0];w++)d[m][1](y);for(u=0;u<4;u++)a!==null&&(r?a.putInt16Le(y[u]):y[u]^=a.getInt16Le()),s.putInt16Le(y[u])},p=null;return p={start:function(d,y){d&&typeof d=="string"&&(d=Hr.util.createBuffer(d)),i=!1,n=Hr.util.createBuffer(),s=y||new Hr.util.createBuffer,a=d,p.output=s},update:function(d){for(i||n.putBuffer(d);n.length()>=8;)h([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(d){var y=!0;if(r)if(d)y=d(8,n,!r);else{var g=n.length()===8?8:8-n.length();n.fillWithByte(g,g)}if(y&&(i=!0,p.update()),!r&&(y=n.length()===0,y))if(d)y=d(8,s,!r);else{var m=s.length(),w=s.at(m-1);w>m?y=!1:s.truncate(w)}return y}},p};Hr.rc2.startEncrypting=function(t,e,r){var i=Hr.rc2.createEncryptionCipher(t,128);return i.start(e,r),i};Hr.rc2.createEncryptionCipher=function(t,e){return Y1(t,e,!0)};Hr.rc2.startDecrypting=function(t,e,r){var i=Hr.rc2.createDecryptionCipher(t,128);return i.start(e,r),i};Hr.rc2.createDecryptionCipher=function(t,e){return Y1(t,e,!1)}});var $l=b((aQ,sb)=>{var sd=lt();sb.exports=sd.jsbn=sd.jsbn||{};var kn,ZO=244837814094590,Z1=(ZO&16777215)==15715070;function Q(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}sd.jsbn.BigInteger=Q;function Xe(){return new Q(null)}function JO(t,e,r,i,n,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[i]+n;n=Math.floor(a/67108864),r.data[i++]=a&67108863}return n}function eN(t,e,r,i,n,s){for(var a=e&32767,o=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=o*c+u*a;c=a*c+((l&32767)<<15)+r.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+o*u+(n>>>30),r.data[i++]=c&1073741823}return n}function J1(t,e,r,i,n,s){for(var a=e&16383,o=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=o*c+u*a;c=a*c+((l&16383)<<14)+r.data[i]+n,n=(c>>28)+(l>>14)+o*u,r.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(Q.prototype.am=J1,kn=28):Z1&&navigator.appName=="Microsoft Internet Explorer"?(Q.prototype.am=eN,kn=30):Z1&&navigator.appName!="Netscape"?(Q.prototype.am=JO,kn=26):(Q.prototype.am=J1,kn=28);Q.prototype.DB=kn;Q.prototype.DM=(1<<kn)-1;Q.prototype.DV=1<<kn;var ad=52;Q.prototype.FV=Math.pow(2,ad);Q.prototype.F1=ad-kn;Q.prototype.F2=2*kn-ad;var tN="0123456789abcdefghijklmnopqrstuvwxyz",zl=new Array,fo,fi;fo="0".charCodeAt(0);for(fi=0;fi<=9;++fi)zl[fo++]=fi;fo="a".charCodeAt(0);for(fi=10;fi<36;++fi)zl[fo++]=fi;fo="A".charCodeAt(0);for(fi=10;fi<36;++fi)zl[fo++]=fi;function eb(t){return tN.charAt(t)}function tb(t,e){var r=zl[t.charCodeAt(e)];return r??-1}function rN(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function iN(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function hs(t){var e=Xe();return e.fromInt(t),e}function nN(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var a=r==8?t[i]&255:tb(t,i);if(a<0){t.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&Q.ZERO.subTo(this,this)}function sN(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function aN(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,i,n=!1,s="",a=this.t,o=this.DB-a*this.DB%e;if(a-- >0)for(o<this.DB&&(i=this.data[a]>>o)>0&&(n=!0,s=eb(i));a>=0;)o<e?(i=(this.data[a]&(1<<o)-1)<<e-o,i|=this.data[--a]>>(o+=this.DB-e)):(i=this.data[a]>>(o-=e)&r,o<=0&&(o+=this.DB,--a)),i>0&&(n=!0),n&&(s+=eb(i));return n?s:"0"}function oN(){var t=Xe();return Q.ZERO.subTo(this,t),t}function cN(){return this.s<0?this.negate():this}function uN(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Wl(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function lN(){return this.t<=0?0:this.DB*(this.t-1)+Wl(this.data[this.t-1]^this.s&this.DM)}function fN(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function hN(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function dN(t,e){var r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+s+1]=this.data[o]>>i|a,a=(this.data[o]&n)<<r;for(o=s-1;o>=0;--o)e.data[o]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function pN(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<n,e.data[a-r]=this.data[a]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function yN(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function gN(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&Q.ZERO.subTo(e,e)}function mN(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function vN(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Xe());var s=Xe(),a=this.s,o=t.s,c=this.DB-Wl(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,r)):(i.copyTo(s),n.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var f=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/f,p=(1<<this.F1)/f,d=1<<this.F2,y=r.t,g=y-u,m=e??Xe();for(s.dlShiftTo(g,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),Q.ONE.dlShiftTo(u,m),m.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--g>=0;){var w=r.data[--y]==l?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+d)*p);if((r.data[y]+=s.am(0,w,r,g,0,u))<w)for(s.dlShiftTo(g,m),r.subTo(m,r);r.data[y]<--w;)r.subTo(m,r)}e!=null&&(r.drShiftTo(u,e),a!=o&&Q.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),a<0&&Q.ZERO.subTo(r,r)}}}function bN(t){var e=Xe();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(Q.ZERO)>0&&t.subTo(e,e),e}function ta(t){this.m=t}function EN(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function wN(t){return t}function _N(t){t.divRemTo(this.m,null,t)}function SN(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function xN(t,e){t.squareTo(e),this.reduce(e)}ta.prototype.convert=EN;ta.prototype.revert=wN;ta.prototype.reduce=_N;ta.prototype.mulTo=SN;ta.prototype.sqrTo=xN;function CN(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ra(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function IN(t){var e=Xe();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(Q.ZERO)>0&&this.m.subTo(e,e),e}function AN(t){var e=Xe();return t.copyTo(e),this.reduce(e),e}function TN(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function RN(t,e){t.squareTo(e),this.reduce(e)}function PN(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ra.prototype.convert=IN;ra.prototype.revert=AN;ra.prototype.reduce=TN;ra.prototype.mulTo=PN;ra.prototype.sqrTo=RN;function BN(){return(this.t>0?this.data[0]&1:this.s)==0}function DN(t,e){if(t>4294967295||t<1)return Q.ONE;var r=Xe(),i=Xe(),n=e.convert(this),s=Wl(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var a=r;r=i,i=a}return e.revert(r)}function ON(t,e){var r;return t<256||e.isEven()?r=new ta(e):r=new ra(e),this.exp(t,r)}Q.prototype.copyTo=rN;Q.prototype.fromInt=iN;Q.prototype.fromString=nN;Q.prototype.clamp=sN;Q.prototype.dlShiftTo=fN;Q.prototype.drShiftTo=hN;Q.prototype.lShiftTo=dN;Q.prototype.rShiftTo=pN;Q.prototype.subTo=yN;Q.prototype.multiplyTo=gN;Q.prototype.squareTo=mN;Q.prototype.divRemTo=vN;Q.prototype.invDigit=CN;Q.prototype.isEven=BN;Q.prototype.exp=DN;Q.prototype.toString=aN;Q.prototype.negate=oN;Q.prototype.abs=cN;Q.prototype.compareTo=uN;Q.prototype.bitLength=lN;Q.prototype.mod=bN;Q.prototype.modPowInt=ON;Q.ZERO=hs(0);Q.ONE=hs(1);function NN(){var t=Xe();return this.copyTo(t),t}function kN(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function LN(){return this.t==0?this.s:this.data[0]<<24>>24}function MN(){return this.t==0?this.s:this.data[0]<<16>>16}function qN(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function UN(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function FN(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=hs(r),n=Xe(),s=Xe(),a="";for(this.divRemTo(i,n,s);n.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,n.divRemTo(i,n,s);return s.intValue().toString(t)+a}function KN(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,a=0,o=0;o<t.length;++o){var c=tb(t,o);if(c<0){t.charAt(o)=="-"&&this.signum()==0&&(n=!0);continue}a=e*a+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),n&&Q.ZERO.subTo(this,this)}function VN(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(Q.ONE.shiftLeft(t-1),od,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(Q.ONE.shiftLeft(t-1),this);else{var i=new Array,n=t&7;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function jN(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,i,n=0;if(t-- >0)for(r<this.DB&&(i=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this.data[t]&(1<<r)-1)<<8-r,i|=this.data[--t]>>(r+=this.DB-8)):(i=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function GN(t){return this.compareTo(t)==0}function HN(t){return this.compareTo(t)<0?this:t}function zN(t){return this.compareTo(t)>0?this:t}function WN(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function $N(t,e){return t&e}function YN(t){var e=Xe();return this.bitwiseTo(t,$N,e),e}function od(t,e){return t|e}function QN(t){var e=Xe();return this.bitwiseTo(t,od,e),e}function rb(t,e){return t^e}function XN(t){var e=Xe();return this.bitwiseTo(t,rb,e),e}function ib(t,e){return t&~e}function ZN(t){var e=Xe();return this.bitwiseTo(t,ib,e),e}function JN(){for(var t=Xe(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function ek(t){var e=Xe();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function tk(t){var e=Xe();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function rk(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function ik(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+rk(this.data[t]);return this.s<0?this.t*this.DB:-1}function nk(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function sk(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=nk(this.data[r]^e);return t}function ak(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function ok(t,e){var r=Q.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function ck(t){return this.changeBit(t,od)}function uk(t){return this.changeBit(t,ib)}function lk(t){return this.changeBit(t,rb)}function fk(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function hk(t){var e=Xe();return this.addTo(t,e),e}function dk(t){var e=Xe();return this.subTo(t,e),e}function pk(t){var e=Xe();return this.multiplyTo(t,e),e}function yk(t){var e=Xe();return this.divRemTo(t,e,null),e}function gk(t){var e=Xe();return this.divRemTo(t,null,e),e}function mk(t){var e=Xe(),r=Xe();return this.divRemTo(t,e,r),new Array(e,r)}function vk(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bk(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function $c(){}function nb(t){return t}function Ek(t,e,r){t.multiplyTo(e,r)}function wk(t,e){t.squareTo(e)}$c.prototype.convert=nb;$c.prototype.revert=nb;$c.prototype.mulTo=Ek;$c.prototype.sqrTo=wk;function _k(t){return this.exp(t,new $c)}function Sk(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function xk(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function ho(t){this.r2=Xe(),this.q3=Xe(),Q.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Ck(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Xe();return t.copyTo(e),this.reduce(e),e}function Ik(t){return t}function Ak(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Tk(t,e){t.squareTo(e),this.reduce(e)}function Rk(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ho.prototype.convert=Ck;ho.prototype.revert=Ik;ho.prototype.reduce=Ak;ho.prototype.mulTo=Rk;ho.prototype.sqrTo=Tk;function Pk(t,e){var r=t.bitLength(),i,n=hs(1),s;if(r<=0)return n;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?s=new ta(e):e.isEven()?s=new ho(e):s=new ra(e);var a=new Array,o=3,c=i-1,u=(1<<i)-1;if(a[1]=s.convert(this),i>1){var l=Xe();for(s.sqrTo(a[1],l);o<=u;)a[o]=Xe(),s.mulTo(l,a[o-2],a[o]),o+=2}var f=t.t-1,h,p=!0,d=Xe(),y;for(r=Wl(t.data[f])-1;f>=0;){for(r>=c?h=t.data[f]>>r-c&u:(h=(t.data[f]&(1<<r+1)-1)<<c-r,f>0&&(h|=t.data[f-1]>>this.DB+r-c)),o=i;(h&1)==0;)h>>=1,--o;if((r-=o)<0&&(r+=this.DB,--f),p)a[h].copyTo(n),p=!1;else{for(;o>1;)s.sqrTo(n,d),s.sqrTo(d,n),o-=2;o>0?s.sqrTo(n,d):(y=n,n=d,d=y),s.mulTo(d,a[h],n)}for(;f>=0&&(t.data[f]&1<<r)==0;)s.sqrTo(n,d),y=n,n=d,d=y,--r<0&&(r=this.DB-1,--f)}return s.revert(n)}function Bk(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Dk(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function Ok(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return Q.ZERO;for(var r=t.clone(),i=this.clone(),n=hs(1),s=hs(0),a=hs(0),o=hs(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(t,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(a,n),s.subTo(o,s)):(i.subTo(r,i),e&&a.subTo(n,a),o.subTo(s,o))}if(i.compareTo(Q.ONE)!=0)return Q.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Ui=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Nk=(1<<26)/Ui[Ui.length-1];function kk(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Ui[Ui.length-1]){for(e=0;e<Ui.length;++e)if(r.data[0]==Ui[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Ui.length;){for(var i=Ui[e],n=e+1;n<Ui.length&&i<Nk;)i*=Ui[n++];for(i=r.modInt(i);e<n;)if(i%Ui[e++]==0)return!1}return r.millerRabin(t)}function Lk(t){var e=this.subtract(Q.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i=e.shiftRight(r),n=Mk(),s,a=0;a<t;++a){do s=new Q(this.bitLength(),n);while(s.compareTo(Q.ONE)<=0||s.compareTo(e)>=0);var o=s.modPow(i,this);if(o.compareTo(Q.ONE)!=0&&o.compareTo(e)!=0){for(var c=1;c++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(Q.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Mk(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}Q.prototype.chunkSize=qN;Q.prototype.toRadix=FN;Q.prototype.fromRadix=KN;Q.prototype.fromNumber=VN;Q.prototype.bitwiseTo=WN;Q.prototype.changeBit=ok;Q.prototype.addTo=fk;Q.prototype.dMultiply=vk;Q.prototype.dAddOffset=bk;Q.prototype.multiplyLowerTo=Sk;Q.prototype.multiplyUpperTo=xk;Q.prototype.modInt=Dk;Q.prototype.millerRabin=Lk;Q.prototype.clone=NN;Q.prototype.intValue=kN;Q.prototype.byteValue=LN;Q.prototype.shortValue=MN;Q.prototype.signum=UN;Q.prototype.toByteArray=jN;Q.prototype.equals=GN;Q.prototype.min=HN;Q.prototype.max=zN;Q.prototype.and=YN;Q.prototype.or=QN;Q.prototype.xor=XN;Q.prototype.andNot=ZN;Q.prototype.not=JN;Q.prototype.shiftLeft=ek;Q.prototype.shiftRight=tk;Q.prototype.getLowestSetBit=ik;Q.prototype.bitCount=sk;Q.prototype.testBit=ak;Q.prototype.setBit=ck;Q.prototype.clearBit=uk;Q.prototype.flipBit=lk;Q.prototype.add=hk;Q.prototype.subtract=dk;Q.prototype.multiply=pk;Q.prototype.divide=yk;Q.prototype.remainder=gk;Q.prototype.divideAndRemainder=mk;Q.prototype.modPow=Pk;Q.prototype.modInverse=Ok;Q.prototype.pow=_k;Q.prototype.gcd=Bk;Q.prototype.isProbablePrime=kk});var lb=b((oQ,ub)=>{var an=lt();ea();Xt();var ab=ub.exports=an.sha1=an.sha1||{};an.md.sha1=an.md.algorithms.sha1=ab;ab.create=function(){ob||qk();var t=null,e=an.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=an.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=an.util.encodeUtf8(n));var a=n.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=i.fullMessageLength.length-1;o>=0;--o)i.fullMessageLength[o]+=a[1],a[1]=a[0]+(i.fullMessageLength[o]/4294967296>>>0),i.fullMessageLength[o]=i.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(n),cb(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=an.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,a=s&i.blockLength-1;n.putBytes(cd.substr(0,i.blockLength-a));for(var o,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)o=i.fullMessageLength[l+1]*8,c=o/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=o>>>0;n.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};cb(f,r,n);var h=an.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h},i};var cd=null,ob=!1;function qk(){cd=String.fromCharCode(128),cd+=an.util.fillString(String.fromCharCode(0),64),ob=!0}function cb(t,e,r){for(var i,n,s,a,o,c,u,l,f=r.length();f>=64;){for(n=t.h0,s=t.h1,a=t.h2,o=t.h3,c=t.h4,l=0;l<16;++l)i=r.getInt32(),e[l]=i,u=o^s&(a^o),i=(n<<5|n>>>27)+u+c+1518500249+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=o^s&(a^o),i=(n<<5|n>>>27)+u+c+1518500249+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=s^a^o,i=(n<<5|n>>>27)+u+c+1859775393+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^a^o,i=(n<<5|n>>>27)+u+c+1859775393+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s&a|o&(s^a),i=(n<<5|n>>>27)+u+c+2400959708+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^a^o,i=(n<<5|n>>>27)+u+c+3395469782+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+o|0,t.h4=t.h4+c|0,f-=64}}});var db=b((cQ,hb)=>{var on=lt();Xt();Wc();lb();var fb=hb.exports=on.pkcs1=on.pkcs1||{};fb.encode_rsa_oaep=function(t,e,r){var i,n,s,a;typeof r=="string"?(i=r,n=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,n=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=on.md.sha1.create(),a||(a=s);var o=Math.ceil(t.n.bitLength()/8),c=o-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var l=s.digest(),f="",h=c-e.length,p=0;p<h;p++)f+="\0";var d=l.getBytes()+f+""+e;if(!n)n=on.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var y=Yl(n,o-s.digestLength-1,a),g=on.util.xorBytes(d,y,d.length),m=Yl(g,s.digestLength,a),w=on.util.xorBytes(n,m,n.length);return"\0"+w+g};fb.decode_rsa_oaep=function(t,e,r){var i,n,s;typeof r=="string"?(i=r,n=arguments[3]||void 0):r&&(i=r.label||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=e.length,g.expectedLength=a,g}if(n===void 0?n=on.md.sha1.create():n.start(),s||(s=n),a<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var o=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),f=Yl(l,n.digestLength,s),h=on.util.xorBytes(u,f,u.length),p=Yl(h,a-n.digestLength-1,s),d=on.util.xorBytes(l,p,l.length),y=d.substring(0,n.digestLength),g=c!=="\0",m=0;m<n.digestLength;++m)g|=o.charAt(m)!==y.charAt(m);for(var w=1,C=n.digestLength,V=n.digestLength;V<d.length;V++){var T=d.charCodeAt(V),A=T&1^1,te=w?65534:0;g|=T&te,w=w&A,C+=w}if(g||d.charCodeAt(C)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(C+1)};function Yl(t,e,r){r||(r=on.md.sha1.create());for(var i="",n=Math.ceil(e/r.digestLength),s=0;s<n;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),i+=r.digest().getBytes()}return i.substring(0,e)}});var pb=b((uQ,ud)=>{var ds=lt();Xt();$l();Wc();(function(){if(ds.prime){ud.exports=ds.prime;return}var t=ud.exports=ds.prime=ds.prime||{},e=ds.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(f,h){return f|h};t.generateProbablePrime=function(f,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var d=h.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var y=h.prng||ds.random,g={nextBytes:function(m){for(var w=y.getBytesSync(m.length),C=0;C<m.length;++C)m[C]=w.charCodeAt(C)}};if(d.name==="PRIMEINC")return s(f,g,d.options,p);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(f,h,p,d){return"workers"in p?c(f,h,p,d):a(f,h,p,d)}function a(f,h,p,d){var y=u(f,h),g=0,m=l(y.bitLength());"millerRabinTests"in p&&(m=p.millerRabinTests);var w=10;"maxBlockTime"in p&&(w=p.maxBlockTime),o(y,f,h,g,m,w,d)}function o(f,h,p,d,y,g,m){var w=+new Date;do{if(f.bitLength()>h&&(f=u(h,p)),f.isProbablePrime(y))return m(null,f);f.dAddOffset(r[d++%8],0)}while(g<0||+new Date-w<g);ds.util.setImmediate(function(){o(f,h,p,d,y,g,m)})}function c(f,h,p,d){if(typeof Worker=="undefined")return a(f,h,p,d);var y=u(f,h),g=p.workers,m=p.workLoad||100,w=m*30/8,C=p.workerScript||"forge/prime.worker.js";if(g===-1)return ds.util.estimateCores(function(T,A){T&&(A=2),g=A-1,V()});V();function V(){g=Math.max(1,g);for(var T=[],A=0;A<g;++A)T[A]=new Worker(C);for(var te=g,A=0;A<g;++A)T[A].addEventListener("message",$);var ie=!1;function $(Ce){if(!ie){--te;var me=Ce.data;if(me.found){for(var be=0;be<T.length;++be)T[be].terminate();return ie=!0,d(null,new e(me.prime,16))}y.bitLength()>f&&(y=u(f,h));var st=y.toString(16);Ce.target.postMessage({hex:st,workLoad:m}),y.dAddOffset(w,0)}}}}function u(f,h){var p=new e(f,h),d=f-1;return p.testBit(d)||p.bitwiseTo(e.ONE.shiftLeft(d),n,p),p.dAddOffset(31-p.mod(i).byteValue(),0),p}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})()});var Xl=b((lQ,wb)=>{var we=lt();zc();$l();kl();db();pb();Wc();Xt();typeof ze=="undefined"&&(ze=we.jsbn.BigInteger);var ze,ld=we.util.isNodejs?On():null,L=we.asn1,hi=we.util;we.pki=we.pki||{};wb.exports=we.pki.rsa=we.rsa=we.rsa||{};var Be=we.pki,Uk=[6,4,2,4,2,4,6,2],Fk={name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Kk={name:"RSAPrivateKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Vk={name:"RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},jk=we.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Gk={name:"DigestInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:L.Class.UNIVERSAL,type:L.Type.NULL,constructed:!1}]},{name:"DigestInfo.digest",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Hk=function(t){var e;if(t.algorithm in Be.oids)e=Be.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var i=L.oidToDer(e).getBytes(),n=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),s=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);s.value.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,i)),s.value.push(L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,""));var a=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(s),n.value.push(a),L.toDer(n).getBytes()},yb=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(ze.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(ze.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new ze(we.util.bytesToHex(we.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(ze.ONE));t=t.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var a=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(i.modInverse(e.n)).mod(e.n),a};Be.rsa.encrypt=function(t,e,r){var i=r,n,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(i=r===2,n=gb(t,e,r)):(n=we.util.createBuffer(),n.putBytes(t));for(var a=new ze(n.toHex(),16),o=yb(a,e,i),c=o.toString(16),u=we.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(we.util.hexToBytes(c)),u.getBytes()};Be.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=n,s}var a=new ze(we.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=yb(a,e,r),c=o.toString(16),u=we.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(we.util.hexToBytes(c)),i!==!1?Ql(u.getBytes(),e,r):u.getBytes()};Be.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||we.random,n={nextBytes:function(o){for(var c=i.getBytesSync(o.length),u=0;u<o.length;++u)o[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:n,eInt:e||65537,e:new ze(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};Be.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new ze(null);r.fromInt(30);for(var i=0,n=function(f,h){return f|h},s=+new Date,a,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new ze(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(ze.ONE.shiftLeft(u),n,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(Wk(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Uk[i++%8],0):t.pqState===2?t.pqState=t.num.subtract(ze.ONE).gcd(t.e).compareTo(ze.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(ze.ONE),t.q1=t.q.subtract(ze.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(ze.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:Be.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:Be.rsa.setPublicKey(t.n,t.e)}}a=+new Date,o+=a-s,s=a}return t.keys!==null};Be.rsa.generateKeyPair=function(t,e,r,i){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(i=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,i=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!we.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(i){if(mb("generateKeyPair"))return ld.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,c,u){if(o)return i(o);i(null,{privateKey:Be.privateKeyFromPem(u),publicKey:Be.publicKeyFromPem(c)})});if(vb("generateKey")&&vb("exportKey"))return hi.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Eb(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return hi.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){i(o)}).then(function(o){if(o){var c=Be.privateKeyFromAsn1(L.fromDer(we.util.createBuffer(o)));i(null,{privateKey:c,publicKey:Be.setRsaPublicKey(c.n,c.e)})}});if(bb("generateKey")&&bb("exportKey")){var n=hi.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Eb(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(o){var c=o.target.result,u=hi.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var f=l.target.result,h=Be.privateKeyFromAsn1(L.fromDer(we.util.createBuffer(f)));i(null,{privateKey:h,publicKey:Be.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){i(l)}},n.onerror=function(o){i(o)};return}}else if(mb("generateKeyPairSync")){var s=ld.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Be.privateKeyFromPem(s.privateKey),publicKey:Be.publicKeyFromPem(s.publicKey)}}}var a=Be.rsa.createKeyPairGenerationState(t,e,r);if(!i)return Be.rsa.stepKeyPairGenerationState(a,0),a.keys;zk(a,r,i)};Be.setRsaPublicKey=Be.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(o,c,u){return gb(o,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(o,c){return we.pkcs1.encode_rsa_oaep(c,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(o){return o}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var a=n.encode(i,r,!0);return Be.rsa.encrypt(a,r,!0)},r.verify=function(i,n,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=Ql(u,r,!0);var l=L.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),f={},h=[];if(!L.validate(l,Gk,f,h)){var p=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw p.errors=h,p}var d=L.derToOid(f.algorithmIdentifier);if(!(d===we.oids.md2||d===we.oids.md5||d===we.oids.sha1||d===we.oids.sha224||d===we.oids.sha256||d===we.oids.sha384||d===we.oids.sha512||d===we.oids["sha512-224"]||d===we.oids["sha512-256"])){var p=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw p.oid=d,p}return c===f.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=Ql(u,r,!0),c===u}});var o=Be.rsa.decrypt(n,r,!0,!1);return s.verify(i,o,r.n.bitLength())},r};Be.setRsaPrivateKey=Be.rsa.setPrivateKey=function(t,e,r,i,n,s,a,o){var c={n:t,e,d:r,p:i,q:n,dP:s,dQ:a,qInv:o};return c.decrypt=function(u,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=Be.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:Ql};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,d){return we.pkcs1.decode_rsa_oaep(d,p,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:Hk},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},f=1);var h=l.encode(u,c.n.bitLength());return Be.rsa.encrypt(h,c,f)},c};Be.wrapRsaPrivateKey=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Be.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(t).getBytes())])};Be.privateKeyFromAsn1=function(t){var e={},r=[];if(L.validate(t,Fk,e,r)&&(t=L.fromDer(we.util.createBuffer(e.privateKey))),e={},r=[],!L.validate(t,Kk,e,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var n,s,a,o,c,u,l,f;return n=we.util.createBuffer(e.privateKeyModulus).toHex(),s=we.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=we.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=we.util.createBuffer(e.privateKeyPrime1).toHex(),c=we.util.createBuffer(e.privateKeyPrime2).toHex(),u=we.util.createBuffer(e.privateKeyExponent1).toHex(),l=we.util.createBuffer(e.privateKeyExponent2).toHex(),f=we.util.createBuffer(e.privateKeyCoefficient).toHex(),Be.setRsaPrivateKey(new ze(n,16),new ze(s,16),new ze(a,16),new ze(o,16),new ze(c,16),new ze(u,16),new ze(l,16),new ze(f,16))};Be.privateKeyToAsn1=Be.privateKeyToRSAPrivateKey=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.e)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.d)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.p)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.q)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.dP)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.dQ)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.qInv))])};Be.publicKeyFromAsn1=function(t){var e={},r=[];if(L.validate(t,jk,e,r)){var i=L.derToOid(e.publicKeyOid);if(i!==Be.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}t=e.rsaPublicKey}if(r=[],!L.validate(t,Vk,e,r)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=r,n}var s=we.util.createBuffer(e.publicKeyModulus).toHex(),a=we.util.createBuffer(e.publicKeyExponent).toHex();return Be.setRsaPublicKey(new ze(s,16),new ze(a,16))};Be.publicKeyToAsn1=Be.publicKeyToSubjectPublicKeyInfo=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Be.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,[Be.publicKeyToRSAPublicKey(t)])])};Be.publicKeyToRSAPublicKey=function(t){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,cn(t.e))])};function gb(t,e,r){var i=we.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(t.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=n-11,s}i.putByte(0),i.putByte(r);var a=n-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var c=0;c<a;++c)i.putByte(o)}else for(;a>0;){for(var u=0,l=we.random.getBytes(a),c=0;c<a;++c)o=l.charCodeAt(c),o===0?++u:i.putByte(o);a=u}return i.putByte(0),i.putBytes(t),i}function Ql(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8),s=we.util.createBuffer(t),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(o===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(o===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function zk(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(t.pBits,function(o,c){if(o)return r(o);if(t.p=c,t.q!==null)return a(o,t.q);s(t.qBits,a)})}function s(o,c){we.prime.generateProbablePrime(o,i,c)}function a(o,c){if(o)return r(o);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(ze.ONE).gcd(t.e).compareTo(ze.ONE)!==0){t.p=null,n();return}if(t.q.subtract(ze.ONE).gcd(t.e).compareTo(ze.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract(ze.ONE),t.q1=t.q.subtract(ze.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(ze.ONE)!==0){t.p=t.q=null,n();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:Be.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:Be.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function cn(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=we.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function Wk(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function mb(t){return we.util.isNodejs&&typeof ld[t]=="function"}function vb(t){return typeof hi.globalScope!="undefined"&&typeof hi.globalScope.crypto=="object"&&typeof hi.globalScope.crypto.subtle=="object"&&typeof hi.globalScope.crypto.subtle[t]=="function"}function bb(t){return typeof hi.globalScope!="undefined"&&typeof hi.globalScope.msCrypto=="object"&&typeof hi.globalScope.msCrypto.subtle=="object"&&typeof hi.globalScope.msCrypto.subtle[t]=="function"}function Eb(t){for(var e=we.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r}});var Ab=b((fQ,Ib)=>{var fe=lt();Fl();zc();D1();ea();kl();td();U1();Wc();X1();Xl();Xt();typeof _b=="undefined"&&(_b=fe.jsbn.BigInteger);var _b,G=fe.asn1,Ne=fe.pki=fe.pki||{};Ib.exports=Ne.pbe=fe.pbe=fe.pbe||{};var ia=Ne.oids,$k={name:"EncryptedPrivateKeyInfo",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:G.Class.UNIVERSAL,type:G.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:G.Class.UNIVERSAL,type:G.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Yk={name:"PBES2Algorithms",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:G.Class.UNIVERSAL,type:G.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:G.Class.UNIVERSAL,type:G.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:G.Class.UNIVERSAL,type:G.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:G.Class.UNIVERSAL,type:G.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:G.Class.UNIVERSAL,type:G.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:G.Class.UNIVERSAL,type:G.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:G.Class.UNIVERSAL,type:G.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Qk={name:"pkcs-12PbeParams",tagClass:G.Class.UNIVERSAL,type:G.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:G.Class.UNIVERSAL,type:G.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:G.Class.UNIVERSAL,type:G.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ne.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=fe.random.getBytesSync(r.saltSize),n=r.count,s=G.integerToDer(n),a,o,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,f;switch(r.algorithm){case"aes128":a=16,u=16,l=ia["aes128-CBC"],f=fe.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,l=ia["aes192-CBC"],f=fe.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,l=ia["aes256-CBC"],f=fe.aes.createEncryptionCipher;break;case"des":a=8,u=8,l=ia.desCBC,f=fe.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Cb(p),y=fe.pkcs5.pbkdf2(e,i,n,a,d),g=fe.random.getBytesSync(u),m=f(y);m.start(g),m.update(G.toDer(t)),m.finish(),c=m.output.getBytes();var w=Xk(i,s,a,p);o=G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OID,!1,G.oidToDer(ia.pkcs5PBES2).getBytes()),G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OID,!1,G.oidToDer(ia.pkcs5PBKDF2).getBytes()),w]),G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OID,!1,G.oidToDer(l).getBytes()),G.create(G.Class.UNIVERSAL,G.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){a=24;var C=new fe.util.ByteBuffer(i),y=Ne.pbe.generatePkcs12Key(e,C,1,n,a),g=Ne.pbe.generatePkcs12Key(e,C,2,n,a),m=fe.des.createEncryptionCipher(y);m.start(g),m.update(G.toDer(t)),m.finish(),c=m.output.getBytes(),o=G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OID,!1,G.oidToDer(ia["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OCTETSTRING,!1,i),G.create(G.Class.UNIVERSAL,G.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var V=G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[o,G.create(G.Class.UNIVERSAL,G.Type.OCTETSTRING,!1,c)]);return V};Ne.decryptPrivateKeyInfo=function(t,e){var r=null,i={},n=[];if(!G.validate(t,$k,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var a=G.derToOid(i.encryptionOid),o=Ne.pbe.getCipher(a,i.encryptionParams,e),c=fe.util.createBuffer(i.encryptedData);return o.update(c),o.finish()&&(r=G.fromDer(o.output)),r};Ne.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:G.toDer(t).getBytes()};return fe.pem.encode(r,{maxline:e})};Ne.encryptedPrivateKeyFromPem=function(t){var e=fe.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return G.fromDer(e.body)};Ne.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var i=Ne.wrapRsaPrivateKey(Ne.privateKeyToAsn1(t));return i=Ne.encryptPrivateKeyInfo(i,e,r),Ne.encryptedPrivateKeyToPem(i)}var n,s,a,o;switch(r.algorithm){case"aes128":n="AES-128-CBC",a=16,s=fe.random.getBytesSync(16),o=fe.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",a=24,s=fe.random.getBytesSync(16),o=fe.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",a=32,s=fe.random.getBytesSync(16),o=fe.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",a=24,s=fe.random.getBytesSync(8),o=fe.des.createEncryptionCipher;break;case"des":n="DES-CBC",a=8,s=fe.random.getBytesSync(8),o=fe.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=fe.pbe.opensslDeriveBytes(e,s.substr(0,8),a),l=o(u);l.start(s),l.update(G.toDer(Ne.privateKeyToAsn1(t))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:fe.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return fe.pem.encode(f)};Ne.decryptRsaPrivateKey=function(t,e){var r=null,i=fe.pem.decode(t)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,a;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,a=fe.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=fe.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=fe.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=fe.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=fe.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(f){return fe.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,a=function(f){return fe.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,a=function(f){return fe.rc2.createDecryptionCipher(f,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var o=fe.util.hexToBytes(i.dekInfo.parameters),c=fe.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);if(u.start(o),u.update(fe.util.createBuffer(i.body)),u.finish())r=u.output.getBytes();else return r}else r=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?r=Ne.decryptPrivateKeyInfo(G.fromDer(r),e):r=G.fromDer(r),r!==null&&(r=Ne.privateKeyFromAsn1(r)),r};Ne.pbe.generatePkcs12Key=function(t,e,r,i,n,s){var a,o;if(typeof s=="undefined"||s===null){if(!("sha1"in fe.md))throw new Error('"sha1" hash algorithm unavailable.');s=fe.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new fe.util.ByteBuffer,f=new fe.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)f.putInt16(t.charCodeAt(o));f.putInt16(0)}var h=f.length(),p=e.length(),d=new fe.util.ByteBuffer;d.fillWithByte(r,u);var y=u*Math.ceil(p/u),g=new fe.util.ByteBuffer;for(o=0;o<y;o++)g.putByte(e.at(o%p));var m=u*Math.ceil(h/u),w=new fe.util.ByteBuffer;for(o=0;o<m;o++)w.putByte(f.at(o%h));var C=g;C.putBuffer(w);for(var V=Math.ceil(n/c),T=1;T<=V;T++){var A=new fe.util.ByteBuffer;A.putBytes(d.bytes()),A.putBytes(C.bytes());for(var te=0;te<i;te++)s.start(),s.update(A.getBytes()),A=s.digest();var ie=new fe.util.ByteBuffer;for(o=0;o<u;o++)ie.putByte(A.at(o%c));var $=Math.ceil(p/u)+Math.ceil(h/u),Ce=new fe.util.ByteBuffer;for(a=0;a<$;a++){var me=new fe.util.ByteBuffer(C.getBytes(u)),be=511;for(o=ie.length()-1;o>=0;o--)be=be>>8,be+=ie.at(o)+me.at(o),me.setAt(o,be&255);Ce.putBuffer(me)}C=Ce,l.putBuffer(A)}return l.truncate(l.length()-n),l};Ne.pbe.getCipher=function(t,e,r){switch(t){case Ne.oids.pkcs5PBES2:return Ne.pbe.getCipherForPBES2(t,e,r);case Ne.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ne.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ne.pbe.getCipherForPKCS12PBE(t,e,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=t,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};Ne.pbe.getCipherForPBES2=function(t,e,r){var i={},n=[];if(!G.validate(e,Yk,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(t=G.derToOid(i.kdfOid),t!==Ne.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=G.derToOid(i.encOid),t!==Ne.oids["aes128-CBC"]&&t!==Ne.oids["aes192-CBC"]&&t!==Ne.oids["aes256-CBC"]&&t!==Ne.oids["des-EDE3-CBC"]&&t!==Ne.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=i.kdfSalt,o=fe.util.createBuffer(i.kdfIterationCount);o=o.getInt(o.length()<<3);var c,u;switch(Ne.oids[t]){case"aes128-CBC":c=16,u=fe.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=fe.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=fe.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=fe.des.createDecryptionCipher;break;case"desCBC":c=8,u=fe.des.createDecryptionCipher;break}var l=xb(i.prfOid),f=fe.pkcs5.pbkdf2(r,a,o,c,l),h=i.encIv,p=u(f);return p.start(h),p};Ne.pbe.getCipherForPKCS12PBE=function(t,e,r){var i={},n=[];if(!G.validate(e,Qk,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var a=fe.util.createBuffer(i.salt),o=fe.util.createBuffer(i.iterations);o=o.getInt(o.length()<<3);var c,u,l;switch(t){case Ne.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=fe.des.startDecrypting;break;case Ne.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(y,g){var m=fe.rc2.createDecryptionCipher(y,40);return m.start(g,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var f=xb(i.prfOid),h=Ne.pbe.generatePkcs12Key(r,a,1,o,c,f);f.start();var p=Ne.pbe.generatePkcs12Key(r,a,2,o,u,f);return l(h,p)};Ne.pbe.opensslDeriveBytes=function(t,e,r,i){if(typeof i=="undefined"||i===null){if(!("md5"in fe.md))throw new Error('"md5" hash algorithm unavailable.');i=fe.md.md5.create()}e===null&&(e="");for(var n=[Sb(i,t+e)],s=16,a=1;s<r;++a,s+=16)n.push(Sb(i,n[a-1]+t+e));return n.join("").substr(0,r)};function Sb(t,e){return t.start().update(e).digest().getBytes()}function xb(t){var e;if(!t)e="hmacWithSHA1";else if(e=Ne.oids[G.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Cb(e)}function Cb(t){var e=fe.md;switch(t){case"hmacWithSHA224":e=fe.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Xk(t,e,r,i){var n=G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OCTETSTRING,!1,t),G.create(G.Class.UNIVERSAL,G.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(G.create(G.Class.UNIVERSAL,G.Type.INTEGER,!1,fe.util.hexToBytes(r.toString(16))),G.create(G.Class.UNIVERSAL,G.Type.SEQUENCE,!0,[G.create(G.Class.UNIVERSAL,G.Type.OID,!1,G.oidToDer(Ne.oids[i]).getBytes()),G.create(G.Class.UNIVERSAL,G.Type.NULL,!1,"")])),n}});var fd={};tr(fd,{identity:()=>Zk});var Zk,Tb=Ge(()=>{Xi();rs();Zk=Sl({prefix:"\0",name:"identity",encode:t=>nv(t),decode:t=>iv(t)})});var hd={};tr(hd,{base2:()=>Jk});var Jk,Rb=Ge(()=>{Xi();Jk=Ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var dd={};tr(dd,{base8:()=>e6});var e6,Pb=Ge(()=>{Xi();e6=Ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var pd={};tr(pd,{base10:()=>t6});var t6,Bb=Ge(()=>{Xi();t6=ns({prefix:"9",name:"base10",alphabet:"0123456789"})});var yd,Db,gd=Ge(()=>{Ws();yd=({name:t,code:e,encode:r})=>new Db(t,e,r),Db=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?is(this.code,r):r.then(i=>is(this.code,i))}else throw Error("Unknown type, must be binary type")}}});var Ln={};tr(Ln,{sha256:()=>r6,sha512:()=>i6});var Nb,r6,i6,ps=Ge(()=>{gd();Nb=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),r6=yd({name:"sha2-256",code:18,encode:Nb("SHA-256")}),i6=yd({name:"sha2-512",code:19,encode:Nb("SHA-512")})});var Yc={};tr(Yc,{identity:()=>a6});var kb,n6,Lb,s6,a6,Zl=Ge(()=>{rs();Ws();kb=0,n6="identity",Lb=Bn,s6=t=>is(kb,Lb(t)),a6={code:kb,name:n6,encode:Lb,digest:s6}});var Mb=Ge(()=>{rs()});var _Q,SQ,qb=Ge(()=>{_Q=new TextEncoder,SQ=new TextDecoder});var Ub=Ge(()=>{ao();_l();rs();gd();Ws()});var md,AQ,Fb=Ge(()=>{Tb();Rb();Pb();Bb();Rh();Ys();Th();as();Uc();ps();Zl();Mb();qb();Ub();md={...fd,...hd,...dd,...pd,...Al,...$s,...Il,...ss,...oo},AQ={...Ln,...Yc}});function Kb(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}var Vb,vd,u6,Jl,bd=Ge(()=>{Fb();Vb=Kb("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),vd=Kb("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),u6={utf8:Vb,"utf-8":Vb,hex:md.base16,latin1:vd,ascii:vd,binary:vd,...md},Jl=u6});var pr={};tr(pr,{fromString:()=>Ed});function Ed(t,e="utf8"){let r=Jl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var ar=Ge(()=>{bd()});var Mn={};tr(Mn,{concat:()=>l6});function l6(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));let r=new Uint8Array(e),i=0;for(let n of t)r.set(n,i),i+=n.length;return r}var qn=Ge(()=>{});var Qc=b(jb=>{"use strict";jb.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var wd=b((OQ,Hb)=>{"use strict";var{concat:f6}=(qn(),Mn),{fromString:Gb}=(ar(),pr),h6=Qc();function d6({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let a=h6.get();r*=8;async function o(u,l){let f=a.getRandomValues(new Uint8Array(n)),h=a.getRandomValues(new Uint8Array(e)),p={name:t,iv:h},d={name:"PBKDF2",salt:f,iterations:s,hash:{name:i}},y=await a.subtle.importKey("raw",Gb(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),g=await a.subtle.deriveKey(d,y,{name:t,length:r},!0,["encrypt"]),m=await a.subtle.encrypt(p,g,u);return f6([f,p.iv,new Uint8Array(m)])}async function c(u,l){let f=u.slice(0,n),h=u.slice(n,n+e),p=u.slice(n+e),d={name:t,iv:h},y={name:"PBKDF2",salt:f,iterations:s,hash:{name:i}},g=await a.subtle.importKey("raw",Gb(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),m=await a.subtle.deriveKey(y,g,{name:t,length:r},!0,["decrypt"]),w=await a.subtle.decrypt(d,m,p);return new Uint8Array(w)}return{encrypt:o,decrypt:c}}Hb.exports={create:d6}});var Wb=b((NQ,zb)=>{"use strict";var{base64:p6}=(Uc(),oo),y6=wd();zb.exports={import:async function(t,e){let r=p6.decode(t);return await y6.create().decrypt(r,e)}}});var di={};tr(di,{equals:()=>g6});function g6(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var pi=Ge(()=>{});var Sr={};tr(Sr,{toString:()=>_d});function _d(t,e="utf8"){let r=Jl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var yr=Ge(()=>{bd()});var Zb=b((LQ,Xb)=>{var xt=lt();ea();Xt();var Xc=Xb.exports=xt.sha512=xt.sha512||{};xt.md.sha512=xt.md.algorithms.sha512=Xc;var $b=xt.sha384=xt.sha512.sha384=xt.sha512.sha384||{};$b.create=function(){return Xc.create("SHA-384")};xt.md.sha384=xt.md.algorithms.sha384=$b;xt.sha512.sha256=xt.sha512.sha256||{create:function(){return Xc.create("SHA-512/256")}};xt.md["sha512/256"]=xt.md.algorithms["sha512/256"]=xt.sha512.sha256;xt.sha512.sha224=xt.sha512.sha224||{create:function(){return Xc.create("SHA-512/224")}};xt.md["sha512/224"]=xt.md.algorithms["sha512/224"]=xt.sha512.sha224;Xc.create=function(t){if(Yb||m6(),typeof t=="undefined"&&(t="SHA-512"),!(t in na))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=na[t],r=null,i=xt.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var c=o.messageLengthSize/4,u=0;u<c;++u)o.fullMessageLength.push(0);i=xt.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return o},o.start(),o.update=function(c,u){u==="utf8"&&(c=xt.util.encodeUtf8(c));var l=c.length;o.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=o.fullMessageLength.length-1;f>=0;--f)o.fullMessageLength[f]+=l[1],l[1]=l[0]+(o.fullMessageLength[f]/4294967296>>>0),o.fullMessageLength[f]=o.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),Qb(r,n,i),(i.read>2048||i.length()===0)&&i.compact(),o},o.digest=function(){var c=xt.util.createBuffer();c.putBytes(i.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,l=u&o.blockLength-1;c.putBytes(Sd.substr(0,o.blockLength-l));for(var f,h,p=o.fullMessageLength[0]*8,d=0;d<o.fullMessageLength.length-1;++d)f=o.fullMessageLength[d+1]*8,h=f/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=f>>>0;c.putInt32(p);for(var y=new Array(r.length),d=0;d<r.length;++d)y[d]=r[d].slice(0);Qb(y,n,c);var g=xt.util.createBuffer(),m;t==="SHA-512"?m=y.length:t==="SHA-384"?m=y.length-2:m=y.length-4;for(var d=0;d<m;++d)g.putInt32(y[d][0]),(d!==m-1||t!=="SHA-512/224")&&g.putInt32(y[d][1]);return g},o};var Sd=null,Yb=!1,xd=null,na=null;function m6(){Sd=String.fromCharCode(128),Sd+=xt.util.fillString(String.fromCharCode(0),128),xd=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],na={},na["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],na["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],na["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],na["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Yb=!0}function Qb(t,e,r){for(var i,n,s,a,o,c,u,l,f,h,p,d,y,g,m,w,C,V,T,A,te,ie,$,Ce,me,be,st,_t,Se,Re,Y,cr,Yt,Qr,ur,Xr=r.length();Xr>=128;){for(Se=0;Se<16;++Se)e[Se][0]=r.getInt32()>>>0,e[Se][1]=r.getInt32()>>>0;for(;Se<80;++Se)cr=e[Se-2],Re=cr[0],Y=cr[1],i=((Re>>>19|Y<<13)^(Y>>>29|Re<<3)^Re>>>6)>>>0,n=((Re<<13|Y>>>19)^(Y<<3|Re>>>29)^(Re<<26|Y>>>6))>>>0,Qr=e[Se-15],Re=Qr[0],Y=Qr[1],s=((Re>>>1|Y<<31)^(Re>>>8|Y<<24)^Re>>>7)>>>0,a=((Re<<31|Y>>>1)^(Re<<24|Y>>>8)^(Re<<25|Y>>>7))>>>0,Yt=e[Se-7],ur=e[Se-16],Y=n+Yt[1]+a+ur[1],e[Se][0]=i+Yt[0]+s+ur[0]+(Y/4294967296>>>0)>>>0,e[Se][1]=Y>>>0;for(y=t[0][0],g=t[0][1],m=t[1][0],w=t[1][1],C=t[2][0],V=t[2][1],T=t[3][0],A=t[3][1],te=t[4][0],ie=t[4][1],$=t[5][0],Ce=t[5][1],me=t[6][0],be=t[6][1],st=t[7][0],_t=t[7][1],Se=0;Se<80;++Se)u=((te>>>14|ie<<18)^(te>>>18|ie<<14)^(ie>>>9|te<<23))>>>0,l=((te<<18|ie>>>14)^(te<<14|ie>>>18)^(ie<<23|te>>>9))>>>0,f=(me^te&($^me))>>>0,h=(be^ie&(Ce^be))>>>0,o=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,c=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,p=(y&m|C&(y^m))>>>0,d=(g&w|V&(g^w))>>>0,Y=_t+l+h+xd[Se][1]+e[Se][1],i=st+u+f+xd[Se][0]+e[Se][0]+(Y/4294967296>>>0)>>>0,n=Y>>>0,Y=c+d,s=o+p+(Y/4294967296>>>0)>>>0,a=Y>>>0,st=me,_t=be,me=$,be=Ce,$=te,Ce=ie,Y=A+n,te=T+i+(Y/4294967296>>>0)>>>0,ie=Y>>>0,T=C,A=V,C=m,V=w,m=y,w=g,Y=n+a,y=i+s+(Y/4294967296>>>0)>>>0,g=Y>>>0;Y=t[0][1]+g,t[0][0]=t[0][0]+y+(Y/4294967296>>>0)>>>0,t[0][1]=Y>>>0,Y=t[1][1]+w,t[1][0]=t[1][0]+m+(Y/4294967296>>>0)>>>0,t[1][1]=Y>>>0,Y=t[2][1]+V,t[2][0]=t[2][0]+C+(Y/4294967296>>>0)>>>0,t[2][1]=Y>>>0,Y=t[3][1]+A,t[3][0]=t[3][0]+T+(Y/4294967296>>>0)>>>0,t[3][1]=Y>>>0,Y=t[4][1]+ie,t[4][0]=t[4][0]+te+(Y/4294967296>>>0)>>>0,t[4][1]=Y>>>0,Y=t[5][1]+Ce,t[5][0]=t[5][0]+$+(Y/4294967296>>>0)>>>0,t[5][1]=Y>>>0,Y=t[6][1]+be,t[6][0]=t[6][0]+me+(Y/4294967296>>>0)>>>0,t[6][1]=Y>>>0,Y=t[7][1]+_t,t[7][0]=t[7][0]+st+(Y/4294967296>>>0)>>>0,t[7][1]=Y>>>0,Xr-=128}}});var Cd=b((MQ,Jb)=>{"use strict";var ef=65536;function v6(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>ef)for(;r<t;)r+ef>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+ef)),r+=ef);else crypto.getRandomValues(e);return e}Jb.exports=v6});var tf=b((qQ,eE)=>{"use strict";var b6=Cd(),E6=Ae();eE.exports=function(t){if(isNaN(t)||t<=0)throw E6(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return b6(t)}});var rf=b(Zc=>{"use strict";Xt();$l();var w6=lt(),{fromString:_6}=(ar(),pr),{toString:tE}=(yr(),Sr),{concat:rE}=(qn(),Mn);Zc.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rE([new Uint8Array(e-r.length),r])}return tE(r,"base64url")};Zc.base64urlToBigInteger=t=>{let e=Zc.base64urlToBuffer(t);return new w6.jsbn.BigInteger(tE(e,"base16"),16)};Zc.base64urlToBuffer=(t,e)=>{let r=_6(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=rE([new Uint8Array(e-r.length),r])}return r}});var sE=b(Jc=>{"use strict";zc();Xl();var ys=lt(),{bigIntegerToUintBase64url:un,base64urlToBigInteger:ln}=rf(),{fromString:iE}=(ar(),pr),{toString:nE}=(yr(),Sr);Jc.pkcs1ToJwk=function(t){let e=ys.asn1.fromDer(nE(t,"ascii")),r=ys.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:un(r.n),e:un(r.e),d:un(r.d),p:un(r.p),q:un(r.q),dp:un(r.dP),dq:un(r.dQ),qi:un(r.qInv),alg:"RS256",kid:"2011-04-29"}};Jc.jwkToPkcs1=function(t){let e=ys.pki.privateKeyToAsn1({n:ln(t.n),e:ln(t.e),d:ln(t.d),p:ln(t.p),q:ln(t.q),dP:ln(t.dp),dQ:ln(t.dq),qInv:ln(t.qi)});return iE(ys.asn1.toDer(e).getBytes(),"ascii")};Jc.pkixToJwk=function(t){let e=ys.asn1.fromDer(nE(t,"ascii")),r=ys.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:un(r.n),e:un(r.e),alg:"RS256",kid:"2011-04-29"}};Jc.jwkToPkix=function(t){let e=ys.pki.publicKeyToAsn1({n:ln(t.n),e:ln(t.e)});return iE(ys.asn1.toDer(e).getBytes(),"ascii")}});var uE=b((KQ,cE)=>{"use strict";Xl();var aE=lt(),{base64urlToBigInteger:S6}=rf();function oE(t,e){return e.map(r=>S6(t[r]))}function x6(t){return aE.pki.setRsaPrivateKey(...oE(t,["n","e","d","p","q","dp","dq","qi"]))}function C6(t){return aE.pki.setRsaPublicKey(...oE(t,["n","e"]))}cE.exports={jwk2pub:C6,jwk2priv:x6}});var hE=b(Fn=>{"use strict";var Un=Qc(),I6=tf(),{toString:A6}=(yr(),Sr),{fromString:T6}=(ar(),pr);Fn.utils=sE();Fn.generateKey=async function(t){let e=await Un.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await lE(e);return{privateKey:r[0],publicKey:r[1]}};Fn.unmarshalPrivateKey=async function(t){let r=[await Un.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await R6(t)],i=await lE({privateKey:r[0],publicKey:r[1]});return{privateKey:i[0],publicKey:i[1]}};Fn.getRandomValues=I6;Fn.hashAndSign=async function(t,e){let r=await Un.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Un.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};Fn.hashAndVerify=async function(t,e,r){let i=await Un.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Un.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,r)};function lE(t){return Promise.all([Un.get().subtle.exportKey("jwk",t.privateKey),Un.get().subtle.exportKey("jwk",t.publicKey)])}function R6(t){return Un.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:P6,jwk2priv:B6}=uE();function fE(t,e,r,i){let n=e?P6(t):B6(t),s=A6(Uint8Array.from(r),"ascii"),a=i(s,n);return T6(a,"ascii")}Fn.encrypt=function(t,e){return fE(t,!0,e,(r,i)=>i.encrypt(r))};Fn.decrypt=function(t,e){return fE(t,!1,e,(r,i)=>i.decrypt(r))}});var nf=b((jQ,dE)=>{"use strict";var{base64:D6}=(Uc(),oo),O6=wd();dE.exports={export:async function(t,e){let i=await O6.create().encrypt(t,e);return D6.encode(i)}}});var vE=b((GQ,mE)=>{"use strict";var{sha256:pE}=(ps(),Ln),yE=Ae(),{equals:gE}=(pi(),di),{toString:N6}=(yr(),Sr);Zb();var sf=lt(),yi=hE(),af=Ol(),k6=nf(),of=class{constructor(e){this._key=e}async verify(e,r){return yi.hashAndVerify(this._key,r,e)}marshal(){return yi.utils.jwkToPkix(this._key)}get bytes(){return af.PublicKey.encode({Type:af.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return yi.encrypt(this._key,e)}equals(e){return gE(this.bytes,e.bytes)}async hash(){let{bytes:e}=await pE.digest(this.bytes);return e}},eu=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return yi.getRandomValues(16)}async sign(e){return yi.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw yE(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new of(this._publicKey)}decrypt(e){return yi.decrypt(this._key,e)}marshal(){return yi.utils.jwkToPkcs1(this._key)}get bytes(){return af.PrivateKey.encode({Type:af.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return gE(this.bytes,e.bytes)}async hash(){let{bytes:e}=await pE.digest(this.bytes);return e}async id(){let e=await this.public.hash();return N6(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let i=new sf.util.ByteBuffer(this.marshal()),n=sf.asn1.fromDer(i),s=sf.pki.privateKeyFromAsn1(n),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return sf.pki.encryptRsaPrivateKey(s,e,a)}else{if(r==="libp2p-key")return k6.export(this.bytes,e);throw yE(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function L6(t){let e=yi.utils.pkcs1ToJwk(t),r=await yi.unmarshalPrivateKey(e);return new eu(r.privateKey,r.publicKey)}function M6(t){let e=yi.utils.pkixToJwk(t);return new of(e)}async function q6(t){let e=await yi.unmarshalPrivateKey(t);return new eu(e.privateKey,e.publicKey)}async function U6(t){let e=await yi.generateKey(t);return new eu(e.privateKey,e.publicKey)}mE.exports={RsaPublicKey:of,RsaPrivateKey:eu,unmarshalRsaPublicKey:M6,unmarshalRsaPrivateKey:L6,generateKeyPair:U6,fromJwk:q6}});var TE=b(tt=>{"use strict";var F6=tt&&tt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(tt,"__esModule",{value:!0});tt.utils=tt.curve25519=tt.getSharedSecret=tt.verify=tt.sign=tt.getPublicKey=tt.Signature=tt.Point=tt.RistrettoPoint=tt.ExtendedPoint=tt.CURVE=void 0;var K6=F6(On()),qt=BigInt(0),Fe=BigInt(1),xr=BigInt(2),bE=BigInt(255),EE=xr**BigInt(252)+BigInt("27742317777372353535851937790883648493"),dt={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:xr**bE-BigInt(19),l:EE,n:EE,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};tt.CURVE=dt;var wE=xr**BigInt(256),tu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),HQ=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),V6=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),j6=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),G6=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),H6=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),We=class{constructor(e,r,i,n){this.x=e,this.y=r,this.z=i,this.t=n}static fromAffine(e){if(!(e instanceof Bt))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Bt.ZERO)?We.ZERO:new We(e.x,e.y,Fe,W(e.x*e.y))}static toAffineBatch(e){let r=$6(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(r[n]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){_E(e);let{x:r,y:i,z:n}=this,{x:s,y:a,z:o}=e,c=W(r*o),u=W(s*n),l=W(i*o),f=W(a*n);return c===u&&l===f}negate(){return new We(W(-this.x),this.y,this.z,W(-this.t))}double(){let{x:e,y:r,z:i}=this,{a:n}=dt,s=W(e**xr),a=W(r**xr),o=W(xr*W(i**xr)),c=W(n*s),u=W(W((e+r)**xr)-s-a),l=c+a,f=l-o,h=c-a,p=W(u*f),d=W(l*h),y=W(u*h),g=W(f*l);return new We(p,d,g,y)}add(e){_E(e);let{x:r,y:i,z:n,t:s}=this,{x:a,y:o,z:c,t:u}=e,l=W((i-r)*(o+a)),f=W((i+r)*(o-a)),h=W(f-l);if(h===qt)return this.double();let p=W(n*xr*u),d=W(s*xr*c),y=d+p,g=f+l,m=d-p,w=W(y*h),C=W(g*m),V=W(y*m),T=W(h*g);return new We(w,C,T,V)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,i=[],n=this,s=n;for(let a=0;a<r;a++){s=n,i.push(s);for(let o=1;o<2**(e-1);o++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,r){!r&&this.equals(We.BASE)&&(r=Bt.BASE);let i=r&&r._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&Td.get(r);n||(n=this.precomputeWindow(i),r&&i!==1&&(n=We.normalizeZ(n),Td.set(r,n)));let s=We.ZERO,a=We.ZERO,o=1+256/i,c=2**(i-1),u=BigInt(2**i-1),l=2**i,f=BigInt(i);for(let h=0;h<o;h++){let p=h*c,d=Number(e&u);if(e>>=f,d>c&&(d-=l,e+=Fe),d===0){let y=n[p];h%2&&(y=y.negate()),a=a.add(y)}else{let y=n[p+Math.abs(d)-1];d<0&&(y=y.negate()),s=s.add(y)}}return We.normalizeZ([s,a])[0]}multiply(e,r){return this.wNAF(yo(e,dt.l),r)}multiplyUnsafe(e){let r=yo(e,dt.l,!1),i=We.BASE,n=We.ZERO;if(r===qt)return n;if(this.equals(n)||r===Fe)return this;if(this.equals(i))return this.wNAF(r);let s=n,a=this;for(;r>qt;)r&Fe&&(s=s.add(a)),a=a.double(),r>>=Fe;return s}isSmallOrder(){return this.multiplyUnsafe(dt.h).equals(We.ZERO)}isTorsionFree(){return this.multiplyUnsafe(dt.l).equals(We.ZERO)}toAffine(e=cf(this.z)){let{x:r,y:i,z:n}=this,s=W(r*e),a=W(i*e);if(W(n*e)!==Fe)throw new Error("invZ was invalid");return new Bt(s,a)}fromRistrettoBytes(){Ad()}toRistrettoBytes(){Ad()}fromRistrettoHash(){Ad()}};tt.ExtendedPoint=We;We.BASE=new We(dt.Gx,dt.Gy,Fe,W(dt.Gx*dt.Gy));We.ZERO=new We(qt,Fe,Fe,qt);function _E(t){if(!(t instanceof We))throw new TypeError("ExtendedPoint expected")}function Id(t){if(!(t instanceof zr))throw new TypeError("RistrettoPoint expected")}function Ad(){throw new Error("Legacy method: switch to RistrettoPoint")}var zr=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=dt,i=W(tu*e*e),n=W((i+Fe)*G6),s=BigInt(-1),a=W((s-r*i)*W(i+r)),{isValid:o,value:c}=Pd(n,a),u=W(c*e);gs(u)||(u=W(-u)),o||(c=u),o||(s=i);let l=W(s*(i-Fe)*H6-a),f=c*c,h=W((c+c)*a),p=W(l*V6),d=W(Fe-f),y=W(Fe+f);return new We(W(h*y),W(d*p),W(p*y),W(h*d))}static hashToCurve(e){e=fn(e,64);let r=Rd(e.slice(0,32)),i=this.calcElligatorRistrettoMap(r),n=Rd(e.slice(32,64)),s=this.calcElligatorRistrettoMap(n);return new zr(i.add(s))}static fromHex(e){e=fn(e,32);let{a:r,d:i}=dt,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Rd(e);if(!Y6(po(s),e)||gs(s))throw new Error(n);let a=W(s*s),o=W(Fe+r*a),c=W(Fe-r*a),u=W(o*o),l=W(c*c),f=W(r*i*u-l),{isValid:h,value:p}=IE(W(f*l)),d=W(p*c),y=W(p*d*f),g=W((s+s)*d);gs(g)&&(g=W(-g));let m=W(o*y),w=W(g*m);if(!h||gs(w)||m===qt)throw new Error(n);return new zr(new We(g,m,Fe,w))}toRawBytes(){let{x:e,y:r,z:i,t:n}=this.ep,s=W(W(i+r)*W(i-r)),a=W(e*r),{value:o}=IE(W(s*a**xr)),c=W(o*s),u=W(o*a),l=W(c*u*n),f;if(gs(n*l)){let p=W(r*tu),d=W(e*tu);e=p,r=d,f=W(c*j6)}else f=u;gs(e*l)&&(r=W(-r));let h=W((i-r)*f);return gs(h)&&(h=W(-h)),po(h)}toHex(){return ru(this.toRawBytes())}toString(){return this.toHex()}equals(e){Id(e);let r=this.ep,i=e.ep,n=W(r.x*i.y)===W(r.y*i.x),s=W(r.y*i.y)===W(r.x*i.x);return n||s}add(e){return Id(e),new zr(this.ep.add(e.ep))}subtract(e){return Id(e),new zr(this.ep.subtract(e.ep))}multiply(e){return new zr(this.ep.multiply(e))}multiplyUnsafe(e){return new zr(this.ep.multiplyUnsafe(e))}};tt.RistrettoPoint=zr;zr.BASE=new zr(We.BASE);zr.ZERO=new zr(We.ZERO);var Td=new WeakMap,Bt=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Td.delete(this)}static fromHex(e,r=!0){let{d:i,P:n}=dt;e=fn(e,32);let s=e.slice();s[31]=e[31]&~128;let a=ms(s);if(r&&a>=n)throw new Error("Expected 0 < hex < P");if(!r&&a>=wE)throw new Error("Expected 0 < hex < 2**256");let o=W(a*a),c=W(o-Fe),u=W(i*o+Fe),{isValid:l,value:f}=Pd(c,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");let h=(f&Fe)===Fe;return(e[31]&128)!=0!==h&&(f=W(-f)),new Bt(f,a)}static async fromPrivateKey(e){return(await iu(e)).point}toRawBytes(){let e=po(this.y);return e[31]|=this.x&Fe?128:0,e}toHex(){return ru(this.toRawBytes())}toX25519(){let{y:e}=this,r=W((Fe+e)*cf(Fe-e));return po(r)}isTorsionFree(){return We.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Bt(W(-this.x),this.y)}add(e){return We.fromAffine(this).add(We.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return We.fromAffine(this).multiply(e,this).toAffine()}};tt.Point=Bt;Bt.BASE=new Bt(dt.Gx,dt.Gy);Bt.ZERO=new Bt(qt,Fe);var sa=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=fn(e,64),i=Bt.fromHex(r.slice(0,32),!1),n=ms(r.slice(32,64));return new sa(i,n)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Bt))throw new Error("Expected Point instance");return yo(r,dt.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(po(this.s),32),e}toHex(){return ru(this.toRawBytes())}};tt.Signature=sa;function z6(...t){if(!t.every(i=>i instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((i,n)=>i+n.length,0),r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){let s=t[i];r.set(s,n),n+=s.length}return r}var W6=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ru(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=W6[t[r]];return e}function SE(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let i=r*2,n=t.slice(i,i+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function xE(t){let e=32,r=t.toString(16).padStart(e*2,"0");return SE(r)}function po(t){return xE(t).reverse()}function gs(t){return(W(t)&Fe)===Fe}function ms(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+ru(Uint8Array.from(t).reverse()))}function Rd(t){return W(ms(t)&xr**bE-Fe)}function W(t,e=dt.P){let r=t%e;return r>=qt?r:e+r}function cf(t,e=dt.P){if(t===qt||e<=qt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=W(t,e),i=e,n=qt,s=Fe,a=Fe,o=qt;for(;r!==qt;){let u=i/r,l=i%r,f=n-a*u,h=s-o*u;i=r,r=l,n=a,s=o,a=f,o=h}if(i!==Fe)throw new Error("invert: does not exist");return W(n,e)}function $6(t,e=dt.P){let r=new Array(t.length),i=t.reduce((s,a,o)=>a===qt?s:(r[o]=s,W(s*a,e)),Fe),n=cf(i,e);return t.reduceRight((s,a,o)=>a===qt?s:(r[o]=W(s*r[o],e),W(s*a,e)),n),r}function Fi(t,e){let{P:r}=dt,i=t;for(;e-- >qt;)i*=i,i%=r;return i}function CE(t){let{P:e}=dt,r=BigInt(5),i=BigInt(10),n=BigInt(20),s=BigInt(40),a=BigInt(80),c=t*t%e*t%e,u=Fi(c,xr)*c%e,l=Fi(u,Fe)*t%e,f=Fi(l,r)*l%e,h=Fi(f,i)*f%e,p=Fi(h,n)*h%e,d=Fi(p,s)*p%e,y=Fi(d,a)*d%e,g=Fi(y,a)*d%e,m=Fi(g,i)*f%e;return{pow_p_5_8:Fi(m,xr)*t%e,b2:c}}function Pd(t,e){let r=W(e*e*e),i=W(r*r*e),n=CE(t*i).pow_p_5_8,s=W(t*r*n),a=W(e*s*s),o=s,c=W(s*tu),u=a===t,l=a===W(-t),f=a===W(-t*tu);return u&&(s=o),(l||f)&&(s=c),gs(s)&&(s=W(-s)),{isValid:u||l,value:s}}function IE(t){return Pd(Fe,t)}async function Bd(...t){let e=await tt.utils.sha512(z6(...t)),r=ms(e);return W(r,dt.l)}function Y6(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function fn(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):SE(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function yo(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(qt<t)return t}else if(qt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function AE(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Q6(t){return ms(AE(fn(t,32)))}async function iu(t){if(t=typeof t=="bigint"||typeof t=="number"?xE(yo(t,wE)):fn(t),t.length!==32)throw new Error("Expected 32 bytes");let e=await tt.utils.sha512(t),r=AE(e.slice(0,32)),i=e.slice(32,64),n=W(ms(r),dt.l),s=Bt.BASE.multiply(n),a=s.toRawBytes();return{head:r,prefix:i,scalar:n,point:s,pointBytes:a}}async function X6(t){return(await iu(t)).pointBytes}tt.getPublicKey=X6;async function Z6(t,e){t=fn(t);let{prefix:r,scalar:i,pointBytes:n}=await iu(e),s=await Bd(r,t),a=Bt.BASE.multiply(s),o=await Bd(a.toRawBytes(),n,t),c=W(s+o*i,dt.l);return new sa(a,c).toRawBytes()}tt.sign=Z6;async function J6(t,e,r){e=fn(e),r instanceof Bt||(r=Bt.fromHex(r,!1));let{r:i,s:n}=t instanceof sa?t.assertValidity():sa.fromHex(t),s=We.BASE.multiplyUnsafe(n),a=await Bd(i.toRawBytes(),r.toRawBytes(),e),o=We.fromAffine(r).multiplyUnsafe(a);return We.fromAffine(i).add(o).subtract(s).multiplyUnsafe(dt.h).equals(We.ZERO)}tt.verify=J6;async function e5(t,e){let{head:r}=await iu(t),i=Bt.fromHex(e).toX25519();return tt.curve25519.scalarMult(r,i)}tt.getSharedSecret=e5;Bt.BASE._setWindowSize(8);function uf(t,e,r){let i=W(t*(e-r));return e=W(e-i),r=W(r+i),[e,r]}function t5(t,e){let{P:r}=dt,i=yo(t,r),n=yo(e,r),s=BigInt(121665),a=i,o=Fe,c=qt,u=i,l=Fe,f=qt,h;for(let g=BigInt(255-1);g>=qt;g--){let m=n>>g&Fe;f^=m,h=uf(f,o,u),o=h[0],u=h[1],h=uf(f,c,l),c=h[0],l=h[1],f=m;let w=o+c,C=W(w*w),V=o-c,T=W(V*V),A=C-T,te=u+l,ie=u-l,$=W(ie*w),Ce=W(te*V);u=W(($+Ce)**xr),l=W(a*($-Ce)**xr),o=W(C*T),c=W(A*(C+W(s*A)))}h=uf(f,o,u),o=h[0],u=h[1],h=uf(f,c,l),c=h[0],l=h[1];let{pow_p_5_8:p,b2:d}=CE(c),y=W(Fi(p,BigInt(3))*d);return W(o*y)}function r5(t){return po(W(t,dt.P))}function i5(t){let e=fn(t,32);return e[31]&=127,ms(e)}tt.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(t,e){let r=i5(e),i=Q6(t),n=t5(r,i);if(n===qt)throw new Error("Invalid private or public key received");return r5(n)},scalarMultBase(t){return tt.curve25519.scalarMult(t,tt.curve25519.BASE_POINT_U)}};var vs={node:K6.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};tt.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:ru,getExtendedPublicKey:iu,mod:W,invert:cf,hashToPrivateScalar:t=>{if(t=fn(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=W(ms(t),dt.l);if(e===qt||e===Fe)throw new Error("Invalid private key");return e},randomBytes:(t=32)=>{if(vs.web)return vs.web.getRandomValues(new Uint8Array(t));if(vs.node){let{randomBytes:e}=vs.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>tt.utils.randomBytes(32),sha512:async t=>{if(vs.web){let e=await vs.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(vs.node)return Uint8Array.from(vs.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Bt.BASE){let r=e.equals(Bt.BASE)?e:new Bt(e.x,e.y);return r._setWindowSize(t),r.multiply(xr),r}}});var PE=b(bs=>{"use strict";var nu=TE(),n5=32,s5=64,lf=32;bs.publicKeyLength=n5;bs.privateKeyLength=s5;bs.generateKey=async function(){let t=nu.utils.randomPrivateKey(),e=await nu.getPublicKey(t);return{privateKey:RE(t,e),publicKey:e}};bs.generateKeyFromSeed=async function(t){if(t.length!==lf)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await nu.getPublicKey(e);return{privateKey:RE(e,r),publicKey:r}};bs.hashAndSign=function(t,e){let r=t.slice(0,lf);return nu.sign(e,r)};bs.hashAndVerify=function(t,e,r){return nu.verify(e,r,t)};function RE(t,e){let r=new Uint8Array(bs.privateKeyLength);for(let i=0;i<lf;i++)r[i]=t[i],r[lf+i]=e[i];return r}});var kE=b(($Q,NE)=>{"use strict";var BE=Ae(),{equals:DE}=(pi(),di),{sha256:OE}=(ps(),Ln),{base58btc:a5}=(as(),ss),{identity:o5}=(Zl(),Yc),Tr=PE(),ff=Ol(),c5=nf(),hf=class{constructor(e){this._key=mo(e,Tr.publicKeyLength)}async verify(e,r){return Tr.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return ff.PublicKey.encode({Type:ff.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return DE(this.bytes,e.bytes)}async hash(){let{bytes:e}=await OE.digest(this.bytes);return e}},go=class{constructor(e,r){this._key=mo(e,Tr.privateKeyLength),this._publicKey=mo(r,Tr.publicKeyLength)}async sign(e){return Tr.hashAndSign(this._key,e)}get public(){return new hf(this._publicKey)}marshal(){return this._key}get bytes(){return ff.PrivateKey.encode({Type:ff.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return DE(this.bytes,e.bytes)}async hash(){let{bytes:e}=await OE.digest(this.bytes);return e}async id(){let e=await o5.digest(this.public.bytes);return a5.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return c5.export(this.bytes,e);throw BE(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function u5(t){if(t.length>Tr.privateKeyLength){t=mo(t,Tr.privateKeyLength+Tr.publicKeyLength);let i=t.slice(0,Tr.privateKeyLength),n=t.slice(Tr.privateKeyLength,t.length);return new go(i,n)}t=mo(t,Tr.privateKeyLength);let e=t.slice(0,Tr.privateKeyLength),r=t.slice(Tr.publicKeyLength);return new go(e,r)}function l5(t){return t=mo(t,Tr.publicKeyLength),new hf(t)}async function f5(){let{privateKey:t,publicKey:e}=await Tr.generateKey();return new go(t,e)}async function h5(t){let{privateKey:e,publicKey:r}=await Tr.generateKeyFromSeed(t);return new go(e,r)}function mo(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw BE(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}NE.exports={Ed25519PublicKey:hf,Ed25519PrivateKey:go,unmarshalEd25519PrivateKey:u5,unmarshalEd25519PublicKey:l5,generateKeyPair:f5,generateKeyPairFromSeed:h5}});var ZE=b(He=>{"use strict";var d5=He&&He.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(He,"__esModule",{value:!0});He.utils=He.schnorr=He.verify=He.signSync=He.sign=He.getSharedSecret=He.recoverPublicKey=He.getPublicKey=He.Signature=He.Point=He.CURVE=void 0;var p5=d5(On()),je=BigInt(0),Ct=BigInt(1),Zt=BigInt(2),su=BigInt(3),y5=BigInt(8),Dd=Zt**BigInt(256),pt={a:je,b:BigInt(7),P:Dd-Zt**BigInt(32)-BigInt(977),n:Dd-BigInt("432420386565659656852420866394968145599"),h:Ct,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};He.CURVE=pt;function LE(t){let{a:e,b:r}=pt,i=le(t*t),n=le(i*t);return le(n+e*t+r)}var df=pt.a===je,rt=class{constructor(e,r,i){this.x=e,this.y=r,this.z=i}static fromAffine(e){if(!(e instanceof it))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new rt(e.x,e.y,Ct)}static toAffineBatch(e){let r=b5(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(r[n]))}static normalizeZ(e){return rt.toAffineBatch(e).map(rt.fromAffine)}equals(e){if(!(e instanceof rt))throw new TypeError("JacobianPoint expected");let{x:r,y:i,z:n}=this,{x:s,y:a,z:o}=e,c=le(n**Zt),u=le(o**Zt),l=le(r*u),f=le(s*c),h=le(le(i*o)*u),p=le(le(a*n)*c);return l===f&&h===p}negate(){return new rt(this.x,le(-this.y),this.z)}double(){let{x:e,y:r,z:i}=this,n=le(e**Zt),s=le(r**Zt),a=le(s**Zt),o=le(Zt*(le((e+s)**Zt)-n-a)),c=le(su*n),u=le(c**Zt),l=le(u-Zt*o),f=le(c*(o-l)-y5*a),h=le(Zt*r*i);return new rt(l,f,h)}add(e){if(!(e instanceof rt))throw new TypeError("JacobianPoint expected");let{x:r,y:i,z:n}=this,{x:s,y:a,z:o}=e;if(s===je||a===je)return this;if(r===je||i===je)return e;let c=le(n**Zt),u=le(o**Zt),l=le(r*u),f=le(s*c),h=le(le(i*o)*u),p=le(le(a*n)*c),d=le(f-l),y=le(p-h);if(d===je)return y===je?this.double():rt.ZERO;let g=le(d**Zt),m=le(d*g),w=le(l*g),C=le(y**Zt-m-Zt*w),V=le(y*(w-C)-h*m),T=le(n*o*d);return new rt(C,V,T)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=UE(e),i=rt.BASE,n=rt.ZERO;if(r===je)return n;if(r===Ct)return this;if(!df){let h=n,p=this;for(;r>je;)r&Ct&&(h=h.add(p)),p=p.double(),r>>=Ct;return h}let{k1neg:s,k1:a,k2neg:o,k2:c}=KE(r),u=n,l=n,f=this;for(;a>je||c>je;)a&Ct&&(u=u.add(f)),c&Ct&&(l=l.add(f)),f=f.double(),a>>=Ct,c>>=Ct;return s&&(u=u.negate()),o&&(l=l.negate()),l=new rt(le(l.x*pt.beta),l.y,l.z),u.add(l)}precomputeWindow(e){let r=df?128/e+1:256/e+1,i=[],n=this,s=n;for(let a=0;a<r;a++){s=n,i.push(s);for(let o=1;o<2**(e-1);o++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,r){!r&&this.equals(rt.BASE)&&(r=it.BASE);let i=r&&r._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&Od.get(r);n||(n=this.precomputeWindow(i),r&&i!==1&&(n=rt.normalizeZ(n),Od.set(r,n)));let s=rt.ZERO,a=rt.ZERO,o=1+(df?128/i:256/i),c=2**(i-1),u=BigInt(2**i-1),l=2**i,f=BigInt(i);for(let h=0;h<o;h++){let p=h*c,d=Number(e&u);if(e>>=f,d>c&&(d-=l,e+=Ct),d===0){let y=n[p];h%2&&(y=y.negate()),a=a.add(y)}else{let y=n[p+Math.abs(d)-1];d<0&&(y=y.negate()),s=s.add(y)}}return{p:s,f:a}}multiply(e,r){let i=UE(e),n,s;if(df){let{k1neg:a,k1:o,k2neg:c,k2:u}=KE(i),{p:l,f}=this.wNAF(o,r),{p:h,f:p}=this.wNAF(u,r);a&&(l=l.negate()),c&&(h=h.negate()),h=new rt(le(h.x*pt.beta),h.y,h.z),n=l.add(h),s=f.add(p)}else{let{p:a,f:o}=this.wNAF(i,r);n=a,s=o}return rt.normalizeZ([n,s])[0]}toAffine(e=cu(this.z)){let{x:r,y:i,z:n}=this,s=e,a=le(s*s),o=le(a*s),c=le(r*a),u=le(i*o);if(le(n*s)!==Ct)throw new Error("invZ was invalid");return new it(c,u)}};rt.BASE=new rt(pt.Gx,pt.Gy,Ct);rt.ZERO=new rt(je,Ct,je);var Od=new WeakMap,it=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Od.delete(this)}static fromCompressedHex(e){let r=e.length===32,i=gi(r?e:e.subarray(1));if(!gf(i))throw new Error("Point is not on curve");let n=LE(i),s=v5(n),a=(s&Ct)===Ct;r?a&&(s=le(-s)):(e[0]&1)==1!==a&&(s=le(-s));let o=new it(i,s);return o.assertValidity(),o}static fromUncompressedHex(e){let r=gi(e.subarray(1,33)),i=gi(e.subarray(33,65)),n=new it(r,i);return n.assertValidity(),n}static fromHex(e){let r=dn(e),i=r.length,n=r[0];if(i===32||i===33&&(n===2||n===3))return this.fromCompressedHex(r);if(i===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${i}`)}static fromPrivateKey(e){return it.BASE.multiply(Eo(e))}static fromSignature(e,r,i){e=dn(e);let n=VE(e),{r:s,s:a}=GE(r);if(i!==0&&i!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(n===je)throw new Error("Cannot recover signature: msgHash cannot be 0");let o=i&1?"03":"02",c=it.fromHex(o+Kn(s)),{n:u}=pt,l=cu(s,u),f=le(-n*l,u),h=le(a*l,u),p=it.BASE.multiplyAndAddUnsafe(c,f,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return Es(this.toHex(e))}toHex(e=!1){let r=Kn(this.x);return e?`${this.y&Ct?"03":"02"}${r}`:`04${r}${Kn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:i}=this;if(!gf(r)||!gf(i))throw new Error(e);let n=le(i*i),s=LE(r);if(le(n-s)!==je)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new it(this.x,le(-this.y))}double(){return rt.fromAffine(this).double().toAffine()}add(e){return rt.fromAffine(this).add(rt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return rt.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,i){let s=rt.fromAffine(this).multiply(r),a=rt.fromAffine(e).multiplyUnsafe(i),o=s.add(a);return o.equals(rt.ZERO)?void 0:o.toAffine()}};He.Point=it;it.BASE=new it(pt.Gx,pt.Gy);it.ZERO=new it(je,je);function ME(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function qE(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${vo(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:gi(r),left:t.subarray(e+2)}}function g5(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${vo(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=qE(t.subarray(2)),{data:i,left:n}=qE(r);if(n.length)throw new Error(`Invalid signature: left bytes after parsing: ${vo(n)}`);return{r:e,s:i}}var hn=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=au(e),i="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${i}: Expected string or Uint8Array`);let n=r?vo(e):e;if(n.length!==128)throw new Error(`${i}: Expected 64-byte hex`);return new hn(pf(n.slice(0,64)),pf(n.slice(64,128)))}static fromDER(e){let r=au(e);if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:i,s:n}=g5(r?e:Es(e));return new hn(i,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!bo(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!bo(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=pt.n>>Ct;return this.s>e}normalizeS(){return this.hasHighS()?new hn(this.r,pt.n-this.s):this}toDERRawBytes(e=!1){return Es(this.toDERHex(e))}toDERHex(e=!1){let r=ME(ou(this.s));if(e)return r;let i=ME(ou(this.r)),n=ou(i.length/2),s=ou(r.length/2);return`30${ou(i.length/2+r.length/2+4)}02${n}${i}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Es(this.toCompactHex())}toCompactHex(){return Kn(this.r)+Kn(this.s)}};He.Signature=hn;function Nd(...t){if(!t.every(au))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((i,n)=>i+n.length,0),r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){let s=t[i];r.set(s,n),n+=s.length}return r}function au(t){return t instanceof Uint8Array}var m5=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function vo(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=m5[t[r]];return e}function Kn(t){if(t>Dd)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function kd(t){return Es(Kn(t))}function ou(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function pf(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Es(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let i=r*2,n=t.slice(i,i+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function gi(t){return pf(vo(t))}function dn(t){return t instanceof Uint8Array?Uint8Array.from(t):Es(t)}function UE(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&bo(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function le(t,e=pt.P){let r=t%e;return r>=je?r:e+r}function mi(t,e){let{P:r}=pt,i=t;for(;e-- >je;)i*=i,i%=r;return i}function v5(t){let{P:e}=pt,r=BigInt(6),i=BigInt(11),n=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),c=t*t*t%e,u=c*c*t%e,l=mi(u,su)*u%e,f=mi(l,su)*u%e,h=mi(f,Zt)*c%e,p=mi(h,i)*h%e,d=mi(p,n)*p%e,y=mi(d,a)*d%e,g=mi(y,o)*y%e,m=mi(g,a)*d%e,w=mi(m,su)*u%e,C=mi(w,s)*p%e,V=mi(C,r)*c%e;return mi(V,Zt)}function cu(t,e=pt.P){if(t===je||e<=je)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=le(t,e),i=e,n=je,s=Ct,a=Ct,o=je;for(;r!==je;){let u=i/r,l=i%r,f=n-a*u,h=s-o*u;i=r,r=l,n=a,s=o,a=f,o=h}if(i!==Ct)throw new Error("invert: does not exist");return le(n,e)}function b5(t,e=pt.P){let r=new Array(t.length),i=t.reduce((s,a,o)=>a===je?s:(r[o]=s,le(s*a,e)),Ct),n=cu(i,e);return t.reduceRight((s,a,o)=>a===je?s:(r[o]=le(s*r[o],e),le(s*a,e)),n),r}var FE=(t,e)=>(t+e/Zt)/e,yf=Zt**BigInt(128);function KE(t){let{n:e}=pt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-Ct*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=FE(s*t,e),o=FE(-i*t,e),c=le(t-a*r-o*n,e),u=le(-a*i-o*s,e),l=c>yf,f=u>yf;if(l&&(c=e-c),f&&(u=e-u),c>yf||u>yf)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:l,k1:c,k2neg:f,k2:u}}function VE(t){let{n:e}=pt,i=t.length*8-256,n=gi(t);return i>0&&(n=n>>BigInt(i)),n>=e&&(n-=e),n}var Ld=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return He.utils.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof He.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=He.utils.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function bo(t){return je<t&&t<pt.n}function gf(t){return je<t&&t<pt.P}function jE(t,e,r){let i=gi(t);if(!bo(i))return;let{n}=pt,s=it.BASE.multiply(i),a=le(s.x,n);if(a===je)return;let o=le(cu(i,n)*le(e+r*a,n),n);if(o===je)return;let c=new hn(a,o),u=(s.x===c.r?0:2)|Number(s.y&Ct);return{sig:c,recovery:u}}function Eo(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=pf(t)}else if(au(t)){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=gi(t)}else throw new TypeError("Expected valid private key");if(!bo(e))throw new Error("Expected private key: 0 < key < n");return e}function Md(t){return t instanceof it?(t.assertValidity(),t):it.fromHex(t)}function GE(t){if(t instanceof hn)return t.assertValidity(),t;try{return hn.fromDER(t)}catch(e){return hn.fromCompact(t)}}function E5(t,e=!1){return it.fromPrivateKey(t).toRawBytes(e)}He.getPublicKey=E5;function w5(t,e,r,i=!1){return it.fromSignature(t,e,r).toRawBytes(i)}He.recoverPublicKey=w5;function HE(t){let e=au(t),r=typeof t=="string",i=(e||r)&&t.length;return e?i===33||i===65:r?i===66||i===130:t instanceof it}function _5(t,e,r=!1){if(HE(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!HE(e))throw new TypeError("getSharedSecret: second arg must be public key");let i=Md(e);return i.assertValidity(),i.multiply(Eo(t)).toRawBytes(r)}He.getSharedSecret=_5;function zE(t){let e=t.length>32?t.slice(0,32):t;return gi(e)}function S5(t){let e=zE(t),r=le(e,pt.n);return WE(r<je?e:r)}function WE(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=Kn(t);return Es(e)}function $E(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let i=dn(t),n=Eo(e),s=[WE(n),S5(i)];if(r!=null){r===!0&&(r=He.utils.randomBytes(32));let c=dn(r);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}let a=Nd(...s),o=zE(i);return{seed:a,m:o,d:n}}function YE(t,e){let{sig:r,recovery:i}=t,{canonical:n,der:s,recovered:a}=Object.assign({canonical:!0,der:!0},e);n&&r.hasHighS()&&(r=r.normalizeS(),i^=1);let o=s?r.toDERRawBytes():r.toCompactRawBytes();return a?[o,i]:o}async function x5(t,e,r={}){let{seed:i,m:n,d:s}=$E(t,e,r.extraEntropy),a,o=new Ld;for(await o.reseed(i);!(a=jE(await o.generate(),n,s));)await o.reseed();return YE(a,r)}He.sign=x5;function C5(t,e,r={}){let{seed:i,m:n,d:s}=$E(t,e,r.extraEntropy),a,o=new Ld;for(o.reseedSync(i);!(a=jE(o.generateSync(),n,s));)o.reseedSync();return YE(a,r)}He.signSync=C5;var I5={strict:!0};function A5(t,e,r,i=I5){let n;try{n=GE(t),e=dn(e)}catch(y){return!1}let{r:s,s:a}=n;if(i.strict&&n.hasHighS())return!1;let o=VE(e);if(o===je)return!1;let c;try{c=Md(r)}catch(y){return!1}let{n:u}=pt,l=cu(a,u),f=le(o*l,u),h=le(s*l,u),p=it.BASE.multiplyAndAddUnsafe(c,f,h);return p?le(p.x,u)===s:!1}He.verify=A5;async function qd(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),i=await He.utils.sha256(r),n=await He.utils.sha256(Nd(i,i,...e));return gi(n)}async function QE(t,e,r){let i=kd(t),n=await qd("BIP0340/challenge",i,e.toRawX(),r);return le(n,pt.n)}function Ud(t){return(t.y&Ct)===je}var aa=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=dn(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let i=gi(r.subarray(0,32)),n=gi(r.subarray(32,64));return new aa(i,n)}assertValidity(){let{r:e,s:r}=this;if(!gf(e)||!bo(r))throw new Error("Invalid signature")}toHex(){return Kn(this.r)+Kn(this.s)}toRawBytes(){return Es(this.toHex())}};function T5(t){return it.fromPrivateKey(t).toRawX()}async function R5(t,e,r=He.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);let{n:i}=pt,n=dn(t),s=Eo(e),a=dn(r);if(a.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let o=it.fromPrivateKey(s),c=Ud(o)?s:i-s,u=await qd("BIP0340/aux",a),l=c^u,f=await qd("BIP0340/nonce",kd(l),o.toRawX(),n),h=le(f,i);if(h===je)throw new Error("sign: Creation of signature failed. k is zero");let p=it.fromPrivateKey(h),d=Ud(p)?h:i-h,y=await QE(p.x,o,n),g=new aa(p.x,le(d+y*c,i)).toRawBytes();if(!await XE(g,n,o.toRawX()))throw new Error("sign: Invalid signature produced");return g}async function XE(t,e,r){let i=t instanceof aa,n;try{n=i?t:aa.fromHex(t),i&&n.assertValidity()}catch(f){return!1}let{r:s,s:a}=n,o=dn(e),c;try{c=Md(r)}catch(f){return!1}let u=await QE(s,c,o),l=it.BASE.multiplyAndAddUnsafe(c,Eo(a),le(-u,pt.n));return!(!l||!Ud(l)||l.x!==s)}He.schnorr={Signature:aa,getPublicKey:T5,sign:R5,verify:XE};it.BASE._setWindowSize(8);var ei={node:p5.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};He.utils={isValidPrivateKey(t){try{return Eo(t),!0}catch(e){return!1}},hashToPrivateKey:t=>{if(t=dn(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=le(gi(t),pt.n);if(e===je||e===Ct)throw new Error("Invalid private key");return kd(e)},randomBytes:(t=32)=>{if(ei.web)return ei.web.getRandomValues(new Uint8Array(t));if(ei.node){let{randomBytes:e}=ei.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>He.utils.hashToPrivateKey(He.utils.randomBytes(40)),bytesToHex:vo,mod:le,sha256:async t=>{if(ei.web){let e=await ei.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(ei.node){let{createHash:e}=ei.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(ei.web){let r=await ei.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),i=Nd(...e),n=await ei.web.subtle.sign("HMAC",r,i);return new Uint8Array(n)}else if(ei.node){let{createHmac:r}=ei.node,i=r("sha256",t);return e.forEach(n=>i.update(n)),Uint8Array.from(i.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=it.BASE){let r=e===it.BASE?e:new it(e.x,e.y);return r._setWindowSize(t),r.multiply(su),r}}});var t2=b((QQ,e2)=>{"use strict";var uu=Ae(),ws=ZE(),{sha256:JE}=(ps(),Ln);e2.exports=()=>{let t=32;function e(){return ws.utils.randomPrivateKey()}async function r(u,l){let{digest:f}=await JE.digest(l);try{return await ws.sign(f,u)}catch(h){throw uu(h,"ERR_INVALID_INPUT")}}async function i(u,l,f){try{let{digest:h}=await JE.digest(f);return ws.verify(l,h,u)}catch(h){throw uu(h,"ERR_INVALID_INPUT")}}function n(u){return ws.Point.fromHex(u).toRawBytes(!0)}function s(u){return ws.Point.fromHex(u).toRawBytes(!1)}function a(u){try{ws.getPublicKey(u,!0)}catch(l){throw uu(l,"ERR_INVALID_PRIVATE_KEY")}}function o(u){try{ws.Point.fromHex(u)}catch(l){throw uu(l,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return ws.getPublicKey(u,!0)}catch(l){throw uu(l,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:i,compressPublicKey:n,decompressPublicKey:s,validatePrivateKey:a,validatePublicKey:o,computePublicKey:c}}});var s2=b((XQ,n2)=>{"use strict";var{sha256:r2}=(ps(),Ln),P5=Ae(),{equals:i2}=(pi(),di),{toString:B5}=(yr(),Sr),D5=nf();n2.exports=(t,e,r)=>{r=r||t2()();class i{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return i2(this.bytes,u.bytes)}async hash(){let{bytes:u}=await r2.digest(this.bytes);return u}}class n{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return i2(this.bytes,u.bytes)}async hash(){let{bytes:u}=await r2.digest(this.bytes);return u}async id(){let u=await this.public.hash();return B5(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return D5.export(this.bytes,u);throw P5(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function a(c){return new i(c)}async function o(){let c=await r.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:a,generateKeyPair:o}}});var o2=b((ZQ,a2)=>{"use strict";a2.exports={SHA1:20,SHA256:32,SHA512:64}});var Fd=b(u2=>{"use strict";var c2=Qc(),O5=o2(),N5={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},k5=async(t,e)=>{let r=await c2.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};u2.create=async function(t,e){let r=N5[t],i=await c2.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(n){return k5(i,n)},length:O5[t]}}});var p2=b((eX,d2)=>{"use strict";var l2=Ae(),{concat:f2}=(qn(),Mn),{fromString:L5}=(ar(),pr),M5=Fd(),h2={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};d2.exports=async(t,e,r)=>{let i=h2[t];if(!i){let w=Object.keys(h2).join(" / ");throw l2(new Error(`unknown cipher type '${t}'. Must be ${w}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw l2(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,a=20,o=L5("key expansion"),c=2*(s+n+a),u=await M5.create(e,r),l=await u.digest(o),f=[],h=0;for(;h<c;){let w=await u.digest(f2([l,o])),C=w.length;h+C>c&&(C=c-h),f.push(w),h+=C,l=await u.digest(l)}let p=c/2,d=f2(f),y=d.slice(0,p),g=d.slice(p,c),m=w=>({iv:w.slice(0,s),cipherKey:w.slice(s,s+n),macKey:w.slice(s+n)});return{k1:m(y),k2:m(g)}}});var g2=b((tX,y2)=>{"use strict";var q5=Ae();y2.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw q5(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var _2=b(w2=>{"use strict";var U5=Ae(),lu=Qc(),{base64urlToBuffer:m2}=rf(),F5=g2(),{toString:Kd}=(yr(),Sr),{concat:K5}=(qn(),Mn),{equals:V5}=(pi(),di),v2={"P-256":256,"P-384":384,"P-521":521};w2.generateEphmeralKeyPair=async function(t){F5(Object.keys(v2),t);let e=await lu.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(n,s)=>{let a;s?a=await lu.get().subtle.importKey("jwk",G5(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):a=e.privateKey;let o=[await lu.get().subtle.importKey("jwk",E2(t,n),{name:"ECDH",namedCurve:t},!1,[]),a],c=await lu.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:o[0]},o[1],v2[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await lu.get().subtle.exportKey("jwk",e.publicKey);return{key:j5(i),genSharedKey:r}};var b2={"P-256":32,"P-384":48,"P-521":66};function j5(t){let e=b2[t.crv];return K5([Uint8Array.from([4]),m2(t.x,e),m2(t.y,e)],1+e*2)}function E2(t,e){let r=b2[t];if(V5(!e.slice(0,1),Uint8Array.from([4])))throw U5(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:Kd(e.slice(1,r+1),"base64url"),y:Kd(e.slice(1+r),"base64url"),ext:!0}}var G5=(t,e)=>({...E2(t,e.public),d:Kd(e.private,"base64url")})});var x2=b((iX,S2)=>{"use strict";var H5=_2();S2.exports=async t=>H5.generateEphmeralKeyPair(t)});var vf=b((nX,I2)=>{"use strict";var pn=Ol();zc();Ab();var Vd=lt(),fu=Ae(),{fromString:z5}=(ar(),pr),W5=Wb(),vi={rsa:vE(),ed25519:kE(),secp256k1:s2()(pn,tf())},mf={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function wo(t){let e=vi[t.toLowerCase()];if(!e){let r=Object.keys(vi).join(" / ");throw fu(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var $5=async(t,e)=>wo(t).generateKeyPair(e),Y5=async(t,e,r)=>{let i=wo(t);if(t.toLowerCase()!=="ed25519")throw fu(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,r)},Q5=t=>{let e=pn.PublicKey.decode(t),r=e.Data;switch(e.Type){case pn.KeyType.RSA:return vi.rsa.unmarshalRsaPublicKey(r);case pn.KeyType.Ed25519:return vi.ed25519.unmarshalEd25519PublicKey(r);case pn.KeyType.Secp256k1:if(vi.secp256k1)return vi.secp256k1.unmarshalSecp256k1PublicKey(r);throw fu(new Error(mf.message),mf.code);default:wo(e.Type)}},X5=(t,e)=>(e=(e||"rsa").toLowerCase(),wo(e),t.bytes),C2=async t=>{let e=pn.PrivateKey.decode(t),r=e.Data;switch(e.Type){case pn.KeyType.RSA:return vi.rsa.unmarshalRsaPrivateKey(r);case pn.KeyType.Ed25519:return vi.ed25519.unmarshalEd25519PrivateKey(r);case pn.KeyType.Secp256k1:if(vi.secp256k1)return vi.secp256k1.unmarshalSecp256k1PrivateKey(r);throw fu(new Error(mf.message),mf.code);default:wo(e.Type)}},Z5=(t,e)=>(e=(e||"rsa").toLowerCase(),wo(e),t.bytes),J5=async(t,e)=>{try{let n=await W5.import(t,e);return C2(n)}catch(n){}let r=Vd.pki.decryptRsaPrivateKey(t,e);if(r===null)throw fu(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=Vd.asn1.toDer(Vd.pki.privateKeyToAsn1(r));return i=z5(i.getBytes(),"ascii"),vi.rsa.unmarshalRsaPrivateKey(i)};I2.exports={supportedKeys:vi,keysPBM:pn,keyStretcher:p2(),generateEphemeralKeyPair:x2(),generateKeyPair:$5,generateKeyPairFromSeed:Y5,unmarshalPublicKey:Q5,marshalPublicKey:X5,unmarshalPrivateKey:C2,marshalPrivateKey:Z5,import:J5}});var A2=b((sX,jd)=>{"use strict";function eL(t,{className:e,symbolName:r}){let i=Symbol.for(r),n={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function tL(t,{className:e,symbolName:r,withoutNew:i}){let n=Symbol.for(r),s={[e]:function(...a){if(i&&!(this instanceof s))return new s(...a);let o=t.call(this,...a)||this;return o&&!o[n]&&Object.defineProperty(o,n,{value:!0}),o}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=a=>!!(a&&a[n]),s}jd.exports=eL;jd.exports.proto=tL});var P2=b((aX,R2)=>{"use strict";var _o=tn(),T2=_o.Reader,rL=_o.Writer,or=_o.util,hu=_o.roots["libp2p-peer-id"]||(_o.roots["libp2p-peer-id"]={});hu.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.id=or.newBuffer([]),t.prototype.pubKey=or.newBuffer([]),t.prototype.privKey=or.newBuffer([]),t.encode=function(r,i){return i||(i=rL.create()),i.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&i.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&i.uint32(26).bytes(r.privKey),i},t.decode=function(r,i){r instanceof T2||(r=T2.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new hu.PeerIdProto;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(a&7);break}}if(!s.hasOwnProperty("id"))throw or.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof hu.PeerIdProto)return r;var i=new hu.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?or.base64.decode(r.id,i.id=or.newBuffer(or.base64.length(r.id)),0):r.id.length&&(i.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?or.base64.decode(r.pubKey,i.pubKey=or.newBuffer(or.base64.length(r.pubKey)),0):r.pubKey.length&&(i.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?or.base64.decode(r.privKey,i.privKey=or.newBuffer(or.base64.length(r.privKey)),0):r.privKey.length&&(i.privKey=r.privKey)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=or.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=or.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=or.newBuffer(n.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(n.id=i.bytes===String?or.base64.encode(r.id,0,r.id.length):i.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?or.base64.encode(r.pubKey,0,r.pubKey.length):i.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?or.base64.encode(r.privKey,0,r.privKey.length):i.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,_o.util.toJSONOptions)},t}();R2.exports=hu});var rr=b((Rr,q2)=>{"use strict";var{CID:Gd}=(ao(),qc),iL=(Ys(),$s),nL=(Th(),Il),sL=(as(),ss),aL=(Uc(),oo),{base58btc:Hd}=(as(),ss),{base32:oL}=(Ys(),$s),{base16:B2}=(Rh(),Al),du=(Ws(),Lc),yn=vf(),cL=A2(),{PeerIdProto:D2}=P2(),{equals:oa}=(pi(),di),{fromString:pu}=(ar(),pr),{toString:uL}=(yr(),Sr),{identity:bf}=(Zl(),Yc),O2={...iL,...nL,...sL,...aL},lL=Object.keys(O2).reduce((t,e)=>t.or(O2[e]),oL.decoder),fL=112,N2=114,k2=class{constructor(e,r,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&i&&!oa(r.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=Hd.encode(this.id).substring(1),this._privKey=r,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=du.decode(this.id);e.code===bf.code&&(this._pubKey=yn.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return yn.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return yn.marshalPrivateKey(this.privKey)}marshal(e){return D2.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:M2(this.marshalPrivKey()),pubKey:M2(this.marshalPubKey())}}toHexString(){return B2.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=Gd.createV1(N2,du.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return oa(this.id,e);if(e.id)return oa(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&oa(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(du.decode(this.id).code===bf.code)return!0}catch(e){}return!1}},gn=cL(k2,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});Rr=q2.exports=gn;var yu=t=>t.bytes.length<=42?du.create(bf.code,t.bytes).bytes:t.hash(),zd=async(t,e)=>{let r=await yu(e);return new gn(r,t,e)};Rr.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await yn.generateKeyPair(t.keyType,t.bits);return zd(e,e.public)};Rr.createFromHexString=t=>new gn(B2.decode("f"+t));Rr.createFromBytes=t=>{try{let e=Gd.decode(t);if(!L2(e))throw new Error("Supplied PeerID CID is invalid");return Rr.createFromCID(e)}catch{if(du.decode(t).code!==bf.code)throw new Error("Supplied PeerID CID is invalid");return new gn(t)}};Rr.createFromB58String=t=>Rr.createFromBytes(Hd.decode("z"+t));var L2=t=>t.code===N2||t.code===fL;Rr.createFromCID=t=>{if(t=Gd.asCID(t),!t||!L2(t))throw new Error("Supplied PeerID CID is invalid");return new gn(t.multihash.bytes)};Rr.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=pu(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await yn.unmarshalPublicKey(e);return zd(void 0,r)};Rr.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=pu(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await yn.unmarshalPrivateKey(t);return zd(e,e.public)};Rr.createFromJSON=async t=>{let e=Hd.decode("z"+t.id),r=t.privKey&&pu(t.privKey,"base64pad"),i=t.pubKey&&pu(t.pubKey,"base64pad"),n=i&&await yn.unmarshalPublicKey(i);if(!r)return new gn(e,void 0,n);let s=await yn.unmarshalPrivateKey(r),a=await yu(s.public),o;if(n&&(o=await yu(n)),n&&!oa(a,o))throw new Error("Public and private key do not match");if(e&&!oa(a,e))throw new Error("Id and private key do not match");return new gn(e,s,n)};Rr.createFromProtobuf=async t=>{typeof t=="string"&&(t=pu(t,"base16"));let{id:e,privKey:r,pubKey:i}=D2.decode(t);r=r?await yn.unmarshalPrivateKey(r):!1,i=i?await yn.unmarshalPublicKey(i):!1;let n,s;if(r&&(s=await yu(r.public)),i&&(n=await yu(i)),r){if(i&&!oa(s,n))throw new Error("Public and private key do not match");return new gn(s,r,r.public)}if(i)return new gn(n,void 0,i);if(e)return new gn(e);throw new Error("Protobuf did not contain any usable key material")};Rr.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),Rr.createFromBytes(lL.decode(t)));Rr.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function M2(t){if(t)return uL(t,"base64pad")}});var $d=b((oX,F2)=>{"use strict";var U2="[a-fA-F\\d:]",_s=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${U2})|(?<=${U2})(?=\\s|$))`:"",Ki="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ir="[a-fA-F\\d]{1,4}",Ef=`
(?:
(?:${ir}:){7}(?:${ir}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ir}:){6}(?:${Ki}|:${ir}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ir}:){5}(?::${Ki}|(?::${ir}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ir}:){4}(?:(?::${ir}){0,1}:${Ki}|(?::${ir}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ir}:){3}(?:(?::${ir}){0,2}:${Ki}|(?::${ir}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ir}:){2}(?:(?::${ir}){0,3}:${Ki}|(?::${ir}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ir}:){1}(?:(?::${ir}){0,4}:${Ki}|(?::${ir}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ir}){0,5}:${Ki}|(?::${ir}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),hL=new RegExp(`(?:^${Ki}$)|(?:^${Ef}$)`),dL=new RegExp(`^${Ki}$`),pL=new RegExp(`^${Ef}$`),Wd=t=>t&&t.exact?hL:new RegExp(`(?:${_s(t)}${Ki}${_s(t)})|(?:${_s(t)}${Ef}${_s(t)})`,"g");Wd.v4=t=>t&&t.exact?dL:new RegExp(`${_s(t)}${Ki}${_s(t)}`,"g");Wd.v6=t=>t&&t.exact?pL:new RegExp(`${_s(t)}${Ef}${_s(t)}`,"g");F2.exports=Wd});var Qd=b((cX,K2)=>{"use strict";var Yd=$d(),So=t=>Yd({exact:!0}).test(t);So.v4=t=>Yd.v4({exact:!0}).test(t);So.v6=t=>Yd.v6({exact:!0}).test(t);So.version=t=>So(t)?So.v4(t)?4:6:void 0;K2.exports=So});var z2=b((uX,H2)=>{"use strict";var Xd=Qd(),{toString:V2}=(yr(),Sr),yL=Xd,Zd=Xd.v4,j2=Xd.v6,G2=function(t,e,r){r=~~r;let i;if(Zd(t))i=e||new Uint8Array(r+4),t.split(/\./g).map(function(n){i[r++]=parseInt(n,10)&255});else if(j2(t)){let n=t.split(":",8),s;for(s=0;s<n.length;s++){let a=Zd(n[s]),o;a&&(o=G2(n[s]),n[s]=V2(o.slice(0,2),"base16")),o&&++s<8&&n.splice(s,0,V2(o.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let a=[s,"1"];for(s=9-n.length;s>0;s--)a.push("0");n.splice.apply(n,a)}for(i=e||new Uint8Array(r+16),s=0;s<n.length;s++){let a=parseInt(n[s],16);i[r++]=a>>8&255,i[r++]=a&255}}if(!i)throw Error("Invalid ip address: "+t);return i},gL=function(t,e,r){e=~~e,r=r||t.length-e;let i=[],n,s=new DataView(t.buffer);if(r===4){for(let a=0;a<r;a++)i.push(t[e+a]);n=i.join(".")}else if(r===16){for(let a=0;a<r;a+=2)i.push(s.getUint16(e+a).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};H2.exports={isIP:yL,isV4:Zd,isV6:j2,toBytes:G2,toString:gL}});var gu=b((lX,$2)=>{"use strict";function Wr(t){if(typeof t=="number"){if(Wr.codes[t])return Wr.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(Wr.names[t])return Wr.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var bi=-1;Wr.lengthPrefixedVarSize=bi;Wr.V=bi;Wr.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,bi,"ip6zone"],[53,bi,"dns","resolvable"],[54,bi,"dns4","resolvable"],[55,bi,"dns6","resolvable"],[56,bi,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,bi,"unix",!1,"path"],[421,bi,"ipfs"],[421,bi,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,bi,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,bi,"memory"]];Wr.names={};Wr.codes={};Wr.table.map(t=>{let e=W2.apply(null,t);return Wr.codes[e.code]=e,Wr.names[e.name]=e,null});Wr.object=W2;function W2(t,e,r,i,n){return{code:t,size:e,name:r,resolvable:Boolean(i),path:Boolean(n)}}$2.exports=Wr});var X2=b((fX,Q2)=>{Q2.exports=Jd;var Y2=128,mL=127,vL=~mL,bL=Math.pow(2,31);function Jd(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Jd.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var i=r;t>=bL;)e[r++]=t&255|Y2,t/=128;for(;t&vL;)e[r++]=t&255|Y2,t>>>=7;return e[r]=t|0,Jd.bytes=r-i+1,e}});var ew=b((hX,J2)=>{J2.exports=ep;var EL=128,Z2=127;function ep(t,e){var r=0,e=e||0,i=0,n=e,s,a=t.length;do{if(n>=a||i>49)throw ep.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Z2)<<i:(s&Z2)*Math.pow(2,i),i+=7}while(s>=EL);return ep.bytes=n-e,r}});var rw=b((dX,tw)=>{var wL=Math.pow(2,7),_L=Math.pow(2,14),SL=Math.pow(2,21),xL=Math.pow(2,28),CL=Math.pow(2,35),IL=Math.pow(2,42),AL=Math.pow(2,49),TL=Math.pow(2,56),RL=Math.pow(2,63);tw.exports=function(t){return t<wL?1:t<_L?2:t<SL?3:t<xL?4:t<CL?5:t<IL?6:t<AL?7:t<TL?8:t<RL?9:10}});var ca=b((pX,iw)=>{iw.exports={encode:X2(),decode:ew(),encodingLength:rw()}});var fw=b((yX,lw)=>{"use strict";var wf=z2(),nw=gu(),{CID:PL}=(ao(),qc),{base32:sw}=(Ys(),$s),{base58btc:BL}=(as(),ss),DL=(Ws(),Lc),xo=ca(),{toString:_f}=(yr(),Sr),{fromString:aw}=(ar(),pr),{concat:Sf}=(qn(),Mn);lw.exports=mu;function mu(t,e){return e instanceof Uint8Array?mu.toString(t,e):mu.toBytes(t,e)}mu.toString=function(e,r){switch(nw(e).code){case 4:case 41:return OL(r);case 6:case 273:case 33:case 132:return cw(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return kL(r);case 421:return ML(r);case 444:return uw(r);case 445:return uw(r);default:return _f(r,"base16")}};mu.toBytes=function(e,r){switch(nw(e).code){case 4:return ow(r);case 41:return ow(r);case 6:case 273:case 33:case 132:return tp(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return NL(r);case 421:return LL(r);case 444:return qL(r);case 445:return UL(r);default:return aw(r,"base16")}};function ow(t){if(!wf.isIP(t))throw new Error("invalid ip address");return wf.toBytes(t)}function OL(t){let e=wf.toString(t);if(!e||!wf.isIP(e))throw new Error("invalid ip address");return e}function tp(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function cw(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function NL(t){let e=aw(t),r=Uint8Array.from(xo.encode(e.length));return Sf([r,e],r.length+e.length)}function kL(t){let e=xo.decode(t);if(t=t.slice(xo.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return _f(t)}function LL(t){let e;t[0]==="Q"||t[0]==="1"?e=DL.decode(BL.decode(`z${t}`)).bytes:e=PL.parse(t).multihash.bytes;let r=Uint8Array.from(xo.encode(e.length));return Sf([r,e],r.length+e.length)}function ML(t){let e=xo.decode(t),r=t.slice(xo.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return _f(r,"base58btc")}function qL(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=sw.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=tp(i);return Sf([r,n],r.length+n.length)}function UL(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=sw.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=tp(i);return Sf([r,n],r.length+n.length)}function uw(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),i=_f(e,"base32"),n=cw(r);return i+":"+n}});var Sw=b((gX,_w)=>{"use strict";var hw=fw(),rp=gu(),vu=ca(),{concat:dw}=(qn(),Mn),{toString:FL}=(yr(),Sr);_w.exports={stringToStringTuples:pw,stringTuplesToString:yw,tuplesToStringTuples:mw,stringTuplesToTuples:gw,bytesToTuples:ip,tuplesToBytes:vw,bytesToString:KL,stringToBytes:Ew,fromString:VL,fromBytes:ww,validateBytes:np,isValidBytes:jL,cleanPath:xf,ParseError:sp,protoFromTuple:bu,sizeForAddr:bw};function pw(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let i=0;i<r.length;i++){let n=r[i],s=rp(n);if(s.size===0){e.push([n]);continue}if(i++,i>=r.length)throw sp("invalid address: "+t);if(s.path){e.push([n,xf(r.slice(i).join("/"))]);break}e.push([n,r[i]])}return e}function yw(t){let e=[];return t.map(r=>{let i=bu(r);return e.push(i.name),r.length>1&&e.push(r[1]),null}),xf(e.join("/"))}function gw(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=bu(e);return e.length>1?[r.code,hw.toBytes(r.code,e[1])]:[r.code]})}function mw(t){return t.map(e=>{let r=bu(e);return e[1]?[r.code,hw.toString(r.code,e[1])]:[r.code]})}function vw(t){return ww(dw(t.map(e=>{let r=bu(e),i=Uint8Array.from(vu.encode(r.code));return e.length>1&&(i=dw([i,e[1]])),i})))}function bw(t,e){return t.size>0?t.size/8:t.size===0?0:vu.decode(e)+vu.decode.bytes}function ip(t){let e=[],r=0;for(;r<t.length;){let i=vu.decode(t,r),n=vu.decode.bytes,s=rp(i),a=bw(s,t.slice(r+n));if(a===0){e.push([i]),r+=n;continue}let o=t.slice(r+n,r+n+a);if(r+=a+n,r>t.length)throw sp("Invalid address Uint8Array: "+FL(t,"base16"));e.push([i,o])}return e}function KL(t){let e=ip(t),r=mw(e);return yw(r)}function Ew(t){t=xf(t);let e=pw(t),r=gw(e);return vw(r)}function VL(t){return Ew(t)}function ww(t){let e=np(t);if(e)throw e;return Uint8Array.from(t)}function np(t){try{ip(t)}catch(e){return e}}function jL(t){return np(t)===void 0}function xf(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function sp(t){return new Error("Error parsing address: "+t)}function bu(t){return rp(t[0])}});var Pr=b((mX,Iw)=>{"use strict";var Vi=Sw(),Co=gu(),xw=ca(),{CID:GL}=(ao(),qc),{base58btc:HL}=(as(),ss),zL=Ae(),WL=Symbol.for("nodejs.util.inspect.custom"),{toString:Cf}=(yr(),Sr),{equals:$L}=(pi(),di),ap=new Map,Cw=Symbol.for("@multiformats/js-multiaddr/multiaddr"),qr=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,Cw,{value:!0}),e instanceof Uint8Array)this.bytes=Vi.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Vi.fromString(e)}else if(qr.isMultiaddr(e))this.bytes=Vi.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Vi.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Co(e)))}protoCodes(){let e=[],r=this.bytes,i=0;for(;i<r.length;){let n=xw.decode(r,i),s=xw.decode.bytes,a=Co(n);i+=Vi.sizeForAddr(a,r.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Vi.bytesToTuples(this.bytes)}stringTuples(){let e=Vi.bytesToTuples(this.bytes);return Vi.tuplesToStringTuples(e)}encapsulate(e){return e=new qr(e),new qr(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),i=this.toString(),n=i.lastIndexOf(r);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new qr(i.slice(0,n))}decapsulateCode(e){let r=this.tuples();for(let i=r.length-1;i>=0;i--)if(r[i][0]===e)return new qr(Vi.tuplesToBytes(r.slice(0,i)));return this}getPeerId(){try{let r=this.stringTuples().filter(i=>i[0]===Co.names.ipfs.code).pop();if(r&&r[1]){let i=r[1];return i[0]==="Q"||i[0]==="1"?Cf(HL.decode(`z${i}`),"base58btc"):Cf(GL.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!Co(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return $L(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let r=ap.get(e.name);if(!r)throw zL(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(n=>new qr(n))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new qr("/"+[i,e.address,r,e.port].join("/"))}static isName(e){return qr.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof qr||Boolean(e&&e[Cw])}[WL](){return"<Multiaddr "+Cf(this.bytes,"base16")+" - "+Vi.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+Cf(this.bytes,"base16")+" - "+Vi.bytesToString(this.bytes)+">"}};qr.protocols=Co;qr.resolvers=ap;function YL(t){return new qr(t)}Iw.exports={Multiaddr:qr,multiaddr:YL,protocols:Co,resolvers:ap}});var ua=b((vX,Aw)=>{"use strict";var QL=async t=>{let e=[];for await(let r of t)e.push(r);return e};Aw.exports=QL});var Tw,op,Rw=Ge(()=>{Tw=Oc(ua()),op=(t,e)=>async function*(){yield*(await(0,Tw.default)(t)).sort(e)}()});var Eu=b((EX,Pw)=>{"use strict";var XL=async t=>{for await(let e of t);};Pw.exports=XL});var la=b((wX,Bw)=>{"use strict";var ZL=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};Bw.exports=ZL});var cp=b((_X,Dw)=>{"use strict";var JL=async function*(t,e){let r=0;if(!(e<1)){for await(let i of t)if(yield i,r++,r===e)return}};Dw.exports=JL});var up,fa,lp,fp,Ow=Ge(()=>{Rw();up=Oc(Eu()),fa=Oc(la()),lp=Oc(cp()),fp=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,i){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:i,value:n}of e)await this.put(i,n,r),yield{key:i,value:n}}async*getMany(e,r={}){for await(let i of e)yield this.get(i,r)}async*deleteMany(e,r={}){for await(let i of e)await this.delete(i,r),yield i}batch(){let e=[],r=[];return{put(i,n){e.push({key:i,value:n})},delete(i){r.push(i)},commit:async i=>{await(0,up.default)(this.putMany(e,i)),e=[],await(0,up.default)(this.deleteMany(r,i)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let i=this._all(e,r);if(e.prefix!=null&&(i=(0,fa.default)(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,fa.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>op(n,s),i)),e.offset!=null){let n=0;i=(0,fa.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,lp.default)(i,e.limit)),i}queryKeys(e,r){let i=this._allKeys(e,r);if(e.prefix!=null&&(i=(0,fa.default)(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,fa.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>op(n,s),i)),e.offset!=null){let n=0;i=(0,fa.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,lp.default)(i,e.limit)),i}}});var Nw,kw=Ge(()=>{Nw="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var dp={};tr(dp,{customAlphabet:()=>eM,customRandom:()=>Mw,nanoid:()=>hp,random:()=>Lw,urlAlphabet:()=>Nw});var Lw,Mw,eM,hp,If=Ge(()=>{kw();Lw=t=>crypto.getRandomValues(new Uint8Array(t)),Mw=(t,e,r)=>{let i=(2<<Math.log(t.length-1)/Math.LN2)-1,n=-~(1.6*i*e/t.length);return(s=e)=>{let a="";for(;;){let o=r(n),c=n;for(;c--;)if(a+=t[o[c]&i]||"",a.length===s)return a}}},eM=(t,e=21)=>Mw(t,e,Lw),hp=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let i=r[t]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var pp={};tr(pp,{Key:()=>Cr});function tM(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function rM(t){let e=t.split(":");return e[e.length-1]}function iM(t){return[].concat(...t)}var Vn,qw,Af,Cr,Tf=Ge(()=>{If();yr();ar();Vn="/",qw=new TextEncoder().encode(Vn),Af=qw[0],Cr=class{constructor(e,r){if(typeof e=="string")this._buf=Ed(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Af)throw new Error("Invalid key")}toString(e="utf8"){return _d(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Cr(e.join(Vn))}static random(){return new Cr(hp().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Cr(e):e.uint8Array?new Cr(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=qw),this._buf[0]!==Af){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Af,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Af;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),i=e.list();for(let n=0;n<r.length;n++){if(i.length<n+1)return!1;let s=r[n],a=i[n];if(s<a)return!0;if(s>a)return!1}return r.length<i.length}reverse(){return Cr.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Vn).slice(1)}type(){return tM(this.baseNamespace())}name(){return rM(this.baseNamespace())}instance(e){return new Cr(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Vn)||(e+=Vn),e+=this.type(),new Cr(e)}parent(){let e=this.list();return e.length===1?new Cr(Vn):new Cr(e.slice(0,-1).join(Vn))}child(e){return this.toString()===Vn?e:e.toString()===Vn?this:new Cr(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Cr.withNamespaces([...this.namespaces(),...iM(e.map(r=>r.namespaces()))])}}});function Fw(t){return t=t||new Error("Not Found"),(0,Uw.default)(t,"ERR_NOT_FOUND")}var Uw,Kw=Ge(()=>{Uw=Oc(Ae())});var jw={};tr(jw,{MemoryDatastore:()=>Vw});var Vw,Gw=Ge(()=>{Ow();Tf();Kw();Vw=class extends fp{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw Fw();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new Cr(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Cr(e))}}});var yt=b(yp=>{"use strict";yp.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};yp.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_PEER_DIAL_INTERCEPTED:"ERR_PEER_DIAL_INTERCEPTED",ERR_CONNECTION_INTERCEPTED:"ERR_CONNECTION_INTERCEPTED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var gp=b((kX,Hw)=>{"use strict";var nM=async function*(t,e){for await(let r of t)yield e(r)};Hw.exports=nM});var mp=b((LX,zw)=>{"use strict";var sM=Ae(),aM=la(),oM=gp(),cM=cp();async function*uM(t,e){yield*oM(t,async r=>(await e.addressBook.add(r.id,r.multiaddrs),r))}function lM(t){let e=new Set;return aM(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*fM(t,e=1){let r=0;for await(let i of t)r++,yield i;if(r<e)throw sM(new Error("not found"),"NOT_FOUND")}function hM(t,e){return e?cM(t,e):t}zw.exports={storeAddresses:uM,uniquePeers:lM,requirePeers:fM,maybeLimitSource:hM}});var $w=b((MX,Ww)=>{"use strict";Ww.exports=function(){return Date.now()}});var wu=b((qX,Qw)=>{"use strict";var Rf=$w(),Yw=class{constructor(e,r,i){let n=this;this._started=Rf(),this._rescheduled=0,this._scheduled=r,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(Rf()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=Rf();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=Rf(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function dM(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new Yw(arguments[0],arguments[1],t)}Qw.exports=dM});var vp=b((UX,Zw)=>{"use strict";var{AbortController:pM}=globalThis,Xw=wu(),Pf=class extends pM{constructor(e){super();this._ms=e,this._timer=Xw(()=>this.abort(),e),Object.setPrototypeOf(this,Pf.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=Xw(()=>this.abort(),this._ms)}};Zw.exports={TimeoutController:Pf}});var e_=b((KX,Jw)=>{Jw.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var bp=b((jX,r_)=>{var t_=e_();r_.exports=class{constructor(e){this.hwm=e||16,this.head=new t_(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new t_(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var Bf=b((GX,i_)=>{var Ep=bp();i_.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new Ep,i,n,s,a=()=>{if(!r.isEmpty()){if(t.writev){let y,g=[];for(;!r.isEmpty();){if(y=r.shift(),y.error)throw y.error;g.push(y.value)}return{done:y.done,value:g}}let d=r.shift();if(d.error)throw d.error;return d}return s?{done:!0}:new Promise((d,y)=>{n=g=>(n=null,g.error?y(g.error):t.writev&&!g.done?d({done:g.done,value:[g.value]}):d(g),i)})},o=d=>n?n(d):(r.push(d),i),c=d=>(r=new Ep,n?n({error:d}):(r.push({error:d}),i)),u=d=>s?i:o({done:!1,value:d}),l=d=>s?i:(s=!0,d?c(d):o({done:!0})),f=()=>(r=new Ep,l(),{done:!0}),h=d=>(l(d),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:f,throw:h,push:u,end:l},!e)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(d){return p.throw(d),e&&(e(d),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(d){return p.end(d),e&&(e(d),e=null),i}},i}});var wp=b((HX,n_)=>{"use strict";var yM=Bf(),gM=async function*(...t){let e=yM();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let i of r)e.push(i)})),e.end()}catch(r){e.end(r)}},0),yield*e};n_.exports=gM});var _p=b((zX,s_)=>{"use strict";var mM=async t=>{for await(let e of t)return e};s_.exports=mM});var Sp=b((WX,a_)=>{"use strict";var Io=new Map,vM=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function bM(t,e,r){for(;Io.get(r);){try{await t()}catch(i){setTimeout(()=>{throw i},1);break}if(!Io.get(r))break;await new Promise(i=>{let n=setTimeout(i,e);Io.set(r,n)})}}function EM(t,e,r){r=r||e;let i=vM(),n=setTimeout(()=>{bM(t,e,i)},r);return Io.set(i,n),i}function wM(t){let e=Io.get(t);e&&(clearTimeout(e),Io.delete(t))}a_.exports={setDelayedInterval:EM,clearDelayedInterval:wM}});var u_=b(($X,c_)=>{"use strict";var _M=Ae(),{messages:SM,codes:xM}=yt(),o_=class{constructor(e){this._dht=e}async findPeer(e,r={}){for await(let i of this._dht.findPeer(e,r))if(i.name==="FINAL_PEER")return i.peer;throw _M(new Error(SM.NOT_FOUND),xM.ERR_NOT_FOUND)}async*getClosestPeers(e,r={}){for await(let i of this._dht.getClosestPeers(e,r))i.name==="PEER_RESPONSE"&&(yield*i.closer)}};c_.exports={DHTPeerRouting:o_}});var v_=b((YX,m_)=>{"use strict";var l_=qe(),f_=Object.assign(l_("libp2p:peer-routing"),{error:l_("libp2p:peer-routing:err")}),Df=Ae(),_u=yt(),{storeAddresses:h_,uniquePeers:CM,requirePeers:IM}=mp(),{TimeoutController:AM}=vp(),d_=wp(),{pipe:p_}=kr(),TM=_p(),RM=Eu(),PM=la(),{setDelayedInterval:BM,clearDelayedInterval:DM}=Sp(),{DHTPeerRouting:OM}=u_(),{setMaxListeners:y_}=_r(),g_=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new OM(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=BM(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await RM(this.getClosestPeers(this._peerId.id,{timeout:this._refreshManagerOptions.timeout||1e4}))}catch(e){f_.error(e)}}stop(){DM(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw Df(new Error("No peer routers available"),_u.codes.ERR_NO_ROUTERS_AVAILABLE);if(e.toB58String()===this._peerId.toB58String())throw Df(new Error("Should not try to find self"),_u.codes.ERR_FIND_SELF);let i=await p_(d_(...this._routers.map(n=>async function*(){try{yield await n.findPeer(e,r)}catch(s){f_.error(s)}}())),n=>PM(n,Boolean),n=>h_(n,this._peerStore),n=>TM(n));if(i)return i;throw Df(new Error(_u.messages.NOT_FOUND),_u.codes.ERR_NOT_FOUND)}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw Df(new Error("No peer routers available"),_u.codes.ERR_NO_ROUTERS_AVAILABLE);if(r.timeout){let i=new AM(r.timeout);try{y_&&y_(1/0,i.signal)}catch{}r.signal=i.signal}yield*p_(d_(...this._routers.map(i=>i.getClosestPeers(e,r))),i=>h_(i,this._peerStore),i=>CM(i),i=>IM(i))}};m_.exports=g_});var w_=b((QX,E_)=>{"use strict";var NM=Eu(),b_=class{constructor(e){this._dht=e}async provide(e){await NM(this._dht.provide(e))}async*findProviders(e,r){for await(let i of this._dht.findProviders(e,r))i.name==="PROVIDER"&&(yield*i.providers)}};E_.exports={DHTContentRouting:b_}});var x_=b((XX,S_)=>{"use strict";var ha=Ae(),{messages:Su,codes:da}=yt(),{storeAddresses:kM,uniquePeers:LM,requirePeers:MM,maybeLimitSource:qM}=mp(),UM=Eu(),FM=wp(),{pipe:KM}=kr(),{DHTContentRouting:VM}=w_(),__=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new VM(this.dht))}async*findProviders(e,r={}){if(!this.routers.length)throw ha(new Error("No content this.routers available"),da.ERR_NO_ROUTERS_AVAILABLE);yield*KM(FM(...this.routers.map(i=>i.findProviders(e,r))),i=>kM(i,this.libp2p.peerStore),i=>LM(i),i=>qM(i,r.maxNumProviders),i=>MM(i))}async provide(e){if(!this.routers.length)throw ha(new Error("No content routers available"),da.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(r=>r.provide(e)))}async put(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw ha(new Error(Su.NOT_STARTED_YET),da.DHT_NOT_STARTED);await UM(this.dht.put(e,r,i))}async get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw ha(new Error(Su.NOT_STARTED_YET),da.DHT_NOT_STARTED);for await(let i of this.dht.get(e,r))if(i.name==="VALUE")return{from:i.peerId,val:i.value};throw ha(new Error(Su.NOT_FOUND),da.ERR_NOT_FOUND)}async*getMany(e,r,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw ha(new Error(Su.NOT_STARTED_YET),da.DHT_NOT_STARTED);if(!r)return;let n=0;for await(let s of this.dht.get(e,i))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},n++,n===r))break;if(n===0)throw ha(new Error(Su.NOT_FOUND),da.ERR_NOT_FOUND)}};S_.exports=__});var xp=b((ZX,T_)=>{"use strict";var jM=rr(),{Multiaddr:C_}=Pr(),I_=Ae(),{codes:A_}=yt();function GM(t){typeof t=="string"&&(t=new C_(t));let e;if(C_.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw I_(new Error(`${t} does not have a valid peer type`),A_.ERR_INVALID_MULTIADDR);try{t=jM.createFromB58String(r)}catch(i){throw I_(new Error(`${t} is not a valid peer type`),A_.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}T_.exports=GM});var P_=b((JX,R_)=>{"use strict";R_.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Ro=b((N_,k_)=>{"use strict";var Of=P_(),{hasOwnProperty:B_}=Object.prototype,{propertyIsEnumerable:HM}=Object,Ao=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),zM=N_,D_={concatArrays:!1,ignoreUndefined:!1},Nf=t=>{let e=[];for(let r in t)B_.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let i of r)HM.call(t,i)&&e.push(i)}return e};function To(t){return Array.isArray(t)?WM(t):Of(t)?$M(t):t}function WM(t){let e=t.slice(0,0);return Nf(t).forEach(r=>{Ao(e,r,To(t[r]))}),e}function $M(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Nf(t).forEach(r=>{Ao(e,r,To(t[r]))}),e}var O_=(t,e,r,i)=>(r.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?Ao(t,n,Cp(t[n],e[n],i)):Ao(t,n,To(e[n])))}),t),YM=(t,e,r)=>{let i=t.slice(0,0),n=0;return[t,e].forEach(s=>{let a=[];for(let o=0;o<s.length;o++)!B_.call(s,o)||(a.push(String(o)),s===t?Ao(i,n++,s[o]):Ao(i,n++,To(s[o])));i=O_(i,s,Nf(s).filter(o=>!a.includes(o)),r)}),i};function Cp(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?YM(t,e,r):!Of(e)||!Of(t)?To(e):O_(t,e,Nf(e),r)}k_.exports=function(...t){let e=Cp(To(D_),this!==zM&&this||{},D_),r={_:{}};for(let i of t)if(i!==void 0){if(!Of(i))throw new TypeError("`"+i+"` is not an Option Object");r=Cp(r,{_:i},e)}return r._}});var M_=b((eZ,L_)=>{var Po=1e3,Bo=Po*60,Do=Bo*60,pa=Do*24,QM=pa*7,XM=pa*365.25;L_.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return ZM(t);if(r==="number"&&isFinite(t))return e.long?eq(t):JM(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function ZM(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*XM;case"weeks":case"week":case"w":return r*QM;case"days":case"day":case"d":return r*pa;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Do;case"minutes":case"minute":case"mins":case"min":case"m":return r*Bo;case"seconds":case"second":case"secs":case"sec":case"s":return r*Po;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function JM(t){var e=Math.abs(t);return e>=pa?Math.round(t/pa)+"d":e>=Do?Math.round(t/Do)+"h":e>=Bo?Math.round(t/Bo)+"m":e>=Po?Math.round(t/Po)+"s":t+"ms"}function eq(t){var e=Math.abs(t);return e>=pa?kf(t,e,pa,"day"):e>=Do?kf(t,e,Do,"hour"):e>=Bo?kf(t,e,Bo,"minute"):e>=Po?kf(t,e,Po,"second"):t+" ms"}function kf(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var F_=b((tZ,U_)=>{"use strict";U_.exports=q_;var tq=M_(),Ss=q_.prototype,rq=new Date%1e9;function iq(){return(Math.random()*1e9>>>0)+rq++}function q_(t){t=t||{},this.id=t.id||iq(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,i=this.items.length;i--;)e=this.items[i],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Ss.has=function(t){return t in this._lookup};Ss.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Ss.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};Ss.set=function(t,e,r){var i=this._lookup[t],n=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(n.meta=r.meta),r.refresh&&(n.refresh=r.ttl)),this};Ss.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};Ss.expire=function(t,e){var r=e||0,i=this._lookup[t];if(!i)return this;if(typeof r=="string"&&(r=tq(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),r),i.expires=Number(new Date)+r,this};Ss.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};Ss.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var xu=b((Oo,K_)=>{"use strict";var nq=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof jn!="undefined")return jn;throw new Error("unable to locate global object")},jn=nq();K_.exports=Oo=jn.fetch;jn.fetch&&(Oo.default=jn.fetch.bind(jn));Oo.Headers=jn.Headers;Oo.Request=jn.Request;Oo.Response=jn.Response});var V_=b((rZ,Ip)=>{"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?Ip.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:Ip.exports={default:xu().default,Headers:xu().Headers,Request:xu().Request,Response:xu().Response}});var G_=b((iZ,j_)=>{"use strict";var{default:sq,Headers:aq}=V_();function oq({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function cq(t){return sq(t,{headers:new aq({accept:"application/dns-json"})})}function uq(t,e){return`${e}_${t}`}j_.exports={buildResource:oq,fetch:cq,getCacheKey:uq}});var W_=b((nZ,z_)=>{"use strict";var H_=qe(),Lf=H_("dns-over-http-resolver");Lf.error=H_("dns-over-http-resolver:error");var lq=F_(),Ei=G_(),Mf=class{constructor({maxCache:e=100}={}){this._cache=new lq({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let i=Math.floor(Math.random()*r),n=e[r];e[r]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",i=this._cache.get(Ei.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let a=await(await Ei.fetch(Ei.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),o=a.Answer.map(u=>u.data),c=Math.min(a.Answer.map(u=>u.TTL));return this._cache.set(Ei.getCacheKey(e,r),o,{ttl:c}),o}catch(s){Lf.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",i=this._cache.get(Ei.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let a=await(await Ei.fetch(Ei.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),o=a.Answer.map(u=>u.data),c=Math.min(a.Answer.map(u=>u.TTL));return this._cache.set(Ei.getCacheKey(e,r),o,{ttl:c}),o}catch(s){Lf.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",i=this._cache.get(Ei.getCacheKey(e,r));if(i)return i;for(let n of this._getShuffledServers())try{let a=await(await Ei.fetch(Ei.buildResource({serverResolver:n,hostname:e,recordType:r}))).json(),o=a.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(a.Answer.map(u=>u.TTL));return this._cache.set(Ei.getCacheKey(e,r),o,{ttl:c}),o}catch(s){Lf.error(`${n} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};Mf.Resolver=Mf;z_.exports=Mf});var Y_=b((sZ,$_)=>{"use strict";var fq=W_();$_.exports=fq});var X_=b((aZ,Q_)=>{"use strict";var hq=gu(),{code:dq}=hq("dnsaddr");async function pq(t){let e=Y_(),r=new e,i=t.getPeerId(),[,n]=t.stringTuples().find(([o])=>o===dq)||[],a=(await r.resolveTxt(`_dnsaddr.${n}`)).flat().map(o=>o.split("=")[1]);return i&&(a=a.filter(o=>o.includes(i))),a}Q_.exports={dnsaddrResolver:pq}});var qf=b((oZ,Z_)=>{"use strict";Z_.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var Ap=b((cZ,yq)=>{yq.exports={name:"libp2p",version:"0.36.1",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:fetch && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:fetch":"pbjs -t static-module -w commonjs -r libp2p-fetch --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/fetch/proto.js ./src/fetch/proto.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:peer":"pbjs -t static-module -w commonjs -r libp2p-peer --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/pb/peer.js ./src/peer-store/pb/peer.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:fetch && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:fetch":"pbts -o src/fetch/proto.d.ts src/fetch/proto.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:peer":"pbts -o src/peer-store/pb/peer.d.ts src/peer-store/pb/peer.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"npm run build",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@vascosantos/moving-average":"^1.1.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^3.0.0","bignumber.js":"^9.0.1","class-is":"^1.1.0","datastore-core":"^7.0.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-foreach":"^0.1.1","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-sort":"^1.0.1","it-take":"^1.0.0","libp2p-crypto":"^0.21.2","libp2p-interfaces":"^4.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.1",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^3.0.0","mutable-proxy":"^1.0.0","nat-api":"^0.3.1","node-forge":"^1.2.1","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^3.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^5.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^1.0.0","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.1","libp2p-interfaces-compliance-tests":"^4.0.8","libp2p-interop":"^0.7.1","libp2p-kad-dht":"^0.28.6","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.4","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Robert Kiel <robert.kiel@hoprnet.org>","Richard Littauer <richard.littauer@gmail.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Franck Royer <franck@royer.one>","Thomas Eizinger <thomas@eizinger.io>","V\xEDt Habada <vithabada93@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Elven <mon.samuel@qq.com>","Samlior <samlior@foxmail.com>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Tim Daubensch\xFCtz <tim@daubenschuetz.de>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","tuyennhv <vutuyen2636@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Marston Connell <34043723+TheMarstonConnell@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>"]}});var Tp=b((uZ,mn)=>{"use strict";var gq=Ap().version;mn.exports.PROTOCOL_VERSION="ipfs/0.1.0";mn.exports.AGENT_VERSION=`js-libp2p/${gq}`;mn.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";mn.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";mn.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";mn.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";mn.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";mn.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";mn.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var Uf=b((lZ,eS)=>{"use strict";var J_=60*1e3;eS.exports={ADVERTISE_BOOT_DELAY:15*J_,ADVERTISE_TTL:30*J_,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var tS=b(Cu=>{(function(){var t,e,r,i,n,s,a,o;o=function(c){var u,l,f,h;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,f=(c&255<<8)>>>8,h=c&255,[u,l,f,h].join(".")},a=function(c){var u,l,f,h,p,d;for(u=[],f=h=0;h<=3&&c.length!==0;f=++h){if(f>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}d=e(c),p=d[0],l=d[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},i=r("0"),s=r("a"),n=r("A"),e=function(c){var u,l,f,h,p;for(h=0,u=10,l="9",f=0,c.length>1&&c[f]==="0"&&(c[f+1]==="x"||c[f+1]==="X"?(f+=2,u=16):"0"<=c[f+1]&&c[f+1]<="9"&&(f++,u=8,l="7")),p=f;f<c.length;){if("0"<=c[f]&&c[f]<=l)h=h*u+(r(c[f])-i)>>>0;else if(u===16)if("a"<=c[f]&&c[f]<="f")h=h*u+(10+r(c[f])-s)>>>0;else if("A"<=c[f]&&c[f]<="F")h=h*u+(10+r(c[f])-n)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");f++}if(f===p)throw new Error("empty octet");return[h,f]},t=function(){function c(u,l){var f,h,p,d;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(d=u.split("/",2),u=d[0],l=d[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=a(l)}catch(y){throw f=y,new Error("Invalid mask: "+l)}for(h=p=32;p>=0;h=--p)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(a(u)&this.maskLong)>>>0}catch(y){throw f=y,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=o(this.netLong),this.mask=o(this.maskLong),this.hostmask=o(~this.maskLong),this.first=this.bitmask<=30?o(this.netLong+1):this.base,this.last=this.bitmask<=30?o(this.netLong+this.size-2):o(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?o(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(a(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(o(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,f,h;for(h=a(this.first),f=a(this.last),l=0;h<=f;)u(o(h),h,l),l++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),Cu.ip2long=a,Cu.long2ip=o,Cu.Netmask=t}).call(Cu)});var iS=b((rS,Ff)=>{(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},i=new RegExp("^0[0-7]+$","i"),n=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",o={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(p,d){if(p.indexOf("::")!==p.lastIndexOf("::"))return null;let y=0,g=-1,m=(p.match(o.zoneIndex)||[])[0],w,C;for(m&&(m=m.substring(1),p=p.replace(/%.+$/,""));(g=p.indexOf(":",g+1))>=0;)y++;if(p.substr(0,2)==="::"&&y--,p.substr(-2,2)==="::"&&y--,y>d)return null;for(C=d-y,w=":";C--;)w+="0:";return p=p.replace("::",w),p[0]===":"&&(p=p.slice(1)),p[p.length-1]===":"&&(p=p.slice(0,-1)),d=function(){let V=p.split(":"),T=[];for(let A=0;A<V.length;A++)T.push(parseInt(V[A],16));return T}(),{parts:d,zoneId:m}}function u(p,d,y,g){if(p.length!==d.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let m=0,w;for(;g>0;){if(w=y-g,w<0&&(w=0),p[m]>>w!=d[m]>>w)return!1;g-=y,m+=1}return!0}function l(p){if(n.test(p))return parseInt(p,16);if(p[0]==="0"&&!isNaN(parseInt(p[1],10))){if(i.test(p))return parseInt(p,8);throw new Error(`ipaddr: cannot parse ${p} as octal`)}return parseInt(p,10)}function f(p,d){for(;p.length<d;)p=`0${p}`;return p}let h={};h.IPv4=function(){function p(d){if(d.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let y,g;for(y=0;y<d.length;y++)if(g=d[y],!(0<=g&&g<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=d}return p.prototype.SpecialRanges={unspecified:[[new p([0,0,0,0]),8]],broadcast:[[new p([255,255,255,255]),32]],multicast:[[new p([224,0,0,0]),4]],linkLocal:[[new p([169,254,0,0]),16]],loopback:[[new p([127,0,0,0]),8]],carrierGradeNat:[[new p([100,64,0,0]),10]],private:[[new p([10,0,0,0]),8],[new p([172,16,0,0]),12],[new p([192,168,0,0]),16]],reserved:[[new p([192,0,0,0]),24],[new p([192,0,2,0]),24],[new p([192,88,99,0]),24],[new p([198,51,100,0]),24],[new p([203,0,113,0]),24],[new p([240,0,0,0]),4]]},p.prototype.kind=function(){return"ipv4"},p.prototype.match=function(d,y){let g;if(y===void 0&&(g=d,d=g[0],y=g[1]),d.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,d.octets,8,y)},p.prototype.prefixLengthFromSubnetMask=function(){let d=0,y=!1,g={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},m,w,C;for(m=3;m>=0;m-=1)if(w=this.octets[m],w in g){if(C=g[w],y&&C!==0)return null;C!==8&&(y=!0),d+=C}else return null;return 32-d},p.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){return this.octets.slice(0)},p.prototype.toIPv4MappedAddress=function(){return h.IPv6.parse(`::ffff:${this.toString()}`)},p.prototype.toNormalizedString=function(){return this.toString()},p.prototype.toString=function(){return this.octets.join(".")},p}(),h.IPv4.broadcastAddressFromCIDR=function(p){try{let d=this.parseCIDR(p),y=d[0].toByteArray(),g=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),m=[],w=0;for(;w<4;)m.push(parseInt(y[w],10)|parseInt(g[w],10)^255),w++;return new this(m)}catch(d){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.isIPv4=function(p){return this.parser(p)!==null},h.IPv4.isValid=function(p){try{return new this(this.parser(p)),!0}catch(d){return!1}},h.IPv4.isValidFourPartDecimal=function(p){return!!(h.IPv4.isValid(p)&&p.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},h.IPv4.networkAddressFromCIDR=function(p){let d,y,g,m,w;try{for(d=this.parseCIDR(p),g=d[0].toByteArray(),w=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),m=[],y=0;y<4;)m.push(parseInt(g[y],10)&parseInt(w[y],10)),y++;return new this(m)}catch(C){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.parse=function(p){let d=this.parser(p);if(d===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(d)},h.IPv4.parseCIDR=function(p){let d;if(d=p.match(/^(.+)\/(\d+)$/)){let y=parseInt(d[2]);if(y>=0&&y<=32){let g=[this.parse(d[1]),y];return Object.defineProperty(g,"toString",{value:function(){return this.join("/")}}),g}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},h.IPv4.parser=function(p){let d,y,g;if(d=p.match(r.fourOctet))return function(){let m=d.slice(1,6),w=[];for(let C=0;C<m.length;C++)y=m[C],w.push(l(y));return w}();if(d=p.match(r.longValue)){if(g=l(d[1]),g>4294967295||g<0)throw new Error("ipaddr: address outside defined range");return function(){let m=[],w;for(w=0;w<=24;w+=8)m.push(g>>w&255);return m}().reverse()}else return(d=p.match(r.twoOctet))?function(){let m=d.slice(1,4),w=[];if(g=l(m[1]),g>16777215||g<0)throw new Error("ipaddr: address outside defined range");return w.push(l(m[0])),w.push(g>>16&255),w.push(g>>8&255),w.push(g&255),w}():(d=p.match(r.threeOctet))?function(){let m=d.slice(1,5),w=[];if(g=l(m[2]),g>65535||g<0)throw new Error("ipaddr: address outside defined range");return w.push(l(m[0])),w.push(l(m[1])),w.push(g>>8&255),w.push(g&255),w}():null},h.IPv4.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>32)throw new Error("ipaddr: invalid IPv4 prefix length");let d=[0,0,0,0],y=0,g=Math.floor(p/8);for(;y<g;)d[y]=255,y++;return g<4&&(d[g]=Math.pow(2,p%8)-1<<8-p%8),new this(d)},h.IPv6=function(){function p(d,y){let g,m;if(d.length===16)for(this.parts=[],g=0;g<=14;g+=2)this.parts.push(d[g]<<8|d[g+1]);else if(d.length===8)this.parts=d;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(g=0;g<this.parts.length;g++)if(m=this.parts[g],!(0<=m&&m<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");y&&(this.zoneId=y)}return p.prototype.SpecialRanges={unspecified:[new p([0,0,0,0,0,0,0,0]),128],linkLocal:[new p([65152,0,0,0,0,0,0,0]),10],multicast:[new p([65280,0,0,0,0,0,0,0]),8],loopback:[new p([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new p([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new p([0,0,0,0,0,65535,0,0]),96],rfc6145:[new p([0,0,0,0,65535,0,0,0]),96],rfc6052:[new p([100,65435,0,0,0,0,0,0]),96],"6to4":[new p([8194,0,0,0,0,0,0,0]),16],teredo:[new p([8193,0,0,0,0,0,0,0]),32],reserved:[[new p([8193,3512,0,0,0,0,0,0]),32]]},p.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},p.prototype.kind=function(){return"ipv6"},p.prototype.match=function(d,y){let g;if(y===void 0&&(g=d,d=g[0],y=g[1]),d.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,d.parts,16,y)},p.prototype.prefixLengthFromSubnetMask=function(){let d=0,y=!1,g={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},m,w;for(let C=7;C>=0;C-=1)if(m=this.parts[C],m in g){if(w=g[m],y&&w!==0)return null;w!==16&&(y=!0),d+=w}else return null;return 128-d},p.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){let d,y=[],g=this.parts;for(let m=0;m<g.length;m++)d=g[m],y.push(d>>8),y.push(d&255);return y},p.prototype.toFixedLengthString=function(){let d=function(){let g=[];for(let m=0;m<this.parts.length;m++)g.push(f(this.parts[m].toString(16),4));return g}.call(this).join(":"),y="";return this.zoneId&&(y=`%${this.zoneId}`),d+y},p.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let d=this.parts.slice(-2),y=d[0],g=d[1];return new h.IPv4([y>>8,y&255,g>>8,g&255])},p.prototype.toNormalizedString=function(){let d=function(){let g=[];for(let m=0;m<this.parts.length;m++)g.push(this.parts[m].toString(16));return g}.call(this).join(":"),y="";return this.zoneId&&(y=`%${this.zoneId}`),d+y},p.prototype.toRFC5952String=function(){let d=/((^|:)(0(:|$)){2,})/g,y=this.toNormalizedString(),g=0,m=-1,w;for(;w=d.exec(y);)w[0].length>m&&(g=w.index,m=w[0].length);return m<0?y:`${y.substring(0,g)}::${y.substring(g+m)}`},p.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},p}(),h.IPv6.broadcastAddressFromCIDR=function(p){try{let d=this.parseCIDR(p),y=d[0].toByteArray(),g=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),m=[],w=0;for(;w<16;)m.push(parseInt(y[w],10)|parseInt(g[w],10)^255),w++;return new this(m)}catch(d){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${d})`)}},h.IPv6.isIPv6=function(p){return this.parser(p)!==null},h.IPv6.isValid=function(p){if(typeof p=="string"&&p.indexOf(":")===-1)return!1;try{let d=this.parser(p);return new this(d.parts,d.zoneId),!0}catch(d){return!1}},h.IPv6.networkAddressFromCIDR=function(p){let d,y,g,m,w;try{for(d=this.parseCIDR(p),g=d[0].toByteArray(),w=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),m=[],y=0;y<16;)m.push(parseInt(g[y],10)&parseInt(w[y],10)),y++;return new this(m)}catch(C){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${C})`)}},h.IPv6.parse=function(p){let d=this.parser(p);if(d.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(d.parts,d.zoneId)},h.IPv6.parseCIDR=function(p){let d,y,g;if((y=p.match(/^(.+)\/(\d+)$/))&&(d=parseInt(y[2]),d>=0&&d<=128))return g=[this.parse(y[1]),d],Object.defineProperty(g,"toString",{value:function(){return this.join("/")}}),g;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},h.IPv6.parser=function(p){let d,y,g,m,w,C;if(g=p.match(o.deprecatedTransitional))return this.parser(`::ffff:${g[1]}`);if(o.native.test(p))return c(p,8);if((g=p.match(o.transitional))&&(C=g[6]||"",d=c(g[1].slice(0,-1)+C,6),d.parts)){for(w=[parseInt(g[2]),parseInt(g[3]),parseInt(g[4]),parseInt(g[5])],y=0;y<w.length;y++)if(m=w[y],!(0<=m&&m<=255))return null;return d.parts.push(w[0]<<8|w[1]),d.parts.push(w[2]<<8|w[3]),{parts:d.parts,zoneId:d.zoneId}}return null},h.IPv6.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>128)throw new Error("ipaddr: invalid IPv6 prefix length");let d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],y=0,g=Math.floor(p/8);for(;y<g;)d[y]=255,y++;return g<16&&(d[g]=Math.pow(2,p%8)-1<<8-p%8),new this(d)},h.fromByteArray=function(p){let d=p.length;if(d===4)return new h.IPv4(p);if(d===16)return new h.IPv6(p);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},h.isValid=function(p){return h.IPv6.isValid(p)||h.IPv4.isValid(p)},h.parse=function(p){if(h.IPv6.isValid(p))return h.IPv6.parse(p);if(h.IPv4.isValid(p))return h.IPv4.parse(p);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},h.parseCIDR=function(p){try{return h.IPv6.parseCIDR(p)}catch(d){try{return h.IPv4.parseCIDR(p)}catch(y){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},h.process=function(p){let d=this.parse(p);return d.kind()==="ipv6"&&d.isIPv4MappedAddress()?d.toIPv4Address():d},h.subnetMatch=function(p,d,y){let g,m,w,C;y==null&&(y="unicast");for(m in d)if(Object.prototype.hasOwnProperty.call(d,m)){for(w=d[m],w[0]&&!(w[0]instanceof Array)&&(w=[w]),g=0;g<w.length;g++)if(C=w[g],p.kind()===C[0].kind()&&p.match.apply(p,C))return m}return y},typeof Ff!="undefined"&&Ff.exports?Ff.exports=h:t.ipaddr=h})(rS)});var oS=b(Iu=>{"use strict";var nS=Iu&&Iu.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Iu,"__esModule",{value:!0});var mq=tS(),vq=nS($d()),bq=nS(Qd()),sS=iS(),Eq=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],wq=Eq.map(t=>new mq.Netmask(t));function _q(t){for(let e of wq)if(e.contains(t))return!0;return!1}function aS(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}Iu.default=t=>{if(sS.isValid(t)){let e=sS.parse(t);if(e.kind()==="ipv4")return _q(e.toNormalizedString());if(e.kind()==="ipv6")return aS(t)}else if(bq.default(t)&&vq.default.v6().test(t))return aS(t)}});var Rp=b((dZ,cS)=>{"use strict";cS.exports=oS().default});var lS=b((pZ,uS)=>{"use strict";var Sq=Rp();function xq(t){let{address:e}=t.nodeAddress();return Sq(e)}uS.exports=xq});var Pp=b((yZ,hS)=>{"use strict";var fS=lS();function Cq(t,e){let r=fS(t.multiaddr),i=fS(e.multiaddr);return r&&!i?1:!r&&i||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function Iq(t){return[...t].sort(Cq)}hS.exports.publicAddressesFirst=Iq});var pS=b((gZ,Bp)=>{"use strict";var dS=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};Bp.exports=dS;Bp.exports.default=dS});var gS=b((mZ,Dp)=>{"use strict";var yS=(t,...e)=>new Promise(r=>{r(t(...e))});Dp.exports=yS;Dp.exports.default=yS});var vS=b((vZ,Op)=>{"use strict";var Aq=gS(),mS=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,i=()=>{r--,e.length>0&&e.shift()()},n=(o,c,...u)=>{r++;let l=Aq(o,...u);c(l),l.then(i,i)},s=(o,c,...u)=>{r<t?n(o,c,...u):e.push(n.bind(null,o,c,...u))},a=(o,...c)=>new Promise(u=>s(o,u,...c));return Object.defineProperties(a,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),a};Op.exports=mS;Op.exports.default=mS});var ES=b((bZ,bS)=>{"use strict";var Np=pS(),Tq=vS();bS.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,i=Tq(r);return Promise.all(t.map(n=>n&&typeof n.then=="function"?Np(n):Np(typeof n=="function"?i(()=>n()):Promise.resolve(n))))}});var SS=b((EZ,_S)=>{"use strict";var No=tn(),wS=No.Reader,Rq=No.Writer,Dt=No.util,Au=No.roots["libp2p-envelope"]||(No.roots["libp2p-envelope"]={});Au.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.publicKey=Dt.newBuffer([]),t.prototype.payloadType=Dt.newBuffer([]),t.prototype.payload=Dt.newBuffer([]),t.prototype.signature=Dt.newBuffer([]),t.encode=function(r,i){return i||(i=Rq.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&i.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&i.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&i.uint32(42).bytes(r.signature),i},t.decode=function(r,i){r instanceof wS||(r=wS.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Au.Envelope;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Au.Envelope)return r;var i=new Au.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?Dt.base64.decode(r.publicKey,i.publicKey=Dt.newBuffer(Dt.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?Dt.base64.decode(r.payloadType,i.payloadType=Dt.newBuffer(Dt.base64.length(r.payloadType)),0):r.payloadType.length&&(i.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?Dt.base64.decode(r.payload,i.payload=Dt.newBuffer(Dt.base64.length(r.payload)),0):r.payload.length&&(i.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?Dt.base64.decode(r.signature,i.signature=Dt.newBuffer(Dt.base64.length(r.signature)),0):r.signature.length&&(i.signature=r.signature)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Dt.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Dt.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Dt.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Dt.newBuffer(n.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Dt.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Dt.base64.encode(r.payloadType,0,r.payloadType.length):i.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Dt.base64.encode(r.payload,0,r.payload.length):i.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Dt.base64.encode(r.signature,0,r.signature.length):i.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,No.util.toJSONOptions)},t}();_S.exports=Au});var Tu=b((wZ,IS)=>{"use strict";var Pq=Ae(),{concat:Bq}=(qn(),Mn),{fromString:Dq}=(ar(),pr),Oq=vf(),Nq=rr(),kp=ca(),{equals:Kf}=(pi(),di),{codes:kq}=yt(),{Envelope:xS}=SS(),xs=class{constructor({peerId:e,payloadType:r,payload:i,signature:n}){this.peerId=e,this.payloadType=r,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=Oq.marshalPublicKey(this.peerId.pubKey);return this._marshal=xS.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return Kf(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&Kf(this.payloadType,e.payloadType)&&Kf(this.payload,e.payload)&&Kf(this.signature,e.signature)}validate(e){let r=CS(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},CS=(t,e,r)=>{let i=Dq(t),n=kp.encode(i.byteLength),s=kp.encode(e.length),a=kp.encode(r.length);return Bq([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(a),r])};xs.createFromProtobuf=async t=>{let e=xS.decode(t),r=await Nq.createFromPubKey(e.publicKey);return new xs({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};xs.seal=async(t,e)=>{let r=t.domain,i=t.codec,n=t.marshal(),s=CS(r,i,n),a=await e.privKey.sign(s);return new xs({peerId:e,payloadType:i,payload:n,signature:a})};xs.openAndCertify=async(t,e)=>{let r=await xs.createFromProtobuf(t);if(!await r.validate(e))throw Pq(new Error("envelope signature is not valid for the given domain"),kq.ERR_SIGNATURE_NOT_VALID);return r};IS.exports=xs});var TS=b((_Z,AS)=>{"use strict";function Lq(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,i)=>e[i].equals(r))}AS.exports=Lq});var BS=b((SZ,PS)=>{"use strict";var ya=tn(),Vf=ya.Reader,RS=ya.Writer,Kt=ya.util,wi=ya.roots["libp2p-peer-record"]||(ya.roots["libp2p-peer-record"]={});wi.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.peerId=Kt.newBuffer([]),t.prototype.seq=Kt.Long?Kt.Long.fromBits(0,0,!0):0,t.prototype.addresses=Kt.emptyArray,t.encode=function(r,i){if(i||(i=RS.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&i.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&i.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var n=0;n<r.addresses.length;++n)wi.PeerRecord.AddressInfo.encode(r.addresses[n],i.uint32(26).fork()).ldelim();return i},t.decode=function(r,i){r instanceof Vf||(r=Vf.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new wi.PeerRecord;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(wi.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof wi.PeerRecord)return r;var i=new wi.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?Kt.base64.decode(r.peerId,i.peerId=Kt.newBuffer(Kt.base64.length(r.peerId)),0):r.peerId.length&&(i.peerId=r.peerId)),r.seq!=null&&(Kt.Long?(i.seq=Kt.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?i.seq=parseInt(r.seq,10):typeof r.seq=="number"?i.seq=r.seq:typeof r.seq=="object"&&(i.seq=new Kt.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<r.addresses.length;++n){if(typeof r.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=wi.PeerRecord.AddressInfo.fromObject(r.addresses[n])}}return i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=Kt.newBuffer(n.peerId))),Kt.Long){var s=new Kt.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?Kt.base64.encode(r.peerId,0,r.peerId.length):i.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?n.seq=i.longs===String?String(r.seq):r.seq:n.seq=i.longs===String?Kt.Long.prototype.toString.call(r.seq):i.longs===Number?new Kt.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){n.addresses=[];for(var a=0;a<r.addresses.length;++a)n.addresses[a]=wi.PeerRecord.AddressInfo.toObject(r.addresses[a],i)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,ya.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.multiaddr=Kt.newBuffer([]),e.encode=function(i,n){return n||(n=RS.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof Vf||(i=Vf.create(i));for(var s=n===void 0?i.len:i.pos+n,a=new wi.PeerRecord.AddressInfo;i.pos<s;){var o=i.uint32();switch(o>>>3){case 1:a.multiaddr=i.bytes();break;default:i.skipType(o&7);break}}return a},e.fromObject=function(i){if(i instanceof wi.PeerRecord.AddressInfo)return i;var n=new wi.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Kt.base64.decode(i.multiaddr,n.multiaddr=Kt.newBuffer(Kt.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Kt.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Kt.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ya.util.toJSONOptions)},e}(),t}();PS.exports=wi});var OS=b((xZ,DS)=>{"use strict";var Mq="libp2p-peer-record",qq=Uint8Array.from([3,1]);DS.exports={ENVELOPE_DOMAIN_PEER_RECORD:Mq,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:qq}});var jf=b((CZ,LS)=>{"use strict";var{Multiaddr:Uq}=Pr(),Fq=rr(),Kq=TS(),{PeerRecord:NS}=BS(),{ENVELOPE_DOMAIN_PEER_RECORD:kS,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Vq}=OS(),ga=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:i=Date.now()}){this.domain=kS,this.codec=Vq,this.peerId=e,this.multiaddrs=r,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=NS.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof ga)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!Kq(this.multiaddrs,e.multiaddrs))}};ga.createFromProtobuf=t=>{let e=NS.decode(t),r=Fq.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new Uq(s.multiaddr)),n=Number(e.seq);return new ga({peerId:r,multiaddrs:i,seqNumber:n})};ga.DOMAIN=kS;LS.exports=ga});var Lp=b((IZ,MS)=>{"use strict";var jq=Tu(),Gq=jf();async function Hq(t){let e=new Gq({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await jq.seal(e,t.peerId);await t.peerStore.addressBook.consumePeerRecord(r)}MS.exports.updateSelfPeerRecord=Hq});var qp=b((AZ,FS)=>{"use strict";var qS=qe(),ma=Object.assign(qS("libp2p:transports"),{error:qS("libp2p:transports:err")}),zq=ES(),{codes:ko}=yt(),Ru=Ae(),{updateSelfPeerRecord:US}=Lp(),Mp=class{constructor({libp2p:e,upgrader:r,faultTolerance:i=Gf.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,r,i={}){if(ma("adding %s",e),!e)throw Ru(new Error(`Transport must have a valid key, was given '${e}'`),ko.ERR_INVALID_KEY);if(this._transports.has(e))throw Ru(new Error("There is already a transport with this key"),ko.ERR_DUPLICATE_TRANSPORT);let n=new r({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,i]of this._listeners)for(ma("closing listeners for %s",r);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),ma("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let i=this.transportForMultiaddr(e);if(!i)throw Ru(new Error(`No transport available for address ${String(e)}`),ko.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,r)}catch(n){throw n.code||(n.code=ko.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let i of r)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){ma("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),a=[];for(let u of s){ma("creating listener for %s on %s",i,u);let l=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(l),l.on("listening",()=>US(this.libp2p)),l.on("close",()=>US(this.libp2p)),a.push(l.listen(u))}if(a.length===0){r.push(i);continue}if(!(await zq(a)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==Gf.NO_FATAL)throw Ru(new Error(`Transport (${i}) could not listen on any available address`),ko.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let i=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===Gf.FATAL_ALL)throw Ru(new Error(i),ko.ERR_NO_VALID_ADDRESSES);ma(`libp2p in dial mode only: ${i}`)}}async remove(e){if(ma("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},Gf={FATAL_ALL:0,NO_FATAL:1};Mp.FaultTolerance=Gf;FS.exports=Mp});var jS=b((TZ,VS)=>{"use strict";var Wq=Ro(),{dnsaddrResolver:$q}=X_(),Up=qf(),{AGENT_VERSION:Yq}=Tp(),KS=Uf(),{publicAddressesFirst:Qq}=Pp(),{FaultTolerance:Xq}=qp(),Zq={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},connectionGater:{},transportManager:{faultTolerance:Xq.FATAL_ALL},dialer:{maxParallelDials:Up.MAX_PARALLEL_DIALS,maxDialsPerPeer:Up.MAX_PER_PEER_DIALS,dialTimeout:Up.DIAL_TIMEOUT,resolvers:{dnsaddr:$q},addressSorter:Qq},host:{agentVersion:Yq},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:KS.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:KS.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};VS.exports.validate=t=>{let e=Wq(Zq,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var zS=b((RZ,HS)=>{"use strict";var{EventEmitter:Jq}=_r(),{Multiaddr:Pu}=Pr(),eU=rr(),GS=class extends Jq{constructor(e,{listen:r=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new Pu(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new Pu(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new Pu(e))}addObservedAddr(e){let r=new Pu(e),i=r.getPeerId();i&&eU.createFromB58String(i).equals(this.peerId)&&(r=r.decapsulate(new Pu(`/p2p/${this.peerId}`)));let n=r.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};HS.exports=GS});var YS=b((PZ,$S)=>{"use strict";var{EventEmitter:tU}=_r(),Fp=qe()("latency-monitor:VisibilityChangeEmitter"),WS=class extends tU{constructor(){super();if(typeof document=="undefined"){Fp('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?Fp("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];Fp(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};$S.exports=WS});var ZS=b((BZ,XS)=>{"use strict";var{EventEmitter:rU}=_r(),iU=YS(),Gn=qe()("latency-monitor:LatencyMonitor"),QS=class extends rU{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,Gn("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?Gn("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):Gn("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(Gn("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(Gn("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(Gn("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),nU()&&(this._visibilityChangeEmitter=new iU,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),Gn("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,Gn("MS: %s Data: %O",s,e._latencyData)};Gn("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function nU(){return typeof window!="undefined"}XS.exports=QS});var Kp=b((DZ,ex)=>{"use strict";var JS=class extends Map{constructor(e){super();let{system:r,component:i,metric:n,metrics:s}=e;this._system=r,this._component=i,this._metric=n,this._metrics=s,this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}set(e,r){return super.set(e,r),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),this}delete(e){let r=super.delete(e);return this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),r}clear(){super.clear(),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}};ex.exports=({system:t="libp2p",component:e,metric:r,metrics:i})=>{let n;return i?n=new JS({system:t,component:e,metric:r,metrics:i}):n=new Map,n}});var ux=b((OZ,cx)=>{"use strict";var tx=qe(),ji=Object.assign(tx("libp2p:connection-manager"),{error:tx("libp2p:connection-manager:err")}),rx=Ae(),sU=Ro(),aU=ZS(),ix=wu(),{EventEmitter:oU}=_r(),nx=Kp(),cU=rr(),{codes:{ERR_INVALID_PARAMETERS:sx}}=yt(),uU={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},ax="connection-manager",lU="peer-connections",fU="peer-values",ox=class extends oU{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=sU.call({ignoreUndefined:!0},uU,r),this._options.maxConnections<this._options.minConnections)throw rx(new Error("Connection Manager maxConnections must be greater than minConnections"),sx);ji("options: %j",this._options),this._peerValues=nx({component:ax,metric:fU,metrics:this._libp2p.metrics}),this.connections=nx({component:ax,metric:lU,metrics:this._libp2p.metrics}),this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new aU({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval}),this.setMaxListeners(1/0)}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||ix(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,ji("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),ji("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let i of r)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}async _checkMetrics(){if(this._libp2p.metrics)try{let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxReceivedData",r);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxSentData",i);let n=r+i;await this._checkMaxLimit("maxData",n),ji("metrics update",n)}finally{this._timer=ix(this._checkMetrics,this._options.pollInterval)}}async onConnect(e){let r=e.remotePeer,i=r.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),await this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),await this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let r=e.remotePeer.toB58String(),i=this.connections.get(r);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(r,i)):i&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e),this._libp2p.metrics&&this._libp2p.metrics.onPeerDisconnected(e.remotePeer))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!cU.isPeerId(e))throw rx(new Error("peerId must be an instance of peer-id"),sx);let r=e.toB58String(),i=this.connections.get(r);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs).catch(r=>{ji.error(r)})}async _checkMaxLimit(e,r){let i=this._options[e];ji("checking limit of %s. current value: %d of %d",e,r,i),r>i&&(ji("%s: limit exceeded: %s, %d",this._peerId,e,r),await this._maybeDisconnectOne())}async _maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));ji("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let i=r[0];ji("%s: lowest value peer is %s",this._peerId,i),ji("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close().catch(s=>{ji.error(s)}),this.onDisconnect(n[0]);break}}}}};cx.exports=ox});var fx=b((NZ,lx)=>{"use strict";var hU=ua(),dU=async function*(t,e){yield*(await hU(t)).sort(e)};lx.exports=dU});var gx=b((kZ,yx)=>{"use strict";var hx=qe(),pU=Ro(),dx=wu(),yU=ua(),{pipe:gU}=kr(),mU=la(),vU=fx(),Cs=Object.assign(hx("libp2p:connection-manager:auto-dialler"),{error:hx("libp2p:connection-manager:auto-dialler:err")}),bU={enabled:!0,minConnections:0,autoDialInterval:1e4},px=class{constructor(e,r={}){this._options=pU.call({ignoreUndefined:!0},bU,r),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),Cs("options: %j",this._options)}async start(){if(!this._options.enabled){Cs("not enabled");return}this._running=!0,this._autoDial().catch(e=>{Cs.error("could start autodial",e)}),Cs("started")}async stop(){if(!this._options.enabled){Cs("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),Cs("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=dx(this._autoDial,this._options.autoDialInterval);return}let r=await gU(this._libp2p.peerStore.getPeers(),i=>mU(i,n=>!n.id.equals(this._libp2p.peerId)),i=>vU(i,(n,s)=>s.protocols&&s.protocols.length&&(!n.protocols||!n.protocols.length)||s.id.pubKey&&!n.id.pubKey?1:-1),i=>yU(i));for(let i=0;this._running&&i<r.length&&this._libp2p.connections.size<e;i++){let n=r[i];if(!this._libp2p.connectionManager.get(n.id)){Cs("connecting to a peerStore stored peer %s",n.id.toB58String());try{await this._libp2p.dialer.connectToPeer(n.id)}catch(s){Cs.error("could not connect to peerStore stored peer",s)}}}!this._running||(this._autoDialTimeout=dx(this._autoDial,this._options.autoDialInterval))}};yx.exports=px});var Ax=b((LZ,Ix)=>{"use strict";var{Multiaddr:Vp}=Pr(),mx=xe("dns4"),vx=xe("dns6"),bx=xe("dnsaddr"),va=Br(xe("dns"),bx,mx,vx),Bu=Br(xe("ip4"),xe("ip6")),Lo=Br(Le(Bu,xe("tcp")),Le(va,xe("tcp"))),jp=Le(Bu,xe("udp")),Ex=Le(jp,xe("utp")),wx=Le(jp,xe("quic")),Mo=Br(Le(Lo,xe("ws")),Le(va,xe("ws"))),qo=Br(Le(Lo,xe("wss")),Le(va,xe("wss"))),Hf=Br(Le(Lo,xe("http")),Le(Bu,xe("http")),Le(va,xe("http"))),zf=Br(Le(Lo,xe("https")),Le(Bu,xe("https")),Le(va,xe("https"))),Gp=Br(Le(Mo,xe("p2p-webrtc-star"),xe("p2p")),Le(qo,xe("p2p-webrtc-star"),xe("p2p")),Le(Mo,xe("p2p-webrtc-star")),Le(qo,xe("p2p-webrtc-star"))),EU=Br(Le(Mo,xe("p2p-websocket-star"),xe("p2p")),Le(qo,xe("p2p-websocket-star"),xe("p2p")),Le(Mo,xe("p2p-websocket-star")),Le(qo,xe("p2p-websocket-star"))),Hp=Br(Le(Hf,xe("p2p-webrtc-direct"),xe("p2p")),Le(zf,xe("p2p-webrtc-direct"),xe("p2p")),Le(Hf,xe("p2p-webrtc-direct")),Le(zf,xe("p2p-webrtc-direct"))),Uo=Br(Mo,qo,Hf,zf,Gp,Hp,Lo,Ex,wx,va),wU=Br(Le(Uo,xe("p2p-stardust"),xe("p2p")),Le(Uo,xe("p2p-stardust"))),Is=Br(Le(Uo,xe("p2p")),Gp,Hp,xe("p2p")),_x=Br(Le(Is,xe("p2p-circuit"),Is),Le(Is,xe("p2p-circuit")),Le(xe("p2p-circuit"),Is),Le(Uo,xe("p2p-circuit")),Le(xe("p2p-circuit"),Uo),xe("p2p-circuit")),Sx=()=>Br(Le(_x,Sx),_x),Fo=Sx(),xx=Br(Le(Fo,Is,Fo),Le(Is,Fo),Le(Fo,Is),Fo,Is);Ix.exports={DNS:va,DNS4:mx,DNS6:vx,DNSADDR:bx,IP:Bu,TCP:Lo,UDP:jp,QUIC:wx,UTP:Ex,HTTP:Hf,HTTPS:zf,WebSockets:Mo,WebSocketsSecure:qo,WebSocketStar:EU,WebRTCStar:Gp,WebRTCDirect:Hp,Reliable:Uo,Stardust:wU,Circuit:Fo,P2P:xx,IPFS:xx};function Cx(t){function e(r){if(!Vp.isMultiaddr(r))try{r=new Vp(r)}catch(n){return!1}let i=t(r.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function Le(...t){function e(r){if(r.length<t.length)return null;let i=r;return t.some(n=>(i=typeof n=="function"?n().partialMatch(r):n.partialMatch(r),Array.isArray(i)&&(r=i),i===null)),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Cx(e),partialMatch:e}}function Br(...t){function e(i){let n=null;return t.some(s=>{let a=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return a?(n=a,!0):!1}),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Cx(e),partialMatch:e}}function xe(t){let e=t;function r(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new Vp(n)}catch(o){return!1}else s=n;let a=s.protoNames();return a.length===1&&a[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:i}}});var Ko=b((MZ,Rx)=>{"use strict";var ba=tn(),Wf=ba.Reader,Tx=ba.Writer,_i=ba.util,gr=ba.roots["libp2p-circuit"]||(ba.roots["libp2p-circuit"]={});gr.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,i){return i||(i=Tx.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&i.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&gr.CircuitRelay.Peer.encode(r.srcPeer,i.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&gr.CircuitRelay.Peer.encode(r.dstPeer,i.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&i.uint32(32).int32(r.code),i},t.decode=function(r,i){r instanceof Wf||(r=Wf.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new gr.CircuitRelay;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=gr.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=gr.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof gr.CircuitRelay)return r;var i=new gr.CircuitRelay;switch(r.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=gr.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=gr.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(n.type=i.enums===String?gr.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(n.srcPeer=gr.CircuitRelay.Peer.toObject(r.srcPeer,i)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(n.dstPeer=gr.CircuitRelay.Peer.toObject(r.dstPeer,i)),r.code!=null&&r.hasOwnProperty("code")&&(n.code=i.enums===String?gr.CircuitRelay.Status[r.code]:r.code),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,ba.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}return e.prototype.id=_i.newBuffer([]),e.prototype.addrs=_i.emptyArray,e.encode=function(i,n){if(n||(n=Tx.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof Wf||(i=Wf.create(i));for(var s=n===void 0?i.len:i.pos+n,a=new gr.CircuitRelay.Peer;i.pos<s;){var o=i.uint32();switch(o>>>3){case 1:a.id=i.bytes();break;case 2:a.addrs&&a.addrs.length||(a.addrs=[]),a.addrs.push(i.bytes());break;default:i.skipType(o&7);break}}if(!a.hasOwnProperty("id"))throw _i.ProtocolError("missing required 'id'",{instance:a});return a},e.fromObject=function(i){if(i instanceof gr.CircuitRelay.Peer)return i;var n=new gr.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?_i.base64.decode(i.id,n.id=_i.newBuffer(_i.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?_i.base64.decode(i.addrs[s],n.addrs[s]=_i.newBuffer(_i.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=_i.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?_i.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var a=0;a<i.addrs.length;++a)s.addrs[a]=n.bytes===String?_i.base64.encode(i.addrs[a],0,i.addrs[a].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[a]):i.addrs[a]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,ba.util.toJSONOptions)},e}(),t}();Rx.exports=gr});var Bx=b((qZ,Px)=>{Px.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Ox=b((FZ,Dx)=>{Dx.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var Du=b((KZ,Ea)=>{var _U=Bx(),zp=Ox(),Nx=(t,e,r)=>Wp(t,Array.isArray(e)?e:[{signal:e,options:r}]),Wp=(t,e)=>{t=_U(t),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*r(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:o,options:c}of e)if(o.aborted){let{abortMessage:u,abortCode:l}=c;throw new zp(u,l)}let a=new Promise((o,c)=>{i=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:l,abortCode:f}=u;c(new zp(l,f))}});s=await Promise.race([a,t.next()]),i=null}catch(a){for(let{signal:u}of e)u.removeEventListener("abort",n);let o=e.find(({signal:u})=>u.aborted),c=a.type==="aborted"&&o;if(c&&o.options.onAbort&&await o.options.onAbort(t),typeof t.return=="function")try{let u=t.return();u instanceof Promise&&u.catch(l=>{o.options.onReturnError!=null&&o.options.onReturnError(l)})}catch(u){o.options.onReturnError!=null&&o.options.onReturnError(u)}if(c&&o.options.returnOnAbort)return;throw a}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return r()},kx=(t,e,r)=>Lx(t,Array.isArray(e)?e:[{signal:e,options:r}]),Lx=(t,e)=>r=>t(Wp(r,e)),SU=(t,e,r)=>xU(t,Array.isArray(e)?e:[{signal:e,options:r}]),xU=(t,e)=>({sink:Lx(t.sink,e),source:Wp(t.source,e)});Ea.exports=Nx;Ea.exports.AbortError=zp;Ea.exports.source=Nx;Ea.exports.sink=kx;Ea.exports.transform=kx;Ea.exports.duplex=SU});var Ux=b((VZ,qx)=>{"use strict";var{source:Mx}=Du(),CU=qe(),IU=CU("libp2p:stream:converter");function AU({stream:t,remoteAddr:e,localAddr:r},i={}){let{sink:n,source:s}=t,a={async sink(c){i.signal&&(c=Mx(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&IU(u)}o()},source:i.signal?Mx(s,i.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),o()}};function o(){return a.timeline.close||(a.timeline.close=Date.now()),Promise.resolve()}return a}qx.exports=AU});var Ou=b((jZ,Fx)=>{"use strict";Fx.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var Vx=b((GZ,Kx)=>{"use strict";var{EventEmitter:TU}=_r(),{Multiaddr:RU}=Pr();Kx.exports=t=>{let e=new Map;async function r(s){let a=String(s).split("/p2p-circuit").find(u=>u!==""),o=await t.dial(new RU(a)),c=o.remoteAddr.encapsulate("/p2p-circuit");e.set(o.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let a of e.values())s.push(a);return s}let n=Object.assign(new TU,{close:()=>Promise.resolve(),listen:r,getAddrs:i});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var $p=b((HZ,Hx)=>{"use strict";var{Multiaddr:jx}=Pr(),{CircuitRelay:wa}=Ko();function Gx(t,e){t.write({type:wa.Type.STATUS,code:e})}function PU(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new jx(r))}catch(r){throw Gx(e,t.type===wa.Type.HOP?wa.Status.HOP_DST_MULTIADDR_INVALID:wa.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new jx(r))}catch(r){throw Gx(e,t.type===wa.Type.HOP?wa.Status.HOP_SRC_MULTIADDR_INVALID:wa.Status.STOP_SRC_MULTIADDR_INVALID),r}}Hx.exports={validateAddrs:PU}});var $x=b($f=>{"use strict";$f.byteLength=DU;$f.toByteArray=NU;$f.fromByteArray=MU;var vn=[],Si=[],BU=typeof Uint8Array!="undefined"?Uint8Array:Array,Yp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(_a=0,zx=Yp.length;_a<zx;++_a)vn[_a]=Yp[_a],Si[Yp.charCodeAt(_a)]=_a;var _a,zx;Si["-".charCodeAt(0)]=62;Si["_".charCodeAt(0)]=63;function Wx(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function DU(t){var e=Wx(t),r=e[0],i=e[1];return(r+i)*3/4-i}function OU(t,e,r){return(e+r)*3/4-r}function NU(t){var e,r=Wx(t),i=r[0],n=r[1],s=new BU(OU(t,i,n)),a=0,o=n>0?i-4:i,c;for(c=0;c<o;c+=4)e=Si[t.charCodeAt(c)]<<18|Si[t.charCodeAt(c+1)]<<12|Si[t.charCodeAt(c+2)]<<6|Si[t.charCodeAt(c+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return n===2&&(e=Si[t.charCodeAt(c)]<<2|Si[t.charCodeAt(c+1)]>>4,s[a++]=e&255),n===1&&(e=Si[t.charCodeAt(c)]<<10|Si[t.charCodeAt(c+1)]<<4|Si[t.charCodeAt(c+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function kU(t){return vn[t>>18&63]+vn[t>>12&63]+vn[t>>6&63]+vn[t&63]}function LU(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),n.push(kU(i));return n.join("")}function MU(t){for(var e,r=t.length,i=r%3,n=[],s=16383,a=0,o=r-i;a<o;a+=s)n.push(LU(t,a,a+s>o?o:a+s));return i===1?(e=t[r-1],n.push(vn[e>>2]+vn[e<<4&63]+"==")):i===2&&(e=(t[r-2]<<8)+t[r-1],n.push(vn[e>>10]+vn[e>>4&63]+vn[e<<2&63]+"=")),n.join("")}});var Yx=b(Qp=>{Qp.read=function(t,e,r,i,n){var s,a,o=n*8-i-1,c=(1<<o)-1,u=c>>1,l=-7,f=r?n-1:0,h=r?-1:1,p=t[e+f];for(f+=h,s=p&(1<<-l)-1,p>>=-l,l+=o;l>0;s=s*256+t[e+f],f+=h,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=i;l>0;a=a*256+t[e+f],f+=h,l-=8);if(s===0)s=1-u;else{if(s===c)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-u}return(p?-1:1)*a*Math.pow(2,s-i)};Qp.write=function(t,e,r,i,n,s){var a,o,c,u=s*8-n-1,l=(1<<u)-1,f=l>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,d=i?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+f>=1?e+=h/c:e+=h*Math.pow(2,1-f),e*c>=2&&(a++,c/=2),a+f>=l?(o=0,a=l):a+f>=1?(o=(e*c-1)*Math.pow(2,n),a=a+f):(o=e*Math.pow(2,f-1)*Math.pow(2,n),a=0));n>=8;t[r+p]=o&255,p+=d,o/=256,n-=8);for(a=a<<n|o,u+=n;u>0;t[r+p]=a&255,p+=d,a/=256,u-=8);t[r+p-d]|=y*128}});var xi=b(Ho=>{"use strict";var Xp=$x(),Vo=Yx(),Qx=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ho.Buffer=H;Ho.SlowBuffer=jU;Ho.INSPECT_MAX_BYTES=50;var Yf=2147483647;Ho.kMaxLength=Yf;H.TYPED_ARRAY_SUPPORT=qU();!H.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function qU(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.buffer}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.byteOffset}});function Hn(t){if(t>Yf)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,H.prototype),e}function H(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Zp(t)}return Xx(t,e,r)}H.poolSize=8192;function Xx(t,e,r){if(typeof t=="string")return FU(t,e);if(ArrayBuffer.isView(t))return KU(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(bn(t,ArrayBuffer)||t&&bn(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(bn(t,SharedArrayBuffer)||t&&bn(t.buffer,SharedArrayBuffer)))return ey(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(i!=null&&i!==t)return H.from(i,e,r);let n=VU(t);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return H.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}H.from=function(t,e,r){return Xx(t,e,r)};Object.setPrototypeOf(H.prototype,Uint8Array.prototype);Object.setPrototypeOf(H,Uint8Array);function Zx(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function UU(t,e,r){return Zx(t),t<=0?Hn(t):e!==void 0?typeof r=="string"?Hn(t).fill(e,r):Hn(t).fill(e):Hn(t)}H.alloc=function(t,e,r){return UU(t,e,r)};function Zp(t){return Zx(t),Hn(t<0?0:ty(t)|0)}H.allocUnsafe=function(t){return Zp(t)};H.allocUnsafeSlow=function(t){return Zp(t)};function FU(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!H.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=Jx(t,e)|0,i=Hn(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function Jp(t){let e=t.length<0?0:ty(t.length)|0,r=Hn(e);for(let i=0;i<e;i+=1)r[i]=t[i]&255;return r}function KU(t){if(bn(t,Uint8Array)){let e=new Uint8Array(t);return ey(e.buffer,e.byteOffset,e.byteLength)}return Jp(t)}function ey(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&r===void 0?i=new Uint8Array(t):r===void 0?i=new Uint8Array(t,e):i=new Uint8Array(t,e,r),Object.setPrototypeOf(i,H.prototype),i}function VU(t){if(H.isBuffer(t)){let e=ty(t.length)|0,r=Hn(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||ny(t.length)?Hn(0):Jp(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Jp(t.data)}function ty(t){if(t>=Yf)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Yf.toString(16)+" bytes");return t|0}function jU(t){return+t!=t&&(t=0),H.alloc(+t)}H.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==H.prototype};H.compare=function(e,r){if(bn(e,Uint8Array)&&(e=H.from(e,e.offset,e.byteLength)),bn(r,Uint8Array)&&(r=H.from(r,r.offset,r.byteLength)),!H.isBuffer(e)||!H.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let i=e.length,n=r.length;for(let s=0,a=Math.min(i,n);s<a;++s)if(e[s]!==r[s]){i=e[s],n=r[s];break}return i<n?-1:n<i?1:0};H.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};H.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return H.alloc(0);let i;if(r===void 0)for(r=0,i=0;i<e.length;++i)r+=e[i].length;let n=H.allocUnsafe(r),s=0;for(i=0;i<e.length;++i){let a=e[i];if(bn(a,Uint8Array))s+a.length>n.length?(H.isBuffer(a)||(a=H.from(a)),a.copy(n,s)):Uint8Array.prototype.set.call(n,a,s);else if(H.isBuffer(a))a.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=a.length}return n};function Jx(t,e){if(H.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||bn(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&r===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return iy(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return fC(t).length;default:if(n)return i?-1:iy(t).length;e=(""+e).toLowerCase(),n=!0}}H.byteLength=Jx;function GU(t,e,r){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return eF(this,e,r);case"utf8":case"utf-8":return rC(this,e,r);case"ascii":return ZU(this,e,r);case"latin1":case"binary":return JU(this,e,r);case"base64":return QU(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tF(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}H.prototype._isBuffer=!0;function Sa(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}H.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Sa(this,r,r+1);return this};H.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Sa(this,r,r+3),Sa(this,r+1,r+2);return this};H.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Sa(this,r,r+7),Sa(this,r+1,r+6),Sa(this,r+2,r+5),Sa(this,r+3,r+4);return this};H.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?rC(this,0,e):GU.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(e){if(!H.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:H.compare(this,e)===0};H.prototype.inspect=function(){let e="",r=Ho.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Qx&&(H.prototype[Qx]=H.prototype.inspect);H.prototype.compare=function(e,r,i,n,s){if(bn(e,Uint8Array)&&(e=H.from(e,e.offset,e.byteLength)),!H.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),r<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&r>=i)return 0;if(n>=s)return-1;if(r>=i)return 1;if(r>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let a=s-n,o=i-r,c=Math.min(a,o),u=this.slice(n,s),l=e.slice(r,i);for(let f=0;f<c;++f)if(u[f]!==l[f]){a=u[f],o=l[f];break}return a<o?-1:o<a?1:0};function eC(t,e,r,i,n){if(t.length===0)return-1;if(typeof r=="string"?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,ny(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0)if(n)r=0;else return-1;if(typeof e=="string"&&(e=H.from(e,i)),H.isBuffer(e))return e.length===0?-1:tC(t,e,r,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):tC(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function tC(t,e,r,i,n){let s=1,a=t.length,o=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,a/=2,o/=2,r/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}let u;if(n){let l=-1;for(u=r;u<a;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===o)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+o>a&&(r=a-o),u=r;u>=0;u--){let l=!0;for(let f=0;f<o;f++)if(c(t,u+f)!==c(e,f)){l=!1;break}if(l)return u}return-1}H.prototype.includes=function(e,r,i){return this.indexOf(e,r,i)!==-1};H.prototype.indexOf=function(e,r,i){return eC(this,e,r,i,!0)};H.prototype.lastIndexOf=function(e,r,i){return eC(this,e,r,i,!1)};function HU(t,e,r,i){r=Number(r)||0;let n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let a;for(a=0;a<i;++a){let o=parseInt(e.substr(a*2,2),16);if(ny(o))return a;t[r+a]=o}return a}function zU(t,e,r,i){return Qf(iy(e,t.length-r),t,r,i)}function WU(t,e,r,i){return Qf(sF(e),t,r,i)}function $U(t,e,r,i){return Qf(fC(e),t,r,i)}function YU(t,e,r,i){return Qf(aF(e,t.length-r),t,r,i)}H.prototype.write=function(e,r,i,n){if(r===void 0)n="utf8",i=this.length,r=0;else if(i===void 0&&typeof r=="string")n=r,i=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return HU(this,e,r,i);case"utf8":case"utf-8":return zU(this,e,r,i);case"ascii":case"latin1":case"binary":return WU(this,e,r,i);case"base64":return $U(this,e,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return YU(this,e,r,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function QU(t,e,r){return e===0&&r===t.length?Xp.fromByteArray(t):Xp.fromByteArray(t.slice(e,r))}function rC(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let s=t[n],a=null,o=s>239?4:s>223?3:s>191?2:1;if(n+o<=r){let c,u,l,f;switch(o){case 1:s<128&&(a=s);break;case 2:c=t[n+1],(c&192)==128&&(f=(s&31)<<6|c&63,f>127&&(a=f));break;case 3:c=t[n+1],u=t[n+2],(c&192)==128&&(u&192)==128&&(f=(s&15)<<12|(c&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:c=t[n+1],u=t[n+2],l=t[n+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(f=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,f>65535&&f<1114112&&(a=f))}}a===null?(a=65533,o=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|a&1023),i.push(a),n+=o}return XU(i)}var iC=4096;function XU(t){let e=t.length;if(e<=iC)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=iC));return r}function ZU(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]&127);return i}function JU(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function eF(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let s=e;s<r;++s)n+=oF[t[s]];return n}function tF(t,e,r){let i=t.slice(e,r),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}H.prototype.slice=function(e,r){let i=this.length;e=~~e,r=r===void 0?i:~~r,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),r<0?(r+=i,r<0&&(r=0)):r>i&&(r=i),r<e&&(r=e);let n=this.subarray(e,r);return Object.setPrototypeOf(n,H.prototype),n};function mr(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}H.prototype.readUintLE=H.prototype.readUIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||mr(e,r,this.length);let n=this[e],s=1,a=0;for(;++a<r&&(s*=256);)n+=this[e+a]*s;return n};H.prototype.readUintBE=H.prototype.readUIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||mr(e,r,this.length);let n=this[e+--r],s=1;for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n};H.prototype.readUint8=H.prototype.readUInt8=function(e,r){return e=e>>>0,r||mr(e,1,this.length),this[e]};H.prototype.readUint16LE=H.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||mr(e,2,this.length),this[e]|this[e+1]<<8};H.prototype.readUint16BE=H.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||mr(e,2,this.length),this[e]<<8|this[e+1]};H.prototype.readUint32LE=H.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||mr(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};H.prototype.readUint32BE=H.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||mr(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};H.prototype.readBigUInt64LE=As(function(e){e=e>>>0,Go(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Nu(e,this.length-8);let n=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});H.prototype.readBigUInt64BE=As(function(e){e=e>>>0,Go(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Nu(e,this.length-8);let n=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});H.prototype.readIntLE=function(e,r,i){e=e>>>0,r=r>>>0,i||mr(e,r,this.length);let n=this[e],s=1,a=0;for(;++a<r&&(s*=256);)n+=this[e+a]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*r)),n};H.prototype.readIntBE=function(e,r,i){e=e>>>0,r=r>>>0,i||mr(e,r,this.length);let n=r,s=1,a=this[e+--n];for(;n>0&&(s*=256);)a+=this[e+--n]*s;return s*=128,a>=s&&(a-=Math.pow(2,8*r)),a};H.prototype.readInt8=function(e,r){return e=e>>>0,r||mr(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};H.prototype.readInt16LE=function(e,r){e=e>>>0,r||mr(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};H.prototype.readInt16BE=function(e,r){e=e>>>0,r||mr(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};H.prototype.readInt32LE=function(e,r){return e=e>>>0,r||mr(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};H.prototype.readInt32BE=function(e,r){return e=e>>>0,r||mr(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};H.prototype.readBigInt64LE=As(function(e){e=e>>>0,Go(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Nu(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});H.prototype.readBigInt64BE=As(function(e){e=e>>>0,Go(e,"offset");let r=this[e],i=this[e+7];(r===void 0||i===void 0)&&Nu(e,this.length-8);let n=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});H.prototype.readFloatLE=function(e,r){return e=e>>>0,r||mr(e,4,this.length),Vo.read(this,e,!0,23,4)};H.prototype.readFloatBE=function(e,r){return e=e>>>0,r||mr(e,4,this.length),Vo.read(this,e,!1,23,4)};H.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||mr(e,8,this.length),Vo.read(this,e,!0,52,8)};H.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||mr(e,8,this.length),Vo.read(this,e,!1,52,8)};function $r(t,e,r,i,n,s){if(!H.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}H.prototype.writeUintLE=H.prototype.writeUIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let o=Math.pow(2,8*i)-1;$r(this,e,r,i,o,0)}let s=1,a=0;for(this[r]=e&255;++a<i&&(s*=256);)this[r+a]=e/s&255;return r+i};H.prototype.writeUintBE=H.prototype.writeUIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,i=i>>>0,!n){let o=Math.pow(2,8*i)-1;$r(this,e,r,i,o,0)}let s=i-1,a=1;for(this[r+s]=e&255;--s>=0&&(a*=256);)this[r+s]=e/a&255;return r+i};H.prototype.writeUint8=H.prototype.writeUInt8=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,1,255,0),this[r]=e&255,r+1};H.prototype.writeUint16LE=H.prototype.writeUInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};H.prototype.writeUint16BE=H.prototype.writeUInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};H.prototype.writeUint32LE=H.prototype.writeUInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};H.prototype.writeUint32BE=H.prototype.writeUInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function nC(t,e,r,i,n){lC(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=a,a=a>>8,t[r++]=a,a=a>>8,t[r++]=a,a=a>>8,t[r++]=a,r}function sC(t,e,r,i,n){lC(e,i,n,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=a,a=a>>8,t[r+2]=a,a=a>>8,t[r+1]=a,a=a>>8,t[r]=a,r+8}H.prototype.writeBigUInt64LE=As(function(e,r=0){return nC(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeBigUInt64BE=As(function(e,r=0){return sC(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeIntLE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);$r(this,e,r,i,c-1,-c)}let s=0,a=1,o=0;for(this[r]=e&255;++s<i&&(a*=256);)e<0&&o===0&&this[r+s-1]!==0&&(o=1),this[r+s]=(e/a>>0)-o&255;return r+i};H.prototype.writeIntBE=function(e,r,i,n){if(e=+e,r=r>>>0,!n){let c=Math.pow(2,8*i-1);$r(this,e,r,i,c-1,-c)}let s=i-1,a=1,o=0;for(this[r+s]=e&255;--s>=0&&(a*=256);)e<0&&o===0&&this[r+s+1]!==0&&(o=1),this[r+s]=(e/a>>0)-o&255;return r+i};H.prototype.writeInt8=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};H.prototype.writeInt16LE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};H.prototype.writeInt16BE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};H.prototype.writeInt32LE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};H.prototype.writeInt32BE=function(e,r,i){return e=+e,r=r>>>0,i||$r(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};H.prototype.writeBigInt64LE=As(function(e,r=0){return nC(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});H.prototype.writeBigInt64BE=As(function(e,r=0){return sC(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function aC(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function oC(t,e,r,i,n){return e=+e,r=r>>>0,n||aC(t,e,r,4,34028234663852886e22,-34028234663852886e22),Vo.write(t,e,r,i,23,4),r+4}H.prototype.writeFloatLE=function(e,r,i){return oC(this,e,r,!0,i)};H.prototype.writeFloatBE=function(e,r,i){return oC(this,e,r,!1,i)};function cC(t,e,r,i,n){return e=+e,r=r>>>0,n||aC(t,e,r,8,17976931348623157e292,-17976931348623157e292),Vo.write(t,e,r,i,52,8),r+8}H.prototype.writeDoubleLE=function(e,r,i){return cC(this,e,r,!0,i)};H.prototype.writeDoubleBE=function(e,r,i){return cC(this,e,r,!1,i)};H.prototype.copy=function(e,r,i,n){if(!H.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),r>=e.length&&(r=e.length),r||(r=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-r<n-i&&(n=e.length-r+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),r),s};H.prototype.fill=function(e,r,i,n){if(typeof e=="string"){if(typeof r=="string"?(n=r,r=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!H.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let a=e.charCodeAt(0);(n==="utf8"&&a<128||n==="latin1")&&(e=a)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r=r>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<i;++s)this[s]=e;else{let a=H.isBuffer(e)?e:H.from(e,n),o=a.length;if(o===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-r;++s)this[s+r]=a[s%o]}return this};var jo={};function ry(t,e,r){jo[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}ry("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);ry("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);ry("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=uC(String(r)):typeof r=="bigint"&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=uC(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function uC(t){let e="",r=t.length,i=t[0]==="-"?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function rF(t,e,r){Go(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Nu(e,t.length-(r+1))}function lC(t,e,r,i,n,s){if(t>r||t<e){let a=typeof e=="bigint"?"n":"",o;throw s>3?e===0||e===BigInt(0)?o=`>= 0${a} and < 2${a} ** ${(s+1)*8}${a}`:o=`>= -(2${a} ** ${(s+1)*8-1}${a}) and < 2 ** ${(s+1)*8-1}${a}`:o=`>= ${e}${a} and <= ${r}${a}`,new jo.ERR_OUT_OF_RANGE("value",o,t)}rF(i,n,s)}function Go(t,e){if(typeof t!="number")throw new jo.ERR_INVALID_ARG_TYPE(e,"number",t)}function Nu(t,e,r){throw Math.floor(t)!==t?(Go(t,r),new jo.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new jo.ERR_BUFFER_OUT_OF_BOUNDS:new jo.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var iF=/[^+/0-9A-Za-z-_]/g;function nF(t){if(t=t.split("=")[0],t=t.trim().replace(iF,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function iy(t,e){e=e||1/0;let r,i=t.length,n=null,s=[];for(let a=0;a<i;++a){if(r=t.charCodeAt(a),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(a+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function sF(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function aF(t,e){let r,i,n,s=[];for(let a=0;a<t.length&&!((e-=2)<0);++a)r=t.charCodeAt(a),i=r>>8,n=r%256,s.push(n),s.push(i);return s}function fC(t){return Xp.toByteArray(nF(t))}function Qf(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function bn(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function ny(t){return t!==t}var oF=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let i=r*16;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function As(t){return typeof BigInt=="undefined"?cF:t}function cF(){throw new Error("BigInt not supported")}});var xa=b((QZ,dC)=>{"use strict";var{Buffer:Gi}=xi(),hC=Symbol.for("BufferList");function bt(t){if(!(this instanceof bt))return new bt(t);bt._init.call(this,t)}bt._init=function(e){Object.defineProperty(this,hC,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};bt.prototype._new=function(e){return new bt(e)};bt.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let i=0;i<this._bufs.length;i++){let n=r+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-r];r=n}};bt.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let i=0;i<e;i++)r+=this._bufs[i].length;return r};bt.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};bt.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};bt.prototype.copy=function(e,r,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Gi.alloc(0);let s=!!e,a=this._offset(i),o=n-i,c=o,u=s&&r||0,l=a[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Gi.concat(this._bufs,this.length);for(let f=0;f<this._bufs.length;f++)this._bufs[f].copy(e,u),u+=this._bufs[f].length;return e}if(c<=this._bufs[a[0]].length-l)return s?this._bufs[a[0]].copy(e,r,l,l+c):this._bufs[a[0]].slice(l,l+c);s||(e=Gi.allocUnsafe(o));for(let f=a[0];f<this._bufs.length;f++){let h=this._bufs[f].length-l;if(c>h)this._bufs[f].copy(e,u,l),u+=h;else{this._bufs[f].copy(e,u,l,l+c),u+=h;break}c-=h,l&&(l=0)}return e.length>u?e.slice(0,u):e};bt.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let i=this._offset(e),n=this._offset(r),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};bt.prototype.toString=function(e,r,i){return this.slice(r,i).toString(e)};bt.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};bt.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};bt.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Gi.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Gi.from(e));return this};bt.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};bt.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Gi.from([t]):typeof t=="string"?t=Gi.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Gi.from(t.buffer,t.byteOffset,t.byteLength):Gi.isBuffer(t)||(t=Gi.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let a=this._bufs[n];for(;s<a.length;)if(a.length-s>=t.length){let c=a.indexOf(t,s);if(c!==-1)return this._reverseOffset([n,c]);s=a.length-t.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,t))return c;s++}s=0}return-1};bt.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?bt.prototype[r]=function(i,n){return this.slice(i,i+n)[r](0,n)}:bt.prototype[r]=function(i=0){return this.slice(i,i+t[r])[r](0)}})(e)})();bt.prototype._isBufferList=function(e){return e instanceof bt||bt.isBufferList(e)};bt.isBufferList=function(e){return e!=null&&e[hC]};dC.exports=bt});var sy=b((XZ,gC)=>{"use strict";var pC=ca(),{Buffer:uF}=xi(),yC=(t,e,r)=>{let i=pC.encode(t,e,r);return yC.bytes=pC.encode.bytes,e||uF.from(i)};gC.exports=yC});var _C=b((ZZ,Xf)=>{"use strict";var{Buffer:mC}=xi(),vC=xa(),bC=sy(),ay=8,EC=10*1024;function wC(t){t=t||{};let e=Math.max(t.poolSize||EC,t.minPoolSize||ay),r=t.lengthEncoder||bC;return async function*(n){let s=mC.alloc(e),a=0;for await(let o of n){r(o.length,s,a);let c=s.slice(a,a+r.bytes);a+=r.bytes,s.length-a<ay&&(s=mC.alloc(e),a=0),yield new vC().append(c).append(o)}}}wC.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||bC;return new vC([r(t.length),t.slice()])};Xf.exports=wC;Xf.exports.MIN_POOL_SIZE=ay;Xf.exports.DEFAULT_POOL_SIZE=EC});var oy=b((JZ,CC)=>{"use strict";var SC=ca(),{Buffer:lF}=xi(),fF=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),xC=t=>{let e=SC.decode(lF.isBuffer(t)?t:fF(t));return xC.bytes=SC.decode.bytes,e};CC.exports=xC});var RC=b((eJ,Zf)=>{"use strict";var{Buffer:hF}=xi(),cy=xa(),dF=oy(),IC=8,AC=1024*1024*4,TC=hF.alloc(0),Ts={LENGTH:"readLength",DATA:"readData"},pF={[Ts.LENGTH]:(t,e,r,i)=>{e=e.append(t);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Ts.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(i.lengthDecoder.bytes),e=new cy,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(TC),{mode:Ts.LENGTH,chunk:t,buffer:e,data:TC}):{mode:Ts.DATA,chunk:t,buffer:e,state:{dataLength:n},data:void 0}},[Ts.DATA]:(t,e,r,i)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:Ts.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:n}=r,s=e.shallowSlice(0,n),a=e.length>n?e.shallowSlice(n):void 0;return e=new cy,i.onData&&i.onData(s),{mode:Ts.LENGTH,chunk:a,buffer:e,state:void 0,data:s}}};function uy(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||dF,maxLengthLength:t.maxLengthLength||IC,maxDataLength:t.maxDataLength||AC,onLength:t.onLength,onData:t.onData};return async function*(i){let n=new cy,s=Ts.LENGTH,a;for await(let o of i){let c=o;for(;c;){let u=pF[s](c,n,a,e);s=u.mode,c=u.chunk,n=u.buffer,a=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}uy.fromReader=(t,e)=>{let r=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return uy({...e||{},onLength:s=>{r=s}})(i)};Zf.exports=uy;Zf.exports.MAX_LENGTH_LENGTH=IC;Zf.exports.MAX_DATA_LENGTH=AC});var DC=b((tJ,BC)=>{"use strict";var{Buffer:yF}=xi(),PC=(t,e,r)=>(e=e||yF.allocUnsafe(4),e.writeInt32BE(t,r),e);PC.bytes=4;BC.exports=PC});var kC=b((rJ,NC)=>{"use strict";var OC=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};OC.bytes=4;NC.exports=OC});var Ia=b(Ca=>{"use strict";Ca.encode=_C();Ca.decode=RC();Ca.varintEncode=sy();Ca.varintDecode=oy();Ca.int32BEEncode=DC();Ca.int32BEDecode=kC()});var fy=b((nJ,LC)=>{var ly=xa();LC.exports=t=>{let e=async function*(){let r=yield,i=new ly;for await(let n of t){if(!r){r=yield i.append(n),i=new ly;continue}for(i.append(n);i.length>=r;){let s=i.shallowSlice(0,r);if(i.consume(r),r=yield s,!r){i.length&&(r=yield i,i=new ly);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var hy=b((sJ,MC)=>{"use strict";var gF=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};MC.exports=gF});var zo=b((aJ,qC)=>{"use strict";var mF=fy(),vF=Bf(),bF=hy();qC.exports=t=>{let e=vF(),r=mF(t.source),i=bF(),n,s=t.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(o=>{n=o}),{reader:r,writer:e,stream:{sink:o=>n?Promise.reject(n):(i.resolve(o),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var e0=b((oJ,jC)=>{"use strict";var UC=qe(),Jf=Object.assign(UC("libp2p:circuit:stream-handler"),{error:UC("libp2p:circuit:stream-handler:err")}),FC=Ia(),EF=zo(),{CircuitRelay:KC}=Ko(),VC=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=EF(this.stream),this.decoder=FC.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=KC.decode(e.value.slice());return Jf("read message type",r.type),r}Jf("read received no value, closing stream"),this.close()}write(e){Jf("write message type %s",e.type),this.shake.write(FC.encode.single(KC.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){Jf("closing the stream"),this.rest().sink([])}};jC.exports=VC});var yy=b((cJ,py)=>{"use strict";var GC=qe(),ku=Object.assign(GC("libp2p:circuit:stop"),{error:GC("libp2p:circuit:stop:err")}),{CircuitRelay:dy}=Ko(),wF=Ou(),_F=e0(),{validateAddrs:SF}=$p();py.exports.handleStop=function({connection:e,request:r,streamHandler:i}){try{SF(r,i)}catch(n){return ku.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return ku("stop request is valid"),i.write({type:dy.Type.STATUS,code:dy.Status.SUCCESS}),i.rest()};py.exports.stop=async function({connection:e,request:r}){let{stream:i}=await e.newStream([wF.relay]);ku("starting stop request to %s",e.remotePeer.toB58String());let n=new _F({stream:i});n.write(r);let s=await n.read();if(!s)return n.close();if(s.code===dy.Status.SUCCESS)return ku("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();ku("stop request failed with code %d",s.code),n.close()}});var gy=b((uJ,QC)=>{"use strict";var HC=qe(),zn=Object.assign(HC("libp2p:circuit:hop"),{error:HC("libp2p:circuit:hop:err")}),zC=Ae(),xF=rr(),{validateAddrs:CF}=$p(),WC=e0(),{CircuitRelay:ti}=Ko(),{pipe:IF}=kr(),{codes:$C}=yt(),{stop:AF}=yy(),YC=Ou();async function TF({connection:t,request:e,streamHandler:r,circuit:i}){if(!i._options.hop.enabled)return zn("HOP request received but we are not acting as a relay"),r.end({type:ti.Type.STATUS,code:ti.Status.HOP_CANT_SPEAK_RELAY});try{CF(e,r)}catch(u){return zn.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){zn("HOP request received but we do not receive a dstPeer");return}let n=new xF(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return zn("HOP request received but we are not connected to the destination peer"),r.end({type:ti.Type.STATUS,code:ti.Status.HOP_NO_CONN_TO_DST});if(!s)return;let a={type:ti.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},o;try{o=await AF({connection:s,request:a})}catch(u){return zn.error(u)}zn("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:ti.Type.STATUS,code:ti.Status.SUCCESS});let c=r.rest();return IF(c,o,c)}async function RF({connection:t,request:e}){let{stream:r}=await t.newStream([YC.relay]),i=new WC({stream:r});i.write(e);let n=await i.read();if(!n)throw zC(new Error("HOP request had no response"),$C.ERR_HOP_REQUEST_FAILED);if(n.code===ti.Status.SUCCESS)return zn("hop request was successful"),i.rest();throw zn("hop request failed with code %d, closing stream",n.code),i.close(),zC(new Error(`HOP request failed with code ${n.code}`),$C.ERR_HOP_REQUEST_FAILED)}async function PF({connection:t}){let{stream:e}=await t.newStream([YC.relay]),r=new WC({stream:e});r.write({type:ti.Type.CAN_HOP});let i=await r.read();return await r.close(),!(!i||i.code!==ti.Status.SUCCESS)}function BF({connection:t,streamHandler:e,circuit:r}){let i=r._options.hop.enabled;zn("can hop (%s) request from %s",i,t.remotePeer.toB58String()),e.end({type:ti.Type.STATUS,code:i?ti.Status.SUCCESS:ti.Status.HOP_CANT_SPEAK_RELAY})}QC.exports={handleHop:TF,hop:RF,canHop:PF,handleCanHop:BF}});var rI=b((lJ,tI)=>{"use strict";var XC=qe(),Wn=Object.assign(XC("libp2p:circuit"),{error:XC("libp2p:circuit:err")}),DF=Ae(),OF=Ax(),{Multiaddr:Lu}=Pr(),ZC=rr(),{CircuitRelay:Mu}=Ko(),{codes:NF}=yt(),JC=Ux(),{relay:kF}=Ou(),LF=Vx(),{handleCanHop:MF,handleHop:qF,hop:UF}=gy(),{handleStop:FF}=yy(),KF=e0(),VF=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),eI=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(kF,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let i=new KF({stream:r}),n=await i.read();if(!n)return;let s=this,a;switch(n.type){case Mu.Type.CAN_HOP:{Wn("received CAN_HOP request from %s",e.remotePeer.toB58String()),await MF({circuit:s,connection:e,streamHandler:i});break}case Mu.Type.HOP:{Wn("received HOP request from %s",e.remotePeer.toB58String()),a=await qF({connection:e,request:n,streamHandler:i,circuit:s});break}case Mu.Type.STOP:{Wn("received STOP request from %s",e.remotePeer.toB58String()),a=await FF({connection:e,request:n,streamHandler:i});break}default:Wn("Request of type %s not supported",n.type)}if(a){let o=new Lu(n.dstPeer.addrs[0]),c=new Lu(n.srcPeer.addrs[0]),u=JC({stream:a,remoteAddr:o,localAddr:c}),l=n.type===Mu.Type.HOP?"relay":"inbound";Wn("new %s connection %s",l,u.remoteAddr);let f=await this._upgrader.upgradeInbound(u);Wn("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(f)}}async dial(e,r){let i=e.toString().split("/p2p-circuit"),n=new Lu(i[0]),s=new Lu(i[i.length-1]),a=n.getPeerId(),o=s.getPeerId();if(!a||!o){let h="Circuit relay dial failed as addresses did not have peer id";throw Wn.error(h),DF(new Error(h),NF.ERR_RELAYED_DIAL)}let c=ZC.createFromB58String(a),u=ZC.createFromB58String(o),l=!1,f=this._connectionManager.get(c);f||(f=await this._dialer.connectToPeer(n,r),l=!0);try{let h=await UF({connection:f,request:{type:Mu.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(y=>y.bytes)},dstPeer:{id:u.toBytes(),addrs:[new Lu(s).bytes]}}}),p=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),d=JC({stream:h,remoteAddr:e,localAddr:p});return Wn("new outbound connection %s",d.remoteAddr),this._upgrader.upgradeOutbound(d)}catch(h){throw Wn.error("Circuit relay dial failed",h),l&&await f.close(),h}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,LF(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>OF.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[VF])}};tI.exports=eI});var my=b((fJ,iI)=>{"use strict";var{CID:jF}=(ao(),qc),{sha256:GF}=(ps(),Ln);iI.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await GF.digest(e);return jF.createV0(r)}});var uI=b((hJ,cI)=>{"use strict";var nI=qe(),vy=Object.assign(nI("libp2p:auto-relay"),{error:nI("libp2p:auto-relay:err")}),{fromString:HF}=(ar(),pr),{toString:zF}=(yr(),Sr),{Multiaddr:WF}=Pr(),$F=ua(),{relay:YF}=Ou(),{canHop:QF}=gy(),{namespaceToCid:XF}=my(),{CIRCUIT_PROTO_CODE:ZF,HOP_METADATA_KEY:sI,HOP_METADATA_VALUE:aI,RELAY_RENDEZVOUS_NS:JF}=Uf(),oI=class{constructor({libp2p:e,maxListeners:r=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{vy.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:r}){let i=e.toB58String(),n=r.find(s=>s===YF);if(!n&&this._listenRelays.has(i)){await this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(ZF)){vy(`relayed connection to ${i} will not be used to hop on`);return}await QF({connection:s})&&(await this._peerStore.metadataBook.setValue(e,sI,HF(aI)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i).catch(n=>{vy.error(n)})}async _addListenRelay(e,r){try{if(this._listenRelays.size>=this.maxListeners)return;let i=await this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);(await Promise.all(i.map(async s=>{try{return await this._transportManager.listen([new WF(`${s.toString()}/p2p-circuit`)]),!0}catch(a){this._onError(a)}return!1}))).includes(!0)&&this._listenRelays.add(r)}catch(i){this._onError(i),this._listenRelays.delete(r)}}async _removeListenRelay(e){this._listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[],i=await $F(this._peerStore.getPeers());for await(let{id:n,metadata:s}of i){let a=n.toB58String();if(this._listenRelays.has(a)||e.includes(a))continue;let o=s.get(sI);if(!o||zF(o)!==aI)continue;let c=this._connectionManager.get(n);if(!c){r.push(n);continue}if(await this._addListenRelay(c,a),this._listenRelays.size>=this.maxListeners)return}for(let n of r)if(await this._tryToListenOnRelay(n),this._listenRelays.size>=this.maxListeners)return;try{let n=await XF(JF);for await(let s of this._libp2p.contentRouting.findProviders(n)){if(!s.multiaddrs.length)continue;let a=s.id;if(await this._peerStore.addressBook.add(a,s.multiaddrs),await this._tryToListenOnRelay(a),this._listenRelays.size>=this.maxListeners)return}}catch(n){this._onError(n)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};cI.exports=oI});var pI=b((dJ,dI)=>{"use strict";var lI=qe(),fI=Object.assign(lI("libp2p:relay"),{error:lI("libp2p:relay:err")}),{codes:eK}=yt(),{setDelayedInterval:tK,clearDelayedInterval:rK}=Sp(),iK=uI(),{namespaceToCid:nK}=my(),{RELAY_RENDEZVOUS_NS:sK}=Uf(),hI=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new iK({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=tK(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){rK(this._timeout)}async _advertiseService(){try{let e=await nK(sK);await this._libp2p.contentRouting.provide(e)}catch(e){e.code===eK.ERR_NO_ROUTERS_AVAILABLE?(fI.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):fI.error(e)}}};dI.exports=hI});var Ey=b((pJ,by)=>{function yI(t){let e=new globalThis.AbortController;function r(){e.abort();for(let i of t)!i||!i.removeEventListener||i.removeEventListener("abort",r)}for(let i of t)if(!(!i||!i.addEventListener)){if(i.aborted){r();break}i.addEventListener("abort",r)}return e.signal}by.exports=yI;by.exports.anySignal=yI});var bI=b((gJ,vI)=>{var gI=bp(),mI=hy();vI.exports=class{constructor(){this._buffer=new gI,this._waitingConsumers=new gI}push(e){let{promise:r,resolve:i}=mI();return this._buffer.push({chunk:e,resolve:i}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=mI();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var wI=b((mJ,EI)=>{"use strict";EI.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let i=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(i,r.indent.repeat(e))}});var _I=b(()=>{});var II=b((EJ,CI)=>{"use strict";var SI=_I(),xI=/\s+at.*(?:\(|\s)(.*)\)?/,aK=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,oK=typeof SI.homedir=="undefined"?"":SI.homedir();CI.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let i=r.match(xI);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!aK.test(n)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(xI,(i,n)=>i.replace(n,n.replace(oK,"~"))):r).join(`
`))});var RI=b((wJ,TI)=>{"use strict";var cK=wI(),uK=II(),lK=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),AI=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let r=e.map(i=>typeof i.stack=="string"?lK(uK(i.stack)):String(i)).join(`
`);r=`
`+cK(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};TI.exports=AI});var Sy=b((_J,_y)=>{"use strict";var wy=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},qu=class{static fn(e){return(...r)=>new qu((i,n,s)=>{r.push(s),e(...r).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,i)=>{this._reject=i;let n=o=>{(!this._isCanceled||!a.shouldReject)&&(this._isPending=!1,r(o))},s=o=>{this._isPending=!1,i(o)},a=o=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(o)};return Object.defineProperties(a,{shouldReject:{get:()=>this._rejectOnCancel,set:o=>{this._rejectOnCancel=o}}}),e(n,s,a)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new wy(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(qu.prototype,Promise.prototype);_y.exports=qu;_y.exports.CancelError=wy});var BI=b((SJ,t0)=>{"use strict";var PI=RI(),fK=Sy(),xy=class extends Error{},hK=(t,e)=>new fK((r,i,n)=>{let{count:s,filter:a=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let o=[],c=[],u=0,l=!1,f=new Set,h=()=>(o.length===s&&(r(o),l=!0),u-c.length<s&&(i(new PI(c)),l=!0),l),p=()=>{for(let d of t)!f.has(d)&&typeof d.cancel=="function"&&d.cancel()};n(p);for(let d of t)u++,(async()=>{try{let y=await d;if(l)return;if(!a(y))throw new xy("Value does not satisfy filter");o.push(y)}catch(y){c.push(y)}finally{f.add(d),!l&&h()&&p()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});t0.exports=hK;t0.exports.AggregateError=PI;t0.exports.FilterError=xy});var OI=b((xJ,Cy)=>{"use strict";var DI=BI(),dK=Sy();Cy.exports=(t,e)=>{let r=DI(t,{...e,count:1});return dK.fn(async i=>{i(()=>{r.cancel()});let[n]=await r;return n})()};Cy.exports.AggregateError=DI.AggregateError});var MI=b((CJ,LI)=>{"use strict";var pK=Ae(),{anySignal:yK}=Ey(),gK=bI(),mK=OI(),{setMaxListeners:NI}=_r(),{codes:vK}=yt(),kI=class{constructor({addrs:e,dialAction:r,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw pK(new Error("No dial tokens available"),vK.ERR_NO_DIAL_TOKENS);let i=new gK;r.forEach(a=>i.push(a));let n=this.addrs.map(()=>{let a=new AbortController;try{NI&&NI(1/0,a.signal)}catch{}return a}),s=0;try{return await mK(this.addrs.map(async(a,o)=>{let c=await i.shift(),u;try{let l=n[o].signal;u=await this.dialAction(a,{...e,signal:e.signal?yK([l,e.signal]):l}),n.splice(o,1)}finally{s++,this.addrs.length-s>=r.length?i.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{n.map(a=>a.abort()),r.forEach(a=>this.dialer.releaseToken(a))}}};LI.exports=kI});var HI=b((IJ,GI)=>{"use strict";var qI=qe(),bK=ua(),EK=la(),{pipe:wK}=kr(),Wo=Object.assign(qI("libp2p:dialer"),{error:qI("libp2p:dialer:err")}),r0=Ae(),{Multiaddr:Iy}=Pr(),{TimeoutController:_K}=vp(),{AbortError:SK}=Du(),{anySignal:xK}=Ey(),{setMaxListeners:UI}=_r(),CK=MI(),{publicAddressesFirst:IK}=Pp(),FI=xp(),KI=Kp(),{codes:Uu}=yt(),{DIAL_TIMEOUT:AK,MAX_PARALLEL_DIALS:TK,MAX_PER_PEER_DIALS:RK,MAX_ADDRS_TO_DIAL:PK}=qf(),VI="dialler",BK="pending-dials",DK="pending-dial-targets",jI=class{constructor({transportManager:e,peerStore:r,connectionGater:i,addressSorter:n=IK,maxParallelDials:s=TK,maxAddrsToDial:a=PK,dialTimeout:o=AK,maxDialsPerPeer:c=RK,resolvers:u={},metrics:l}){this.connectionGater=i,this.transportManager=e,this.peerStore=r,this.addressSorter=n,this.maxParallelDials=s,this.maxAddrsToDial=a,this.timeout=o,this.maxDialsPerPeer=c,this.tokens=[...new Array(s)].map((f,h)=>h),this._pendingDials=KI({component:VI,metric:BK,metrics:l}),this._pendingDialTargets=KI({component:VI,metric:DK,metrics:l});for(let[f,h]of Object.entries(u))Iy.resolvers.set(f,h)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){Wo.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new SK("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let{id:i}=FI(e);if(await this.connectionGater.denyDialPeer(i))throw r0(new Error("The dial request is blocked by gater.allowDialPeer"),Uu.ERR_PEER_DIAL_INTERCEPTED);let n=await this._createCancellableDialTarget(e);if(!n.addrs.length)throw r0(new Error("The dial request has no valid addresses"),Uu.ERR_NO_VALID_ADDRESSES);let s=this._pendingDials.get(n.id)||this._createPendingDial(n,r);try{let a=await s.promise;return Wo("dial succeeded to %s",n.id),a}catch(a){throw s.controller.signal.aborted&&(a.code=Uu.ERR_TIMEOUT),Wo.error(a),a}finally{s.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((n,s)=>{this._pendingDialTargets.set(r,{resolve:n,reject:s})});try{return await Promise.race([this._createDialTarget(e),i])}finally{this._pendingDialTargets.delete(r)}}async _createDialTarget(e){let{id:r,multiaddrs:i}=FI(e);i&&await this.peerStore.addressBook.add(r,i);let n=await wK(await this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter),o=>EK(o,async c=>!await this.connectionGater.denyDialMultiaddr(r,c)),o=>bK(o));Iy.isMultiaddr(e)&&(n=n.filter(o=>!e.equals(o)),n.unshift(e));let s=[];for(let o of n)(await this._resolve(o)).forEach(u=>s.push(u));let a=s.filter(o=>this.transportManager.transportForMultiaddr(o));if(a.length>this.maxAddrsToDial)throw await this.peerStore.delete(r),r0(new Error("dial with more addresses than allowed"),Uu.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:a}}_createPendingDial(e,r={}){let i=(u,l)=>{if(l.signal.aborted)throw r0(new Error("already aborted"),Uu.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},n=new CK({addrs:e.addrs,dialAction:i,dialer:this}),s=new _K(this.timeout),a=[s.signal];r.signal&&a.push(r.signal);let o=xK(a);try{UI&&UI(1/0,o)}catch{}let c={dialRequest:n,controller:s,promise:n.run({...r,signal:o}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,r);return Wo("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(Wo("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(a=>this._resolve(a)))).flat().reduce((a,o)=>(a.find(c=>c.equals(o))||a.push(o),a),[])}async _resolveRecord(e){try{return e=new Iy(e.toString()),await e.resolve()}catch(r){return Wo.error(`multiaddr ${e} could not be resolved`),[]}}};GI.exports=jI});var WI=b((AJ,zI)=>{"use strict";function OK(t){return t>=55296&&t<=56319}function NK(t){return t>=56320&&t<=57343}zI.exports=function(e,r,i){if(typeof r!="string")throw new Error("Input must be string");for(var n=r.length,s=0,a,o,c=0;c<n;c+=1){if(a=r.charCodeAt(c),o=r[c],OK(a)&&NK(r.charCodeAt(c+1))&&(c+=1,o+=r[c]),s+=e(o),s===i)return r.slice(0,c+1);if(s>i)return r.slice(0,c-o.length+1)}return r}});var YI=b((TJ,$I)=>{"use strict";function kK(t){return t>=55296&&t<=56319}function LK(t){return t>=56320&&t<=57343}$I.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,i=0,n=null,s=null,a=0;a<r;a++)n=e.charCodeAt(a),LK(n)?s!=null&&kK(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var XI=b((RJ,QI)=>{"use strict";var MK=WI(),qK=YI();QI.exports=MK.bind(null,qK)});var eA=b((PJ,JI)=>{"use strict";var UK=XI(),FK=/[\/\?<>\\:\*\|"]/g,KK=/[\x00-\x1f\x80-\x9f]/g,VK=/^\.+$/,jK=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,GK=/[\. ]+$/;function ZI(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(FK,e).replace(KK,e).replace(VK,e).replace(jK,e).replace(GK,e);return UK(r,255)}JI.exports=function(t,e){var r=e&&e.replacement||"",i=ZI(t,r);return r===""?i:ZI(i,"")}});var iA=b((BJ,rA)=>{"use strict";Fl();var i0=lt(),{toString:$o}=(yr(),Sr),{fromString:tA}=(ar(),pr);rA.exports={createCipheriv:(t,e,r)=>{let i=i0.cipher.createCipher("AES-CTR",$o(e,"ascii"));return i.start({iv:$o(r,"ascii")}),{update:n=>(i.update(i0.util.createBuffer($o(n,"ascii"))),tA(i.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let i=i0.cipher.createDecipher("AES-CTR",$o(e,"ascii"));return i.start({iv:$o(r,"ascii")}),{update:n=>(i.update(i0.util.createBuffer($o(n,"ascii"))),tA(i.output.getBytes(),"ascii"))}}}});var aA=b((DJ,sA)=>{"use strict";var HK=Ae(),nA={16:"aes-128-ctr",32:"aes-256-ctr"};sA.exports=function(t){let e=nA[t.length];if(!e){let r=Object.entries(nA).map(([i,n])=>`${i} (${n})`).join(" / ");throw HK(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var uA=b(cA=>{"use strict";var oA=iA(),zK=aA();cA.create=async function(t,e){let r=zK(t),i=oA.createCipheriv(r,t,e),n=oA.createDecipheriv(r,t,e);return{async encrypt(a){return i.update(a)},async decrypt(a){return n.update(a)}}}});var hA=b((NJ,fA)=>{"use strict";var WK=td(),$K=Xt(),YK=Ae(),lA={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function QK(t,e,r,i,n){let s=lA[n];if(!s){let o=Object.keys(lA).join(" / ");throw YK(new Error(`Hash '${n}' is unknown or not supported. Must be ${o}`),"ERR_UNSUPPORTED_HASH_TYPE")}let a=WK(t,e,r,i,s);return $K.encode64(a)}fA.exports=QK});var Fu=b(Yo=>{"use strict";var XK=Fd(),ZK=uA(),JK=vf();Yo.aes=ZK;Yo.hmac=XK;Yo.keys=JK;Yo.randomBytes=tf();Yo.pbkdf2=hA()});var nt=b((LJ,dA)=>{dA.exports={options:{usePureJavaScript:!1}}});var gA=b((MJ,yA)=>{var Ay={};yA.exports=Ay;var pA={};Ay.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(t instanceof Uint8Array))i=e7(t,e);else{var n=0,s=e.length,a=e.charAt(0),o=[0];for(n=0;n<t.length;++n){for(var c=0,u=t[n];c<o.length;++c)u+=o[c]<<8,o[c]=u%s,u=u/s|0;for(;u>0;)o.push(u%s),u=u/s|0}for(n=0;t[n]===0&&n<t.length-1;++n)i+=a;for(n=o.length-1;n>=0;--n)i+=e[o[n]]}if(r){var l=new RegExp(".{1,"+r+"}","g");i=i.match(l).join(`\r
`)}return i};Ay.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=pA[e];if(!r){r=pA[e]=[];for(var i=0;i<e.length;++i)r[e.charCodeAt(i)]=i}t=t.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),a=[0],i=0;i<t.length;i++){var o=r[t.charCodeAt(i)];if(o===void 0)return;for(var c=0,u=o;c<a.length;++c)u+=a[c]*n,a[c]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)a.push(0);return typeof Buffer!="undefined"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function e7(t,e){var r=0,i=e.length,n=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,o=t.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%i,o=o/i|0;for(;o>0;)s.push(o%i),o=o/i|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=n;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Ot=b((qJ,EA)=>{var mA=nt(),vA=gA(),B=EA.exports=mA.util=mA.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){B.nextTick=process.nextTick,typeof setImmediate=="function"?B.setImmediate=setImmediate:B.setImmediate=B.nextTick;return}if(typeof setImmediate=="function"){B.setImmediate=function(){return setImmediate.apply(void 0,arguments)},B.nextTick=function(o){return setImmediate(o)};return}if(B.setImmediate=function(o){setTimeout(o,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let o=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var a=o,t="forge.setImmediate",e=[];B.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=B.setImmediate;B.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}B.nextTick=B.setImmediate})();B.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;B.globalScope=function(){return B.isNodejs?globalThis:typeof self=="undefined"?window:self}();B.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};B.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};B.isArrayBufferView=function(t){return t&&B.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Ku(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}B.ByteBuffer=Ty;function Ty(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(B.isArrayBuffer(t)||B.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ty||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}B.ByteStringBuffer=Ty;var t7=4096;B.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>t7&&(this.data.substr(0,1),this._constructedStringLength=0)};B.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};B.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};B.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};B.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};B.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};B.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(B.encodeUtf8(t))};B.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};B.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};B.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};B.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};B.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};B.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};B.ByteStringBuffer.prototype.putInt=function(t,e){Ku(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};B.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};B.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};B.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};B.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};B.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};B.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};B.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};B.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};B.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};B.ByteStringBuffer.prototype.getInt=function(t){Ku(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};B.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};B.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};B.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};B.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};B.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};B.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};B.ByteStringBuffer.prototype.copy=function(){var t=B.createBuffer(this.data);return t.read=this.read,t};B.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};B.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};B.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};B.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};B.ByteStringBuffer.prototype.toString=function(){return B.decodeUtf8(this.bytes())};function r7(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=B.isArrayBuffer(t),i=B.isArrayBufferView(t);if(r||i){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}B.DataBuffer=r7;B.DataBuffer.prototype.length=function(){return this.write-this.read};B.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};B.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this};B.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};B.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};B.DataBuffer.prototype.putBytes=function(t,e){if(B.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=r.byteLength-r.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(r),this.write+=i,this}if(B.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof B.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&B.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var n=new Uint8Array(t.data.byteLength,this.write);return n.set(r),this.write+=r.byteLength,this}if(t instanceof B.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=B.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=B.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};B.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};B.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};B.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};B.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};B.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};B.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};B.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};B.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};B.DataBuffer.prototype.putInt=function(t,e){Ku(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};B.DataBuffer.prototype.putSignedInt=function(t,e){return Ku(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};B.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};B.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};B.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};B.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};B.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};B.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};B.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};B.DataBuffer.prototype.getInt=function(t){Ku(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};B.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};B.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};B.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};B.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};B.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};B.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};B.DataBuffer.prototype.copy=function(){return new B.DataBuffer(this)};B.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};B.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};B.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};B.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};B.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return B.binary.raw.encode(e);if(t==="hex")return B.binary.hex.encode(e);if(t==="base64")return B.binary.base64.encode(e);if(t==="utf8")return B.text.utf8.decode(e);if(t==="utf16")return B.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};B.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=B.encodeUtf8(t)),new B.ByteBuffer(t)};B.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};B.xorBytes=function(t,e,r){for(var i="",n="",s="",a=0,o=0;r>0;--r,++a)n=t.charCodeAt(a)^e.charCodeAt(a),o>=10&&(i+=s,s="",o=0),s+=String.fromCharCode(n),++o;return i+=s,i};B.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};B.bytesToHex=function(t){return B.createBuffer(t).toHex()};B.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ps=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],bA="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";B.encode64=function(t,e){for(var r="",i="",n,s,a,o=0;o<t.length;)n=t.charCodeAt(o++),s=t.charCodeAt(o++),a=t.charCodeAt(o++),r+=Rs.charAt(n>>2),r+=Rs.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Rs.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Rs.charAt(a&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};B.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,i,n,s,a=0;a<t.length;)r=Ps[t.charCodeAt(a++)-43],i=Ps[t.charCodeAt(a++)-43],n=Ps[t.charCodeAt(a++)-43],s=Ps[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};B.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};B.decodeUtf8=function(t){return decodeURIComponent(escape(t))};B.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:vA.encode,decode:vA.decode}};B.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};B.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};B.binary.hex.encode=B.bytesToHex;B.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var n=0,s=r;for(t.length&1&&(n=1,i[s++]=parseInt(t[0],16));n<t.length;n+=2)i[s++]=parseInt(t.substr(n,2),16);return e?s-r:i};B.binary.base64.encode=function(t,e){for(var r="",i="",n,s,a,o=0;o<t.byteLength;)n=t[o++],s=t[o++],a=t[o++],r+=Rs.charAt(n>>2),r+=Rs.charAt((n&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Rs.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Rs.charAt(a&63)),e&&r.length>e&&(i+=r.substr(0,e)+`\r
`,r=r.substr(e));return i+=r,i};B.binary.base64.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var n,s,a,o,c=0,u=r;c<t.length;)n=Ps[t.charCodeAt(c++)-43],s=Ps[t.charCodeAt(c++)-43],a=Ps[t.charCodeAt(c++)-43],o=Ps[t.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,a!==64&&(i[u++]=(s&15)<<4|a>>2,o!==64&&(i[u++]=(a&3)<<6|o));return e?u-r:i.subarray(0,u)};B.binary.base58.encode=function(t,e){return B.binary.baseN.encode(t,bA,e)};B.binary.base58.decode=function(t,e){return B.binary.baseN.decode(t,bA,e)};B.text={utf8:{},utf16:{}};B.text.utf8.encode=function(t,e,r){t=B.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length)),r=r||0;for(var n=r,s=0;s<t.length;++s)i[n++]=t.charCodeAt(s);return e?n-r:i};B.text.utf8.decode=function(t){return B.decodeUtf8(String.fromCharCode.apply(null,t))};B.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length*2));var n=new Uint16Array(i.buffer);r=r||0;for(var s=r,a=r,o=0;o<t.length;++o)n[a++]=t.charCodeAt(o),s+=2;return e?s-r:i};B.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};B.deflate=function(t,e,r){if(e=B.decode64(t.deflate(B.encode64(e)).rval),r){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};B.inflate=function(t,e,r){var i=t.inflate(B.encode64(e)).rval;return i===null?null:B.decode64(i)};var Ry=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(r===null?i=t.removeItem(e):(r=B.encode64(JSON.stringify(r)),i=t.setItem(e,r)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},Py=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(B.decode64(r))),r},i7=function(t,e,r,i){var n=Py(t,e);n===null&&(n={}),n[r]=i,Ry(t,e,n)},n7=function(t,e,r){var i=Py(t,e);return i!==null&&(i=r in i?i[r]:null),i},s7=function(t,e,r){var i=Py(t,e);if(i!==null&&r in i){delete i[r];var n=!0;for(var s in i){n=!1;break}n&&(i=null),Ry(t,e,i)}},a7=function(t,e){Ry(t,e,null)},n0=function(t,e,r){var i=null;typeof r=="undefined"&&(r=["web","flash"]);var n,s=!1,a=null;for(var o in r){n=r[o];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=t.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=t.apply(this,e),s=!0)}catch(c){a=c}if(s)break}if(!s)throw a;return i};B.setItem=function(t,e,r,i,n){n0(i7,arguments,n)};B.getItem=function(t,e,r,i){return n0(n7,arguments,i)};B.removeItem=function(t,e,r,i){n0(s7,arguments,i)};B.clearItems=function(t,e,r){n0(a7,arguments,r)};B.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};B.format=function(t){for(var e=/%./g,r,i,n=0,s=[],a=0;r=e.exec(t);){i=t.substring(a,e.lastIndex-2),i.length>0&&s.push(i),a=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(t.substring(a)),s.join("")};B.formatNumber=function(t,e,r,i){var n=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,o=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+o:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(n-u).toFixed(s).slice(2):"")};B.formatSize=function(t){return t>=1073741824?t=B.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=B.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=B.formatNumber(t/1024,0)+" KiB":t=B.formatNumber(t,0)+" bytes",t};B.bytesFromIP=function(t){return t.indexOf(".")!==-1?B.bytesFromIPv4(t):t.indexOf(":")!==-1?B.bytesFromIPv6(t):null};B.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=B.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};B.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,i=B.createBuffer(),n=0;n<8;++n){if(!t[n]||t[n].length===0){i.fillWithByte(0,r),r=0;continue}var s=B.hexToBytes(t[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};B.bytesToIP=function(t){return t.length===4?B.bytesToIPv4(t):t.length===16?B.bytesToIPv6(t):null};B.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};B.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var s=B.bytesToHex(t[n]+t[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=e.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[i].end-r[i].start&&(i=r.length-1))}e.push(s)}if(r.length>0){var c=r[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};B.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in B&&!t.update)return e(null,B.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return B.cores=navigator.hardwareConcurrency,e(null,B.cores);if(typeof Worker=="undefined")return B.cores=1,e(null,B.cores);if(typeof Blob=="undefined")return B.cores=2,e(null,B.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),c=o+4;Date.now()<c;);self.postMessage({st:o,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(a,o,c){if(o===0){var u=Math.floor(a.reduce(function(l,f){return l+f},0)/a.length);return B.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,B.cores)}n(c,function(l,f){a.push(s(c,f)),i(a,o-1,c)})}function n(a,o){for(var c=[],u=[],l=0;l<a;++l){var f=new Worker(r);f.addEventListener("message",function(h){if(u.push(h.data),u.length===a){for(var p=0;p<a;++p)c[p].terminate();o(null,u)}}),c.push(f)}for(var l=0;l<a;++l)c[l].postMessage(l)}function s(a,o){for(var c=[],u=0;u<a;++u)for(var l=o[u],f=c[u]=[],h=0;h<a;++h)if(u!==h){var p=o[h];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&f.push(h)}return c.reduce(function(d,y){return Math.max(d,y.length)},0)}}});var Dy=b((UJ,wA)=>{var vr=nt();Ot();wA.exports=vr.cipher=vr.cipher||{};vr.cipher.algorithms=vr.cipher.algorithms||{};vr.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=vr.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new vr.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};vr.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=vr.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new vr.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};vr.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),vr.cipher.algorithms[t]=e};vr.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in vr.cipher.algorithms?vr.cipher.algorithms[t]:null};var By=vr.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};By.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=vr.util.createBuffer(),this.output=t.output||vr.util.createBuffer(),this.mode.start(e)};By.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};By.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Ny=b((FJ,_A)=>{var br=nt();Ot();br.cipher=br.cipher||{};var Ke=_A.exports=br.cipher.modes=br.cipher.modes||{};Ke.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ke.ecb.prototype.start=function(t){};Ke.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Ke.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Ke.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ke.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};Ke.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ke.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=s0(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ke.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};Ke.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};Ke.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ke.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),i=t.at(r-1);return i>this.blockSize<<2?!1:(t.truncate(i),!0)};Ke.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=br.util.createBuffer(),this._partialBytes=0};Ke.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=s0(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ke.cfb.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ke.cfb.prototype.decrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ke.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=br.util.createBuffer(),this._partialBytes=0};Ke.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=s0(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ke.ofb.prototype.encrypt=function(t,e,r){var i=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0)t.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Ke.ofb.prototype.decrypt=Ke.ofb.prototype.encrypt;Ke.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=br.util.createBuffer(),this._partialBytes=0};Ke.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=s0(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ke.ctr.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(t.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}a0(this._inBlock)};Ke.ctr.prototype.decrypt=Ke.ctr.prototype.encrypt;Ke.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=br.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ke.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=br.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=br.util.createBuffer(t.additionalData):r=br.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=br.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Oy(i*8)))}this._inBlock=this._j0.slice(0),a0(this._inBlock),this._partialBytes=0,r=br.util.createBuffer(r),this._aDataLength=Oy(r.length()*8);var n=r.length()%this.blockSize;for(n&&r.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Ke.gcm.prototype.encrypt=function(t,e,r){var i=t.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(t.getInt32()^this._outBlock[n]);if(s<=0||r){if(r){var a=i%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),a0(this._inBlock)};Ke.gcm.prototype.decrypt=function(t,e,r){var i=t.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),a0(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};Ke.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=br.util.createBuffer();var i=this._aDataLength.concat(Oy(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Ke.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=t[n/32|0]&1<<31-n%32;s&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i)}return r};Ke.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,i=3;i>0;--i)e[i]=t[i]>>>1|(t[i-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Ke.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var i=r/8|0,n=t[i]>>>(7-r%8)*4&15,s=this._m[r][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Ke.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Ke.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,i=4*r,n=16*r,s=new Array(n),a=0;a<n;++a){var o=[0,0,0,0],c=a/i|0,u=(i-1-a%i)*e;o[c]=1<<e-1<<u,s[a]=this.generateSubHashTable(this.multiply(o,t),e)}return s};Ke.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,i=r>>>1,n=new Array(r);n[i]=t.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var a=1;a<s;++a){var o=n[s],c=n[a];n[s+a]=[o[0]^c[0],o[1]^c[1],o[2]^c[2],o[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<r;++s){var u=n[s^i];n[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return n};function s0(t,e){if(typeof t=="string"&&(t=br.util.createBuffer(t)),br.util.isArray(t)&&t.length>4){var r=t;t=br.util.createBuffer();for(var i=0;i<r.length;++i)t.putByte(r[i])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!br.util.isArray(t)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(t.getInt32());t=n}return t}function a0(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Oy(t){return[t/4294967296|0,t&4294967295]}});var Vu=b((KJ,IA)=>{var Et=nt();Dy();Ny();Ot();IA.exports=Et.aes=Et.aes||{};Et.aes.startEncrypting=function(t,e,r,i){var n=o0({key:t,output:r,decrypt:!1,mode:i});return n.start(e),n};Et.aes.createEncryptionCipher=function(t,e){return o0({key:t,output:null,decrypt:!1,mode:e})};Et.aes.startDecrypting=function(t,e,r,i){var n=o0({key:t,output:r,decrypt:!0,mode:i});return n.start(e),n};Et.aes.createDecryptionCipher=function(t,e){return o0({key:t,output:null,decrypt:!0,mode:e})};Et.aes.Algorithm=function(t,e){ky||xA();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return My(r._w,i,n,!1)},decrypt:function(i,n){return My(r._w,i,n,!0)}}}),r._init=!1};Et.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Et.util.createBuffer(e);else if(Et.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Et.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(!Et.util.isArray(e)){r=e,e=[];var n=r.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(r.getInt32())}}if(!Et.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=CA(e,t.decrypt&&!a),this._init=!0}};Et.aes._expandKey=function(t,e){return ky||xA(),CA(t,e)};Et.aes._updateBlock=My;Qo("AES-ECB",Et.cipher.modes.ecb);Qo("AES-CBC",Et.cipher.modes.cbc);Qo("AES-CFB",Et.cipher.modes.cfb);Qo("AES-OFB",Et.cipher.modes.ofb);Qo("AES-CTR",Et.cipher.modes.ctr);Qo("AES-GCM",Et.cipher.modes.gcm);function Qo(t,e){var r=function(){return new Et.aes.Algorithm(t,e)};Et.cipher.registerAlgorithm(t,r)}var ky=!1,Xo=4,Ur,Ly,SA,Aa,Hi;function xA(){ky=!0,SA=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ur=new Array(256),Ly=new Array(256),Aa=new Array(4),Hi=new Array(4);for(var e=0;e<4;++e)Aa[e]=new Array(256),Hi[e]=new Array(256);for(var r=0,i=0,n,s,a,o,c,u,l,e=0;e<256;++e){o=i^i<<1^i<<2^i<<3^i<<4,o=o>>8^o&255^99,Ur[r]=o,Ly[o]=r,c=t[o],n=t[r],s=t[n],a=t[s],u=c<<24^o<<16^o<<8^(o^c),l=(n^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^n^a);for(var f=0;f<4;++f)Aa[f][r]=u,Hi[f][o]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=i=1:(r=n^t[t[t[n^a]]],i^=t[t[i]])}}function CA(t,e){for(var r=t.slice(0),i,n=1,s=r.length,a=s+6+1,o=Xo*a,c=s;c<o;++c)i=r[c-1],c%s==0?(i=Ur[i>>>16&255]<<24^Ur[i>>>8&255]<<16^Ur[i&255]<<8^Ur[i>>>24]^SA[n]<<24,n++):s>6&&c%s==4&&(i=Ur[i>>>24]<<24^Ur[i>>>16&255]<<16^Ur[i>>>8&255]<<8^Ur[i&255]),r[c]=r[c-s]^i;if(e){var u,l=Hi[0],f=Hi[1],h=Hi[2],p=Hi[3],d=r.slice(0);o=r.length;for(var c=0,y=o-Xo;c<o;c+=Xo,y-=Xo)if(c===0||c===o-Xo)d[c]=r[y],d[c+1]=r[y+3],d[c+2]=r[y+2],d[c+3]=r[y+1];else for(var g=0;g<Xo;++g)u=r[y+g],d[c+(3&-g)]=l[Ur[u>>>24]]^f[Ur[u>>>16&255]]^h[Ur[u>>>8&255]]^p[Ur[u&255]];r=d}return r}function My(t,e,r,i){var n=t.length/4-1,s,a,o,c,u;i?(s=Hi[0],a=Hi[1],o=Hi[2],c=Hi[3],u=Ly):(s=Aa[0],a=Aa[1],o=Aa[2],c=Aa[3],u=Ur);var l,f,h,p,d,y,g;l=e[0]^t[0],f=e[i?3:1]^t[1],h=e[2]^t[2],p=e[i?1:3]^t[3];for(var m=3,w=1;w<n;++w)d=s[l>>>24]^a[f>>>16&255]^o[h>>>8&255]^c[p&255]^t[++m],y=s[f>>>24]^a[h>>>16&255]^o[p>>>8&255]^c[l&255]^t[++m],g=s[h>>>24]^a[p>>>16&255]^o[l>>>8&255]^c[f&255]^t[++m],p=s[p>>>24]^a[l>>>16&255]^o[f>>>8&255]^c[h&255]^t[++m],l=d,f=y,h=g;r[0]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^t[++m],r[i?3:1]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^t[++m],r[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[f&255]^t[++m],r[i?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[h&255]^t[++m]}function o0(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,i;t.decrypt?i=Et.cipher.createDecipher(r,t.key):i=Et.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,a){var o=null;a instanceof Et.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,n.call(i,a)},i}});var Zo=b((VJ,AA)=>{var ju=nt();ju.pki=ju.pki||{};var qy=AA.exports=ju.pki.oids=ju.oids=ju.oids||{};function ee(t,e){qy[t]=e,qy[e]=t}function ot(t,e){qy[t]=e}ee("1.2.840.113549.1.1.1","rsaEncryption");ee("1.2.840.113549.1.1.4","md5WithRSAEncryption");ee("1.2.840.113549.1.1.5","sha1WithRSAEncryption");ee("1.2.840.113549.1.1.7","RSAES-OAEP");ee("1.2.840.113549.1.1.8","mgf1");ee("1.2.840.113549.1.1.9","pSpecified");ee("1.2.840.113549.1.1.10","RSASSA-PSS");ee("1.2.840.113549.1.1.11","sha256WithRSAEncryption");ee("1.2.840.113549.1.1.12","sha384WithRSAEncryption");ee("1.2.840.113549.1.1.13","sha512WithRSAEncryption");ee("1.3.101.112","EdDSA25519");ee("1.2.840.10040.4.3","dsa-with-sha1");ee("1.3.14.3.2.7","desCBC");ee("1.3.14.3.2.26","sha1");ee("1.3.14.3.2.29","sha1WithRSASignature");ee("2.16.840.1.101.3.4.2.1","sha256");ee("2.16.840.1.101.3.4.2.2","sha384");ee("2.16.840.1.101.3.4.2.3","sha512");ee("2.16.840.1.101.3.4.2.4","sha224");ee("2.16.840.1.101.3.4.2.5","sha512-224");ee("2.16.840.1.101.3.4.2.6","sha512-256");ee("1.2.840.113549.2.2","md2");ee("1.2.840.113549.2.5","md5");ee("1.2.840.113549.1.7.1","data");ee("1.2.840.113549.1.7.2","signedData");ee("1.2.840.113549.1.7.3","envelopedData");ee("1.2.840.113549.1.7.4","signedAndEnvelopedData");ee("1.2.840.113549.1.7.5","digestedData");ee("1.2.840.113549.1.7.6","encryptedData");ee("1.2.840.113549.1.9.1","emailAddress");ee("1.2.840.113549.1.9.2","unstructuredName");ee("1.2.840.113549.1.9.3","contentType");ee("1.2.840.113549.1.9.4","messageDigest");ee("1.2.840.113549.1.9.5","signingTime");ee("1.2.840.113549.1.9.6","counterSignature");ee("1.2.840.113549.1.9.7","challengePassword");ee("1.2.840.113549.1.9.8","unstructuredAddress");ee("1.2.840.113549.1.9.14","extensionRequest");ee("1.2.840.113549.1.9.20","friendlyName");ee("1.2.840.113549.1.9.21","localKeyId");ee("1.2.840.113549.1.9.22.1","x509Certificate");ee("1.2.840.113549.1.12.10.1.1","keyBag");ee("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");ee("1.2.840.113549.1.12.10.1.3","certBag");ee("1.2.840.113549.1.12.10.1.4","crlBag");ee("1.2.840.113549.1.12.10.1.5","secretBag");ee("1.2.840.113549.1.12.10.1.6","safeContentsBag");ee("1.2.840.113549.1.5.13","pkcs5PBES2");ee("1.2.840.113549.1.5.12","pkcs5PBKDF2");ee("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");ee("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");ee("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");ee("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");ee("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");ee("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");ee("1.2.840.113549.2.7","hmacWithSHA1");ee("1.2.840.113549.2.8","hmacWithSHA224");ee("1.2.840.113549.2.9","hmacWithSHA256");ee("1.2.840.113549.2.10","hmacWithSHA384");ee("1.2.840.113549.2.11","hmacWithSHA512");ee("1.2.840.113549.3.7","des-EDE3-CBC");ee("2.16.840.1.101.3.4.1.2","aes128-CBC");ee("2.16.840.1.101.3.4.1.22","aes192-CBC");ee("2.16.840.1.101.3.4.1.42","aes256-CBC");ee("2.5.4.3","commonName");ee("2.5.4.4","surname");ee("2.5.4.5","serialNumber");ee("2.5.4.6","countryName");ee("2.5.4.7","localityName");ee("2.5.4.8","stateOrProvinceName");ee("2.5.4.9","streetAddress");ee("2.5.4.10","organizationName");ee("2.5.4.11","organizationalUnitName");ee("2.5.4.12","title");ee("2.5.4.13","description");ee("2.5.4.15","businessCategory");ee("2.5.4.17","postalCode");ee("2.5.4.42","givenName");ee("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");ee("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");ee("2.16.840.1.113730.1.1","nsCertType");ee("2.16.840.1.113730.1.13","nsComment");ot("2.5.29.1","authorityKeyIdentifier");ot("2.5.29.2","keyAttributes");ot("2.5.29.3","certificatePolicies");ot("2.5.29.4","keyUsageRestriction");ot("2.5.29.5","policyMapping");ot("2.5.29.6","subtreesConstraint");ot("2.5.29.7","subjectAltName");ot("2.5.29.8","issuerAltName");ot("2.5.29.9","subjectDirectoryAttributes");ot("2.5.29.10","basicConstraints");ot("2.5.29.11","nameConstraints");ot("2.5.29.12","policyConstraints");ot("2.5.29.13","basicConstraints");ee("2.5.29.14","subjectKeyIdentifier");ee("2.5.29.15","keyUsage");ot("2.5.29.16","privateKeyUsagePeriod");ee("2.5.29.17","subjectAltName");ee("2.5.29.18","issuerAltName");ee("2.5.29.19","basicConstraints");ot("2.5.29.20","cRLNumber");ot("2.5.29.21","cRLReason");ot("2.5.29.22","expirationDate");ot("2.5.29.23","instructionCode");ot("2.5.29.24","invalidityDate");ot("2.5.29.25","cRLDistributionPoints");ot("2.5.29.26","issuingDistributionPoint");ot("2.5.29.27","deltaCRLIndicator");ot("2.5.29.28","issuingDistributionPoint");ot("2.5.29.29","certificateIssuer");ot("2.5.29.30","nameConstraints");ee("2.5.29.31","cRLDistributionPoints");ee("2.5.29.32","certificatePolicies");ot("2.5.29.33","policyMappings");ot("2.5.29.34","policyConstraints");ee("2.5.29.35","authorityKeyIdentifier");ot("2.5.29.36","policyConstraints");ee("2.5.29.37","extKeyUsage");ot("2.5.29.46","freshestCRL");ot("2.5.29.54","inhibitAnyPolicy");ee("1.3.6.1.4.1.11129.2.4.2","timestampList");ee("1.3.6.1.5.5.7.1.1","authorityInfoAccess");ee("1.3.6.1.5.5.7.3.1","serverAuth");ee("1.3.6.1.5.5.7.3.2","clientAuth");ee("1.3.6.1.5.5.7.3.3","codeSigning");ee("1.3.6.1.5.5.7.3.4","emailProtection");ee("1.3.6.1.5.5.7.3.8","timeStamping")});var Jo=b((jJ,RA)=>{var It=nt();Ot();Zo();var ce=RA.exports=It.asn1=It.asn1||{};ce.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ce.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ce.create=function(t,e,r,i,n){if(It.util.isArray(i)){for(var s=[],a=0;a<i.length;++a)i[a]!==void 0&&s.push(i[a]);i=s}var o={tagClass:t,type:e,constructed:r,composed:r||It.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(o.bitStringContents=n.bitStringContents,o.original=ce.copy(o)),o};ce.copy=function(t,e){var r;if(It.util.isArray(t)){r=[];for(var i=0;i<t.length;++i)r.push(ce.copy(t[i],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:ce.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};ce.equals=function(t,e,r){if(It.util.isArray(t)){if(!It.util.isArray(e)||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!ce.equals(t[i],e[i]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var n=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&ce.equals(t.value,e.value);return r&&r.includeBitStringContents&&(n=n&&t.bitStringContents===e.bitStringContents),n};ce.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,i=e&128;return i?r=t.getInt((e&127)<<3):r=e,r}};function Gu(t,e,r){if(r>e){var i=new Error("Too few bytes to parse DER.");throw i.available=t.length(),i.remaining=e,i.requested=r,i}}var o7=function(t,e){var r=t.getByte();if(e--,r!==128){var i,n=r&128;if(!n)i=r;else{var s=r&127;Gu(t,e,s),i=t.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};ce.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=It.util.createBuffer(t));var r=t.length(),i=c0(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var n=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw n.byteCount=r,n.remaining=t.length(),n}return i};function c0(t,e,r,i){var n;Gu(t,e,2);var s=t.getByte();e--;var a=s&192,o=s&31;n=t.length();var c=o7(t,e);if(e-=n-t.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,f,h=(s&32)==32;if(h)if(l=[],c===void 0)for(;;){if(Gu(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}n=t.length(),l.push(c0(t,e,r+1,i)),e-=n-t.length()}else for(;c>0;)n=t.length(),l.push(c0(t,c,r+1,i)),e-=n-t.length(),c-=n-t.length();if(l===void 0&&a===ce.Class.UNIVERSAL&&o===ce.Type.BITSTRING&&(f=t.bytes(c)),l===void 0&&i.decodeBitStrings&&a===ce.Class.UNIVERSAL&&o===ce.Type.BITSTRING&&c>1){var p=t.read,d=e,y=0;if(o===ce.Type.BITSTRING&&(Gu(t,e,1),y=t.getByte(),e--),y===0)try{n=t.length();var g={strict:!0,decodeBitStrings:!0},m=c0(t,e,r+1,g),w=n-t.length();e-=w,o==ce.Type.BITSTRING&&w++;var C=m.tagClass;w===c&&(C===ce.Class.UNIVERSAL||C===ce.Class.CONTEXT_SPECIFIC)&&(l=[m])}catch(T){}l===void 0&&(t.read=p,e=d)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(o===ce.Type.BMPSTRING)for(l="";c>0;c-=2)Gu(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c),e-=c}var V=f===void 0?null:{bitStringContents:f};return ce.create(a,o,h,l,V)}ce.toDer=function(t){var e=It.util.createBuffer(),r=t.tagClass|t.type,i=It.util.createBuffer(),n=!1;if("bitStringContents"in t&&(n=!0,t.original&&(n=ce.equals(t,t.original))),n)i.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:i.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&i.putBuffer(ce.toDer(t.value[s]))}else if(t.type===ce.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)i.putInt16(t.value.charCodeAt(s));else t.type===ce.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?i.putBytes(t.value.substr(1)):i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(i.length()&127);else{var a=i.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)e.putByte(o.charCodeAt(s))}return e.putBuffer(i),e};ce.oidToDer=function(t){var e=t.split("."),r=It.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,a,o=2;o<e.length;++o){i=!0,n=[],s=parseInt(e[o],10);do a=s&127,s=s>>>7,i||(a|=128),n.push(a),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)r.putByte(n[c])}return r};ce.derToOid=function(t){var e;typeof t=="string"&&(t=It.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var i=0;t.length()>0;)r=t.getByte(),i=i<<7,r&128?i+=r&127:(e+="."+(i+r),i=0);return e};ce.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var i=parseInt(t.substr(2,2),10)-1,n=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(o=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,i,n),e.setUTCHours(s,a,o,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),f=parseInt(t.substr(u+4,2),10),h=l*60+f;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};ce.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),i=parseInt(t.substr(4,2),10)-1,n=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var f=t.length-5,h=t.charAt(f);if(h==="+"||h==="-"){var p=parseInt(t.substr(f+1,2),10),d=parseInt(t.substr(f+4,2),10);u=p*60+d,u*=6e4,h==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,i,n),e.setUTCHours(s,a,o,c),e.setTime(+e+u)):(e.setFullYear(r,i,n),e.setHours(s,a,o,c)),e};ce.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};ce.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var i=0;i<r.length;++i)r[i].length<2&&(e+="0"),e+=r[i];return e+="Z",e};ce.integerToDer=function(t){var e=It.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};ce.derToInteger=function(t){typeof t=="string"&&(t=It.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};ce.validate=function(t,e,r,i){var n=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&It.util.isArray(e.value))for(var s=0,a=0;n&&a<e.value.length;++a)n=e.value[a].optional||!1,t.value[s]&&(n=ce.validate(t.value[s],e.value[a],r,i),n?++s:e.value[a].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(n&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else i&&(t.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return n};var TA=/[^\\u0000-\\u00ff]/;ce.prettyPrint=function(t,e,r){var i="";e=e||0,r=r||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*r;++s)n+=" ";switch(i+=n+"Tag: ",t.tagClass){case ce.Class.UNIVERSAL:i+="Universal:";break;case ce.Class.APPLICATION:i+="Application:";break;case ce.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case ce.Class.PRIVATE:i+="Private:";break}if(t.tagClass===ce.Class.UNIVERSAL)switch(i+=t.type,t.type){case ce.Type.NONE:i+=" (None)";break;case ce.Type.BOOLEAN:i+=" (Boolean)";break;case ce.Type.INTEGER:i+=" (Integer)";break;case ce.Type.BITSTRING:i+=" (Bit string)";break;case ce.Type.OCTETSTRING:i+=" (Octet string)";break;case ce.Type.NULL:i+=" (Null)";break;case ce.Type.OID:i+=" (Object Identifier)";break;case ce.Type.ODESC:i+=" (Object Descriptor)";break;case ce.Type.EXTERNAL:i+=" (External or Instance of)";break;case ce.Type.REAL:i+=" (Real)";break;case ce.Type.ENUMERATED:i+=" (Enumerated)";break;case ce.Type.EMBEDDED:i+=" (Embedded PDV)";break;case ce.Type.UTF8:i+=" (UTF8)";break;case ce.Type.ROID:i+=" (Relative Object Identifier)";break;case ce.Type.SEQUENCE:i+=" (Sequence)";break;case ce.Type.SET:i+=" (Set)";break;case ce.Type.PRINTABLESTRING:i+=" (Printable String)";break;case ce.Type.IA5String:i+=" (IA5String (ASCII))";break;case ce.Type.UTCTIME:i+=" (UTC time)";break;case ce.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case ce.Type.BMPSTRING:i+=" (BMP String)";break}else i+=t.type;if(i+=`
`,i+=n+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,o="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,o+=ce.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(o+=","));i+=n+"Sub values: "+a+o}else{if(i+=n+"Value: ",t.type===ce.Type.OID){var c=ce.derToOid(t.value);i+=c,It.pki&&It.pki.oids&&c in It.pki.oids&&(i+=" ("+It.pki.oids[c]+") ")}if(t.type===ce.Type.INTEGER)try{i+=ce.derToInteger(t.value)}catch(l){i+="0x"+It.util.bytesToHex(t.value)}else if(t.type===ce.Type.BITSTRING){if(t.value.length>1?i+="0x"+It.util.bytesToHex(t.value.slice(1)):i+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else if(t.type===ce.Type.OCTETSTRING)TA.test(t.value)||(i+="("+t.value+") "),i+="0x"+It.util.bytesToHex(t.value);else if(t.type===ce.Type.UTF8)try{i+=It.util.decodeUtf8(t.value)}catch(l){if(l.message==="URI malformed")i+="0x"+It.util.bytesToHex(t.value)+" (malformed UTF8)";else throw l}else t.type===ce.Type.PRINTABLESTRING||t.type===ce.Type.IA5String?i+=t.value:TA.test(t.value)?i+="0x"+It.util.bytesToHex(t.value):t.value.length===0?i+="[null]":i+=t.value}return i}});var l0=b((GJ,BA)=>{var Nt=nt();Dy();Ny();Ot();BA.exports=Nt.des=Nt.des||{};Nt.des.startEncrypting=function(t,e,r,i){var n=u0({key:t,output:r,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Nt.des.createEncryptionCipher=function(t,e){return u0({key:t,output:null,decrypt:!1,mode:e})};Nt.des.startDecrypting=function(t,e,r,i){var n=u0({key:t,output:r,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};Nt.des.createDecryptionCipher=function(t,e){return u0({key:t,output:null,decrypt:!0,mode:e})};Nt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return PA(r._keys,i,n,!1)},decrypt:function(i,n){return PA(r._keys,i,n,!0)}}}),r._init=!1};Nt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Nt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=g7(e),this._init=!0}};En("DES-ECB",Nt.cipher.modes.ecb);En("DES-CBC",Nt.cipher.modes.cbc);En("DES-CFB",Nt.cipher.modes.cfb);En("DES-OFB",Nt.cipher.modes.ofb);En("DES-CTR",Nt.cipher.modes.ctr);En("3DES-ECB",Nt.cipher.modes.ecb);En("3DES-CBC",Nt.cipher.modes.cbc);En("3DES-CFB",Nt.cipher.modes.cfb);En("3DES-OFB",Nt.cipher.modes.ofb);En("3DES-CTR",Nt.cipher.modes.ctr);function En(t,e){var r=function(){return new Nt.des.Algorithm(t,e)};Nt.cipher.registerAlgorithm(t,r)}var c7=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],u7=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],l7=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],f7=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h7=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],d7=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],p7=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y7=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function g7(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,g=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,C,V=0;V<y;V++){var T=t.getInt32(),A=t.getInt32();C=(T>>>4^A)&252645135,A^=C,T^=C<<4,C=(A>>>-16^T)&65535,T^=C,A^=C<<-16,C=(T>>>2^A)&858993459,A^=C,T^=C<<2,C=(A>>>-16^T)&65535,T^=C,A^=C<<-16,C=(T>>>1^A)&1431655765,A^=C,T^=C<<1,C=(A>>>8^T)&16711935,T^=C,A^=C<<8,C=(T>>>1^A)&1431655765,A^=C,T^=C<<1,C=T<<8|A>>>20&240,T=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=C;for(var te=0;te<m.length;++te){m[te]?(T=T<<2|T>>>26,A=A<<2|A>>>26):(T=T<<1|T>>>27,A=A<<1|A>>>27),T&=-15,A&=-15;var ie=e[T>>>28]|r[T>>>24&15]|i[T>>>20&15]|n[T>>>16&15]|s[T>>>12&15]|a[T>>>8&15]|o[T>>>4&15],$=c[A>>>28]|u[A>>>24&15]|l[A>>>20&15]|f[A>>>16&15]|h[A>>>12&15]|p[A>>>8&15]|d[A>>>4&15];C=($>>>16^ie)&65535,g[w++]=ie^C,g[w++]=$^C<<16}}return g}function PA(t,e,r,i){var n=t.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=e[0],c=e[1];a=(o>>>4^c)&252645135,c^=a,o^=a<<4,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,o=o<<1|o>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var l=s[u+1],f=s[u+2],h=s[u];h!=l;h+=f){var p=c^t[h],d=(c>>>4|c<<28)^t[h+1];a=o,o=c,c=a^(u7[p>>>24&63]|f7[p>>>16&63]|d7[p>>>8&63]|y7[p&63]|c7[d>>>24&63]|l7[d>>>16&63]|h7[d>>>8&63]|p7[d&63])}a=o,o=c,c=a}o=o>>>1|o<<31,c=c>>>1|c<<31,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(o>>>4^c)&252645135,c^=a,o^=a<<4,r[0]=o,r[1]=c}function u0(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,i;t.decrypt?i=Nt.cipher.createDecipher(r,t.key):i=Nt.cipher.createCipher(r,t.key);var n=i.start;return i.start=function(s,a){var o=null;a instanceof Nt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,n.call(i,a)},i}});var d0=b((HJ,OA)=>{var f0=nt();Ot();var DA=OA.exports=f0.pem=f0.pem||{};DA.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,i;if(t.procType&&(i={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=h0(i)),t.contentDomain&&(i={name:"Content-Domain",values:[t.contentDomain]},r+=h0(i)),t.dekInfo&&(i={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&i.values.push(t.dekInfo.parameters),r+=h0(i)),t.headers)for(var n=0;n<t.headers.length;++n)r+=h0(t.headers[n]);return t.procType&&(r+=`\r
`),r+=f0.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};DA.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:f0.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var c=s[2].split(n),u=0;s&&u<c.length;){for(var l=c[u].replace(/\s+$/,""),f=u+1;f<c.length;++f){var h=c[f];if(!/\s/.test(h[0]))break;l+=h,u=f}if(s=l.match(i),s){for(var p={name:s[1],values:[]},d=s[2].split(","),y=0;y<d.length;++y)p.values.push(m7(d[y]));if(o.procType)if(!o.contentDomain&&p.name==="Content-Domain")o.contentDomain=d[0]||"";else if(!o.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else o.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:d[0],type:d[1]}}}++u}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function h0(t){for(var e=t.name+": ",r=[],i=function(c,u){return" "+u},n=0;n<t.values.length;++n)r.push(t.values[n].replace(/^(\S+\r\n)/,i));e+=r.join(",")+`\r
`;for(var s=0,a=-1,n=0;n<e.length;++n,++s)if(s>65&&a!==-1){var o=e[a];o===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+o+e.substr(a+1),s=n-a-1,a=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(a=n);return e}function m7(t){return t.replace(/^\s+/,"")}});var MA=b((zJ,LA)=>{var ec=nt();Jo();Ot();var ue=ec.asn1,tc=LA.exports=ec.pkcs7asn1=ec.pkcs7asn1||{};ec.pkcs7=ec.pkcs7||{};ec.pkcs7.asn1=tc;var NA={name:"ContentInfo",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:ue.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};tc.contentInfoValidator=NA;var kA={name:"EncryptedContentInfo",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:ue.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:ue.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};tc.envelopedDataValidator={name:"EnvelopedData",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(kA)};tc.encryptedDataValidator={name:"EncryptedData",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1,capture:"version"}].concat(kA)};var v7={name:"SignerInfo",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:ue.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:ue.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:ue.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};tc.signedDataValidator={name:"SignedData",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},NA,{name:"SignedData.Certificates",tagClass:ue.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:ue.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SET,capture:"signerInfos",optional:!0,value:[v7]}]};tc.recipientInfoValidator={name:"RecipientInfo",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:ue.Class.UNIVERSAL,type:ue.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:ue.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:ue.Class.UNIVERSAL,type:ue.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var Bs=b((WJ,qA)=>{var p0=nt();qA.exports=p0.md=p0.md||{};p0.md.algorithms=p0.md.algorithms||{}});var GA=b(($J,jA)=>{var wn=nt();Bs();Ot();var UA=jA.exports=wn.sha256=wn.sha256||{};wn.md.sha256=wn.md.algorithms.sha256=UA;UA.create=function(){FA||b7();var t=null,e=wn.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=wn.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=wn.util.encodeUtf8(n));var a=n.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=i.fullMessageLength.length-1;o>=0;--o)i.fullMessageLength[o]+=a[1],a[1]=a[0]+(i.fullMessageLength[o]/4294967296>>>0),i.fullMessageLength[o]=i.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(n),VA(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=wn.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,a=s&i.blockLength-1;n.putBytes(Uy.substr(0,i.blockLength-a));for(var o,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)o=i.fullMessageLength[l+1]*8,c=o/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=o>>>0;n.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};VA(f,r,n);var h=wn.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h.putInt32(f.h5),h.putInt32(f.h6),h.putInt32(f.h7),h},i};var Uy=null,FA=!1,KA=null;function b7(){Uy=String.fromCharCode(128),Uy+=wn.util.fillString(String.fromCharCode(0),64),KA=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],FA=!0}function VA(t,e,r){for(var i,n,s,a,o,c,u,l,f,h,p,d,y,g,m,w=r.length();w>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(l=t.h0,f=t.h1,h=t.h2,p=t.h3,d=t.h4,y=t.h5,g=t.h6,m=t.h7,u=0;u<64;++u)a=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),o=g^d&(y^g),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|h&(l^f),i=m+a+o+KA[u]+e[u],n=s+c,m=g,g=y,y=d,d=p+i>>>0,p=h,h=f,f=l,l=i+n>>>0;t.h0=t.h0+l|0,t.h1=t.h1+f|0,t.h2=t.h2+h|0,t.h3=t.h3+p|0,t.h4=t.h4+d|0,t.h5=t.h5+y|0,t.h6=t.h6+g|0,t.h7=t.h7+m|0,w-=64}}});var zA=b((YJ,HA)=>{var _n=nt();Ot();var y0=null;_n.util.isNodejs&&!_n.options.usePureJavaScript&&!process.versions["node-webkit"]&&(y0=On());var E7=HA.exports=_n.prng=_n.prng||{};E7.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();e.pools=i,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var f=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,d=e.plugin.formatSeed,y=_n.util.createBuffer();e.key=null,g();function g(m){if(m)return l(m);if(y.length()>=u)return l(null,y.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return _n.util.nextTick(function(){s(g)});var w=f(e.key,e.seed);e.generated+=w.length,y.putBytes(w),e.key=p(f(e.key,h(e.seed))),e.seed=d(f(e.key,e.seed)),_n.util.setImmediate(g)}},e.generateSync=function(u){var l=e.plugin.cipher,f=e.plugin.increment,h=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var d=_n.util.createBuffer();d.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&a();var y=l(e.key,e.seed);e.generated+=y.length,d.putBytes(y),e.key=h(l(e.key,f(e.seed))),e.seed=p(l(e.key,e.seed))}return d.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return o(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(f,h){if(f)return u(f);e.collect(h),o(),u()})}function a(){if(e.pools[0].messageLength>=32)return o();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,f=0;f<32;++f)e.reseeds%l==0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,f=_n.util.globalScope,h=f.crypto||f.msCrypto;h&&h.getRandomValues&&(l=function(T){return h.getRandomValues(T)});var p=_n.util.createBuffer();if(l)for(;p.length()<u;){var d=Math.max(1,Math.min(u-p.length(),65536)/4),y=new Uint32Array(Math.floor(d));try{l(y);for(var g=0;g<y.length;++g)p.putInt32(y[g])}catch(T){if(!(typeof QuotaExceededError!="undefined"&&T instanceof QuotaExceededError))throw T}}if(p.length()<u)for(var m,w,C,V=Math.floor(Math.random()*65536);p.length()<u;){w=16807*(V&65535),m=16807*(V>>16),w+=(m&32767)<<16,w+=m>>15,w=(w&2147483647)+(w>>31),V=w&4294967295;for(var g=0;g<3;++g)C=V>>>(g<<3),C^=Math.floor(Math.random()*256),p.putByte(C&255)}return p.getBytes(u)}return y0?(e.seedFile=function(u,l){y0.randomBytes(u,function(f,h){if(f)return l(f);l(null,h.toString())})},e.seedFileSync=function(u){return y0.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(f){l(f)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,f=0;f<l;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var f="",h=0;h<l;h+=8)f+=String.fromCharCode(u>>h&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,h){function p(d){var y=d.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",p),h(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var h=f.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(p,d){u.postMessage({forge:{prng:{err:p,bytes:d}}})})};u.addEventListener("message",l)}},e}});var Ta=b((QJ,Fy)=>{var Er=nt();Vu();GA();zA();Ot();(function(){if(Er.random&&Er.random.getBytes){Fy.exports=Er.random;return}(function(t){var e={},r=new Array(4),i=Er.util.createBuffer();e.formatKey=function(f){var h=Er.util.createBuffer(f);return f=new Array(4),f[0]=h.getInt32(),f[1]=h.getInt32(),f[2]=h.getInt32(),f[3]=h.getInt32(),Er.aes._expandKey(f,!1)},e.formatSeed=function(f){var h=Er.util.createBuffer(f);return f=new Array(4),f[0]=h.getInt32(),f[1]=h.getInt32(),f[2]=h.getInt32(),f[3]=h.getInt32(),f},e.cipher=function(f,h){return Er.aes._updateBlock(f,h,r,!1),i.putInt32(r[0]),i.putInt32(r[1]),i.putInt32(r[2]),i.putInt32(r[3]),i.getBytes()},e.increment=function(f){return++f[3],f},e.md=Er.md.sha256;function n(){var f=Er.prng.create(e);return f.getBytes=function(h,p){return f.generate(h,p)},f.getBytesSync=function(h){return f.generate(h)},f}var s=n(),a=null,o=Er.util.globalScope,c=o.crypto||o.msCrypto;if(c&&c.getRandomValues&&(a=function(f){return c.getRandomValues(f)}),Er.options.usePureJavaScript||!Er.util.isNodejs&&!a){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(f){}s.collect(u),u=null}t&&(t().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),t().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!Er.random)Er.random=s;else for(var l in s)Er.random[l]=s[l];Er.random.createInstance=n,Fy.exports=Er.random})(typeof jQuery!="undefined"?jQuery:null)})()});var $A=b((XJ,WA)=>{var Ra=nt();Ot();Ra.mgf=Ra.mgf||{};var w7=WA.exports=Ra.mgf.mgf1=Ra.mgf1=Ra.mgf1||{};w7.create=function(t){var e={generate:function(r,i){for(var n=new Ra.util.ByteBuffer,s=Math.ceil(i/t.digestLength),a=0;a<s;a++){var o=new Ra.util.ByteBuffer;o.putInt32(a),t.start(),t.update(r+o.getBytes()),n.putBuffer(t.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var QA=b((ZJ,YA)=>{var g0=nt();$A();YA.exports=g0.mgf=g0.mgf||{};g0.mgf.mgf1=g0.mgf1});var ZA=b((JJ,XA)=>{var Pa=nt();Ta();Ot();var _7=XA.exports=Pa.pss=Pa.pss||{};_7.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,i=e.digestLength,n=t.salt||null;typeof n=="string"&&(n=Pa.util.createBuffer(n));var s;if("saltLength"in t)s=t.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var a=t.prng||Pa.random,o={};return o.encode=function(c,u){var l,f=u-1,h=Math.ceil(f/8),p=c.digest().getBytes();if(h<i+s+2)throw new Error("Message is too long to encrypt.");var d;n===null?d=a.getBytesSync(s):d=n.bytes();var y=new Pa.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(p),y.putBytes(d),e.start(),e.update(y.getBytes());var g=e.digest().getBytes(),m=new Pa.util.ByteBuffer;m.fillWithByte(0,h-s-i-2),m.putByte(1),m.putBytes(d);var w=m.getBytes(),C=h-i-1,V=r.generate(g,C),T="";for(l=0;l<C;l++)T+=String.fromCharCode(w.charCodeAt(l)^V.charCodeAt(l));var A=65280>>8*h-f&255;return T=String.fromCharCode(T.charCodeAt(0)&~A)+T.substr(1),T+g+String.fromCharCode(188)},o.verify=function(c,u,l){var f,h=l-1,p=Math.ceil(h/8);if(u=u.substr(-p),p<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var d=p-i-1,y=u.substr(0,d),g=u.substr(d,i),m=65280>>8*p-h&255;if((y.charCodeAt(0)&m)!=0)throw new Error("Bits beyond keysize not zero as expected.");var w=r.generate(g,d),C="";for(f=0;f<d;f++)C+=String.fromCharCode(y.charCodeAt(f)^w.charCodeAt(f));C=String.fromCharCode(C.charCodeAt(0)&~m)+C.substr(1);var V=p-i-s-2;for(f=0;f<V;f++)if(C.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(C.charCodeAt(V)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var T=C.substr(-s),A=new Pa.util.ByteBuffer;A.fillWithByte(0,8),A.putBytes(c),A.putBytes(T),e.start(),e.update(A.getBytes());var te=e.digest().getBytes();return g===te},o}});var Gy=b((eee,aT)=>{var Ky=nt();aT.exports=Ky.jsbn=Ky.jsbn||{};var $n,S7=244837814094590,JA=(S7&16777215)==15715070;function X(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Ky.jsbn.BigInteger=X;function Ze(){return new X(null)}function x7(t,e,r,i,n,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[i]+n;n=Math.floor(a/67108864),r.data[i++]=a&67108863}return n}function C7(t,e,r,i,n,s){for(var a=e&32767,o=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=o*c+u*a;c=a*c+((l&32767)<<15)+r.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+o*u+(n>>>30),r.data[i++]=c&1073741823}return n}function eT(t,e,r,i,n,s){for(var a=e&16383,o=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=o*c+u*a;c=a*c+((l&16383)<<14)+r.data[i]+n,n=(c>>28)+(l>>14)+o*u,r.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(X.prototype.am=eT,$n=28):JA&&navigator.appName=="Microsoft Internet Explorer"?(X.prototype.am=C7,$n=30):JA&&navigator.appName!="Netscape"?(X.prototype.am=x7,$n=26):(X.prototype.am=eT,$n=28);X.prototype.DB=$n;X.prototype.DM=(1<<$n)-1;X.prototype.DV=1<<$n;var Vy=52;X.prototype.FV=Math.pow(2,Vy);X.prototype.F1=Vy-$n;X.prototype.F2=2*$n-Vy;var I7="0123456789abcdefghijklmnopqrstuvwxyz",m0=new Array,rc,Ci;rc="0".charCodeAt(0);for(Ci=0;Ci<=9;++Ci)m0[rc++]=Ci;rc="a".charCodeAt(0);for(Ci=10;Ci<36;++Ci)m0[rc++]=Ci;rc="A".charCodeAt(0);for(Ci=10;Ci<36;++Ci)m0[rc++]=Ci;function tT(t){return I7.charAt(t)}function rT(t,e){var r=m0[t.charCodeAt(e)];return r??-1}function A7(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function T7(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Ds(t){var e=Ze();return e.fromInt(t),e}function R7(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var a=r==8?t[i]&255:rT(t,i);if(a<0){t.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&X.ZERO.subTo(this,this)}function P7(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function B7(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,i,n=!1,s="",a=this.t,o=this.DB-a*this.DB%e;if(a-- >0)for(o<this.DB&&(i=this.data[a]>>o)>0&&(n=!0,s=tT(i));a>=0;)o<e?(i=(this.data[a]&(1<<o)-1)<<e-o,i|=this.data[--a]>>(o+=this.DB-e)):(i=this.data[a]>>(o-=e)&r,o<=0&&(o+=this.DB,--a)),i>0&&(n=!0),n&&(s+=tT(i));return n?s:"0"}function D7(){var t=Ze();return X.ZERO.subTo(this,t),t}function O7(){return this.s<0?this.negate():this}function N7(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function v0(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function k7(){return this.t<=0?0:this.DB*(this.t-1)+v0(this.data[this.t-1]^this.s&this.DM)}function L7(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function M7(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function q7(t,e){var r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+s+1]=this.data[o]>>i|a,a=(this.data[o]&n)<<r;for(o=s-1;o>=0;--o)e.data[o]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function U7(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<n,e.data[a-r]=this.data[a]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}function F7(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function K7(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&X.ZERO.subTo(e,e)}function V7(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function j7(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Ze());var s=Ze(),a=this.s,o=t.s,c=this.DB-v0(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,r)):(i.copyTo(s),n.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var f=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/f,p=(1<<this.F1)/f,d=1<<this.F2,y=r.t,g=y-u,m=e??Ze();for(s.dlShiftTo(g,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),X.ONE.dlShiftTo(u,m),m.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--g>=0;){var w=r.data[--y]==l?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+d)*p);if((r.data[y]+=s.am(0,w,r,g,0,u))<w)for(s.dlShiftTo(g,m),r.subTo(m,r);r.data[y]<--w;)r.subTo(m,r)}e!=null&&(r.drShiftTo(u,e),a!=o&&X.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),a<0&&X.ZERO.subTo(r,r)}}}function G7(t){var e=Ze();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(X.ZERO)>0&&t.subTo(e,e),e}function Ba(t){this.m=t}function H7(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function z7(t){return t}function W7(t){t.divRemTo(this.m,null,t)}function $7(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Y7(t,e){t.squareTo(e),this.reduce(e)}Ba.prototype.convert=H7;Ba.prototype.revert=z7;Ba.prototype.reduce=W7;Ba.prototype.mulTo=$7;Ba.prototype.sqrTo=Y7;function Q7(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Da(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function X7(t){var e=Ze();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(X.ZERO)>0&&this.m.subTo(e,e),e}function Z7(t){var e=Ze();return t.copyTo(e),this.reduce(e),e}function J7(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function e9(t,e){t.squareTo(e),this.reduce(e)}function t9(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Da.prototype.convert=X7;Da.prototype.revert=Z7;Da.prototype.reduce=J7;Da.prototype.mulTo=t9;Da.prototype.sqrTo=e9;function r9(){return(this.t>0?this.data[0]&1:this.s)==0}function i9(t,e){if(t>4294967295||t<1)return X.ONE;var r=Ze(),i=Ze(),n=e.convert(this),s=v0(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var a=r;r=i,i=a}return e.revert(r)}function n9(t,e){var r;return t<256||e.isEven()?r=new Ba(e):r=new Da(e),this.exp(t,r)}X.prototype.copyTo=A7;X.prototype.fromInt=T7;X.prototype.fromString=R7;X.prototype.clamp=P7;X.prototype.dlShiftTo=L7;X.prototype.drShiftTo=M7;X.prototype.lShiftTo=q7;X.prototype.rShiftTo=U7;X.prototype.subTo=F7;X.prototype.multiplyTo=K7;X.prototype.squareTo=V7;X.prototype.divRemTo=j7;X.prototype.invDigit=Q7;X.prototype.isEven=r9;X.prototype.exp=i9;X.prototype.toString=B7;X.prototype.negate=D7;X.prototype.abs=O7;X.prototype.compareTo=N7;X.prototype.bitLength=k7;X.prototype.mod=G7;X.prototype.modPowInt=n9;X.ZERO=Ds(0);X.ONE=Ds(1);function s9(){var t=Ze();return this.copyTo(t),t}function a9(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function o9(){return this.t==0?this.s:this.data[0]<<24>>24}function c9(){return this.t==0?this.s:this.data[0]<<16>>16}function u9(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function l9(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function f9(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=Ds(r),n=Ze(),s=Ze(),a="";for(this.divRemTo(i,n,s);n.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,n.divRemTo(i,n,s);return s.intValue().toString(t)+a}function h9(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,a=0,o=0;o<t.length;++o){var c=rT(t,o);if(c<0){t.charAt(o)=="-"&&this.signum()==0&&(n=!0);continue}a=e*a+c,++s>=r&&(this.dMultiply(i),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),n&&X.ZERO.subTo(this,this)}function d9(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(X.ONE.shiftLeft(t-1),jy,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(X.ONE.shiftLeft(t-1),this);else{var i=new Array,n=t&7;i.length=(t>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function p9(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,i,n=0;if(t-- >0)for(r<this.DB&&(i=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this.data[t]&(1<<r)-1)<<8-r,i|=this.data[--t]>>(r+=this.DB-8)):(i=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function y9(t){return this.compareTo(t)==0}function g9(t){return this.compareTo(t)<0?this:t}function m9(t){return this.compareTo(t)>0?this:t}function v9(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function b9(t,e){return t&e}function E9(t){var e=Ze();return this.bitwiseTo(t,b9,e),e}function jy(t,e){return t|e}function w9(t){var e=Ze();return this.bitwiseTo(t,jy,e),e}function iT(t,e){return t^e}function _9(t){var e=Ze();return this.bitwiseTo(t,iT,e),e}function nT(t,e){return t&~e}function S9(t){var e=Ze();return this.bitwiseTo(t,nT,e),e}function x9(){for(var t=Ze(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function C9(t){var e=Ze();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function I9(t){var e=Ze();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function A9(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function T9(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+A9(this.data[t]);return this.s<0?this.t*this.DB:-1}function R9(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function P9(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=R9(this.data[r]^e);return t}function B9(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function D9(t,e){var r=X.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function O9(t){return this.changeBit(t,jy)}function N9(t){return this.changeBit(t,nT)}function k9(t){return this.changeBit(t,iT)}function L9(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function M9(t){var e=Ze();return this.addTo(t,e),e}function q9(t){var e=Ze();return this.subTo(t,e),e}function U9(t){var e=Ze();return this.multiplyTo(t,e),e}function F9(t){var e=Ze();return this.divRemTo(t,e,null),e}function K9(t){var e=Ze();return this.divRemTo(t,null,e),e}function V9(t){var e=Ze(),r=Ze();return this.divRemTo(t,e,r),new Array(e,r)}function j9(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function G9(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Hu(){}function sT(t){return t}function H9(t,e,r){t.multiplyTo(e,r)}function z9(t,e){t.squareTo(e)}Hu.prototype.convert=sT;Hu.prototype.revert=sT;Hu.prototype.mulTo=H9;Hu.prototype.sqrTo=z9;function W9(t){return this.exp(t,new Hu)}function $9(t,e,r){var i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var n;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,t.data[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t.data[i],r,i,0,e-i);r.clamp()}function Y9(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function ic(t){this.r2=Ze(),this.q3=Ze(),X.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Q9(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Ze();return t.copyTo(e),this.reduce(e),e}function X9(t){return t}function Z9(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function J9(t,e){t.squareTo(e),this.reduce(e)}function eV(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ic.prototype.convert=Q9;ic.prototype.revert=X9;ic.prototype.reduce=Z9;ic.prototype.mulTo=eV;ic.prototype.sqrTo=J9;function tV(t,e){var r=t.bitLength(),i,n=Ds(1),s;if(r<=0)return n;r<18?i=1:r<48?i=3:r<144?i=4:r<768?i=5:i=6,r<8?s=new Ba(e):e.isEven()?s=new ic(e):s=new Da(e);var a=new Array,o=3,c=i-1,u=(1<<i)-1;if(a[1]=s.convert(this),i>1){var l=Ze();for(s.sqrTo(a[1],l);o<=u;)a[o]=Ze(),s.mulTo(l,a[o-2],a[o]),o+=2}var f=t.t-1,h,p=!0,d=Ze(),y;for(r=v0(t.data[f])-1;f>=0;){for(r>=c?h=t.data[f]>>r-c&u:(h=(t.data[f]&(1<<r+1)-1)<<c-r,f>0&&(h|=t.data[f-1]>>this.DB+r-c)),o=i;(h&1)==0;)h>>=1,--o;if((r-=o)<0&&(r+=this.DB,--f),p)a[h].copyTo(n),p=!1;else{for(;o>1;)s.sqrTo(n,d),s.sqrTo(d,n),o-=2;o>0?s.sqrTo(n,d):(y=n,n=d,d=y),s.mulTo(d,a[h],n)}for(;f>=0&&(t.data[f]&1<<r)==0;)s.sqrTo(n,d),y=n,n=d,d=y,--r<0&&(r=this.DB-1,--f)}return s.revert(n)}function rV(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function iV(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function nV(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return X.ZERO;for(var r=t.clone(),i=this.clone(),n=Ds(1),s=Ds(0),a=Ds(0),o=Ds(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(t,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(a,n),s.subTo(o,s)):(i.subTo(r,i),e&&a.subTo(n,a),o.subTo(s,o))}if(i.compareTo(X.ONE)!=0)return X.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var zi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],sV=(1<<26)/zi[zi.length-1];function aV(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=zi[zi.length-1]){for(e=0;e<zi.length;++e)if(r.data[0]==zi[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<zi.length;){for(var i=zi[e],n=e+1;n<zi.length&&i<sV;)i*=zi[n++];for(i=r.modInt(i);e<n;)if(i%zi[e++]==0)return!1}return r.millerRabin(t)}function oV(t){var e=this.subtract(X.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var i=e.shiftRight(r),n=cV(),s,a=0;a<t;++a){do s=new X(this.bitLength(),n);while(s.compareTo(X.ONE)<=0||s.compareTo(e)>=0);var o=s.modPow(i,this);if(o.compareTo(X.ONE)!=0&&o.compareTo(e)!=0){for(var c=1;c++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(X.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function cV(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}X.prototype.chunkSize=u9;X.prototype.toRadix=f9;X.prototype.fromRadix=h9;X.prototype.fromNumber=d9;X.prototype.bitwiseTo=v9;X.prototype.changeBit=D9;X.prototype.addTo=L9;X.prototype.dMultiply=j9;X.prototype.dAddOffset=G9;X.prototype.multiplyLowerTo=$9;X.prototype.multiplyUpperTo=Y9;X.prototype.modInt=iV;X.prototype.millerRabin=oV;X.prototype.clone=s9;X.prototype.intValue=a9;X.prototype.byteValue=o9;X.prototype.shortValue=c9;X.prototype.signum=l9;X.prototype.toByteArray=p9;X.prototype.equals=y9;X.prototype.min=g9;X.prototype.max=m9;X.prototype.and=E9;X.prototype.or=w9;X.prototype.xor=_9;X.prototype.andNot=S9;X.prototype.not=x9;X.prototype.shiftLeft=C9;X.prototype.shiftRight=I9;X.prototype.getLowestSetBit=T9;X.prototype.bitCount=P9;X.prototype.testBit=B9;X.prototype.setBit=O9;X.prototype.clearBit=N9;X.prototype.flipBit=k9;X.prototype.add=M9;X.prototype.subtract=q9;X.prototype.multiply=U9;X.prototype.divide=F9;X.prototype.remainder=K9;X.prototype.divideAndRemainder=V9;X.prototype.modPow=tV;X.prototype.modInverse=nV;X.prototype.pow=W9;X.prototype.gcd=rV;X.prototype.isProbablePrime=aV});var fT=b((tee,lT)=>{var Sn=nt();Bs();Ot();var oT=lT.exports=Sn.sha1=Sn.sha1||{};Sn.md.sha1=Sn.md.algorithms.sha1=oT;oT.create=function(){cT||uV();var t=null,e=Sn.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Sn.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Sn.util.encodeUtf8(n));var a=n.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=i.fullMessageLength.length-1;o>=0;--o)i.fullMessageLength[o]+=a[1],a[1]=a[0]+(i.fullMessageLength[o]/4294967296>>>0),i.fullMessageLength[o]=i.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(n),uT(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Sn.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,a=s&i.blockLength-1;n.putBytes(Hy.substr(0,i.blockLength-a));for(var o,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)o=i.fullMessageLength[l+1]*8,c=o/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=o>>>0;n.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};uT(f,r,n);var h=Sn.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h},i};var Hy=null,cT=!1;function uV(){Hy=String.fromCharCode(128),Hy+=Sn.util.fillString(String.fromCharCode(0),64),cT=!0}function uT(t,e,r){for(var i,n,s,a,o,c,u,l,f=r.length();f>=64;){for(n=t.h0,s=t.h1,a=t.h2,o=t.h3,c=t.h4,l=0;l<16;++l)i=r.getInt32(),e[l]=i,u=o^s&(a^o),i=(n<<5|n>>>27)+u+c+1518500249+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=o^s&(a^o),i=(n<<5|n>>>27)+u+c+1518500249+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=s^a^o,i=(n<<5|n>>>27)+u+c+1859775393+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^a^o,i=(n<<5|n>>>27)+u+c+1859775393+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s&a|o&(s^a),i=(n<<5|n>>>27)+u+c+2400959708+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^a^o,i=(n<<5|n>>>27)+u+c+3395469782+i,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=n,n=i;t.h0=t.h0+n|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+o|0,t.h4=t.h4+c|0,f-=64}}});var pT=b((ree,dT)=>{var xn=nt();Ot();Ta();fT();var hT=dT.exports=xn.pkcs1=xn.pkcs1||{};hT.encode_rsa_oaep=function(t,e,r){var i,n,s,a;typeof r=="string"?(i=r,n=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,n=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=xn.md.sha1.create(),a||(a=s);var o=Math.ceil(t.n.bitLength()/8),c=o-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var l=s.digest(),f="",h=c-e.length,p=0;p<h;p++)f+="\0";var d=l.getBytes()+f+""+e;if(!n)n=xn.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var y=b0(n,o-s.digestLength-1,a),g=xn.util.xorBytes(d,y,d.length),m=b0(g,s.digestLength,a),w=xn.util.xorBytes(n,m,n.length);return"\0"+w+g};hT.decode_rsa_oaep=function(t,e,r){var i,n,s;typeof r=="string"?(i=r,n=arguments[3]||void 0):r&&(i=r.label||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=e.length,g.expectedLength=a,g}if(n===void 0?n=xn.md.sha1.create():n.start(),s||(s=n),a<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var o=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),f=b0(l,n.digestLength,s),h=xn.util.xorBytes(u,f,u.length),p=b0(h,a-n.digestLength-1,s),d=xn.util.xorBytes(l,p,l.length),y=d.substring(0,n.digestLength),g=c!=="\0",m=0;m<n.digestLength;++m)g|=o.charAt(m)!==y.charAt(m);for(var w=1,C=n.digestLength,V=n.digestLength;V<d.length;V++){var T=d.charCodeAt(V),A=T&1^1,te=w?65534:0;g|=T&te,w=w&A,C+=w}if(g||d.charCodeAt(C)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(C+1)};function b0(t,e,r){r||(r=xn.md.sha1.create());for(var i="",n=Math.ceil(e/r.digestLength),s=0;s<n;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),i+=r.digest().getBytes()}return i.substring(0,e)}});var yT=b((iee,zy)=>{var Os=nt();Ot();Gy();Ta();(function(){if(Os.prime){zy.exports=Os.prime;return}var t=zy.exports=Os.prime=Os.prime||{},e=Os.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(f,h){return f|h};t.generateProbablePrime=function(f,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var d=h.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var y=h.prng||Os.random,g={nextBytes:function(m){for(var w=y.getBytesSync(m.length),C=0;C<m.length;++C)m[C]=w.charCodeAt(C)}};if(d.name==="PRIMEINC")return s(f,g,d.options,p);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(f,h,p,d){return"workers"in p?c(f,h,p,d):a(f,h,p,d)}function a(f,h,p,d){var y=u(f,h),g=0,m=l(y.bitLength());"millerRabinTests"in p&&(m=p.millerRabinTests);var w=10;"maxBlockTime"in p&&(w=p.maxBlockTime),o(y,f,h,g,m,w,d)}function o(f,h,p,d,y,g,m){var w=+new Date;do{if(f.bitLength()>h&&(f=u(h,p)),f.isProbablePrime(y))return m(null,f);f.dAddOffset(r[d++%8],0)}while(g<0||+new Date-w<g);Os.util.setImmediate(function(){o(f,h,p,d,y,g,m)})}function c(f,h,p,d){if(typeof Worker=="undefined")return a(f,h,p,d);var y=u(f,h),g=p.workers,m=p.workLoad||100,w=m*30/8,C=p.workerScript||"forge/prime.worker.js";if(g===-1)return Os.util.estimateCores(function(T,A){T&&(A=2),g=A-1,V()});V();function V(){g=Math.max(1,g);for(var T=[],A=0;A<g;++A)T[A]=new Worker(C);for(var te=g,A=0;A<g;++A)T[A].addEventListener("message",$);var ie=!1;function $(Ce){if(!ie){--te;var me=Ce.data;if(me.found){for(var be=0;be<T.length;++be)T[be].terminate();return ie=!0,d(null,new e(me.prime,16))}y.bitLength()>f&&(y=u(f,h));var st=y.toString(16);Ce.target.postMessage({hex:st,workLoad:m}),y.dAddOffset(w,0)}}}}function u(f,h){var p=new e(f,h),d=f-1;return p.testBit(d)||p.bitwiseTo(e.ONE.shiftLeft(d),n,p),p.dAddOffset(31-p.mod(i).byteValue(),0),p}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})()});var $y=b((nee,_T)=>{var _e=nt();Jo();Gy();Zo();pT();yT();Ta();Ot();typeof $e=="undefined"&&($e=_e.jsbn.BigInteger);var $e,Wy=_e.util.isNodejs?On():null,M=_e.asn1,Ii=_e.util;_e.pki=_e.pki||{};_T.exports=_e.pki.rsa=_e.rsa=_e.rsa||{};var De=_e.pki,lV=[6,4,2,4,2,4,6,2],fV={name:"PrivateKeyInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},hV={name:"RSAPrivateKey",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},dV={name:"RSAPublicKey",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},pV=_e.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:M.Class.UNIVERSAL,type:M.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},yV={name:"DigestInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:M.Class.UNIVERSAL,type:M.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:M.Class.UNIVERSAL,type:M.Type.NULL,constructed:!1}]},{name:"DigestInfo.digest",tagClass:M.Class.UNIVERSAL,type:M.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},gV=function(t){var e;if(t.algorithm in De.oids)e=De.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var i=M.oidToDer(e).getBytes(),n=M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[]),s=M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[]);s.value.push(M.create(M.Class.UNIVERSAL,M.Type.OID,!1,i)),s.value.push(M.create(M.Class.UNIVERSAL,M.Type.NULL,!1,""));var a=M.create(M.Class.UNIVERSAL,M.Type.OCTETSTRING,!1,t.digest().getBytes());return n.value.push(s),n.value.push(a),M.toDer(n).getBytes()},gT=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract($e.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract($e.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new $e(_e.util.bytesToHex(_e.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals($e.ONE));t=t.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var a=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(i.modInverse(e.n)).mod(e.n),a};De.rsa.encrypt=function(t,e,r){var i=r,n,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(i=r===2,n=mT(t,e,r)):(n=_e.util.createBuffer(),n.putBytes(t));for(var a=new $e(n.toHex(),16),o=gT(a,e,i),c=o.toString(16),u=_e.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(_e.util.hexToBytes(c)),u.getBytes()};De.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=n,s}var a=new $e(_e.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=gT(a,e,r),c=o.toString(16),u=_e.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(_e.util.hexToBytes(c)),i!==!1?E0(u.getBytes(),e,r):u.getBytes()};De.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var i=r.prng||_e.random,n={nextBytes:function(o){for(var c=i.getBytesSync(o.length),u=0;u<o.length;++u)o[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:n,eInt:e||65537,e:new $e(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};De.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new $e(null);r.fromInt(30);for(var i=0,n=function(f,h){return f|h},s=+new Date,a,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new $e(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo($e.ONE.shiftLeft(u),n,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),i=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(vV(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(lV[i++%8],0):t.pqState===2?t.pqState=t.num.subtract($e.ONE).gcd(t.e).compareTo($e.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract($e.ONE),t.q1=t.q.subtract($e.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo($e.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:De.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:De.rsa.setPublicKey(t.n,t.e)}}a=+new Date,o+=a-s,s=a}return t.keys!==null};De.rsa.generateKeyPair=function(t,e,r,i){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(i=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,i=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!_e.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(i){if(vT("generateKeyPair"))return Wy.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,c,u){if(o)return i(o);i(null,{privateKey:De.privateKeyFromPem(u),publicKey:De.publicKeyFromPem(c)})});if(bT("generateKey")&&bT("exportKey"))return Ii.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:wT(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Ii.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){i(o)}).then(function(o){if(o){var c=De.privateKeyFromAsn1(M.fromDer(_e.util.createBuffer(o)));i(null,{privateKey:c,publicKey:De.setRsaPublicKey(c.n,c.e)})}});if(ET("generateKey")&&ET("exportKey")){var n=Ii.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:wT(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(o){var c=o.target.result,u=Ii.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var f=l.target.result,h=De.privateKeyFromAsn1(M.fromDer(_e.util.createBuffer(f)));i(null,{privateKey:h,publicKey:De.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){i(l)}},n.onerror=function(o){i(o)};return}}else if(vT("generateKeyPairSync")){var s=Wy.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:De.privateKeyFromPem(s.privateKey),publicKey:De.publicKeyFromPem(s.publicKey)}}}var a=De.rsa.createKeyPairGenerationState(t,e,r);if(!i)return De.rsa.stepKeyPairGenerationState(a,0),a.keys;mV(a,r,i)};De.setRsaPublicKey=De.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(o,c,u){return mT(o,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(o,c){return _e.pkcs1.encode_rsa_oaep(c,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(o){return o}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var a=n.encode(i,r,!0);return De.rsa.encrypt(a,r,!0)},r.verify=function(i,n,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=E0(u,r,!0);var l=M.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),f={},h=[];if(!M.validate(l,yV,f,h)){var p=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw p.errors=h,p}var d=M.derToOid(f.algorithmIdentifier);if(!(d===_e.oids.md2||d===_e.oids.md5||d===_e.oids.sha1||d===_e.oids.sha224||d===_e.oids.sha256||d===_e.oids.sha384||d===_e.oids.sha512||d===_e.oids["sha512-224"]||d===_e.oids["sha512-256"])){var p=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw p.oid=d,p}return c===f.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=E0(u,r,!0),c===u}});var o=De.rsa.decrypt(n,r,!0,!1);return s.verify(i,o,r.n.bitLength())},r};De.setRsaPrivateKey=De.rsa.setPrivateKey=function(t,e,r,i,n,s,a,o){var c={n:t,e,d:r,p:i,q:n,dP:s,dQ:a,qInv:o};return c.decrypt=function(u,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=De.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:E0};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,d){return _e.pkcs1.decode_rsa_oaep(d,p,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:gV},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},f=1);var h=l.encode(u,c.n.bitLength());return De.rsa.encrypt(h,c,f)},c};De.wrapRsaPrivateKey=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,M.integerToDer(0).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.OID,!1,M.oidToDer(De.oids.rsaEncryption).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.NULL,!1,"")]),M.create(M.Class.UNIVERSAL,M.Type.OCTETSTRING,!1,M.toDer(t).getBytes())])};De.privateKeyFromAsn1=function(t){var e={},r=[];if(M.validate(t,fV,e,r)&&(t=M.fromDer(_e.util.createBuffer(e.privateKey))),e={},r=[],!M.validate(t,hV,e,r)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=r,i}var n,s,a,o,c,u,l,f;return n=_e.util.createBuffer(e.privateKeyModulus).toHex(),s=_e.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=_e.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=_e.util.createBuffer(e.privateKeyPrime1).toHex(),c=_e.util.createBuffer(e.privateKeyPrime2).toHex(),u=_e.util.createBuffer(e.privateKeyExponent1).toHex(),l=_e.util.createBuffer(e.privateKeyExponent2).toHex(),f=_e.util.createBuffer(e.privateKeyCoefficient).toHex(),De.setRsaPrivateKey(new $e(n,16),new $e(s,16),new $e(a,16),new $e(o,16),new $e(c,16),new $e(u,16),new $e(l,16),new $e(f,16))};De.privateKeyToAsn1=De.privateKeyToRSAPrivateKey=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,M.integerToDer(0).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.n)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.e)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.d)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.p)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.q)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.dP)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.dQ)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.qInv))])};De.publicKeyFromAsn1=function(t){var e={},r=[];if(M.validate(t,pV,e,r)){var i=M.derToOid(e.publicKeyOid);if(i!==De.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}t=e.rsaPublicKey}if(r=[],!M.validate(t,dV,e,r)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=r,n}var s=_e.util.createBuffer(e.publicKeyModulus).toHex(),a=_e.util.createBuffer(e.publicKeyExponent).toHex();return De.setRsaPublicKey(new $e(s,16),new $e(a,16))};De.publicKeyToAsn1=De.publicKeyToSubjectPublicKeyInfo=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.OID,!1,M.oidToDer(De.oids.rsaEncryption).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.NULL,!1,"")]),M.create(M.Class.UNIVERSAL,M.Type.BITSTRING,!1,[De.publicKeyToRSAPublicKey(t)])])};De.publicKeyToRSAPublicKey=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.n)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Cn(t.e))])};function mT(t,e,r){var i=_e.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(t.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=n-11,s}i.putByte(0),i.putByte(r);var a=n-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var c=0;c<a;++c)i.putByte(o)}else for(;a>0;){for(var u=0,l=_e.random.getBytes(a),c=0;c<a;++c)o=l.charCodeAt(c),o===0?++u:i.putByte(o);a=u}return i.putByte(0),i.putBytes(t),i}function E0(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8),s=_e.util.createBuffer(t),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(o===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(o===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function mV(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(t.pBits,function(o,c){if(o)return r(o);if(t.p=c,t.q!==null)return a(o,t.q);s(t.qBits,a)})}function s(o,c){_e.prime.generateProbablePrime(o,i,c)}function a(o,c){if(o)return r(o);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract($e.ONE).gcd(t.e).compareTo($e.ONE)!==0){t.p=null,n();return}if(t.q.subtract($e.ONE).gcd(t.e).compareTo($e.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract($e.ONE),t.q1=t.q.subtract($e.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo($e.ONE)!==0){t.p=t.q=null,n();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:De.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:De.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Cn(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=_e.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function vV(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function vT(t){return _e.util.isNodejs&&typeof Wy[t]=="function"}function bT(t){return typeof Ii.globalScope!="undefined"&&typeof Ii.globalScope.crypto=="object"&&typeof Ii.globalScope.crypto.subtle=="object"&&typeof Ii.globalScope.crypto.subtle[t]=="function"}function ET(t){return typeof Ii.globalScope!="undefined"&&typeof Ii.globalScope.msCrypto=="object"&&typeof Ii.globalScope.msCrypto.subtle=="object"&&typeof Ii.globalScope.msCrypto.subtle[t]=="function"}function wT(t){for(var e=_e.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),i=0;i<e.length;++i)r[i]=e.charCodeAt(i);return r}});var Qy=b((see,AT)=>{var Ee=nt();Vu();Jo();l0();Bs();QA();Zo();d0();ZA();$y();Ot();var v=Ee.asn1,se=AT.exports=Ee.pki=Ee.pki||{},Ye=se.oids,Vt={};Vt.CN=Ye.commonName;Vt.commonName="CN";Vt.C=Ye.countryName;Vt.countryName="C";Vt.L=Ye.localityName;Vt.localityName="L";Vt.ST=Ye.stateOrProvinceName;Vt.stateOrProvinceName="ST";Vt.O=Ye.organizationName;Vt.organizationName="O";Vt.OU=Ye.organizationalUnitName;Vt.organizationalUnitName="OU";Vt.E=Ye.emailAddress;Vt.emailAddress="E";var ST=Ee.pki.rsa.publicKeyValidator,bV={name:"Certificate",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:v.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:v.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:v.Class.UNIVERSAL,type:v.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:v.Class.UNIVERSAL,type:v.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:v.Class.UNIVERSAL,type:v.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:v.Class.UNIVERSAL,type:v.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},ST,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:v.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:v.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:v.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:v.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},EV={name:"rsapss",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:v.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:v.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:v.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:v.Class.UNIVERSAL,type:v.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:v.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:v.Class.UNIVERSAL,type:v.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},wV={name:"CertificationRequestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},ST,{name:"CertificationRequestInfo.attributes",tagClass:v.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:v.Class.UNIVERSAL,type:v.Type.SET,constructed:!0}]}]}]},_V={name:"CertificationRequest",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[wV,{name:"CertificationRequest.signatureAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};se.RDNAttributesAsArray=function(t,e){for(var r=[],i,n,s,a=0;a<t.value.length;++a){i=t.value[a];for(var o=0;o<i.value.length;++o)s={},n=i.value[o],s.type=v.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in Ye&&(s.name=Ye[s.type],s.name in Vt&&(s.shortName=Vt[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};se.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var i=t[r],n=v.derToOid(i.value[0].value),s=i.value[1].value,a=0;a<s.length;++a){var o={};if(o.type=n,o.value=s[a].value,o.valueTagClass=s[a].type,o.type in Ye&&(o.name=Ye[o.type],o.name in Vt&&(o.shortName=Vt[o.name])),o.type===Ye.extensionRequest){o.extensions=[];for(var c=0;c<o.value.length;++c)o.extensions.push(se.certificateExtensionFromAsn1(o.value[c]))}e.push(o)}return e};function Ns(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,i,n=0;r===null&&n<t.attributes.length;++n)i=t.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(r=i);return r}var w0=function(t,e,r){var i={};if(t!==Ye["RSASSA-PSS"])return i;r&&(i={hash:{algorithmOid:Ye.sha1},mgf:{algorithmOid:Ye.mgf1,hash:{algorithmOid:Ye.sha1}},saltLength:20});var n={},s=[];if(!v.validate(e,EV,n,s)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=s,a}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=v.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=v.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=v.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i},_0=function(t){switch(Ye[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return Ee.md.sha1.create();case"md5WithRSAEncryption":return Ee.md.md5.create();case"sha256WithRSAEncryption":return Ee.md.sha256.create();case"sha384WithRSAEncryption":return Ee.md.sha384.create();case"sha512WithRSAEncryption":return Ee.md.sha512.create();case"RSASSA-PSS":return Ee.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},xT=function(t){var e=t.certificate,r;switch(e.signatureOid){case Ye.sha1WithRSAEncryption:case Ye.sha1WithRSASignature:break;case Ye["RSASSA-PSS"]:var i,n;if(i=Ye[e.signatureParameters.mgf.hash.algorithmOid],i===void 0||Ee.md[i]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=i,s}if(n=Ye[e.signatureParameters.mgf.algorithmOid],n===void 0||Ee.mgf[n]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=n,s}if(n=Ee.mgf[n].create(Ee.md[i].create()),i=Ye[e.signatureParameters.hash.algorithmOid],i===void 0||Ee.md[i]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=i,s}r=Ee.pss.create(Ee.md[i].create(),n,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};se.certificateFromPem=function(t,e,r){var i=Ee.pem.decode(t)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=v.fromDer(i.body,r);return se.certificateFromAsn1(s,e)};se.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:v.toDer(se.certificateToAsn1(t)).getBytes()};return Ee.pem.encode(r,{maxline:e})};se.publicKeyFromPem=function(t){var e=Ee.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=v.fromDer(e.body);return se.publicKeyFromAsn1(i)};se.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:v.toDer(se.publicKeyToAsn1(t)).getBytes()};return Ee.pem.encode(r,{maxline:e})};se.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:v.toDer(se.publicKeyToRSAPublicKey(t)).getBytes()};return Ee.pem.encode(r,{maxline:e})};se.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||Ee.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=v.toDer(se.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":n=v.toDer(se.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(n);var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};se.certificationRequestFromPem=function(t,e,r){var i=Ee.pem.decode(t)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=v.fromDer(i.body,r);return se.certificationRequestFromAsn1(s,e)};se.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:v.toDer(se.certificationRequestToAsn1(t)).getBytes()};return Ee.pem.encode(r,{maxline:e})};se.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Ns(t.issuer,e)},t.issuer.addField=function(e){Ai([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Ns(t.subject,e)},t.subject.addField=function(e){Ai([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){Ai(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){Ai(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)CT(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,i,n=0;r===null&&n<t.extensions.length;++n)i=t.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(r=i);return r},t.sign=function(e,r){t.md=r||Ee.md.sha1.create();var i=Ye[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.tbsCertificate=se.getTBSCertificate(t);var s=v.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var i=e.issuer,n=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=n.attributes,s.actualIssuer=i.attributes,s}var a=e.md;if(a===null){a=_0({signatureOid:e.signatureOid,type:"certificate"});var o=e.tbsCertificate||se.getTBSCertificate(e),c=v.toDer(o);a.update(c.getBytes())}return a!==null&&(r=xT({certificate:t,md:a,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,i=t.issuer,n=e.subject;if(i.hash&&n.hash)r=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){r=!0;for(var s,a,o=0;r&&o<i.attributes.length;++o)s=i.attributes[o],a=n.attributes[o],(s.type!==a.type||s.value!==a.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return se.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=Ye.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var i=t.extensions[r];if(i.id===e){var n=t.generateSubjectKeyIdentifier().getBytes();return Ee.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},t};se.certificateFromAsn1=function(t,e){var r={},i=[];if(!v.validate(t,bV,r,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=v.derToOid(r.publicKeyOid);if(s!==se.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=se.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var o=Ee.util.createBuffer(r.certSerialNumber);a.serialNumber=o.toHex(),a.signatureOid=Ee.asn1.derToOid(r.certSignatureOid),a.signatureParameters=w0(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=Ee.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=w0(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(v.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(v.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(v.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(v.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=c[0],a.validity.notAfter=c[1],a.tbsCertificate=r.tbsCertificate,e){a.md=_0({signatureOid:a.signatureOid,type:"certificate"});var u=v.toDer(a.tbsCertificate);a.md.update(u.getBytes())}var l=Ee.md.sha1.create(),f=v.toDer(r.certIssuer);l.update(f.getBytes()),a.issuer.getField=function(d){return Ns(a.issuer,d)},a.issuer.addField=function(d){Ai([d]),a.issuer.attributes.push(d)},a.issuer.attributes=se.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=l.digest().toHex();var h=Ee.md.sha1.create(),p=v.toDer(r.certSubject);return h.update(p.getBytes()),a.subject.getField=function(d){return Ns(a.subject,d)},a.subject.addField=function(d){Ai([d]),a.subject.attributes.push(d)},a.subject.attributes=se.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=h.digest().toHex(),r.certExtensions?a.extensions=se.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=se.publicKeyFromAsn1(r.subjectPublicKeyInfo),a};se.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var i=t.value[r],n=0;n<i.value.length;++n)e.push(se.certificateExtensionFromAsn1(i.value[n]));return e};se.certificateExtensionFromAsn1=function(t){var e={};if(e.id=v.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===v.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in Ye){if(e.name=Ye[e.id],e.name==="keyUsage"){var r=v.fromDer(e.value),i=0,n=0;r.value.length>1&&(i=r.value.charCodeAt(1),n=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var r=v.fromDer(e.value);r.value.length>0&&r.value[0].type===v.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===v.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=v.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=v.fromDer(e.value),a=0;a<r.value.length;++a){var o=v.derToOid(r.value[a].value);o in Ye?e[Ye[o]]=!0:e[o]=!0}else if(e.name==="nsCertType"){var r=v.fromDer(e.value),i=0;r.value.length>1&&(i=r.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=v.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=Ee.util.bytesToIP(c.value);break;case 8:l.oid=v.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=v.fromDer(e.value);e.subjectKeyIdentifier=Ee.util.bytesToHex(r.value)}}return e};se.certificationRequestFromAsn1=function(t,e){var r={},i=[];if(!v.validate(t,_V,r,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=v.derToOid(r.publicKeyOid);if(s!==se.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=se.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=Ee.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=w0(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=Ee.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=w0(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,e){a.md=_0({signatureOid:a.signatureOid,type:"certification request"});var o=v.toDer(a.certificationRequestInfo);a.md.update(o.getBytes())}var c=Ee.md.sha1.create();return a.subject.getField=function(u){return Ns(a.subject,u)},a.subject.addField=function(u){Ai([u]),a.subject.attributes.push(u)},a.subject.attributes=se.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),a.subject.hash=c.digest().toHex(),a.publicKey=se.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(u){return Ns(a,u)},a.addAttribute=function(u){Ai([u]),a.attributes.push(u)},a.attributes=se.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a};se.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Ns(t.subject,e)},t.subject.addField=function(e){Ai([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Ns(t,e)},t.addAttribute=function(e){Ai([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){Ai(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){Ai(e),t.attributes=e},t.sign=function(e,r){t.md=r||Ee.md.sha1.create();var i=Ye[t.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=t.md.algorithm,n}t.signatureOid=t.siginfo.algorithmOid=i,t.certificationRequestInfo=se.getCertificationRequestInfo(t);var s=v.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=_0({signatureOid:t.signatureOid,type:"certification request"});var i=t.certificationRequestInfo||se.getCertificationRequestInfo(t),n=v.toDer(i);r.update(n.getBytes())}return r!==null&&(e=xT({certificate:t,md:r,signature:t.signature})),e},t};function nc(t){for(var e=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),r,i,n=t.attributes,s=0;s<n.length;++s){r=n[s];var a=r.value,o=v.Type.PRINTABLESTRING;"valueTagClass"in r&&(o=r.valueTagClass,o===v.Type.UTF8&&(a=Ee.util.encodeUtf8(a))),i=v.create(v.Class.UNIVERSAL,v.Type.SET,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(r.type).getBytes()),v.create(v.Class.UNIVERSAL,o,!1,a)])]),e.value.push(i)}return e}function Ai(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in se.oids?e.name=se.oids[e.type]:e.shortName&&e.shortName in Vt&&(e.name=se.oids[Vt[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in se.oids)e.type=se.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Vt&&(e.shortName=Vt[e.name]),e.type===Ye.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=v.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(se.certificateExtensionToAsn1(CT(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function CT(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in se.oids&&(t.name=se.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in se.oids)t.id=se.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var i=0,n=0,s=0;t.digitalSignature&&(n|=128,i=7),t.nonRepudiation&&(n|=64,i=6),t.keyEncipherment&&(n|=32,i=5),t.dataEncipherment&&(n|=16,i=4),t.keyAgreement&&(n|=8,i=3),t.keyCertSign&&(n|=4,i=2),t.cRLSign&&(n|=2,i=1),t.encipherOnly&&(n|=1,i=0),t.decipherOnly&&(s|=128,i=7);var a=String.fromCharCode(i);s!==0?a+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(a+=String.fromCharCode(n)),t.value=v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,a)}else if(t.name==="basicConstraints")t.value=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(v.create(v.Class.UNIVERSAL,v.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);var o=t.value.value;for(var c in t)t[c]===!0&&(c in Ye?o.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(Ye[c]).getBytes())):c.indexOf(".")!==-1&&o.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var i=0,n=0;t.client&&(n|=128,i=7),t.server&&(n|=64,i=6),t.email&&(n|=32,i=5),t.objsign&&(n|=16,i=4),t.reserved&&(n|=8,i=3),t.sslCA&&(n|=4,i=2),t.emailCA&&(n|=2,i=1),t.objCA&&(n|=1,i=0);var a=String.fromCharCode(i);n!==0&&(a+=String.fromCharCode(n)),t.value=v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,a)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var a=u.value;if(u.type===7&&u.ip){if(a=Ee.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?a=v.oidToDer(v.oidToDer(u.oid)):a=v.oidToDer(a));t.value.value.push(v.create(v.Class.CONTEXT_SPECIFIC,u.type,!1,a))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=v.create(v.Class.UNIVERSAL,v.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var f=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=f.toHex(),t.value=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,f.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);var o=t.value.value;if(t.keyIdentifier){var h=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;o.push(v.create(v.Class.CONTEXT_SPECIFIC,0,!1,h))}if(t.authorityCertIssuer){var p=[v.create(v.Class.CONTEXT_SPECIFIC,4,!0,[nc(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];o.push(v.create(v.Class.CONTEXT_SPECIFIC,1,!0,p))}if(t.serialNumber){var d=Ee.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);o.push(v.create(v.Class.CONTEXT_SPECIFIC,2,!1,d))}}else if(t.name==="cRLDistributionPoints"){t.value=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);for(var o=t.value.value,y=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),g=v.create(v.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var a=u.value;if(u.type===7&&u.ip){if(a=Ee.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?a=v.oidToDer(v.oidToDer(u.oid)):a=v.oidToDer(a));g.value.push(v.create(v.Class.CONTEXT_SPECIFIC,u.type,!1,a))}y.value.push(v.create(v.Class.CONTEXT_SPECIFIC,0,!0,[g])),o.push(y)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function Yy(t,e){switch(t){case Ye["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(v.create(v.Class.CONTEXT_SPECIFIC,0,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(e.hash.algorithmOid).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(v.create(v.Class.CONTEXT_SPECIFIC,1,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(e.mgf.algorithmOid).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(e.mgf.hash.algorithmOid).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(v.create(v.Class.CONTEXT_SPECIFIC,2,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(e.saltLength).getBytes())])),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,r);default:return v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")}}function SV(t){var e=v.create(v.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,i=0;i<r.length;++i){var n=r[i],s=n.value,a=v.Type.UTF8;"valueTagClass"in n&&(a=n.valueTagClass),a===v.Type.UTF8&&(s=Ee.util.encodeUtf8(s));var o=!1;"valueConstructed"in n&&(o=n.valueConstructed);var c=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(n.type).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SET,!0,[v.create(v.Class.UNIVERSAL,a,o,s)])]);e.value.push(c)}return e}var xV=new Date("1950-01-01T00:00:00Z"),CV=new Date("2050-01-01T00:00:00Z");function IT(t){return t>=xV&&t<CV?v.create(v.Class.UNIVERSAL,v.Type.UTCTIME,!1,v.dateToUtcTime(t)):v.create(v.Class.UNIVERSAL,v.Type.GENERALIZEDTIME,!1,v.dateToGeneralizedTime(t))}se.getTBSCertificate=function(t){var e=IT(t.validity.notBefore),r=IT(t.validity.notAfter),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.CONTEXT_SPECIFIC,0,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(t.version).getBytes())]),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Ee.util.hexToBytes(t.serialNumber)),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(t.siginfo.algorithmOid).getBytes()),Yy(t.siginfo.algorithmOid,t.siginfo.parameters)]),nc(t.issuer),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[e,r]),nc(t.subject),se.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&i.value.push(v.create(v.Class.CONTEXT_SPECIFIC,1,!0,[v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&i.value.push(v.create(v.Class.CONTEXT_SPECIFIC,2,!0,[v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&i.value.push(se.certificateExtensionsToAsn1(t.extensions)),i};se.getCertificationRequestInfo=function(t){var e=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(t.version).getBytes()),nc(t.subject),se.publicKeyToAsn1(t.publicKey),SV(t)]);return e};se.distinguishedNameToAsn1=function(t){return nc(t)};se.certificateToAsn1=function(t){var e=t.tbsCertificate||se.getTBSCertificate(t);return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[e,v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(t.signatureOid).getBytes()),Yy(t.signatureOid,t.signatureParameters)]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};se.certificateExtensionsToAsn1=function(t){var e=v.create(v.Class.CONTEXT_SPECIFIC,3,!0,[]),r=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);e.value.push(r);for(var i=0;i<t.length;++i)r.value.push(se.certificateExtensionToAsn1(t[i]));return e};se.certificateExtensionToAsn1=function(t){var e=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);e.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(t.id).getBytes())),t.critical&&e.value.push(v.create(v.Class.UNIVERSAL,v.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=v.toDer(r).getBytes()),e.value.push(v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,r)),e};se.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||se.getCertificationRequestInfo(t);return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[e,v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(t.signatureOid).getBytes()),Yy(t.signatureOid,t.signatureParameters)]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};se.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(a){var o=r(a.issuer);return o},e.addCertificate=function(a){if(typeof a=="string"&&(a=Ee.pki.certificateFromPem(a)),i(a.subject),!e.hasCertificate(a))if(a.subject.hash in e.certs){var o=e.certs[a.subject.hash];Ee.util.isArray(o)||(o=[o]),o.push(a),e.certs[a.subject.hash]=o}else e.certs[a.subject.hash]=a},e.hasCertificate=function(a){typeof a=="string"&&(a=Ee.pki.certificateFromPem(a));var o=r(a.subject);if(!o)return!1;Ee.util.isArray(o)||(o=[o]);for(var c=v.toDer(se.certificateToAsn1(a)).getBytes(),u=0;u<o.length;++u){var l=v.toDer(se.certificateToAsn1(o[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var a=[];for(var o in e.certs)if(e.certs.hasOwnProperty(o)){var c=e.certs[o];if(!Ee.util.isArray(c))a.push(c);else for(var u=0;u<c.length;++u)a.push(c[u])}return a},e.removeCertificate=function(a){var o;if(typeof a=="string"&&(a=Ee.pki.certificateFromPem(a)),i(a.subject),!e.hasCertificate(a))return null;var c=r(a.subject);if(!Ee.util.isArray(c))return o=e.certs[a.subject.hash],delete e.certs[a.subject.hash],o;for(var u=v.toDer(se.certificateToAsn1(a)).getBytes(),l=0;l<c.length;++l){var f=v.toDer(se.certificateToAsn1(c[l])).getBytes();u===f&&(o=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[a.subject.hash],o};function r(a){return i(a),e.certs[a.hash]||null}function i(a){if(!a.hash){var o=Ee.md.sha1.create();a.attributes=se.RDNAttributesAsArray(nc(a),o),a.hash=o.digest().toHex()}}if(t)for(var n=0;n<t.length;++n){var s=t[n];e.addCertificate(s)}return e};se.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};se.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var i=e.slice(0),n=r.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,a=null,o=0;do{var c=e.shift(),u=null,l=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:se.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),a===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var f=u;Ee.util.isArray(f)||(f=[f]);for(var h=!1;!h&&f.length>0;){u=f.shift();try{h=u.verify(c)}catch(T){}}h||(a={message:"Certificate signature is invalid.",error:se.certificateError.bad_certificate})}a===null&&(!u||l)&&!t.hasCertificate(c)&&(a={message:"Certificate is not trusted.",error:se.certificateError.unknown_ca})}if(a===null&&u&&!c.isIssuer(u)&&(a={message:"Certificate issuer is invalid.",error:se.certificateError.bad_certificate}),a===null)for(var p={keyUsage:!0,basicConstraints:!0},d=0;a===null&&d<c.extensions.length;++d){var y=c.extensions[d];y.critical&&!(y.name in p)&&(a={message:"Certificate has an unsupported critical extension.",error:se.certificateError.unsupported_certificate})}if(a===null&&(!s||e.length===0&&(!u||l))){var g=c.getExtension("basicConstraints"),m=c.getExtension("keyUsage");if(m!==null&&(!m.keyCertSign||g===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:se.certificateError.bad_certificate}),a===null&&g!==null&&!g.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:se.certificateError.bad_certificate}),a===null&&m!==null&&"pathLenConstraint"in g){var w=o-1;w>g.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:se.certificateError.bad_certificate})}}var C=a===null?!0:a.error,V=r.verify?r.verify(C,o,i):C;if(V===!0)a=null;else throw C===!0&&(a={message:"The application rejected the certificate.",error:se.certificateError.bad_certificate}),(V||V===0)&&(typeof V=="object"&&!Ee.util.isArray(V)?(V.message&&(a.message=V.message),V.error&&(a.error=V.error)):typeof V=="string"&&(a.error=V)),a;s=!1,++o}while(e.length>0);return!0}});var PT=b((aee,RT)=>{var ae=nt();Vu();Jo();l0();Zo();d0();MA();Ta();Ot();Qy();var R=ae.asn1,Fr=RT.exports=ae.pkcs7=ae.pkcs7||{};Fr.messageFromPem=function(t){var e=ae.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=R.fromDer(e.body);return Fr.messageFromAsn1(i)};Fr.messageToPem=function(t,e){var r={type:"PKCS7",body:R.toDer(t.toAsn1()).getBytes()};return ae.pem.encode(r,{maxline:e})};Fr.messageFromAsn1=function(t){var e={},r=[];if(!R.validate(t,Fr.asn1.contentInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=r,i}var n=R.derToOid(e.contentType),s;switch(n){case ae.pki.oids.envelopedData:s=Fr.createEnvelopedData();break;case ae.pki.oids.encryptedData:s=Fr.createEncryptedData();break;case ae.pki.oids.signedData:s=Fr.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Fr.createSignedData=function(){var t=null;return t={type:ae.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(Zy(t,i,Fr.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var n=t.rawCapture.certificates.value,s=0;s<n.length;++s)t.certificates.push(ae.pki.certificateFromAsn1(n[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var i=[],n=0;n<t.certificates.length;++n)i.push(ae.pki.certificateToAsn1(t.certificates[n]));var s=[],a=R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(t.version).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return i.length>0&&a.value[0].value.push(R.create(R.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&a.value[0].value.push(R.create(R.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(R.create(R.Class.UNIVERSAL,R.Type.SET,!0,t.signerInfos)),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.type).getBytes()),a])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var a=i.certificate;typeof a=="string"&&(a=ae.pki.certificateFromPem(a)),n=a.issuer.attributes,s=a.serialNumber}var o=i.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof o=="string"&&(o=ae.pki.privateKeyFromPem(o));var c=i.digestAlgorithm||ae.pki.oids.sha1;switch(c){case ae.pki.oids.sha1:case ae.pki.oids.sha256:case ae.pki.oids.sha384:case ae.pki.oids.sha512:case ae.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var l=!1,f=!1,h=0;h<u.length;++h){var p=u[h];if(!l&&p.type===ae.pki.oids.contentType){if(l=!0,f)break;continue}if(!f&&p.type===ae.pki.oids.messageDigest){if(f=!0,l)break;continue}}if(!l||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:o,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:ae.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(ae.pki.oids.data).getBytes())]),"content"in t)){var n;t.content instanceof ae.util.ByteBuffer?n=t.content.bytes():typeof t.content=="string"&&(n=ae.util.encodeUtf8(t.content)),i.detached?t.detachedContent=R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,n):t.contentInfo.value.push(R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,n)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=ae.pki.certificateFromPem(i)),t.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var i={},n=0;n<t.signers.length;++n){var s=t.signers[n],a=s.digestAlgorithm;a in i||(i[a]=ae.md[ae.pki.oids[a]].create()),s.authenticatedAttributes.length===0?s.md=i[a]:s.md=ae.md[ae.pki.oids[a]].create()}t.digestAlgorithmIdentifiers=[];for(var a in i)t.digestAlgorithmIdentifiers.push(R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(a).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")]));return i}function r(i){var n;if(t.detachedContent?n=t.detachedContent:(n=t.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=R.derToOid(t.contentInfo.value[0].value),a=R.toDer(n);a.getByte(),R.getBerValueLength(a),a=a.getBytes();for(var o in i)i[o].start().update(a);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==ae.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=R.create(R.Class.UNIVERSAL,R.Type.SET,!0,[]),h=0;h<l.authenticatedAttributes.length;++h){var p=l.authenticatedAttributes[h];p.type===ae.pki.oids.messageDigest?p.value=i[l.digestAlgorithm].digest():p.type===ae.pki.oids.signingTime&&(p.value||(p.value=c)),f.value.push(Xy(p)),l.authenticatedAttributesAsn1.value.push(Xy(p))}a=R.toDer(f).getBytes(),l.md.start().update(a)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=BV(t.signers)}};Fr.createEncryptedData=function(){var t=null;return t={type:ae.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:ae.pki.oids["aes256-CBC"]},fromAsn1:function(e){Zy(t,e,Fr.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),TT(t)}},t};Fr.createEnvelopedData=function(){var t=null;return t={type:ae.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:ae.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=Zy(t,e,Fr.asn1.envelopedDataValidator);t.recipients=TV(r.recipientInfos.value)},toAsn1:function(){return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.type).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(t.version).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SET,!0,RV(t.recipients)),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,DV(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,i=0;i<t.recipients.length;++i){var n=t.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===r.length){for(var a=!0,o=0;o<r.length;++o)if(s[o].type!==r[o].type||s[o].value!==r[o].value){a=!1;break}if(a)return n}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case ae.pki.oids.rsaEncryption:case ae.pki.oids.desCBC:var i=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=ae.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}TT(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:ae.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var i,n,s;switch(r){case ae.pki.oids["aes128-CBC"]:i=16,n=16,s=ae.aes.createEncryptionCipher;break;case ae.pki.oids["aes192-CBC"]:i=24,n=16,s=ae.aes.createEncryptionCipher;break;case ae.pki.oids["aes256-CBC"]:i=32,n=16,s=ae.aes.createEncryptionCipher;break;case ae.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=ae.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=ae.util.createBuffer(ae.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=ae.util.createBuffer(ae.random.getBytes(n));var a=s(e);if(a.start(t.encryptedContent.parameter.copy()),a.update(t.content),!a.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=a.output}for(var o=0;o<t.recipients.length;++o){var c=t.recipients[o];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case ae.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function IV(t){var e={},r=[];if(!R.validate(t,Fr.asn1.recipientInfoValidator,e,r)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=r,i}return{version:e.version.charCodeAt(0),issuer:ae.pki.RDNAttributesAsArray(e.issuer),serialNumber:ae.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:R.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function AV(t){return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(t.version).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[ae.pki.distinguishedNameToAsn1({attributes:t.issuer}),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,ae.util.hexToBytes(t.serialNumber))]),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.encryptedContent.algorithm).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")]),R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function TV(t){for(var e=[],r=0;r<t.length;++r)e.push(IV(t[r]));return e}function RV(t){for(var e=[],r=0;r<t.length;++r)e.push(AV(t[r]));return e}function PV(t){var e=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(t.version).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[ae.pki.distinguishedNameToAsn1({attributes:t.issuer}),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,ae.util.hexToBytes(t.serialNumber))]),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.digestAlgorithm).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.signatureAlgorithm).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")])),e.value.push(R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=R.create(R.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<t.unauthenticatedAttributes.length;++i){var n=t.unauthenticatedAttributes[i];r.values.push(Xy(n))}e.value.push(r)}return e}function BV(t){for(var e=[],r=0;r<t.length;++r)e.push(PV(t[r]));return e}function Xy(t){var e;if(t.type===ae.pki.oids.contentType)e=R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.value).getBytes());else if(t.type===ae.pki.oids.messageDigest)e=R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===ae.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=t.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=R.utcTimeToDate(n):n=R.generalizedTimeToDate(n):n=new Date(s)}n>=r&&n<i?e=R.create(R.Class.UNIVERSAL,R.Type.UTCTIME,!1,R.dateToUtcTime(n)):e=R.create(R.Class.UNIVERSAL,R.Type.GENERALIZEDTIME,!1,R.dateToGeneralizedTime(n))}return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.type).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SET,!0,[e])])}function DV(t){return[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(ae.pki.oids.data).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(t.algorithm).getBytes()),t.parameter?R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t.content.getBytes())])]}function Zy(t,e,r){var i={},n=[];if(!R.validate(e,r,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var a=R.derToOid(i.contentType);if(a!==ae.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var o="";if(ae.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==R.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=i.encryptedContent[c].value}else o=i.encryptedContent;t.encryptedContent={algorithm:R.derToOid(i.encAlgorithm),parameter:ae.util.createBuffer(i.encParameter.value),content:ae.util.createBuffer(o)}}if(i.content){var o="";if(ae.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==R.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=i.content[c].value}else o=i.content;t.content=ae.util.createBuffer(o)}return t.version=i.version.charCodeAt(0),t.rawCapture=i,i}function TT(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case ae.pki.oids["aes128-CBC"]:case ae.pki.oids["aes192-CBC"]:case ae.pki.oids["aes256-CBC"]:e=ae.aes.createDecryptionCipher(t.encryptedContent.key);break;case ae.pki.oids.desCBC:case ae.pki.oids["des-EDE3-CBC"]:e=ae.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var DT=b((oee,BT)=>{var Yn=nt();Bs();Ot();var OV=BT.exports=Yn.hmac=Yn.hmac||{};OV.create=function(){var t=null,e=null,r=null,i=null,n={};return n.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Yn.md.algorithms)e=Yn.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=Yn.util.createBuffer(a);else if(Yn.util.isArray(a)){var o=a;a=Yn.util.createBuffer();for(var c=0;c<o.length;++c)a.putByte(o[c])}var u=a.length();u>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=Yn.util.createBuffer(),i=Yn.util.createBuffer(),u=a.length();for(var c=0;c<u;++c){var o=a.at(c);r.putByte(54^o),i.putByte(92^o)}if(u<e.blockLength)for(var o=e.blockLength-u,c=0;c<o;++c)r.putByte(54),i.putByte(92);t=a,r=r.bytes(),i=i.bytes()}e.start(),e.update(r)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var NT=b((cee,OT)=>{var Kr=nt();DT();Bs();Ot();var NV=Kr.pkcs5=Kr.pkcs5||{},Qn;Kr.util.isNodejs&&!Kr.options.usePureJavaScript&&(Qn=On());OT.exports=Kr.pbkdf2=NV.pbkdf2=function(t,e,r,i,n,s){if(typeof n=="function"&&(s=n,n=null),Kr.util.isNodejs&&!Kr.options.usePureJavaScript&&Qn.pbkdf2&&(n===null||typeof n!="object")&&(Qn.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Qn.pbkdf2Sync.length===4?Qn.pbkdf2(t,e,r,i,function(C,V){if(C)return s(C);s(null,V.toString("binary"))}):Qn.pbkdf2(t,e,r,i,n,function(C,V){if(C)return s(C);s(null,V.toString("binary"))}):Qn.pbkdf2Sync.length===4?Qn.pbkdf2Sync(t,e,r,i).toString("binary"):Qn.pbkdf2Sync(t,e,r,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Kr.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Kr.md[n].create()}var a=n.digestLength;if(i>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var c=Math.ceil(i/a),u=i-(c-1)*a,l=Kr.hmac.create();l.start(n,t);var f="",h,p,d;if(!s){for(var y=1;y<=c;++y){l.start(null,null),l.update(e),l.update(Kr.util.int32ToBytes(y)),h=d=l.digest().getBytes();for(var g=2;g<=r;++g)l.start(null,null),l.update(d),p=l.digest().getBytes(),h=Kr.util.xorBytes(h,p,a),d=p;f+=y<c?h:h.substr(0,u)}return f}var y=1,g;function m(){if(y>c)return s(null,f);l.start(null,null),l.update(e),l.update(Kr.util.int32ToBytes(y)),h=d=l.digest().getBytes(),g=2,w()}function w(){if(g<=r)return l.start(null,null),l.update(d),p=l.digest().getBytes(),h=Kr.util.xorBytes(h,p,a),d=p,++g,Kr.util.setImmediate(w);f+=y<c?h:h.substr(0,u),++y,m()}m()}});var qT=b((uee,MT)=>{var Yr=nt();Ot();var Jy=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],kT=[1,2,3,5],kV=function(t,e){return t<<e&65535|(t&65535)>>16-e},LV=function(t,e){return(t&65535)>>e|t<<16-e&65535};MT.exports=Yr.rc2=Yr.rc2||{};Yr.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Yr.util.createBuffer(t)),e=e||128;var r=t,i=t.length(),n=e,s=Math.ceil(n/8),a=255>>(n&7),o;for(o=i;o<128;o++)r.putByte(Jy[r.at(o-1)+r.at(o-i)&255]);for(r.setAt(128-s,Jy[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,Jy[r.at(o+1)^r.at(o+s)]);return r};var LT=function(t,e,r){var i=!1,n=null,s=null,a=null,o,c,u,l,f=[];for(t=Yr.rc2.expandKey(t,e),u=0;u<64;u++)f.push(t.getInt16Le());r?(o=function(d){for(u=0;u<4;u++)d[u]+=f[l]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),d[u]=kV(d[u],kT[u]),l++},c=function(d){for(u=0;u<4;u++)d[u]+=f[d[(u+3)%4]&63]}):(o=function(d){for(u=3;u>=0;u--)d[u]=LV(d[u],kT[u]),d[u]-=f[l]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),l--},c=function(d){for(u=3;u>=0;u--)d[u]-=f[d[(u+3)%4]&63]});var h=function(d){var y=[];for(u=0;u<4;u++){var g=n.getInt16Le();a!==null&&(r?g^=a.getInt16Le():a.putInt16Le(g)),y.push(g&65535)}l=r?0:63;for(var m=0;m<d.length;m++)for(var w=0;w<d[m][0];w++)d[m][1](y);for(u=0;u<4;u++)a!==null&&(r?a.putInt16Le(y[u]):y[u]^=a.getInt16Le()),s.putInt16Le(y[u])},p=null;return p={start:function(d,y){d&&typeof d=="string"&&(d=Yr.util.createBuffer(d)),i=!1,n=Yr.util.createBuffer(),s=y||new Yr.util.createBuffer,a=d,p.output=s},update:function(d){for(i||n.putBuffer(d);n.length()>=8;)h([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(d){var y=!0;if(r)if(d)y=d(8,n,!r);else{var g=n.length()===8?8:8-n.length();n.fillWithByte(g,g)}if(y&&(i=!0,p.update()),!r&&(y=n.length()===0,y))if(d)y=d(8,s,!r);else{var m=s.length(),w=s.at(m-1);w>m?y=!1:s.truncate(w)}return y}},p};Yr.rc2.startEncrypting=function(t,e,r){var i=Yr.rc2.createEncryptionCipher(t,128);return i.start(e,r),i};Yr.rc2.createEncryptionCipher=function(t,e){return LT(t,e,!0)};Yr.rc2.startDecrypting=function(t,e,r){var i=Yr.rc2.createDecryptionCipher(t,128);return i.start(e,r),i};Yr.rc2.createDecryptionCipher=function(t,e){return LT(t,e,!1)}});var GT=b((lee,jT)=>{var he=nt();Vu();Jo();l0();Bs();Zo();NT();d0();Ta();qT();$y();Ot();typeof UT=="undefined"&&(UT=he.jsbn.BigInteger);var UT,z=he.asn1,ke=he.pki=he.pki||{};jT.exports=ke.pbe=he.pbe=he.pbe||{};var Oa=ke.oids,MV={name:"EncryptedPrivateKeyInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},qV={name:"PBES2Algorithms",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},UV={name:"pkcs-12PbeParams",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"iterations"}]};ke.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i=he.random.getBytesSync(r.saltSize),n=r.count,s=z.integerToDer(n),a,o,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,f;switch(r.algorithm){case"aes128":a=16,u=16,l=Oa["aes128-CBC"],f=he.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,l=Oa["aes192-CBC"],f=he.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,l=Oa["aes256-CBC"],f=he.aes.createEncryptionCipher;break;case"des":a=8,u=8,l=Oa.desCBC,f=he.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),d=VT(p),y=he.pkcs5.pbkdf2(e,i,n,a,d),g=he.random.getBytesSync(u),m=f(y);m.start(g),m.update(z.toDer(t)),m.finish(),c=m.output.getBytes();var w=FV(i,s,a,p);o=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Oa.pkcs5PBES2).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Oa.pkcs5PBKDF2).getBytes()),w]),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(l).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){a=24;var C=new he.util.ByteBuffer(i),y=ke.pbe.generatePkcs12Key(e,C,1,n,a),g=ke.pbe.generatePkcs12Key(e,C,2,n,a),m=he.des.createEncryptionCipher(y);m.start(g),m.update(z.toDer(t)),m.finish(),c=m.output.getBytes(),o=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Oa["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,i),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var V=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[o,z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,c)]);return V};ke.decryptPrivateKeyInfo=function(t,e){var r=null,i={},n=[];if(!z.validate(t,MV,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var a=z.derToOid(i.encryptionOid),o=ke.pbe.getCipher(a,i.encryptionParams,e),c=he.util.createBuffer(i.encryptedData);return o.update(c),o.finish()&&(r=z.fromDer(o.output)),r};ke.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:z.toDer(t).getBytes()};return he.pem.encode(r,{maxline:e})};ke.encryptedPrivateKeyFromPem=function(t){var e=he.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return z.fromDer(e.body)};ke.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var i=ke.wrapRsaPrivateKey(ke.privateKeyToAsn1(t));return i=ke.encryptPrivateKeyInfo(i,e,r),ke.encryptedPrivateKeyToPem(i)}var n,s,a,o;switch(r.algorithm){case"aes128":n="AES-128-CBC",a=16,s=he.random.getBytesSync(16),o=he.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",a=24,s=he.random.getBytesSync(16),o=he.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",a=32,s=he.random.getBytesSync(16),o=he.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",a=24,s=he.random.getBytesSync(8),o=he.des.createEncryptionCipher;break;case"des":n="DES-CBC",a=8,s=he.random.getBytesSync(8),o=he.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=he.pbe.opensslDeriveBytes(e,s.substr(0,8),a),l=o(u);l.start(s),l.update(z.toDer(ke.privateKeyToAsn1(t))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:he.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return he.pem.encode(f)};ke.decryptRsaPrivateKey=function(t,e){var r=null,i=he.pem.decode(t)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,a;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,a=he.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=he.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=he.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=he.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=he.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(f){return he.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,a=function(f){return he.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,a=function(f){return he.rc2.createDecryptionCipher(f,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var o=he.util.hexToBytes(i.dekInfo.parameters),c=he.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(c);if(u.start(o),u.update(he.util.createBuffer(i.body)),u.finish())r=u.output.getBytes();else return r}else r=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?r=ke.decryptPrivateKeyInfo(z.fromDer(r),e):r=z.fromDer(r),r!==null&&(r=ke.privateKeyFromAsn1(r)),r};ke.pbe.generatePkcs12Key=function(t,e,r,i,n,s){var a,o;if(typeof s=="undefined"||s===null){if(!("sha1"in he.md))throw new Error('"sha1" hash algorithm unavailable.');s=he.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new he.util.ByteBuffer,f=new he.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)f.putInt16(t.charCodeAt(o));f.putInt16(0)}var h=f.length(),p=e.length(),d=new he.util.ByteBuffer;d.fillWithByte(r,u);var y=u*Math.ceil(p/u),g=new he.util.ByteBuffer;for(o=0;o<y;o++)g.putByte(e.at(o%p));var m=u*Math.ceil(h/u),w=new he.util.ByteBuffer;for(o=0;o<m;o++)w.putByte(f.at(o%h));var C=g;C.putBuffer(w);for(var V=Math.ceil(n/c),T=1;T<=V;T++){var A=new he.util.ByteBuffer;A.putBytes(d.bytes()),A.putBytes(C.bytes());for(var te=0;te<i;te++)s.start(),s.update(A.getBytes()),A=s.digest();var ie=new he.util.ByteBuffer;for(o=0;o<u;o++)ie.putByte(A.at(o%c));var $=Math.ceil(p/u)+Math.ceil(h/u),Ce=new he.util.ByteBuffer;for(a=0;a<$;a++){var me=new he.util.ByteBuffer(C.getBytes(u)),be=511;for(o=ie.length()-1;o>=0;o--)be=be>>8,be+=ie.at(o)+me.at(o),me.setAt(o,be&255);Ce.putBuffer(me)}C=Ce,l.putBuffer(A)}return l.truncate(l.length()-n),l};ke.pbe.getCipher=function(t,e,r){switch(t){case ke.oids.pkcs5PBES2:return ke.pbe.getCipherForPBES2(t,e,r);case ke.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ke.oids["pbewithSHAAnd40BitRC2-CBC"]:return ke.pbe.getCipherForPKCS12PBE(t,e,r);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=t,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};ke.pbe.getCipherForPBES2=function(t,e,r){var i={},n=[];if(!z.validate(e,qV,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(t=z.derToOid(i.kdfOid),t!==ke.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=z.derToOid(i.encOid),t!==ke.oids["aes128-CBC"]&&t!==ke.oids["aes192-CBC"]&&t!==ke.oids["aes256-CBC"]&&t!==ke.oids["des-EDE3-CBC"]&&t!==ke.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=i.kdfSalt,o=he.util.createBuffer(i.kdfIterationCount);o=o.getInt(o.length()<<3);var c,u;switch(ke.oids[t]){case"aes128-CBC":c=16,u=he.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=he.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=he.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=he.des.createDecryptionCipher;break;case"desCBC":c=8,u=he.des.createDecryptionCipher;break}var l=KT(i.prfOid),f=he.pkcs5.pbkdf2(r,a,o,c,l),h=i.encIv,p=u(f);return p.start(h),p};ke.pbe.getCipherForPKCS12PBE=function(t,e,r){var i={},n=[];if(!z.validate(e,UV,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var a=he.util.createBuffer(i.salt),o=he.util.createBuffer(i.iterations);o=o.getInt(o.length()<<3);var c,u,l;switch(t){case ke.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=he.des.startDecrypting;break;case ke.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(y,g){var m=he.rc2.createDecryptionCipher(y,40);return m.start(g,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var f=KT(i.prfOid),h=ke.pbe.generatePkcs12Key(r,a,1,o,c,f);f.start();var p=ke.pbe.generatePkcs12Key(r,a,2,o,u,f);return l(h,p)};ke.pbe.opensslDeriveBytes=function(t,e,r,i){if(typeof i=="undefined"||i===null){if(!("md5"in he.md))throw new Error('"md5" hash algorithm unavailable.');i=he.md.md5.create()}e===null&&(e="");for(var n=[FT(i,t+e)],s=16,a=1;s<r;++a,s+=16)n.push(FT(i,n[a-1]+t+e));return n.join("").substr(0,r)};function FT(t,e){return t.start().update(e).digest().getBytes()}function KT(t){var e;if(!t)e="hmacWithSHA1";else if(e=ke.oids[z.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return VT(e)}function VT(t){var e=he.md;switch(t){case"hmacWithSHA224":e=he.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function FV(t,e,r,i){var n=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,t),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,he.util.hexToBytes(r.toString(16))),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(ke.oids[i]).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")])),n}});var WT=b((fee,zT)=>{"use strict";Qy();var KV=nt(),HT=KV.pki,VV=(t,e)=>{let r=HT.setRsaPublicKey(e.n,e.e),i=HT.createCertificate();i.publicKey=r,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function jV(t,e){let r=t.map(e),n=(await Promise.all(r)).findIndex(s=>s);return t[n]}zT.exports={certificateForKey:VV,findAsync:jV}});var XT=b((hee,QT)=>{"use strict";PT();GT();var ks=nt(),{certificateForKey:GV,findAsync:HV}=WT(),sc=Ae(),{fromString:$T}=(ar(),pr),{toString:zV}=(yr(),Sr),{codes:ac}=yt(),eg=new WeakMap,YT=class{constructor(e,r){if(!e)throw sc(new Error("keychain is required"),ac.ERR_KEYCHAIN_REQUIRED);this.keychain=e,eg.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw sc(new Error("Plain data must be a Uint8Array"),ac.ERR_INVALID_PARAMETERS);let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=eg.get(this).dek,a=ks.pki.decryptRsaPrivateKey(n,s),o=await GV(i,a),c=ks.pkcs7.createEnvelopedData();c.addRecipient(o),c.content=ks.util.createBuffer(r),c.encrypt();let u=ks.asn1.toDer(c.toAsn1()).getBytes();return $T(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw sc(new Error("CMS data is required"),ac.ERR_INVALID_PARAMETERS);let r;try{let u=ks.util.createBuffer(zV(e,"ascii")),l=ks.asn1.fromDer(u);r=ks.pkcs7.messageFromAsn1(l)}catch(u){throw sc(new Error("Invalid CMS: "+u.message),ac.ERR_INVALID_CMS)}let i=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),n=await HV(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!n){let u=i.map(l=>l.keyId);throw sc(new Error("Decryption needs one of the key(s): "+u.join(", ")),ac.ERR_MISSING_KEYS,{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw sc(new Error("No key available to decrypto"),ac.ERR_NO_KEY);let a=await this.keychain._getPrivateKey(s.name),o=eg.get(this).dek,c=ks.pki.decryptRsaPrivateKey(a,o);return r.decrypt(n.recipient,c),$T(r.content.getBytes(),"ascii")}};QT.exports=YT});var rR=b((dee,tR)=>{var At=nt();Bs();Ot();var zu=tR.exports=At.sha512=At.sha512||{};At.md.sha512=At.md.algorithms.sha512=zu;var ZT=At.sha384=At.sha512.sha384=At.sha512.sha384||{};ZT.create=function(){return zu.create("SHA-384")};At.md.sha384=At.md.algorithms.sha384=ZT;At.sha512.sha256=At.sha512.sha256||{create:function(){return zu.create("SHA-512/256")}};At.md["sha512/256"]=At.md.algorithms["sha512/256"]=At.sha512.sha256;At.sha512.sha224=At.sha512.sha224||{create:function(){return zu.create("SHA-512/224")}};At.md["sha512/224"]=At.md.algorithms["sha512/224"]=At.sha512.sha224;zu.create=function(t){if(JT||WV(),typeof t=="undefined"&&(t="SHA-512"),!(t in Na))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Na[t],r=null,i=At.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var c=o.messageLengthSize/4,u=0;u<c;++u)o.fullMessageLength.push(0);i=At.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return o},o.start(),o.update=function(c,u){u==="utf8"&&(c=At.util.encodeUtf8(c));var l=c.length;o.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=o.fullMessageLength.length-1;f>=0;--f)o.fullMessageLength[f]+=l[1],l[1]=l[0]+(o.fullMessageLength[f]/4294967296>>>0),o.fullMessageLength[f]=o.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),eR(r,n,i),(i.read>2048||i.length()===0)&&i.compact(),o},o.digest=function(){var c=At.util.createBuffer();c.putBytes(i.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,l=u&o.blockLength-1;c.putBytes(tg.substr(0,o.blockLength-l));for(var f,h,p=o.fullMessageLength[0]*8,d=0;d<o.fullMessageLength.length-1;++d)f=o.fullMessageLength[d+1]*8,h=f/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=f>>>0;c.putInt32(p);for(var y=new Array(r.length),d=0;d<r.length;++d)y[d]=r[d].slice(0);eR(y,n,c);var g=At.util.createBuffer(),m;t==="SHA-512"?m=y.length:t==="SHA-384"?m=y.length-2:m=y.length-4;for(var d=0;d<m;++d)g.putInt32(y[d][0]),(d!==m-1||t!=="SHA-512/224")&&g.putInt32(y[d][1]);return g},o};var tg=null,JT=!1,rg=null,Na=null;function WV(){tg=String.fromCharCode(128),tg+=At.util.fillString(String.fromCharCode(0),128),rg=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Na={},Na["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Na["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Na["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Na["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],JT=!0}function eR(t,e,r){for(var i,n,s,a,o,c,u,l,f,h,p,d,y,g,m,w,C,V,T,A,te,ie,$,Ce,me,be,st,_t,Se,Re,Y,cr,Yt,Qr,ur,Xr=r.length();Xr>=128;){for(Se=0;Se<16;++Se)e[Se][0]=r.getInt32()>>>0,e[Se][1]=r.getInt32()>>>0;for(;Se<80;++Se)cr=e[Se-2],Re=cr[0],Y=cr[1],i=((Re>>>19|Y<<13)^(Y>>>29|Re<<3)^Re>>>6)>>>0,n=((Re<<13|Y>>>19)^(Y<<3|Re>>>29)^(Re<<26|Y>>>6))>>>0,Qr=e[Se-15],Re=Qr[0],Y=Qr[1],s=((Re>>>1|Y<<31)^(Re>>>8|Y<<24)^Re>>>7)>>>0,a=((Re<<31|Y>>>1)^(Re<<24|Y>>>8)^(Re<<25|Y>>>7))>>>0,Yt=e[Se-7],ur=e[Se-16],Y=n+Yt[1]+a+ur[1],e[Se][0]=i+Yt[0]+s+ur[0]+(Y/4294967296>>>0)>>>0,e[Se][1]=Y>>>0;for(y=t[0][0],g=t[0][1],m=t[1][0],w=t[1][1],C=t[2][0],V=t[2][1],T=t[3][0],A=t[3][1],te=t[4][0],ie=t[4][1],$=t[5][0],Ce=t[5][1],me=t[6][0],be=t[6][1],st=t[7][0],_t=t[7][1],Se=0;Se<80;++Se)u=((te>>>14|ie<<18)^(te>>>18|ie<<14)^(ie>>>9|te<<23))>>>0,l=((te<<18|ie>>>14)^(te<<14|ie>>>18)^(ie<<23|te>>>9))>>>0,f=(me^te&($^me))>>>0,h=(be^ie&(Ce^be))>>>0,o=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,c=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,p=(y&m|C&(y^m))>>>0,d=(g&w|V&(g^w))>>>0,Y=_t+l+h+rg[Se][1]+e[Se][1],i=st+u+f+rg[Se][0]+e[Se][0]+(Y/4294967296>>>0)>>>0,n=Y>>>0,Y=c+d,s=o+p+(Y/4294967296>>>0)>>>0,a=Y>>>0,st=me,_t=be,me=$,be=Ce,$=te,Ce=ie,Y=A+n,te=T+i+(Y/4294967296>>>0)>>>0,ie=Y>>>0,T=C,A=V,C=m,V=w,m=y,w=g,Y=n+a,y=i+s+(Y/4294967296>>>0)>>>0,g=Y>>>0;Y=t[0][1]+g,t[0][0]=t[0][0]+y+(Y/4294967296>>>0)>>>0,t[0][1]=Y>>>0,Y=t[1][1]+w,t[1][0]=t[1][0]+m+(Y/4294967296>>>0)>>>0,t[1][1]=Y>>>0,Y=t[2][1]+V,t[2][0]=t[2][0]+C+(Y/4294967296>>>0)>>>0,t[2][1]=Y>>>0,Y=t[3][1]+A,t[3][0]=t[3][0]+T+(Y/4294967296>>>0)>>>0,t[3][1]=Y>>>0,Y=t[4][1]+ie,t[4][0]=t[4][0]+te+(Y/4294967296>>>0)>>>0,t[4][1]=Y>>>0,Y=t[5][1]+Ce,t[5][0]=t[5][0]+$+(Y/4294967296>>>0)>>>0,t[5][1]=Y>>>0,Y=t[6][1]+be,t[6][0]=t[6][0]+me+(Y/4294967296>>>0)>>>0,t[6][1]=Y>>>0,Y=t[7][1]+_t,t[7][0]=t[7][0]+st+(Y/4294967296>>>0)>>>0,t[7][1]=Y>>>0,Xr-=128}}});var uR=b((pee,cR)=>{"use strict";var iR=qe(),nR=Object.assign(iR("libp2p:keychain"),{error:iR("libp2p:keychain:err")}),$V=eA(),YV=Ro(),ka=Fu(),{Key:sR}=(Tf(),pp),QV=XT(),kt=Ae(),{codes:Lt}=yt(),{toString:La}=(yr(),Sr),{fromString:Xn}=(ar(),pr);rR();var XV="/pkcs8/",aR="/info/",Ls=new WeakMap,Ma={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},ig={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function Zn(t){return!t||typeof t!="string"?!1:t===$V(t.trim())}async function ct(t){let e=200,r=1e3,i=Math.random()*(r-e)+e;throw await new Promise(n=>setTimeout(n,i)),t}function In(t){return new sR(XV+t)}function Ms(t){return new sR(aR+t)}var oR=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=YV(ig,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Ma.minKeyLength)throw new Error(`dek.keyLength must be least ${Ma.minKeyLength} bytes`);if(this.opts.dek.salt.length<Ma.minSaltLength)throw new Error(`dek.saltLength must be least ${Ma.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Ma.minIterationCount)throw new Error(`dek.iterationCount must be least ${Ma.minIterationCount}`);let i=this.opts.pass?ka.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Ls.set(this,{dek:i})}get cms(){return new QV(this,Ls.get(this).dek)}static generateOptions(){let e=Object.assign({},ig),r=Math.ceil(Ma.minSaltLength/3)*3;return e.dek.salt=La(ka.randomBytes(r),"base64"),e}static get options(){return ig}async createKey(e,r,i=2048){let n=this;if(!Zn(e)||e==="self")return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));if(typeof r!="string")return ct(kt(new Error(`Invalid key type '${r}'`),Lt.ERR_INVALID_KEY_TYPE));let s=In(e);if(await n.store.has(s))return ct(kt(new Error(`Key '${e}' already exists`),Lt.ERR_KEY_ALREADY_EXISTS));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return ct(kt(new Error(`Invalid RSA key size ${i}`),Lt.ERR_INVALID_KEY_SIZE));break;default:break}let o;try{let c=await ka.keys.generateKeyPair(r,i),u=await c.id(),l=Ls.get(this).dek,f=await c.export(l);o={name:e,id:u};let h=n.store.batch();h.put(s,Xn(f)),h.put(Ms(e),Xn(JSON.stringify(o))),await h.commit()}catch(c){return ct(c)}return o}async listKeys(){let e=this,r={prefix:aR},i=[];for await(let n of e.store.query(r))i.push(JSON.parse(La(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(r){return ct(r)}}async findKeyByName(e){if(!Zn(e))return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));let r=Ms(e);try{let i=await this.store.get(r);return JSON.parse(La(i))}catch(i){return ct(kt(new Error(`Key '${e}' does not exist. ${i.message}`),Lt.ERR_KEY_NOT_FOUND))}}async removeKey(e){let r=this;if(!Zn(e)||e==="self")return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));let i=In(e),n=await r.findKeyByName(e),s=r.store.batch();return s.delete(i),s.delete(Ms(e)),await s.commit(),n}async renameKey(e,r){let i=this;if(!Zn(e)||e==="self")return ct(kt(new Error(`Invalid old key name '${e}'`),Lt.ERR_OLD_KEY_NAME_INVALID));if(!Zn(r)||r==="self")return ct(kt(new Error(`Invalid new key name '${r}'`),Lt.ERR_NEW_KEY_NAME_INVALID));let n=In(e),s=In(r),a=Ms(e),o=Ms(r);if(await i.store.has(s))return ct(kt(new Error(`Key '${r}' already exists`),Lt.ERR_KEY_ALREADY_EXISTS));try{let u=await i.store.get(n),l=await i.store.get(a),f=JSON.parse(La(l));f.name=r;let h=i.store.batch();return h.put(s,u),h.put(o,Xn(JSON.stringify(f))),h.delete(n),h.delete(a),await h.commit(),f}catch(u){return ct(u)}}async exportKey(e,r){if(!Zn(e))return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));if(!r)return ct(kt(new Error("Password is required"),Lt.ERR_PASSWORD_REQUIRED));let i=In(e);try{let n=await this.store.get(i),s=La(n),a=Ls.get(this).dek;return(await ka.keys.import(s,a)).export(r)}catch(n){return ct(n)}}async importKey(e,r,i){let n=this;if(!Zn(e)||e==="self")return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));if(!r)return ct(kt(new Error("PEM encoded key is required"),Lt.ERR_PEM_REQUIRED));let s=In(e);if(await n.store.has(s))return ct(kt(new Error(`Key '${e}' already exists`),Lt.ERR_KEY_ALREADY_EXISTS));let o;try{o=await ka.keys.import(r,i)}catch(f){return ct(kt(new Error("Cannot read the key, most likely the password is wrong"),Lt.ERR_CANNOT_READ_KEY))}let c;try{c=await o.id();let f=Ls.get(this).dek;r=await o.export(f)}catch(f){return ct(f)}let u={name:e,id:c},l=n.store.batch();return l.put(s,Xn(r)),l.put(Ms(e),Xn(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let i=this;if(!Zn(e))return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));if(!r||!r.privKey)return ct(kt(new Error("Peer.privKey is required"),Lt.ERR_MISSING_PRIVATE_KEY));let n=r.privKey,s=In(e);if(await i.store.has(s))return ct(kt(new Error(`Key '${e}' already exists`),Lt.ERR_KEY_ALREADY_EXISTS));try{let o=await n.id(),c=Ls.get(this).dek,u=await n.export(c),l={name:e,id:o},f=i.store.batch();return f.put(s,Xn(u)),f.put(Ms(e),Xn(JSON.stringify(l))),await f.commit(),l}catch(o){return ct(o)}}async _getPrivateKey(e){if(!Zn(e))return ct(kt(new Error(`Invalid key name '${e}'`),Lt.ERR_INVALID_KEY_NAME));try{let r=In(e),i=await this.store.get(r);return La(i)}catch(r){return ct(kt(new Error(`Key '${e}' does not exist. ${r.message}`),Lt.ERR_KEY_NOT_FOUND))}}async rotateKeychainPass(e,r){if(typeof e!="string")return ct(kt(new Error(`Invalid old pass type '${typeof e}'`),Lt.ERR_INVALID_OLD_PASS_TYPE));if(typeof r!="string")return ct(kt(new Error(`Invalid new pass type '${typeof r}'`),Lt.ERR_INVALID_NEW_PASS_TYPE));if(r.length<20)return ct(kt(new Error(`Invalid pass length ${r.length}`),Lt.ERR_INVALID_PASS_LENGTH));nR("recreating keychain");let i=Ls.get(this).dek;this.opts.pass=r;let n=r?ka.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Ls.set(this,{dek:n});let s=await this.listKeys();for(let a of s){let o=await this.store.get(In(a.name)),c=La(o),u=await ka.keys.import(c,i),l=n.toString(),f=await u.export(l),h=this.store.batch(),p={name:a.name,id:a.id};h.put(In(a.name),Xn(f)),h.put(Ms(a.name),Xn(JSON.stringify(p))),await h.commit()}nR("keychain reconstructed")}};cR.exports=oR});var x0=b((S0,lR)=>{(function(t,e){typeof S0=="object"&&typeof lR!="undefined"?e(S0):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(S0,function(t){"use strict";async function*e(E,x){let O=[];for await(let q of x)O.push(q),O.length===E&&(yield O,O=[]);O.length>0&&(yield O)}function*r(E,x){let O=[];for(let q of x)O.push(q),O.length===E&&(yield O,O=[]);O.length>0&&(yield O)}function i(E,x){return x===void 0?O=>i(E,O):x[Symbol.asyncIterator]?e(E,x):r(E,x)}let n=Symbol("TIMEOUT"),s=E=>{let x;return[new Promise(O=>{x=setTimeout(()=>O(n),E)}),()=>{clearTimeout(x)}]};async function*a(E,x,O){let q=O[Symbol.asyncIterator](),Z,de=[],ge,pe,ye=()=>{Ie(),[ge,pe]=s(x)},Ie=()=>{pe&&pe(),ge=void 0};for(Z=q.next();;){let et=await(ge?Promise.race([Z,ge]):Z);if(et===n||et.done){if(de.length&&(yield de,de=[]),Ie(),et!==n)break;continue}if(Z=q.next(),de.push(et.value),de.length===1&&ye(),de.length===E){yield de,de=[],Ie();continue}}}function o(E,x,O){return O===void 0?q=>o(E,x,q):O[Symbol.asyncIterator]&&x!==1/0?a(E,x,O):i(E,O)}function c(E){if(typeof E.next=="function")return E;if(typeof E[Symbol.iterator]=="function")return E[Symbol.iterator]();if(typeof E[Symbol.asyncIterator]=="function")return E[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function u(){let E,x;return{promise:new Promise((q,Z)=>{x=q,E=Z}),reject:E,resolve:x}}function l(E,x){let O=c(x),q=[],Z=[],de=!1,ge=!1;function pe(){for(;Z.length>0&&q.length>0;){let Oe=Z.shift(),{error:Tt,value:er}=q.shift();Tt?Oe.reject(Tt):Oe.resolve({done:!1,value:er})}for(;Z.length>0&&ge;){let{resolve:Oe}=Z.shift();Oe({done:!0,value:void 0})}}async function ye(){if(!ge&&!de&&!(q.length>=E)){de=!0;try{let{done:Oe,value:Tt}=await O.next();Oe?ge=!0:q.push({value:Tt})}catch(Oe){ge=!0,q.push({error:Oe})}pe(),de=!1,ye()}}async function Ie(){if(q.length>0){let{error:Tt,value:er}=q.shift();if(Tt)throw Tt;return ye(),{done:!1,value:er}}if(ge)return{done:!0,value:void 0};let Oe=u();return Z.push(Oe),ye(),Oe.promise}let et={next:Ie,[Symbol.asyncIterator]:()=>et};return et}function*f(E,x){let O=[],q;try{for(let Z of x)O.push(Z),!(O.length<=E)&&(yield O.shift())}catch(Z){q=Z}for(let Z of O)yield Z;if(q)throw q}function h(E,x){return x===void 0?O=>h(E,O):E===0?x:x[Symbol.asyncIterator]?l(E,x):f(E,x)}async function p(E){let x=[];for await(let O of E)x.push(O);return x}function d(E){return E[Symbol.asyncIterator]?p(E):Array.from(E)}async function*y(E){for await(let x of E)yield*x}function*g(E){for(let x of E)yield*x}function m(...E){return E.find(O=>O[Symbol.asyncIterator]!==void 0)?y(E):g(E)}async function w(E){for await(let x of E);}function C(E){if(E[Symbol.asyncIterator])return w(E);for(let x of E);}async function*V(E,x){for await(let O of x)await E(O)&&(yield O)}function T(E,x){return x===void 0?O=>V(E,O):V(E,x)}async function*A(E){for await(let x of E)x&&typeof x!="string"&&(x[Symbol.iterator]||x[Symbol.asyncIterator])?yield*A(x):yield x}async function*te(E,x){for await(let O of x)yield await E(O)}function ie(E,x){return x===void 0?O=>te(E,O):te(E,x)}function $(E,x){return x===void 0?O=>$(E,O):T(O=>O!=null,A(ie(E,x)))}function Ce(E,x,O){let q=c(O),Z=[],de=[],ge=!1,pe=!1,ye=0,Ie=null;function et(){for(;de.length>0&&Z.length>0;){let{resolve:Ve}=de.shift(),Pe=Z.shift();Ve({done:!1,value:Pe})}for(;de.length>0&&ye===0&&ge;){let{resolve:Ve,reject:Pe}=de.shift();Ie?(Pe(Ie),Ie=null):Ve({done:!0,value:void 0})}}async function Oe(){if(ge){et();return}if(!pe&&!(ye+Z.length>=E)){pe=!0,ye++;try{let{done:Ve,value:Pe}=await q.next();Ve?(ge=!0,ye--,et()):Tt(Pe)}catch(Ve){ge=!0,ye--,Ie=Ve,et()}pe=!1,Oe()}}async function Tt(Ve){try{let Pe=await x(Ve);if(Pe&&Pe[Symbol.asyncIterator])for await(let Rt of Pe)Z.push(Rt);else Z.push(Pe)}catch(Pe){ge=!0,Ie=Pe}ye--,et(),Oe()}async function er(){if(Z.length===0){let Pe=u();return de.push(Pe),Oe(),Pe.promise}let Ve=Z.shift();return Oe(),{done:!1,value:Ve}}let Zr={next:er,[Symbol.asyncIterator]:()=>Zr};return Zr}function me(E,x,O){return x===void 0?(q,Z)=>Z?me(E,q,Z):me(E,q):O===void 0?q=>me(E,x,q):T(q=>q!=null,A(Ce(E,x,O)))}async function be(E){return new Promise(x=>{E.once("readable",()=>{x()})})}async function*st(E){for(;;){let x=E.read();if(x!==null){yield x;continue}if(E._readableState.ended)break;await be(E)}}function _t(E){return typeof E[Symbol.asyncIterator]=="function"?E:st(E)}async function*Se(...E){let x=new Set(E.map(c));for(;x.size>0;)for(let O of x){let q=await O.next();q.done?x.delete(O):yield q.value}}function Re(E,...x){let O=E();for(let q of x)O=q(O);return O}async function*Y(E,x,O){let q=null,Z=ye=>({value:x(ye)}),de=async function*(ye){for await(let Ie of ye){if(q)return;yield Ie}},ge=Re(()=>O,h(1),de,ie(Z),h(E-1)),pe=c(ge);for(;;){let{value:ye,done:Ie}=await pe.next();if(Ie)break;try{let et=await ye.value;q||(yield et)}catch(et){q=et}}if(q)throw q}function cr(E,x,O){return x===void 0?(q,Z)=>cr(E,q,Z):O===void 0?q=>cr(E,x,q):E===1?ie(x,O):Y(E,x,O)}function Yt(E,x,O){return x===void 0?(q,Z)=>Z?Yt(E,q,Z):Yt(E,q):O===void 0?q=>Yt(E,x,q):T(q=>q!=null,A(cr(E,x,O)))}async function*Qr(...E){let x=E.map(c),O=new Set,q=new Map,Z=null,de=null,ge=null,pe=Oe=>{Z=Oe,de&&de(Oe)},ye=Oe=>{ge&&ge(Oe)},Ie=()=>new Promise((Oe,Tt)=>{if(Z&&Tt(Z),q.size>0)return Oe();ge=Oe,de=Tt}),et=Oe=>{let Tt=Promise.resolve(Oe.next()).then(async({done:er,value:Zr})=>{er||q.set(Oe,Zr),O.delete(Tt)});O.add(Tt),Tt.then(ye,pe)};for(let Oe of x)et(Oe);for(;;){if(O.size===0&&q.size===0)return;await Ie();for(let[Oe,Tt]of q)q.delete(Oe),yield Tt,et(Oe)}}async function ur(E,x,O){let q=x;for await(let Z of O)q=await E(q,Z);return q}function Xr(E,x,O){return x===void 0?(q,Z)=>Z?ur(E,q,Z):Xr(E,q):O===void 0?q=>Xr(E,x,q):ur(E,x,O)}async function*ne(E,x){let O=0;for await(let q of x)if(yield await q,O++,O>=E)break}function*Bc(E,x){let O=0;for(let q of x)if(yield q,O++,O>=E)break}function Dc(E,x){return x===void 0?O=>Dc(E,O):x[Symbol.asyncIterator]?ne(E,x):Bc(E,x)}async function*Qa(E,x){for await(let O of x)await E(O),yield O}function jr(E,x){return x===void 0?O=>Qa(E,O):Qa(E,x)}let ki=E=>new Promise(x=>setTimeout(x,E));function _(E,x,O){if(!Number.isFinite(E))throw new TypeError("Expected `limit` to be a finite number");if(E<=0)throw new TypeError("Expected `limit` to be greater than 0");if(!Number.isFinite(x))throw new TypeError("Expected `interval` to be a finite number");return async function*(){let Z=0,de;for await(let ge of O){if(Z<E){typeof de=="undefined"&&(de=Date.now()),Z++,yield ge;continue}let pe=Date.now()-de,ye=x-pe;ye>0&&await ki(ye),de=Date.now(),Z=1,yield ge}}()}function S(E,x,O){return O===void 0?q=>_(E,x,q):_(E,x,O)}function I(E,x){let O=E[0]+x[0],q=E[1]+x[1];if(q>=1e9){let Z=q%1e9;O+=(q-Z)/1e9,q=Z}return[O,q]}async function*F(E,x){let O=x[Symbol.asyncIterator](),q=[0,0];for(;;){let Z=process.hrtime(),{value:de,done:ge}=await O.next(),pe=process.hrtime(Z);if(q=I(q,pe),E.progress&&E.progress(pe,q),ge)return E.total&&E.total(q),de;yield de}}function*N(E,x){let O=x[Symbol.iterator](),q=[0,0];for(;;){let Z=process.hrtime(),{value:de,done:ge}=O.next(),pe=process.hrtime(Z);if(q=I(q,pe),E.progress&&E.progress(pe,q),ge)return E.total&&E.total(q),de;yield de}}function U(E={},x){return x===void 0?O=>U(E,O):x[Symbol.asyncIterator]!==void 0?F(E,x):N(E,x)}function j(E,x,O){let q=c(O),Z=[],de=[],ge=!1,pe=!1,ye=0,Ie=null;function et(){for(;de.length>0&&Z.length>0;){let{resolve:Ve}=de.shift(),Pe=Z.shift();Ve({done:!1,value:Pe})}for(;de.length>0&&ye===0&&ge;){let{resolve:Ve,reject:Pe}=de.shift();Ie?(Pe(Ie),Ie=null):Ve({done:!0,value:void 0})}}async function Oe(){if(ge){et();return}if(!pe&&!(ye+Z.length>=E)){pe=!0,ye++;try{let{done:Ve,value:Pe}=await q.next();Ve?(ge=!0,ye--,et()):Tt(Pe)}catch(Ve){ge=!0,ye--,Ie=Ve,et()}pe=!1,Oe()}}async function Tt(Ve){try{let Pe=await x(Ve);Z.push(Pe)}catch(Pe){ge=!0,Ie=Pe}ye--,et(),Oe()}async function er(){if(Z.length===0){let Pe=u();return de.push(Pe),Oe(),Pe.promise}let Ve=Z.shift();return Oe(),{done:!1,value:Ve}}let Zr={next:er,[Symbol.asyncIterator]:()=>Zr};return Zr}function D(E,x,O){return x===void 0?(q,Z)=>Z?D(E,q,Z):D(E,q):O===void 0?q=>D(E,x,q):j(E,x,O)}async function k(E,x){let O=null,q=null,Z=null,de=Ie=>{O=Ie,q&&q(Ie)},ge=()=>{Z&&Z()},pe=()=>{E.removeListener("error",de),E.removeListener("drain",ge)};E.once("error",de);let ye=()=>new Promise((Ie,et)=>{if(O)return et(O);E.once("drain",ge),Z=Ie,q=et});for await(let Ie of x)if(E.write(Ie)===!1&&await ye(),O)break;if(pe(),O)throw O}function K(E,x){return x===void 0?O=>k(E,O):k(E,x)}t.batch=i,t.batchWithTimeout=o,t.buffer=h,t.collect=d,t.concat=m,t.consume=C,t.filter=T,t.flatMap=$,t.flatTransform=me,t.flatten=A,t.fromStream=_t,t.getIterator=c,t.map=ie,t.merge=Se,t.parallelFlatMap=Yt,t.parallelMap=cr,t.parallelMerge=Qr,t.pipeline=Re,t.reduce=Xr,t.take=Dc,t.tap=jr,t.throttle=S,t.time=U,t.transform=D,t.writeToStream=K,Object.defineProperty(t,"__esModule",{value:!0})})});var hR=b((yee,fR)=>{fR.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),i=Object.create(null);function n(s,a){r[s]=a,e++,e>=t&&(e=0,i=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||i[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var a=r[s];if(a!==void 0)return a;if((a=i[s])!==void 0)return n(s,a),a},set:function(s,a){r[s]!==void 0?r[s]=a:n(s,a)},clear:function(){r=Object.create(null),i=Object.create(null)}}}});var pR=b((gee,dR)=>{"use strict";var ZV=hR();dR.exports=t=>{let e=ZV(t);return e.delete=e.remove,e}});var gR=b((yR,C0)=>{(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",o=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,h=1e9;function p(T){var A,te,ie,$=ne.prototype={constructor:ne,toString:null,valueOf:null},Ce=new ne(1),me=20,be=4,st=-7,_t=21,Se=-1e7,Re=1e7,Y=!1,cr=1,Yt=0,Qr={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},ur="0123456789abcdefghijklmnopqrstuvwxyz",Xr=!0;function ne(_,S){var I,F,N,U,j,D,k,K,E=this;if(!(E instanceof ne))return new ne(_,S);if(S==null){if(_&&_._isBigNumber===!0){E.s=_.s,!_.c||_.e>Re?E.c=E.e=null:_.e<Se?E.c=[E.e=0]:(E.e=_.e,E.c=_.c.slice());return}if((D=typeof _=="number")&&_*0==0){if(E.s=1/_<0?(_=-_,-1):1,_===~~_){for(U=0,j=_;j>=10;j/=10,U++);U>Re?E.c=E.e=null:(E.e=U,E.c=[_]);return}K=String(_)}else{if(!r.test(K=String(_)))return ie(E,K,D);E.s=K.charCodeAt(0)==45?(K=K.slice(1),-1):1}(U=K.indexOf("."))>-1&&(K=K.replace(".","")),(j=K.search(/e/i))>0?(U<0&&(U=j),U+=+K.slice(j+1),K=K.substring(0,j)):U<0&&(U=K.length)}else{if(m(S,2,ur.length,"Base"),S==10&&Xr)return E=new ne(_),jr(E,me+E.e+1,be);if(K=String(_),D=typeof _=="number"){if(_*0!=0)return ie(E,K,D,S);if(E.s=1/_<0?(K=K.slice(1),-1):1,ne.DEBUG&&K.replace(/^0\.0*|\./,"").length>15)throw Error(a+_)}else E.s=K.charCodeAt(0)===45?(K=K.slice(1),-1):1;for(I=ur.slice(0,S),U=j=0,k=K.length;j<k;j++)if(I.indexOf(F=K.charAt(j))<0){if(F=="."){if(j>U){U=k;continue}}else if(!N&&(K==K.toUpperCase()&&(K=K.toLowerCase())||K==K.toLowerCase()&&(K=K.toUpperCase()))){N=!0,j=-1,U=0;continue}return ie(E,String(_),D,S)}D=!1,K=te(K,S,10,E.s),(U=K.indexOf("."))>-1?K=K.replace(".",""):U=K.length}for(j=0;K.charCodeAt(j)===48;j++);for(k=K.length;K.charCodeAt(--k)===48;);if(K=K.slice(j,++k)){if(k-=j,D&&ne.DEBUG&&k>15&&(_>u||_!==n(_)))throw Error(a+E.s*_);if((U=U-j-1)>Re)E.c=E.e=null;else if(U<Se)E.c=[E.e=0];else{if(E.e=U,E.c=[],j=(U+1)%c,U<0&&(j+=c),j<k){for(j&&E.c.push(+K.slice(0,j)),k-=c;j<k;)E.c.push(+K.slice(j,j+=c));j=c-(K=K.slice(j)).length}else j-=k;for(;j--;K+="0");E.c.push(+K)}}else E.c=[E.e=0]}ne.clone=p,ne.ROUND_UP=0,ne.ROUND_DOWN=1,ne.ROUND_CEIL=2,ne.ROUND_FLOOR=3,ne.ROUND_HALF_UP=4,ne.ROUND_HALF_DOWN=5,ne.ROUND_HALF_EVEN=6,ne.ROUND_HALF_CEIL=7,ne.ROUND_HALF_FLOOR=8,ne.EUCLID=9,ne.config=ne.set=function(_){var S,I;if(_!=null)if(typeof _=="object"){if(_.hasOwnProperty(S="DECIMAL_PLACES")&&(I=_[S],m(I,0,h,S),me=I),_.hasOwnProperty(S="ROUNDING_MODE")&&(I=_[S],m(I,0,8,S),be=I),_.hasOwnProperty(S="EXPONENTIAL_AT")&&(I=_[S],I&&I.pop?(m(I[0],-h,0,S),m(I[1],0,h,S),st=I[0],_t=I[1]):(m(I,-h,h,S),st=-(_t=I<0?-I:I))),_.hasOwnProperty(S="RANGE"))if(I=_[S],I&&I.pop)m(I[0],-h,-1,S),m(I[1],1,h,S),Se=I[0],Re=I[1];else if(m(I,-h,h,S),I)Se=-(Re=I<0?-I:I);else throw Error(s+S+" cannot be zero: "+I);if(_.hasOwnProperty(S="CRYPTO"))if(I=_[S],I===!!I)if(I)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Y=I;else throw Y=!I,Error(s+"crypto unavailable");else Y=I;else throw Error(s+S+" not true or false: "+I);if(_.hasOwnProperty(S="MODULO_MODE")&&(I=_[S],m(I,0,9,S),cr=I),_.hasOwnProperty(S="POW_PRECISION")&&(I=_[S],m(I,0,h,S),Yt=I),_.hasOwnProperty(S="FORMAT"))if(I=_[S],typeof I=="object")Qr=I;else throw Error(s+S+" not an object: "+I);if(_.hasOwnProperty(S="ALPHABET"))if(I=_[S],typeof I=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(I))Xr=I.slice(0,10)=="0123456789",ur=I;else throw Error(s+S+" invalid: "+I)}else throw Error(s+"Object expected: "+_);return{DECIMAL_PLACES:me,ROUNDING_MODE:be,EXPONENTIAL_AT:[st,_t],RANGE:[Se,Re],CRYPTO:Y,MODULO_MODE:cr,POW_PRECISION:Yt,FORMAT:Qr,ALPHABET:ur}},ne.isBigNumber=function(_){if(!_||_._isBigNumber!==!0)return!1;if(!ne.DEBUG)return!0;var S,I,F=_.c,N=_.e,U=_.s;e:if({}.toString.call(F)=="[object Array]"){if((U===1||U===-1)&&N>=-h&&N<=h&&N===n(N)){if(F[0]===0){if(N===0&&F.length===1)return!0;break e}if(S=(N+1)%c,S<1&&(S+=c),String(F[0]).length==S){for(S=0;S<F.length;S++)if(I=F[S],I<0||I>=o||I!==n(I))break e;if(I!==0)return!0}}}else if(F===null&&N===null&&(U===null||U===1||U===-1))return!0;throw Error(s+"Invalid BigNumber: "+_)},ne.maximum=ne.max=function(){return Dc(arguments,$.lt)},ne.minimum=ne.min=function(){return Dc(arguments,$.gt)},ne.random=function(){var _=9007199254740992,S=Math.random()*_&2097151?function(){return n(Math.random()*_)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(I){var F,N,U,j,D,k=0,K=[],E=new ne(Ce);if(I==null?I=me:m(I,0,h),j=i(I/c),Y)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array(j*=2));k<j;)D=F[k]*131072+(F[k+1]>>>11),D>=9e15?(N=crypto.getRandomValues(new Uint32Array(2)),F[k]=N[0],F[k+1]=N[1]):(K.push(D%1e14),k+=2);k=j/2}else if(crypto.randomBytes){for(F=crypto.randomBytes(j*=7);k<j;)D=(F[k]&31)*281474976710656+F[k+1]*1099511627776+F[k+2]*4294967296+F[k+3]*16777216+(F[k+4]<<16)+(F[k+5]<<8)+F[k+6],D>=9e15?crypto.randomBytes(7).copy(F,k):(K.push(D%1e14),k+=7);k=j/7}else throw Y=!1,Error(s+"crypto unavailable");if(!Y)for(;k<j;)D=S(),D<9e15&&(K[k++]=D%1e14);for(j=K[--k],I%=c,j&&I&&(D=l[c-I],K[k]=n(j/D)*D);K[k]===0;K.pop(),k--);if(k<0)K=[U=0];else{for(U=-1;K[0]===0;K.splice(0,1),U-=c);for(k=1,D=K[0];D>=10;D/=10,k++);k<c&&(U-=c-k)}return E.e=U,E.c=K,E}}(),ne.sum=function(){for(var _=1,S=arguments,I=new ne(S[0]);_<S.length;)I=I.plus(S[_++]);return I},te=function(){var _="0123456789";function S(I,F,N,U){for(var j,D=[0],k,K=0,E=I.length;K<E;){for(k=D.length;k--;D[k]*=F);for(D[0]+=U.indexOf(I.charAt(K++)),j=0;j<D.length;j++)D[j]>N-1&&(D[j+1]==null&&(D[j+1]=0),D[j+1]+=D[j]/N|0,D[j]%=N)}return D.reverse()}return function(I,F,N,U,j){var D,k,K,E,x,O,q,Z,de=I.indexOf("."),ge=me,pe=be;for(de>=0&&(E=Yt,Yt=0,I=I.replace(".",""),Z=new ne(F),O=Z.pow(I.length-de),Yt=E,Z.c=S(V(y(O.c),O.e,"0"),10,N,_),Z.e=Z.c.length),q=S(I,F,N,j?(D=ur,_):(D=_,ur)),K=E=q.length;q[--E]==0;q.pop());if(!q[0])return D.charAt(0);if(de<0?--K:(O.c=q,O.e=K,O.s=U,O=A(O,Z,ge,pe,N),q=O.c,x=O.r,K=O.e),k=K+ge+1,de=q[k],E=N/2,x=x||k<0||q[k+1]!=null,x=pe<4?(de!=null||x)&&(pe==0||pe==(O.s<0?3:2)):de>E||de==E&&(pe==4||x||pe==6&&q[k-1]&1||pe==(O.s<0?8:7)),k<1||!q[0])I=x?V(D.charAt(1),-ge,D.charAt(0)):D.charAt(0);else{if(q.length=k,x)for(--N;++q[--k]>N;)q[k]=0,k||(++K,q=[1].concat(q));for(E=q.length;!q[--E];);for(de=0,I="";de<=E;I+=D.charAt(q[de++]));I=V(I,K,D.charAt(0))}return I}}(),A=function(){function _(F,N,U){var j,D,k,K,E=0,x=F.length,O=N%f,q=N/f|0;for(F=F.slice();x--;)k=F[x]%f,K=F[x]/f|0,j=q*k+K*O,D=O*k+j%f*f+E,E=(D/U|0)+(j/f|0)+q*K,F[x]=D%U;return E&&(F=[E].concat(F)),F}function S(F,N,U,j){var D,k;if(U!=j)k=U>j?1:-1;else for(D=k=0;D<U;D++)if(F[D]!=N[D]){k=F[D]>N[D]?1:-1;break}return k}function I(F,N,U,j){for(var D=0;U--;)F[U]-=D,D=F[U]<N[U]?1:0,F[U]=D*j+F[U]-N[U];for(;!F[0]&&F.length>1;F.splice(0,1));}return function(F,N,U,j,D){var k,K,E,x,O,q,Z,de,ge,pe,ye,Ie,et,Oe,Tt,er,Zr,Ve=F.s==N.s?1:-1,Pe=F.c,Rt=N.c;if(!Pe||!Pe[0]||!Rt||!Rt[0])return new ne(!F.s||!N.s||(Pe?Rt&&Pe[0]==Rt[0]:!Rt)?NaN:Pe&&Pe[0]==0||!Rt?Ve*0:Ve/0);for(de=new ne(Ve),ge=de.c=[],K=F.e-N.e,Ve=U+K+1,D||(D=o,K=d(F.e/c)-d(N.e/c),Ve=Ve/c|0),E=0;Rt[E]==(Pe[E]||0);E++);if(Rt[E]>(Pe[E]||0)&&K--,Ve<0)ge.push(1),x=!0;else{for(Oe=Pe.length,er=Rt.length,E=0,Ve+=2,O=n(D/(Rt[0]+1)),O>1&&(Rt=_(Rt,O,D),Pe=_(Pe,O,D),er=Rt.length,Oe=Pe.length),et=er,pe=Pe.slice(0,er),ye=pe.length;ye<er;pe[ye++]=0);Zr=Rt.slice(),Zr=[0].concat(Zr),Tt=Rt[0],Rt[1]>=D/2&&Tt++;do{if(O=0,k=S(Rt,pe,er,ye),k<0){if(Ie=pe[0],er!=ye&&(Ie=Ie*D+(pe[1]||0)),O=n(Ie/Tt),O>1)for(O>=D&&(O=D-1),q=_(Rt,O,D),Z=q.length,ye=pe.length;S(q,pe,Z,ye)==1;)O--,I(q,er<Z?Zr:Rt,Z,D),Z=q.length,k=1;else O==0&&(k=O=1),q=Rt.slice(),Z=q.length;if(Z<ye&&(q=[0].concat(q)),I(pe,q,ye,D),ye=pe.length,k==-1)for(;S(Rt,pe,er,ye)<1;)O++,I(pe,er<ye?Zr:Rt,ye,D),ye=pe.length}else k===0&&(O++,pe=[0]);ge[E++]=O,pe[0]?pe[ye++]=Pe[et]||0:(pe=[Pe[et]],ye=1)}while((et++<Oe||pe[0]!=null)&&Ve--);x=pe[0]!=null,ge[0]||ge.splice(0,1)}if(D==o){for(E=1,Ve=ge[0];Ve>=10;Ve/=10,E++);jr(de,U+(de.e=E+K*c-1)+1,j,x)}else de.e=K,de.r=+x;return de}}();function Bc(_,S,I,F){var N,U,j,D,k;if(I==null?I=be:m(I,0,8),!_.c)return _.toString();if(N=_.c[0],j=_.e,S==null)k=y(_.c),k=F==1||F==2&&(j<=st||j>=_t)?C(k,j):V(k,j,"0");else if(_=jr(new ne(_),S,I),U=_.e,k=y(_.c),D=k.length,F==1||F==2&&(S<=U||U<=st)){for(;D<S;k+="0",D++);k=C(k,U)}else if(S-=j,k=V(k,U,"0"),U+1>D){if(--S>0)for(k+=".";S--;k+="0");}else if(S+=U-D,S>0)for(U+1==D&&(k+=".");S--;k+="0");return _.s<0&&N?"-"+k:k}function Dc(_,S){for(var I,F=1,N=new ne(_[0]);F<_.length;F++)if(I=new ne(_[F]),I.s)S.call(N,I)&&(N=I);else{N=I;break}return N}function Qa(_,S,I){for(var F=1,N=S.length;!S[--N];S.pop());for(N=S[0];N>=10;N/=10,F++);return(I=F+I*c-1)>Re?_.c=_.e=null:I<Se?_.c=[_.e=0]:(_.e=I,_.c=S),_}ie=function(){var _=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,I=/^\.([^.]+)$/,F=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,j,D,k){var K,E=D?j:j.replace(N,"");if(F.test(E))U.s=isNaN(E)?null:E<0?-1:1;else{if(!D&&(E=E.replace(_,function(x,O,q){return K=(q=q.toLowerCase())=="x"?16:q=="b"?2:8,!k||k==K?O:x}),k&&(K=k,E=E.replace(S,"$1").replace(I,"0.$1")),j!=E))return new ne(E,K);if(ne.DEBUG)throw Error(s+"Not a"+(k?" base "+k:"")+" number: "+j);U.s=null}U.c=U.e=null}}();function jr(_,S,I,F){var N,U,j,D,k,K,E,x=_.c,O=l;if(x){e:{for(N=1,D=x[0];D>=10;D/=10,N++);if(U=S-N,U<0)U+=c,j=S,k=x[K=0],E=k/O[N-j-1]%10|0;else if(K=i((U+1)/c),K>=x.length)if(F){for(;x.length<=K;x.push(0));k=E=0,N=1,U%=c,j=U-c+1}else break e;else{for(k=D=x[K],N=1;D>=10;D/=10,N++);U%=c,j=U-c+N,E=j<0?0:k/O[N-j-1]%10|0}if(F=F||S<0||x[K+1]!=null||(j<0?k:k%O[N-j-1]),F=I<4?(E||F)&&(I==0||I==(_.s<0?3:2)):E>5||E==5&&(I==4||F||I==6&&(U>0?j>0?k/O[N-j]:0:x[K-1])%10&1||I==(_.s<0?8:7)),S<1||!x[0])return x.length=0,F?(S-=_.e+1,x[0]=O[(c-S%c)%c],_.e=-S||0):x[0]=_.e=0,_;if(U==0?(x.length=K,D=1,K--):(x.length=K+1,D=O[c-U],x[K]=j>0?n(k/O[N-j]%O[j])*D:0),F)for(;;)if(K==0){for(U=1,j=x[0];j>=10;j/=10,U++);for(j=x[0]+=D,D=1;j>=10;j/=10,D++);U!=D&&(_.e++,x[0]==o&&(x[0]=1));break}else{if(x[K]+=D,x[K]!=o)break;x[K--]=0,D=1}for(U=x.length;x[--U]===0;x.pop());}_.e>Re?_.c=_.e=null:_.e<Se&&(_.c=[_.e=0])}return _}function ki(_){var S,I=_.e;return I===null?_.toString():(S=y(_.c),S=I<=st||I>=_t?C(S,I):V(S,I,"0"),_.s<0?"-"+S:S)}return $.absoluteValue=$.abs=function(){var _=new ne(this);return _.s<0&&(_.s=1),_},$.comparedTo=function(_,S){return g(this,new ne(_,S))},$.decimalPlaces=$.dp=function(_,S){var I,F,N,U=this;if(_!=null)return m(_,0,h),S==null?S=be:m(S,0,8),jr(new ne(U),_+U.e+1,S);if(!(I=U.c))return null;if(F=((N=I.length-1)-d(this.e/c))*c,N=I[N])for(;N%10==0;N/=10,F--);return F<0&&(F=0),F},$.dividedBy=$.div=function(_,S){return A(this,new ne(_,S),me,be)},$.dividedToIntegerBy=$.idiv=function(_,S){return A(this,new ne(_,S),0,1)},$.exponentiatedBy=$.pow=function(_,S){var I,F,N,U,j,D,k,K,E,x=this;if(_=new ne(_),_.c&&!_.isInteger())throw Error(s+"Exponent not an integer: "+ki(_));if(S!=null&&(S=new ne(S)),D=_.e>14,!x.c||!x.c[0]||x.c[0]==1&&!x.e&&x.c.length==1||!_.c||!_.c[0])return E=new ne(Math.pow(+ki(x),D?2-w(_):+ki(_))),S?E.mod(S):E;if(k=_.s<0,S){if(S.c?!S.c[0]:!S.s)return new ne(NaN);F=!k&&x.isInteger()&&S.isInteger(),F&&(x=x.mod(S))}else{if(_.e>9&&(x.e>0||x.e<-1||(x.e==0?x.c[0]>1||D&&x.c[1]>=24e7:x.c[0]<8e13||D&&x.c[0]<=9999975e7)))return U=x.s<0&&w(_)?-0:0,x.e>-1&&(U=1/U),new ne(k?1/U:U);Yt&&(U=i(Yt/c+2))}for(D?(I=new ne(.5),k&&(_.s=1),K=w(_)):(N=Math.abs(+ki(_)),K=N%2),E=new ne(Ce);;){if(K){if(E=E.times(x),!E.c)break;U?E.c.length>U&&(E.c.length=U):F&&(E=E.mod(S))}if(N){if(N=n(N/2),N===0)break;K=N%2}else if(_=_.times(I),jr(_,_.e+1,1),_.e>14)K=w(_);else{if(N=+ki(_),N===0)break;K=N%2}x=x.times(x),U?x.c&&x.c.length>U&&(x.c.length=U):F&&(x=x.mod(S))}return F?E:(k&&(E=Ce.div(E)),S?E.mod(S):U?jr(E,Yt,be,j):E)},$.integerValue=function(_){var S=new ne(this);return _==null?_=be:m(_,0,8),jr(S,S.e+1,_)},$.isEqualTo=$.eq=function(_,S){return g(this,new ne(_,S))===0},$.isFinite=function(){return!!this.c},$.isGreaterThan=$.gt=function(_,S){return g(this,new ne(_,S))>0},$.isGreaterThanOrEqualTo=$.gte=function(_,S){return(S=g(this,new ne(_,S)))===1||S===0},$.isInteger=function(){return!!this.c&&d(this.e/c)>this.c.length-2},$.isLessThan=$.lt=function(_,S){return g(this,new ne(_,S))<0},$.isLessThanOrEqualTo=$.lte=function(_,S){return(S=g(this,new ne(_,S)))===-1||S===0},$.isNaN=function(){return!this.s},$.isNegative=function(){return this.s<0},$.isPositive=function(){return this.s>0},$.isZero=function(){return!!this.c&&this.c[0]==0},$.minus=function(_,S){var I,F,N,U,j=this,D=j.s;if(_=new ne(_,S),S=_.s,!D||!S)return new ne(NaN);if(D!=S)return _.s=-S,j.plus(_);var k=j.e/c,K=_.e/c,E=j.c,x=_.c;if(!k||!K){if(!E||!x)return E?(_.s=-S,_):new ne(x?j:NaN);if(!E[0]||!x[0])return x[0]?(_.s=-S,_):new ne(E[0]?j:be==3?-0:0)}if(k=d(k),K=d(K),E=E.slice(),D=k-K){for((U=D<0)?(D=-D,N=E):(K=k,N=x),N.reverse(),S=D;S--;N.push(0));N.reverse()}else for(F=(U=(D=E.length)<(S=x.length))?D:S,D=S=0;S<F;S++)if(E[S]!=x[S]){U=E[S]<x[S];break}if(U&&(N=E,E=x,x=N,_.s=-_.s),S=(F=x.length)-(I=E.length),S>0)for(;S--;E[I++]=0);for(S=o-1;F>D;){if(E[--F]<x[F]){for(I=F;I&&!E[--I];E[I]=S);--E[I],E[F]+=o}E[F]-=x[F]}for(;E[0]==0;E.splice(0,1),--K);return E[0]?Qa(_,E,K):(_.s=be==3?-1:1,_.c=[_.e=0],_)},$.modulo=$.mod=function(_,S){var I,F,N=this;return _=new ne(_,S),!N.c||!_.s||_.c&&!_.c[0]?new ne(NaN):!_.c||N.c&&!N.c[0]?new ne(N):(cr==9?(F=_.s,_.s=1,I=A(N,_,0,3),_.s=F,I.s*=F):I=A(N,_,0,cr),_=N.minus(I.times(_)),!_.c[0]&&cr==1&&(_.s=N.s),_)},$.multipliedBy=$.times=function(_,S){var I,F,N,U,j,D,k,K,E,x,O,q,Z,de,ge,pe=this,ye=pe.c,Ie=(_=new ne(_,S)).c;if(!ye||!Ie||!ye[0]||!Ie[0])return!pe.s||!_.s||ye&&!ye[0]&&!Ie||Ie&&!Ie[0]&&!ye?_.c=_.e=_.s=null:(_.s*=pe.s,!ye||!Ie?_.c=_.e=null:(_.c=[0],_.e=0)),_;for(F=d(pe.e/c)+d(_.e/c),_.s*=pe.s,k=ye.length,x=Ie.length,k<x&&(Z=ye,ye=Ie,Ie=Z,N=k,k=x,x=N),N=k+x,Z=[];N--;Z.push(0));for(de=o,ge=f,N=x;--N>=0;){for(I=0,O=Ie[N]%ge,q=Ie[N]/ge|0,j=k,U=N+j;U>N;)K=ye[--j]%ge,E=ye[j]/ge|0,D=q*K+E*O,K=O*K+D%ge*ge+Z[U]+I,I=(K/de|0)+(D/ge|0)+q*E,Z[U--]=K%de;Z[U]=I}return I?++F:Z.splice(0,1),Qa(_,Z,F)},$.negated=function(){var _=new ne(this);return _.s=-_.s||null,_},$.plus=function(_,S){var I,F=this,N=F.s;if(_=new ne(_,S),S=_.s,!N||!S)return new ne(NaN);if(N!=S)return _.s=-S,F.minus(_);var U=F.e/c,j=_.e/c,D=F.c,k=_.c;if(!U||!j){if(!D||!k)return new ne(N/0);if(!D[0]||!k[0])return k[0]?_:new ne(D[0]?F:N*0)}if(U=d(U),j=d(j),D=D.slice(),N=U-j){for(N>0?(j=U,I=k):(N=-N,I=D),I.reverse();N--;I.push(0));I.reverse()}for(N=D.length,S=k.length,N-S<0&&(I=k,k=D,D=I,S=N),N=0;S;)N=(D[--S]=D[S]+k[S]+N)/o|0,D[S]=o===D[S]?0:D[S]%o;return N&&(D=[N].concat(D),++j),Qa(_,D,j)},$.precision=$.sd=function(_,S){var I,F,N,U=this;if(_!=null&&_!==!!_)return m(_,1,h),S==null?S=be:m(S,0,8),jr(new ne(U),_,S);if(!(I=U.c))return null;if(N=I.length-1,F=N*c+1,N=I[N]){for(;N%10==0;N/=10,F--);for(N=I[0];N>=10;N/=10,F++);}return _&&U.e+1>F&&(F=U.e+1),F},$.shiftedBy=function(_){return m(_,-u,u),this.times("1e"+_)},$.squareRoot=$.sqrt=function(){var _,S,I,F,N,U=this,j=U.c,D=U.s,k=U.e,K=me+4,E=new ne("0.5");if(D!==1||!j||!j[0])return new ne(!D||D<0&&(!j||j[0])?NaN:j?U:1/0);if(D=Math.sqrt(+ki(U)),D==0||D==1/0?(S=y(j),(S.length+k)%2==0&&(S+="0"),D=Math.sqrt(+S),k=d((k+1)/2)-(k<0||k%2),D==1/0?S="5e"+k:(S=D.toExponential(),S=S.slice(0,S.indexOf("e")+1)+k),I=new ne(S)):I=new ne(D+""),I.c[0]){for(k=I.e,D=k+K,D<3&&(D=0);;)if(N=I,I=E.times(N.plus(A(U,N,K,1))),y(N.c).slice(0,D)===(S=y(I.c)).slice(0,D))if(I.e<k&&--D,S=S.slice(D-3,D+1),S=="9999"||!F&&S=="4999"){if(!F&&(jr(N,N.e+me+2,0),N.times(N).eq(U))){I=N;break}K+=4,D+=4,F=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(jr(I,I.e+me+2,1),_=!I.times(I).eq(U));break}}return jr(I,I.e+me+1,be,_)},$.toExponential=function(_,S){return _!=null&&(m(_,0,h),_++),Bc(this,_,S,1)},$.toFixed=function(_,S){return _!=null&&(m(_,0,h),_=_+this.e+1),Bc(this,_,S)},$.toFormat=function(_,S,I){var F,N=this;if(I==null)_!=null&&S&&typeof S=="object"?(I=S,S=null):_&&typeof _=="object"?(I=_,_=S=null):I=Qr;else if(typeof I!="object")throw Error(s+"Argument not an object: "+I);if(F=N.toFixed(_,S),N.c){var U,j=F.split("."),D=+I.groupSize,k=+I.secondaryGroupSize,K=I.groupSeparator||"",E=j[0],x=j[1],O=N.s<0,q=O?E.slice(1):E,Z=q.length;if(k&&(U=D,D=k,k=U,Z-=U),D>0&&Z>0){for(U=Z%D||D,E=q.substr(0,U);U<Z;U+=D)E+=K+q.substr(U,D);k>0&&(E+=K+q.slice(U)),O&&(E="-"+E)}F=x?E+(I.decimalSeparator||"")+((k=+I.fractionGroupSize)?x.replace(new RegExp("\\d{"+k+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):x):E}return(I.prefix||"")+F+(I.suffix||"")},$.toFraction=function(_){var S,I,F,N,U,j,D,k,K,E,x,O,q=this,Z=q.c;if(_!=null&&(D=new ne(_),!D.isInteger()&&(D.c||D.s!==1)||D.lt(Ce)))throw Error(s+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+ki(D));if(!Z)return new ne(q);for(S=new ne(Ce),K=I=new ne(Ce),F=k=new ne(Ce),O=y(Z),U=S.e=O.length-q.e-1,S.c[0]=l[(j=U%c)<0?c+j:j],_=!_||D.comparedTo(S)>0?U>0?S:K:D,j=Re,Re=1/0,D=new ne(O),k.c[0]=0;E=A(D,S,0,1),N=I.plus(E.times(F)),N.comparedTo(_)!=1;)I=F,F=N,K=k.plus(E.times(N=K)),k=N,S=D.minus(E.times(N=S)),D=N;return N=A(_.minus(I),F,0,1),k=k.plus(N.times(K)),I=I.plus(N.times(F)),k.s=K.s=q.s,U=U*2,x=A(K,F,U,be).minus(q).abs().comparedTo(A(k,I,U,be).minus(q).abs())<1?[K,F]:[k,I],Re=j,x},$.toNumber=function(){return+ki(this)},$.toPrecision=function(_,S){return _!=null&&m(_,1,h),Bc(this,_,S,2)},$.toString=function(_){var S,I=this,F=I.s,N=I.e;return N===null?F?(S="Infinity",F<0&&(S="-"+S)):S="NaN":(_==null?S=N<=st||N>=_t?C(y(I.c),N):V(y(I.c),N,"0"):_===10&&Xr?(I=jr(new ne(I),me+N+1,be),S=V(y(I.c),I.e,"0")):(m(_,2,ur.length,"Base"),S=te(V(y(I.c),N,"0"),10,_,F,!0)),F<0&&I.c[0]&&(S="-"+S)),S},$.valueOf=$.toJSON=function(){return ki(this)},$._isBigNumber=!0,T!=null&&ne.set(T),ne}function d(T){var A=T|0;return T>0||T===A?A:A-1}function y(T){for(var A,te,ie=1,$=T.length,Ce=T[0]+"";ie<$;){for(A=T[ie++]+"",te=c-A.length;te--;A="0"+A);Ce+=A}for($=Ce.length;Ce.charCodeAt(--$)===48;);return Ce.slice(0,$+1||1)}function g(T,A){var te,ie,$=T.c,Ce=A.c,me=T.s,be=A.s,st=T.e,_t=A.e;if(!me||!be)return null;if(te=$&&!$[0],ie=Ce&&!Ce[0],te||ie)return te?ie?0:-be:me;if(me!=be)return me;if(te=me<0,ie=st==_t,!$||!Ce)return ie?0:!$^te?1:-1;if(!ie)return st>_t^te?1:-1;for(be=(st=$.length)<(_t=Ce.length)?st:_t,me=0;me<be;me++)if($[me]!=Ce[me])return $[me]>Ce[me]^te?1:-1;return st==_t?0:st>_t^te?1:-1}function m(T,A,te,ie){if(T<A||T>te||T!==n(T))throw Error(s+(ie||"Argument")+(typeof T=="number"?T<A||T>te?" out of range: ":" not an integer: ":" not a primitive number: ")+String(T))}function w(T){var A=T.c.length-1;return d(T.e/c)==A&&T.c[A]%2!=0}function C(T,A){return(T.length>1?T.charAt(0)+"."+T.slice(1):T)+(A<0?"e":"e+")+A}function V(T,A,te){var ie,$;if(A<0){for($=te+".";++A;$+=te);T=$+T}else if(ie=T.length,++A>ie){for($=te,A-=ie;--A;$+=te);T+=$}else A<ie&&(T=T.slice(0,A)+"."+T.slice(A));return T}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof C0!="undefined"&&C0.exports?C0.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(yR)});var bR=b((mR,vR)=>{"use strict";var JV=Math.exp;mR=vR.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,i=0,n=0,s=0,a,o={};function c(u,l){return 1-JV(-(u-l)/e)}return o.push=function(l,f){if(a){let h=c(l,a),p=f-r,d=h*p;r=h*f+(1-h)*r,i=(1-h)*(i+p*d),n=Math.sqrt(i),s=r+h*p}else r=f;a=l},o.movingAverage=function(){return r},o.variance=function(){return i},o.deviation=function(){return n},o.forecast=function(){return s},o}});var SR=b((mee,_R)=>{"use strict";var{EventEmitter:ej}=_r(),{BigNumber:I0}=gR(),ER=bR(),tj=wu(),wR=class extends ej{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:I0(0),dataSent:I0(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=I0(0),this._movingAverages[s]={};for(let a=0;a<i.length;a++){let o=i[a];(this._movingAverages[s][o]=ER(o)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(r);for(let s of n){i.movingAverages[s]={};for(let a of Object.keys(r[s]))i.movingAverages[s][a]=r[s][a].movingAverage()}return i}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=tj(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let a=n/(r||1)*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],f=o[l];f||(f=o[l]=ER(l)),f.push(i,a)}}_applyOp(e){let r=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,r)?n=this._stats[r]:n=this._stats[r]=I0(0),this._stats[r]=n.plus(i),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=i}};_R.exports=wR});var IR=b((vee,CR)=>{"use strict";var rj=Ro(),{pipe:ij}=kr(),{tap:xR}=x0(),nj=pR(),{METRICS:sj}=qf(),ng=SR(),sg=["dataReceived","dataSent"],aj={in:"dataReceived",out:"dataSent"},A0=class{constructor(e){this._options=rj(sj,e),this._globalStats=new ng(sg,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=nj(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._systems=new Map}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}getComponentMetrics(){return this._systems}updateComponentMetric({system:e="libp2p",component:r,metric:i,value:n}){this._systems.has(e)||this._systems.set(e,new Map);let s=this._systems.get(e);s.has(r)||s.set(r,new Map),s.get(r).set(i,n)}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),i=this._peerStats.get(r);i&&(i.stop(),this._peerStats.delete(r),this._oldPeers.set(r,i))}_onMessage({remotePeer:e,protocol:r,direction:i,dataLength:n}){if(!this._running)return;let s=aj[i],a=this.forPeer(e);if(a||(a=new ng(sg,this._options),this._peerStats.set(e.toB58String(),a)),a.push(s,n),this._globalStats.push(s,n),r){let o=this.forProtocol(r);o||(o=new ng(sg,this._options),this._protocolStats.set(r,o)),o.push(s,n)}}updatePlaceholder(e,r){if(!this._running)return;let i=this.forPeer(e),n=r.toB58String(),s=this.forPeer(r),a=i;s&&(a=A0.mergeStats(s,a),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,a),a.start()}trackStream({stream:e,remotePeer:r,protocol:i}){let n=this,s=e.source;e.source=xR(o=>n._onMessage({remotePeer:r,protocol:i,direction:"in",dataLength:o.length}))(s);let a=e.sink;return e.sink=o=>ij(o,xR(c=>n._onMessage({remotePeer:r,protocol:i,direction:"out",dataLength:c.length})),a),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};CR.exports=A0});var T0=b((bee,PR)=>{"use strict";var AR=xa(),TR=Ia(),{pipe:oj}=kr(),cj=Ae(),{fromString:uj}=(ar(),pr),lj=_p(),{source:fj}=Du(),RR=uj(`
`);function ag(t){return TR.encode.single(new AR([t,RR]))}function hj(t,e){t.push(ag(e))}async function dj(t,e){t.push(e.reduce((r,i)=>r.append(ag(i)),new AR))}async function pj(t,e){let r=1,i={[Symbol.asyncIterator](){return this},next:()=>t.next(r)},n=i;e&&e.signal&&(n=fj(i,e.signal));let s=o=>{r=o},a=await oj(n,TR.decode({onLength:s}),lj);if(a.get(a.length-1)!==RR[0])throw cj(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return a.shallowSlice(0,-1)}PR.exports={encode:ag,write:hj,writeAll:dj,read:pj}});var OR=b((Eee,DR)=>{"use strict";var BR=qe(),yj=Ae(),oc=T0(),gj=zo(),cc=Object.assign(BR("mss:select"),{error:BR("mss:select:error")});DR.exports=async function(e,r,i,n){r=Array.isArray(r)?[...r]:[r];let{reader:s,writer:a,rest:o,stream:c}=gj(e),u=r.shift();if(!u)throw new Error("At least one protocol must be specified");i?(cc('select: write ["%s", "%s"]',i,u),oc.writeAll(a,[i,u])):(cc('select: write "%s"',u),oc.write(a,u));let l=(await oc.read(s,n)).toString();if(cc('select: read "%s"',l),l===i&&(l=(await oc.read(s,n)).toString(),cc('select: read "%s"',l)),l===u)return o(),{stream:c,protocol:u};for(let f of r){cc('select: write "%s"',f),oc.write(a,f);let h=(await oc.read(s,n)).toString();if(cc('select: read "%s" for "%s"',h,f),h===f)return o(),{stream:c,protocol:f}}throw o(),yj(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var og=b(NR=>{"use strict";NR.PROTOCOL_ID="/multistream/1.0.0"});var MR=b((_ee,LR)=>{"use strict";var kR=qe(),mj=xa(),uc=T0(),vj=zo(),{PROTOCOL_ID:cg}=og(),Wu=Object.assign(kR("mss:handle"),{error:kR("mss:handle:error")});LR.exports=async function(e,r,i){r=Array.isArray(r)?r:[r];let{writer:n,reader:s,rest:a,stream:o}=vj(e);for(;;){let c=(await uc.read(s,i)).toString();if(Wu('read "%s"',c),c===cg){Wu('respond with "%s" for "%s"',cg,c),uc.write(n,cg);continue}if(r.includes(c))return uc.write(n,c),Wu('respond with "%s" for "%s"',c,c),a(),{stream:o,protocol:c};if(c==="ls"){uc.write(n,new mj(r.map(u=>uc.encode(u)))),Wu('respond with "%s" for %s',r,c);continue}uc.write(n,"na"),Wu('respond with "na" for "%s"',c)}}});var KR=b((See,FR)=>{"use strict";var bj=fy(),qR=qe(),UR=T0(),Ej=zo(),wj=Ia(),{pipe:_j}=kr(),Sj=Object.assign(qR("mss:ls"),{error:qR("mss:ls:error")});FR.exports=async function(e,r){let{reader:i,writer:n,rest:s,stream:a}=Ej(e);Sj('write "ls"'),UR.write(n,"ls"),s();let o=await UR.read(i,r),c=bj([o]),u=[];return await _j(c,wj.decode(),async f=>{for await(let h of f)u.push(h.shallowSlice(0,-1).toString())}),{stream:a,protocols:u}}});var HR=b(R0=>{"use strict";var VR=OR(),xj=MR(),Cj=KR(),{PROTOCOL_ID:ug}=og();R0.PROTOCOL_ID=ug;var lg=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(e){if(this._shaken)return;let{stream:r}=await VR(this._stream,ug,void 0,e);this._stream=r,this._shaken=!0}},jR=class extends lg{select(e,r){return VR(this._stream,e,this._shaken?void 0:ug,r)}async ls(e){await this._handshake(e);let r=await Cj(this._stream,e),{stream:i,protocols:n}=r;return this._stream=i,n}};R0.Dialer=jR;var GR=class extends lg{handle(e,r){return xj(this._stream,e,r)}};R0.Listener=GR});var WR=b((Cee,zR)=>{"use strict";var Ij={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};zR.exports=Ij});var JR=b((Iee,ZR)=>{"use strict";var $R=rr(),{Multiaddr:Aj}=Pr(),ri=Ae(),{OPEN:Tj,CLOSING:YR,CLOSED:fg}=WR(),QR=Symbol.for("@libp2p/interface-connection/connection"),XR=class{constructor({localAddr:e,remoteAddr:r,localPeer:i,remotePeer:n,newStream:s,close:a,getStreams:o,stat:c}){Rj(e,i,n,s,a,o,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:Tj},this._newStream=s,this._close=a,this._getStreams=o,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[QR](){return!0}static isConnection(e){return Boolean(e&&e[QR])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===YR)throw ri(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===fg)throw ri(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:i}=await this._newStream(e);return this.addStream(r,{protocol:i}),{stream:r,protocol:i}}addStream(e,{protocol:r,metadata:i={}}){this.registry.set(e.id,{protocol:r,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==fg){if(this._closing)return this._closing;this.stat.status=YR,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=fg}}};ZR.exports=XR;function Rj(t,e,r,i,n,s,a){if(t&&!Aj.isMultiaddr(t))throw ri(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!$R.isPeerId(e))throw ri(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!$R.isPeerId(r))throw ri(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw ri(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw ri(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw ri(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!a)throw ri(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(a.direction!=="inbound"&&a.direction!=="outbound")throw ri(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!a.timeline)throw ri(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!a.timeline.open)throw ri(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!a.timeline.upgraded)throw ri(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var t4=b(e4=>{"use strict";e4.Connection=JR()});var i4=b((Tee,r4)=>{"use strict";function Pj(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}r4.exports=function(e){var r=void 0,i=void 0;function n(o){if(!(o instanceof Object))throw new Error('Target "'+o+'" is not an object');i=o}function s(o){Object.keys(o).forEach(function(c){var u=o[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=o}n(function(){}),e&&n(e),s(Reflect);var a=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,f=Array(l),h=0;h<l;h++)f[h]=arguments[h];return r[u].apply(null,[i].concat(Pj(f.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return r},proxy:new Proxy(i,a)}}});var c4=b((Ree,o4)=>{"use strict";var n4=qe(),nr=Object.assign(n4("libp2p:upgrader"),{error:n4("libp2p:upgrader:err")}),ii=Ae(),lc=HR(),{Connection:Bj}=t4(),Dj=rr(),{pipe:Oj}=kr(),s4=i4(),{codes:ni}=yt(),a4=class{constructor({localPeer:e,metrics:r,connectionGater:i,cryptos:n=new Map,muxers:s=new Map,onConnectionEnd:a=()=>{},onConnection:o=()=>{}}){this.connectionGater=i,this.localPeer=e,this.metrics=r,this.cryptos=n,this.muxers=s,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=a}async upgradeInbound(e){let r,i,n,s,a,o,c;if(await this.connectionGater.denyInboundConnection(e))throw ii(new Error("The multiaddr connection is blocked by gater.acceptConnection"),ni.ERR_CONNECTION_INTERCEPTED);if(this.metrics){({setTarget:o,proxy:c}=s4());let l=(Math.random()*1e9).toString(36)+Date.now();o({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}nr("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{if({conn:r,remotePeer:i,protocol:a}=await this._encryptInbound(this.localPeer,u,this.cryptos),await this.connectionGater.denyInboundEncryptedConnection(i,r))throw ii(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ni.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(r,this.muxers):n=r}catch(l){throw nr.error("Failed to upgrade inbound connection",l),await e.close(l),l}if(await this.connectionGater.denyInboundUpgradedConnection(i,r))throw ii(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ni.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(c,i),o(i)),nr("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:a,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw ii(new Error("outbound connection must have a peer id"),ni.ERR_INVALID_MULTIADDR);let i=Dj.createFromB58String(r);if(await this.connectionGater.denyOutboundConnection(i,e))throw ii(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),ni.ERR_CONNECTION_INTERCEPTED);let n,s,a,o,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=s4());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:l})}nr("Starting the outbound connection upgrade");let f=e;this.protector&&(f=await this.protector.protect(e));try{if({conn:n,remotePeer:s,protocol:o}=await this._encryptOutbound(this.localPeer,f,i,this.cryptos),await this.connectionGater.denyOutboundEncryptedConnection(s,n))throw ii(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ni.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:a,Muxer:c}=await this._multiplexOutbound(n,this.muxers):a=n}catch(h){throw nr.error("Failed to upgrade outbound connection",h),await e.close(h),h}if(await this.connectionGater.denyOutboundUpgradedConnection(s,n))throw ii(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),ni.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),nr("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:o,direction:"outbound",maConn:e,upgradedConn:a,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:i,upgradedConn:n,Muxer:s,remotePeer:a}){let o,c,u;s&&(o=new s({onStream:async h=>{if(!u)return;let p=new lc.Listener(h);try{let{stream:d,protocol:y}=await p.handle(Array.from(this.protocols.keys()));nr("%s: incoming stream opened on %s",r,y),this.metrics&&this.metrics.trackStream({stream:d,remotePeer:a,protocol:y}),u.addStream(h,{protocol:y}),this._onStream({connection:u,stream:{...h,...d},protocol:y})}catch(d){nr.error(d)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{nr("%s: starting new stream on %s",r,h);let p=o.newStream(),d=new lc.Dialer(p);try{let{stream:y,protocol:g}=await d.select(h);return this.metrics&&this.metrics.trackStream({stream:y,remotePeer:a,protocol:g}),{stream:{...p,...y},protocol:g}}catch(y){throw nr.error("could not create new stream",y),ii(y,ni.ERR_UNSUPPORTED_PROTOCOL)}},Oj(n,o,n).catch(nr.error));let l=i.timeline;i.timeline=new Proxy(l,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){nr.error(p)}finally{this.onConnectionEnd(u)}})().catch(p=>{nr.error(p)}),Reflect.set(...h))}),i.timeline.upgraded=Date.now();let f=()=>{throw ii(new Error("connection is not multiplexed"),ni.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=new Bj({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:a,stat:{direction:r,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||f,getStreams:()=>o?o.streams:f(),close:async()=>{await i.close(),o&&o.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:i}){this.protocols.get(i)({connection:e,stream:r,protocol:i})}async _encryptInbound(e,r,i){let n=new lc.Listener(r),s=Array.from(i.keys());nr("handling inbound crypto protocol selection",s);try{let{stream:a,protocol:o}=await n.handle(s),c=i.get(o);if(nr("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${o}`);return{...await c.secureInbound(e,a),protocol:o}}catch(a){throw ii(a,ni.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,i,n){let s=new lc.Dialer(r),a=Array.from(n.keys());nr("selecting outbound crypto protocol",a);try{let{stream:o,protocol:c}=await s.select(a),u=n.get(c);if(nr("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,o,i),protocol:c}}catch(o){throw ii(o,ni.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let i=new lc.Dialer(e),n=Array.from(r.keys());nr("outbound selecting muxer %s",n);try{let{stream:s,protocol:a}=await i.select(n);nr("%s selected as muxer protocol",a);let o=r.get(a);return{stream:s,Muxer:o}}catch(s){throw ii(s,ni.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let i=new lc.Listener(e),n=Array.from(r.keys());nr("inbound handling muxers %s",n);try{let{stream:s,protocol:a}=await i.handle(n),o=r.get(a);return{stream:s,Muxer:o}}catch(s){throw ii(s,ni.ERR_MUXER_UNAVAILABLE)}}};o4.exports=a4});var l4=b((Pee,u4)=>{"use strict";var Nj=async function*(t,e){for await(let r of t)await e(r),yield r};u4.exports=Nj});var m4=b((Bee,g4)=>{"use strict";var f4=qe(),qa=Ae(),{Multiaddr:h4}=Pr(),P0=rr(),{codes:Wi}=yt(),d4=jf(),p4=Tu(),{pipe:kj}=kr(),Lj=ua(),Mj=la(),qj=gp(),Uj=l4(),ut=Object.assign(f4("libp2p:peer-store:address-book"),{error:f4("libp2p:peer-store:address-book:err")}),B0="change:multiaddrs",y4=class{constructor(e,r,i){this._emit=e,this._store=r,this._addressFilter=i}async consumePeerRecord(e){ut("consumePeerRecord await write lock");let r=await this._store.lock.writeLock();ut("consumePeerRecord got write lock");let i,n;try{let s;try{s=d4.createFromProtobuf(e.payload)}catch(o){return ut.error("invalid peer record received"),!1}i=s.peerId;let a=s.multiaddrs;if(!i.equals(e.peerId))return ut("signing key does not match PeerId in the PeerRecord"),!1;if(!a||!a.length)return!1;if(await this._store.has(i)){let o=await this._store.load(i);if(o.peerRecordEnvelope){let c=await p4.createFromProtobuf(o.peerRecordEnvelope);if(d4.createFromProtobuf(c.payload).seqNumber>=s.seqNumber)return!1}}n=await this._store.patchOrCreate(i,{addresses:await hg(i,a,this._addressFilter,!0),peerRecordEnvelope:e.marshal()}),ut(`stored provided peer record for ${s.peerId.toB58String()}`)}finally{ut("consumePeerRecord release write lock"),r()}return this._emit(B0,{peerId:i,multiaddrs:n.addresses.map(({multiaddr:s})=>s)}),!0}async getRawEnvelope(e){ut("getRawEnvelope await read lock");let r=await this._store.lock.readLock();ut("getRawEnvelope got read lock");try{return(await this._store.load(e)).peerRecordEnvelope}catch(i){if(i.code!==Wi.ERR_NOT_FOUND)throw i}finally{ut("getRawEnvelope release read lock"),r()}}async getPeerRecord(e){let r=await this.getRawEnvelope(e);if(!!r)return p4.createFromProtobuf(r)}async get(e){if(!P0.isPeerId(e))throw ut.error("peerId must be an instance of peer-id to store data"),qa(new Error("peerId must be an instance of peer-id"),Wi.ERR_INVALID_PARAMETERS);ut("get wait for read lock");let r=await this._store.lock.readLock();ut("get got read lock");try{return(await this._store.load(e)).addresses}catch(i){if(i.code!==Wi.ERR_NOT_FOUND)throw i}finally{ut("get release read lock"),r()}return[]}async set(e,r){if(!P0.isPeerId(e))throw ut.error("peerId must be an instance of peer-id to store data"),qa(new Error("peerId must be an instance of peer-id"),Wi.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw ut.error("multiaddrs must be an array of Multiaddrs"),qa(new Error("multiaddrs must be an array of Multiaddrs"),Wi.ERR_INVALID_PARAMETERS);ut("set await write lock");let i=await this._store.lock.writeLock();ut("set got write lock");let n=!1,s;try{let a=await hg(e,r,this._addressFilter);if(!a.length)return;try{let o=await this._store.load(e);if(n=!0,new Set([...a.map(({multiaddr:c})=>c.toString()),...o.addresses.map(({multiaddr:c})=>c.toString())]).size===o.addresses.length&&a.length===o.addresses.length)return}catch(o){if(o.code!==Wi.ERR_NOT_FOUND)throw o}s=await this._store.patchOrCreate(e,{addresses:a}),ut(`set multiaddrs for ${e.toB58String()}`)}finally{ut("set release write lock"),i()}this._emit(B0,{peerId:e,multiaddrs:s.addresses.map(a=>a.multiaddr)}),n||this._emit("peer",e)}async add(e,r){if(!P0.isPeerId(e))throw ut.error("peerId must be an instance of peer-id to store data"),qa(new Error("peerId must be an instance of peer-id"),Wi.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw ut.error("multiaddrs must be an array of Multiaddrs"),qa(new Error("multiaddrs must be an array of Multiaddrs"),Wi.ERR_INVALID_PARAMETERS);ut("add await write lock");let i=await this._store.lock.writeLock();ut("add got write lock");let n,s;try{let a=await hg(e,r,this._addressFilter);if(!a.length)return;try{let o=await this._store.load(e);if(n=!0,new Set([...a.map(({multiaddr:c})=>c.toString()),...o.addresses.map(({multiaddr:c})=>c.toString())]).size===o.addresses.length)return}catch(o){if(o.code!==Wi.ERR_NOT_FOUND)throw o}s=await this._store.mergeOrCreate(e,{addresses:a}),ut(`added multiaddrs for ${e}`)}finally{ut("set release write lock"),i()}this._emit(B0,{peerId:e,multiaddrs:s.addresses.map(a=>a.multiaddr)}),n||this._emit("peer",e)}async delete(e){if(!P0.isPeerId(e))throw ut.error("peerId must be an instance of peer-id to store data"),qa(new Error("peerId must be an instance of peer-id"),Wi.ERR_INVALID_PARAMETERS);ut("delete await write lock");let r=await this._store.lock.writeLock();ut("delete got write lock");let i;try{i=await this._store.has(e),await this._store.patchOrCreate(e,{addresses:[]})}finally{ut("delete release write lock"),r()}i&&this._emit(B0,{peerId:e,multiaddrs:[]})}async getMultiaddrsForPeer(e,r=i=>i){let i=await this.get(e);return r(i).map(n=>{let s=n.multiaddr,a=s.getPeerId();return a&&a===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};function hg(t,e,r,i=!1){return kj(e,n=>Uj(n,s=>{if(!h4.isMultiaddr(s))throw ut.error("multiaddr must be an instance of Multiaddr"),qa(new Error("multiaddr must be an instance of Multiaddr"),Wi.ERR_INVALID_PARAMETERS)}),n=>Mj(n,s=>r(t,s)),n=>qj(n,s=>({multiaddr:new h4(s.toString()),isCertified:i})),n=>Lj(n))}g4.exports=y4});var _4=b((Dee,w4)=>{"use strict";var v4=qe(),D0=Ae(),{codes:fc}=yt(),dg=rr(),{equals:Fj}=(pi(),di),si=Object.assign(v4("libp2p:peer-store:key-book"),{error:v4("libp2p:peer-store:key-book:err")}),b4="change:pubkey",E4=class{constructor(e,r){this._emit=e,this._store=r}async set(e,r){if(!dg.isPeerId(e))throw si.error("peerId must be an instance of peer-id to store data"),D0(new Error("peerId must be an instance of peer-id"),fc.ERR_INVALID_PARAMETERS);if(!r)throw si.error("publicKey must be an instance of PublicKey to store data"),D0(new Error("publicKey must be an instance of PublicKey"),fc.ERR_INVALID_PARAMETERS);si("set await write lock");let i=await this._store.lock.writeLock();si("set got write lock");let n=!1;try{try{let s=await this._store.load(e);if(s.pubKey&&Fj(s.pubKey.bytes,r.bytes))return}catch(s){if(s.code!==fc.ERR_NOT_FOUND)throw s}await this._store.patchOrCreate(e,{pubKey:r}),n=!0}finally{si("set release write lock"),i()}n&&this._emit(b4,{peerId:e,pubKey:r})}async get(e){if(!dg.isPeerId(e))throw si.error("peerId must be an instance of peer-id to store data"),D0(new Error("peerId must be an instance of peer-id"),fc.ERR_INVALID_PARAMETERS);si("get await write lock");let r=await this._store.lock.readLock();si("get got write lock");try{return(await this._store.load(e)).pubKey}catch(i){if(i.code!==fc.ERR_NOT_FOUND)throw i}finally{si("get release write lock"),r()}}async delete(e){if(!dg.isPeerId(e))throw si.error("peerId must be an instance of peer-id to store data"),D0(new Error("peerId must be an instance of peer-id"),fc.ERR_INVALID_PARAMETERS);si("delete await write lock");let r=await this._store.lock.writeLock();si("delete got write lock");try{await this._store.patchOrCreate(e,{pubKey:void 0})}finally{si("delete release write lock"),r()}this._emit(b4,{peerId:e,pubKey:void 0})}};w4.exports=E4});var I4=b((Oee,C4)=>{"use strict";var S4=qe(),qs=Ae(),{codes:Ti}=yt(),hc=rr(),{equals:Kj}=(pi(),di),wt=Object.assign(S4("libp2p:peer-store:metadata-book"),{error:S4("libp2p:peer-store:metadata-book:err")}),O0="change:metadata",x4=class{constructor(e,r){this._emit=e,this._store=r}async get(e){if(!hc.isPeerId(e))throw wt.error("peerId must be an instance of peer-id to store data"),qs(new Error("peerId must be an instance of peer-id"),Ti.ERR_INVALID_PARAMETERS);wt("get await read lock");let r=await this._store.lock.readLock();wt("get got read lock");try{return(await this._store.load(e)).metadata}catch(i){if(i.code!==Ti.ERR_NOT_FOUND)throw i}finally{wt("get release read lock"),r()}return new Map}async getValue(e,r){if(!hc.isPeerId(e))throw wt.error("peerId must be an instance of peer-id to store data"),qs(new Error("peerId must be an instance of peer-id"),Ti.ERR_INVALID_PARAMETERS);wt("getValue await read lock");let i=await this._store.lock.readLock();wt("getValue got read lock");try{return(await this._store.load(e)).metadata.get(r)}catch(n){if(n.code!==Ti.ERR_NOT_FOUND)throw n}finally{wt("getValue release write lock"),i()}}async set(e,r){if(!hc.isPeerId(e))throw wt.error("peerId must be an instance of peer-id to store data"),qs(new Error("peerId must be an instance of peer-id"),Ti.ERR_INVALID_PARAMETERS);if(!r||!(r instanceof Map))throw wt.error("valid metadata must be provided to store data"),qs(new Error("valid metadata must be provided"),Ti.ERR_INVALID_PARAMETERS);wt("set await write lock");let i=await this._store.lock.writeLock();wt("set got write lock");try{await this._store.mergeOrCreate(e,{metadata:r})}finally{wt("set release write lock"),i()}this._emit(O0,{peerId:e,metadata:r})}async setValue(e,r,i){if(!hc.isPeerId(e))throw wt.error("peerId must be an instance of peer-id to store data"),qs(new Error("peerId must be an instance of peer-id"),Ti.ERR_INVALID_PARAMETERS);if(typeof r!="string"||!(i instanceof Uint8Array))throw wt.error("valid key and value must be provided to store data"),qs(new Error("valid key and value must be provided"),Ti.ERR_INVALID_PARAMETERS);wt("setValue await write lock");let n=await this._store.lock.writeLock();wt("setValue got write lock");let s;try{try{let o=(await this._store.load(e)).metadata.get(r);if(o!=null&&Kj(i,o))return}catch(a){if(a.code!==Ti.ERR_NOT_FOUND)throw a}s=await this._store.mergeOrCreate(e,{metadata:new Map([[r,i]])})}finally{wt("setValue release write lock"),n()}this._emit(O0,{peerId:e,metadata:s.metadata})}async delete(e){if(!hc.isPeerId(e))throw wt.error("peerId must be an instance of peer-id to store data"),qs(new Error("peerId must be an instance of peer-id"),Ti.ERR_INVALID_PARAMETERS);wt("delete await write lock");let r=await this._store.lock.writeLock();wt("delete got write lock");let i;try{i=await this._store.has(e),i&&await this._store.patch(e,{metadata:new Map})}finally{wt("delete release write lock"),r()}i&&this._emit(O0,{peerId:e,metadata:new Map})}async deleteValue(e,r){if(!hc.isPeerId(e))throw wt.error("peerId must be an instance of peer-id to store data"),qs(new Error("peerId must be an instance of peer-id"),Ti.ERR_INVALID_PARAMETERS);wt("deleteValue await write lock");let i=await this._store.lock.writeLock();wt("deleteValue got write lock");let n;try{n=(await this._store.load(e)).metadata,n.delete(r),await this._store.patch(e,{metadata:n})}catch(s){if(s.code!==Ti.ERR_NOT_FOUND)throw s}finally{wt("deleteValue release write lock"),i()}n&&this._emit(O0,{peerId:e,metadata:n})}};C4.exports=x4});var P4=b((Nee,R4)=>{"use strict";var A4=qe(),dc=Ae(),{codes:$i}=yt(),pg=rr(),Ut=Object.assign(A4("libp2p:peer-store:proto-book"),{error:A4("libp2p:peer-store:proto-book:err")}),N0="change:protocols",T4=class{constructor(e,r){this._emit=e,this._store=r}async get(e){Ut("get wait for read lock");let r=await this._store.lock.readLock();Ut("get got read lock");try{return(await this._store.load(e)).protocols}catch(i){if(i.code!==$i.ERR_NOT_FOUND)throw i}finally{Ut("get release read lock"),r()}return[]}async set(e,r){if(!pg.isPeerId(e))throw Ut.error("peerId must be an instance of peer-id to store data"),dc(new Error("peerId must be an instance of peer-id"),$i.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw Ut.error("protocols must be provided to store data"),dc(new Error("protocols must be provided"),$i.ERR_INVALID_PARAMETERS);Ut("set await write lock");let i=await this._store.lock.writeLock();Ut("set got write lock");let n;try{try{let s=await this._store.load(e);if(new Set([...r]).size===s.protocols.length)return}catch(s){if(s.code!==$i.ERR_NOT_FOUND)throw s}n=await this._store.patchOrCreate(e,{protocols:r}),Ut(`stored provided protocols for ${e.toB58String()}`)}finally{Ut("set release write lock"),i()}this._emit(N0,{peerId:e,protocols:n.protocols})}async add(e,r){if(!pg.isPeerId(e))throw Ut.error("peerId must be an instance of peer-id to store data"),dc(new Error("peerId must be an instance of peer-id"),$i.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw Ut.error("protocols must be provided to store data"),dc(new Error("protocols must be provided"),$i.ERR_INVALID_PARAMETERS);Ut("add await write lock");let i=await this._store.lock.writeLock();Ut("add got write lock");let n;try{try{let s=await this._store.load(e);if(new Set([...s.protocols,...r]).size===s.protocols.length)return}catch(s){if(s.code!==$i.ERR_NOT_FOUND)throw s}n=await this._store.mergeOrCreate(e,{protocols:r}),Ut(`added provided protocols for ${e.toB58String()}`)}finally{Ut("add release write lock"),i()}this._emit(N0,{peerId:e,protocols:n.protocols})}async remove(e,r){if(!pg.isPeerId(e))throw Ut.error("peerId must be an instance of peer-id to store data"),dc(new Error("peerId must be an instance of peer-id"),$i.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw Ut.error("protocols must be provided to store data"),dc(new Error("protocols must be provided"),$i.ERR_INVALID_PARAMETERS);Ut("remove await write lock");let i=await this._store.lock.writeLock();Ut("remove got write lock");let n;try{try{let s=await this._store.load(e),a=new Set(s.protocols);for(let o of r)a.delete(o);if(s.protocols.length===a.size)return;r=Array.from(a)}catch(s){if(s.code!==$i.ERR_NOT_FOUND)throw s}n=await this._store.patchOrCreate(e,{protocols:r})}finally{Ut("remove release write lock"),i()}this._emit(N0,{peerId:e,protocols:n.protocols})}async delete(e){Ut("delete await write lock");let r=await this._store.lock.writeLock();Ut("delete got write lock");let i;try{i=await this._store.has(e),await this._store.patchOrCreate(e,{protocols:[]})}catch(n){if(n.code!==$i.ERR_NOT_FOUND)throw n}finally{Ut("delete release write lock"),r()}i&&this._emit(N0,{peerId:e,protocols:[]})}};R4.exports=T4});var D4=b((kee,B4)=>{"use strict";var Us=tn(),pc=Us.Reader,yg=Us.Writer,ft=Us.util,Jt=Us.roots["libp2p-peer"]||(Us.roots["libp2p-peer"]={});Jt.Peer=function(){function t(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.addresses=ft.emptyArray,t.prototype.protocols=ft.emptyArray,t.prototype.metadata=ft.emptyArray,t.prototype.pubKey=null,t.prototype.peerRecordEnvelope=null;var e;return Object.defineProperty(t.prototype,"_pubKey",{get:ft.oneOfGetter(e=["pubKey"]),set:ft.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_peerRecordEnvelope",{get:ft.oneOfGetter(e=["peerRecordEnvelope"]),set:ft.oneOfSetter(e)}),t.encode=function(i,n){if(n||(n=yg.create()),i.addresses!=null&&i.addresses.length)for(var s=0;s<i.addresses.length;++s)Jt.Address.encode(i.addresses[s],n.uint32(10).fork()).ldelim();if(i.protocols!=null&&i.protocols.length)for(var s=0;s<i.protocols.length;++s)n.uint32(18).string(i.protocols[s]);if(i.metadata!=null&&i.metadata.length)for(var s=0;s<i.metadata.length;++s)Jt.Metadata.encode(i.metadata[s],n.uint32(26).fork()).ldelim();return i.pubKey!=null&&Object.hasOwnProperty.call(i,"pubKey")&&n.uint32(34).bytes(i.pubKey),i.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(i,"peerRecordEnvelope")&&n.uint32(42).bytes(i.peerRecordEnvelope),n},t.decode=function(i,n){i instanceof pc||(i=pc.create(i));for(var s=n===void 0?i.len:i.pos+n,a=new Jt.Peer;i.pos<s;){var o=i.uint32();switch(o>>>3){case 1:a.addresses&&a.addresses.length||(a.addresses=[]),a.addresses.push(Jt.Address.decode(i,i.uint32()));break;case 2:a.protocols&&a.protocols.length||(a.protocols=[]),a.protocols.push(i.string());break;case 3:a.metadata&&a.metadata.length||(a.metadata=[]),a.metadata.push(Jt.Metadata.decode(i,i.uint32()));break;case 4:a.pubKey=i.bytes();break;case 5:a.peerRecordEnvelope=i.bytes();break;default:i.skipType(o&7);break}}return a},t.fromObject=function(i){if(i instanceof Jt.Peer)return i;var n=new Jt.Peer;if(i.addresses){if(!Array.isArray(i.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var s=0;s<i.addresses.length;++s){if(typeof i.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[s]=Jt.Address.fromObject(i.addresses[s])}}if(i.protocols){if(!Array.isArray(i.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var s=0;s<i.protocols.length;++s)n.protocols[s]=String(i.protocols[s])}if(i.metadata){if(!Array.isArray(i.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var s=0;s<i.metadata.length;++s){if(typeof i.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[s]=Jt.Metadata.fromObject(i.metadata[s])}}return i.pubKey!=null&&(typeof i.pubKey=="string"?ft.base64.decode(i.pubKey,n.pubKey=ft.newBuffer(ft.base64.length(i.pubKey)),0):i.pubKey.length&&(n.pubKey=i.pubKey)),i.peerRecordEnvelope!=null&&(typeof i.peerRecordEnvelope=="string"?ft.base64.decode(i.peerRecordEnvelope,n.peerRecordEnvelope=ft.newBuffer(ft.base64.length(i.peerRecordEnvelope)),0):i.peerRecordEnvelope.length&&(n.peerRecordEnvelope=i.peerRecordEnvelope)),n},t.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),i.addresses&&i.addresses.length){s.addresses=[];for(var a=0;a<i.addresses.length;++a)s.addresses[a]=Jt.Address.toObject(i.addresses[a],n)}if(i.protocols&&i.protocols.length){s.protocols=[];for(var a=0;a<i.protocols.length;++a)s.protocols[a]=i.protocols[a]}if(i.metadata&&i.metadata.length){s.metadata=[];for(var a=0;a<i.metadata.length;++a)s.metadata[a]=Jt.Metadata.toObject(i.metadata[a],n)}return i.pubKey!=null&&i.hasOwnProperty("pubKey")&&(s.pubKey=n.bytes===String?ft.base64.encode(i.pubKey,0,i.pubKey.length):n.bytes===Array?Array.prototype.slice.call(i.pubKey):i.pubKey,n.oneofs&&(s._pubKey="pubKey")),i.peerRecordEnvelope!=null&&i.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=n.bytes===String?ft.base64.encode(i.peerRecordEnvelope,0,i.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(i.peerRecordEnvelope):i.peerRecordEnvelope,n.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Us.util.toJSONOptions)},t}();Jt.Address=function(){function t(r){if(r)for(var i=Object.keys(r),n=0;n<i.length;++n)r[i[n]]!=null&&(this[i[n]]=r[i[n]])}t.prototype.multiaddr=ft.newBuffer([]),t.prototype.isCertified=null;var e;return Object.defineProperty(t.prototype,"_isCertified",{get:ft.oneOfGetter(e=["isCertified"]),set:ft.oneOfSetter(e)}),t.encode=function(i,n){return n||(n=yg.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},t.decode=function(i,n){i instanceof pc||(i=pc.create(i));for(var s=n===void 0?i.len:i.pos+n,a=new Jt.Address;i.pos<s;){var o=i.uint32();switch(o>>>3){case 1:a.multiaddr=i.bytes();break;case 2:a.isCertified=i.bool();break;default:i.skipType(o&7);break}}return a},t.fromObject=function(i){if(i instanceof Jt.Address)return i;var n=new Jt.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?ft.base64.decode(i.multiaddr,n.multiaddr=ft.newBuffer(ft.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},t.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=ft.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?ft.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,n.oneofs&&(s._isCertified="isCertified")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,Us.util.toJSONOptions)},t}();Jt.Metadata=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.key="",t.prototype.value=ft.newBuffer([]),t.encode=function(r,i){return i||(i=yg.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&i.uint32(10).string(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&i.uint32(18).bytes(r.value),i},t.decode=function(r,i){r instanceof pc||(r=pc.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Jt.Metadata;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.key=r.string();break;case 2:s.value=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Jt.Metadata)return r;var i=new Jt.Metadata;return r.key!=null&&(i.key=String(r.key)),r.value!=null&&(typeof r.value=="string"?ft.base64.decode(r.value,i.value=ft.newBuffer(ft.base64.length(r.value)),0):r.value.length&&(i.value=r.value)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.key="",i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=ft.newBuffer(n.value)))),r.key!=null&&r.hasOwnProperty("key")&&(n.key=r.key),r.value!=null&&r.hasOwnProperty("value")&&(n.value=i.bytes===String?ft.base64.encode(r.value,0,r.value.length):i.bytes===Array?Array.prototype.slice.call(r.value):r.value),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Us.util.toJSONOptions)},t}();B4.exports=Jt});var gg=b((Lee,O4)=>{O4.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var N4=b(()=>{});var G4=b((Uee,j4)=>{var Vj=_r().EventEmitter,{nanoid:jj}=(If(),dp),{WORKER_REQUEST_READ_LOCK:k4,WORKER_RELEASE_READ_LOCK:L4,MASTER_GRANT_READ_LOCK:M4,WORKER_REQUEST_WRITE_LOCK:q4,WORKER_RELEASE_WRITE_LOCK:U4,MASTER_GRANT_WRITE_LOCK:F4}=gg(),$u,K4=(t,e,r,i,n)=>(s,a)=>{a&&a.type===r&&t.emit(e,a.name,()=>(s.send({type:n,name:a.name,identifier:a.identifier}),new Promise(o=>{let c=u=>{u&&u.type===i&&u.identifier===a.identifier&&(s.removeListener("message",c),o())};s.on("message",c)})))},V4=(t,e,r,i)=>()=>{let n=jj();return process.send({type:e,identifier:n,name:t}),new Promise(s=>{let a=o=>{o&&o.type===r&&o.identifier===n&&(process.removeListener("message",a),s(()=>{process.send({type:i,identifier:n,name:t})}))};process.on("message",a)})};j4.exports=t=>{try{if($u=N4(),!Object.keys($u).length)return}catch(e){return}if($u.isMaster||t.singleProcess){let e=new Vj;return $u.on("message",K4(e,"requestReadLock",k4,L4,M4)),$u.on("message",K4(e,"requestWriteLock",q4,U4,F4)),e}return{isWorker:!0,readLock:e=>V4(e,k4,M4,L4),writeLock:e=>V4(e,q4,F4,U4)}}});var mg=b((Fee,H4)=>{var Fs={},yc=t=>{t.addEventListener("message",e=>{yc.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{yc.dispatchEvent("message",t,e)})};yc.addEventListener=(t,e)=>{Fs[t]||(Fs[t]=[]),Fs[t].push(e)};yc.removeEventListener=(t,e)=>{!Fs[t]||(Fs[t]=Fs[t].filter(r=>r===e))};yc.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!Fs[e]||Fs[e].forEach(r=>r.apply(null,t))};H4.exports=yc});var rP=b((Kee,tP)=>{var Gj=_r().EventEmitter,{nanoid:Hj}=(If(),dp),{WORKER_REQUEST_READ_LOCK:z4,WORKER_RELEASE_READ_LOCK:W4,MASTER_GRANT_READ_LOCK:$4,WORKER_REQUEST_WRITE_LOCK:Y4,WORKER_RELEASE_WRITE_LOCK:Q4,MASTER_GRANT_WRITE_LOCK:X4}=gg(),Z4=mg(),J4=(t,e,r,i,n)=>(s,a)=>{if(!a||!a.data||a.data.type!==r)return;let o={type:a.data.type,name:a.data.name,identifier:a.data.identifier};t.emit(e,o.name,()=>(s.postMessage({type:n,name:o.name,identifier:o.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let f={type:l.data.type,name:l.data.name,identifier:l.data.identifier};f&&f.type===i&&f.identifier===o.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},eP=(t,e,r,i)=>()=>{let n=Hj();return globalThis.postMessage({type:e,identifier:n,name:t}),new Promise(s=>{let a=o=>{if(!o||!o.data)return;let c={type:o.data.type,identifier:o.data.identifier};c&&c.type===r&&c.identifier===n&&(globalThis.removeEventListener("message",a),s(()=>{globalThis.postMessage({type:i,identifier:n,name:t})}))};globalThis.addEventListener("message",a)})},zj={singleProcess:!1};tP.exports=t=>{if(t=Object.assign({},zj,t),!!globalThis.document||t.singleProcess){let r=new Gj;return Z4.addEventListener("message",J4(r,"requestReadLock",z4,W4,$4)),Z4.addEventListener("message",J4(r,"requestWriteLock",Y4,Q4,X4)),r}return{isWorker:!0,readLock:r=>eP(r,z4,$4,W4),writeLock:r=>eP(r,Y4,X4,Q4)}}});var nP=b((Vee,vg)=>{"use strict";var Wj=Object.prototype.hasOwnProperty,Vr="~";function Yu(){}Object.create&&(Yu.prototype=Object.create(null),new Yu().__proto__||(Vr=!1));function $j(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function iP(t,e,r,i,n){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new $j(r,i||t,n),a=Vr?Vr+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function k0(t,e){--t._eventsCount==0?t._events=new Yu:delete t._events[e]}function Dr(){this._events=new Yu,this._eventsCount=0}Dr.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)Wj.call(r,i)&&e.push(Vr?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Dr.prototype.listeners=function(e){var r=Vr?Vr+e:e,i=this._events[r];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,a=new Array(s);n<s;n++)a[n]=i[n].fn;return a};Dr.prototype.listenerCount=function(e){var r=Vr?Vr+e:e,i=this._events[r];return i?i.fn?1:i.length:0};Dr.prototype.emit=function(e,r,i,n,s,a){var o=Vr?Vr+e:e;if(!this._events[o])return!1;var c=this._events[o],u=arguments.length,l,f;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,i),!0;case 4:return c.fn.call(c.context,r,i,n),!0;case 5:return c.fn.call(c.context,r,i,n,s),!0;case 6:return c.fn.call(c.context,r,i,n,s,a),!0}for(f=1,l=new Array(u-1);f<u;f++)l[f-1]=arguments[f];c.fn.apply(c.context,l)}else{var h=c.length,p;for(f=0;f<h;f++)switch(c[f].once&&this.removeListener(e,c[f].fn,void 0,!0),u){case 1:c[f].fn.call(c[f].context);break;case 2:c[f].fn.call(c[f].context,r);break;case 3:c[f].fn.call(c[f].context,r,i);break;case 4:c[f].fn.call(c[f].context,r,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[f].fn.apply(c[f].context,l)}}return!0};Dr.prototype.on=function(e,r,i){return iP(this,e,r,i,!1)};Dr.prototype.once=function(e,r,i){return iP(this,e,r,i,!0)};Dr.prototype.removeListener=function(e,r,i,n){var s=Vr?Vr+e:e;if(!this._events[s])return this;if(!r)return k0(this,s),this;var a=this._events[s];if(a.fn)a.fn===r&&(!n||a.once)&&(!i||a.context===i)&&k0(this,s);else{for(var o=0,c=[],u=a.length;o<u;o++)(a[o].fn!==r||n&&!a[o].once||i&&a[o].context!==i)&&c.push(a[o]);c.length?this._events[s]=c.length===1?c[0]:c:k0(this,s)}return this};Dr.prototype.removeAllListeners=function(e){var r;return e?(r=Vr?Vr+e:e,this._events[r]&&k0(this,r)):(this._events=new Yu,this._eventsCount=0),this};Dr.prototype.off=Dr.prototype.removeListener;Dr.prototype.addListener=Dr.prototype.on;Dr.prefixed=Vr;Dr.EventEmitter=Dr;typeof vg!="undefined"&&(vg.exports=Dr)});var aP=b((jee,sP)=>{"use strict";sP.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(i=>{i(e())}).then(()=>r),r=>new Promise(i=>{i(e())}).then(()=>{throw r})))});var cP=b((Gee,L0)=>{"use strict";var Yj=aP(),bg=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},oP=(t,e,r)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{i(r())}catch(c){n(c)}return}let a=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,o=r instanceof Error?r:new bg(a);typeof t.cancel=="function"&&t.cancel(),n(o)},e);Yj(t.then(i,n),()=>{clearTimeout(s)})});L0.exports=oP;L0.exports.default=oP;L0.exports.TimeoutError=bg});var uP=b(Eg=>{"use strict";Object.defineProperty(Eg,"__esModule",{value:!0});function Qj(t,e,r){let i=0,n=t.length;for(;n>0;){let s=n/2|0,a=i+s;r(t[a],e)<=0?(i=++a,n-=s+1):n=s}return i}Eg.default=Qj});var fP=b(wg=>{"use strict";Object.defineProperty(wg,"__esModule",{value:!0});var Xj=uP(),lP=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let i={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(i);return}let n=Xj.default(this._queue,i,(s,a)=>a.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};wg.default=lP});var pP=b(_g=>{"use strict";Object.defineProperty(_g,"__esModule",{value:!0});var Zj=nP(),hP=cP(),Jj=fP(),M0=()=>{},eG=new hP.TimeoutError,dP=class extends Zj{constructor(e){var r,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=M0,this._resolveIdle=M0,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Jj.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=M0,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=M0,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let a=this._timeout===void 0&&r.timeout===void 0?e():hP.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&n(eG)});i(await a)}catch(a){n(a)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async i=>this.add(i,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};_g.default=dP});var yP=b((Yee,Sg)=>{"use strict";var q0,$ee=Sg.exports.timeout=function(t,e){var r=new q0,i;return Promise.race([t,new Promise(function(n,s){i=setTimeout(function(){s(r)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};q0=Sg.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};q0.prototype=Object.create(Error.prototype);q0.prototype.name="TimeoutError"});var mP=b((Qee,Cg)=>{var tG=G4(),rG=rP(),{default:gP}=pP(),{timeout:iG}=yP(),nG=mg(),Ua={},Ks;function xg(t,e){let r,i=new Promise(n=>{r=n});return t.add(()=>iG((()=>new Promise(n=>{r(()=>{n()})}))(),e.timeout)),i}var sG=(t,e)=>{if(Ks.isWorker)return{readLock:Ks.readLock(t,e),writeLock:Ks.writeLock(t,e)};let r=new gP({concurrency:1}),i=null;return{readLock:()=>{if(i)return xg(i,e);i=new gP({concurrency:e.concurrency,autoStart:!1});let n=i,s=xg(i,e);return r.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,xg(r,e))}},aG={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};Cg.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},aG,e),Ks||(Ks=tG(e)||rG(e),Ks.isWorker||(Ks.on("requestReadLock",(r,i)=>{!Ua[r]||Ua[r].readLock().then(n=>i().finally(()=>n()))}),Ks.on("requestWriteLock",async(r,i)=>{!Ua[r]||Ua[r].writeLock().then(n=>i().finally(()=>n()))}))),Ua[t]||(Ua[t]=sG(t,e)),Ua[t]);Cg.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(i){i.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return nG(r),r}});var AP=b((Xee,IP)=>{"use strict";var vP=qe(),bP=rr(),EP=Ae(),{codes:U0}=yt(),{Key:oG}=(Tf(),pp),{base32:cG}=(Ys(),$s),{keys:{unmarshalPublicKey:uG,marshalPublicKey:lG}}=Fu(),{Multiaddr:wP}=Pr(),{Peer:_P}=D4(),fG=mP(),{equals:hG}=(pi(),di),SP=Object.assign(vP("libp2p:peer-store:store"),{error:vP("libp2p:peer-store:store:err")}),xP="/peers/",CP=class{constructor(e){this._datastore=e,this.lock=fG("peer-store",{singleProcess:!0})}_peerIdToDatastoreKey(e){if(!bP.isPeerId(e))throw SP.error("peerId must be an instance of peer-id to store data"),EP(new Error("peerId must be an instance of peer-id"),U0.ERR_INVALID_PARAMETERS);let r=e.toString();return new oG(`${xP}${r}`)}async has(e){return this._datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this._datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){let r=await this._datastore.get(this._peerIdToDatastoreKey(e)),i=_P.decode(r),n=i.pubKey?uG(i.pubKey):e.pubKey,s=new Map;for(let a of i.metadata)s.set(a.key,a.value);return{...i,id:e,pubKey:n,addresses:i.addresses.map(({multiaddr:a,isCertified:o})=>({multiaddr:new wP(a),isCertified:o||!1})),metadata:s,peerRecordEnvelope:i.peerRecordEnvelope||void 0}}async save(e){if(e.pubKey!=null&&e.id.pubKey!=null&&!hG(e.pubKey.bytes,e.id.pubKey.bytes))throw SP.error("peer publicKey bytes do not match peer id publicKey bytes"),EP(new Error("publicKey bytes do not match peer id publicKey bytes"),U0.ERR_INVALID_PARAMETERS);let r=new Set,i=_P.encode({addresses:e.addresses.filter(n=>r.has(n.multiaddr.toString())?!1:(r.add(n.multiaddr.toString()),!0)).sort((n,s)=>n.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({multiaddr:n,isCertified:s})=>({multiaddr:n.bytes,isCertified:s})),protocols:e.protocols.sort(),pubKey:e.pubKey?lG(e.pubKey):void 0,metadata:[...e.metadata.keys()].sort().map(n=>({key:n,value:e.metadata.get(n)})),peerRecordEnvelope:e.peerRecordEnvelope}).finish();return await this._datastore.put(this._peerIdToDatastoreKey(e.id),i),this.load(e.id)}async patch(e,r){let i=await this.load(e);return await this._patch(e,r,i)}async patchOrCreate(e,r){let i;try{i=await this.load(e)}catch(n){if(n.code!==U0.ERR_NOT_FOUND)throw n;i={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,r,i)}async _patch(e,r,i){return await this.save({...i,...r,id:e})}async merge(e,r){let i=await this.load(e);return this._merge(e,r,i)}async mergeOrCreate(e,r){let i;try{i=await this.load(e)}catch(n){if(n.code!==U0.ERR_NOT_FOUND)throw n;i={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,r,i)}async _merge(e,r,i){let n=new Map;return(r.addresses||[]).forEach(s=>{n.set(s.multiaddr.toString(),s.isCertified)}),i.addresses.forEach(({multiaddr:s,isCertified:a})=>{let o=s.toString();n.set(o,Boolean(n.get(o)||a))}),await this.save({id:e,addresses:Array.from(n.entries()).map(([s,a])=>({multiaddr:new wP(s),isCertified:a})),protocols:Array.from(new Set([...i.protocols||[],...r.protocols||[]])),metadata:new Map([...i.metadata?i.metadata.entries():[],...r.metadata?r.metadata.entries():[]]),pubKey:r.pubKey||(i!=null?i.pubKey:void 0),peerRecordEnvelope:r.peerRecordEnvelope||(i!=null?i.peerRecordEnvelope:void 0)})}async*all(){for await(let e of this._datastore.queryKeys({prefix:xP})){let r=e.toString().split("/")[2],i=cG.decode(r);yield this.load(bP.createFromBytes(i))}}};IP.exports=CP});var BP=b((Zee,PP)=>{"use strict";var TP=qe(),{EventEmitter:dG}=_r(),pG=m4(),yG=_4(),gG=I4(),mG=P4(),vG=AP(),Ri=Object.assign(TP("libp2p:peer-store"),{error:TP("libp2p:peer-store:err")}),RP=class extends dG{constructor({peerId:e,datastore:r,addressFilter:i}){super();this._peerId=e,this._store=new vG(r),this.addressBook=new pG(this.emit.bind(this),this._store,i),this.keyBook=new yG(this.emit.bind(this),this._store),this.metadataBook=new gG(this.emit.bind(this),this._store),this.protoBook=new mG(this.emit.bind(this),this._store)}async*getPeers(){Ri("getPeers await read lock");let e=await this._store.lock.readLock();Ri("getPeers got read lock");try{for await(let r of this._store.all())r.id.toB58String()!==this._peerId.toB58String()&&(yield r)}finally{Ri("getPeers release read lock"),e()}}async delete(e){Ri("delete await write lock");let r=await this._store.lock.writeLock();Ri("delete got write lock");try{await this._store.delete(e)}finally{Ri("delete release write lock"),r()}}async get(e){Ri("get await read lock");let r=await this._store.lock.readLock();Ri("get got read lock");try{return this._store.load(e)}finally{Ri("get release read lock"),r()}}async has(e){Ri("has await read lock");let r=await this._store.lock.readLock();Ri("has got read lock");try{return this._store.has(e)}finally{Ri("has release read lock"),r()}}};PP.exports=RP});var OP=b((Jee,DP)=>{"use strict";function bG(t,e,r){let i=new t(e,r);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(a,o){o&&i.on(a,o),i._subscribeAdapter(a)}function s(a,o){o?i.removeListener(a,o):i.removeAllListeners(a),i.listenerCount(a)===0&&i._unsubscribeAdapter(a)}return i.subscribe=n,i.unsubscribe=s,i}DP.exports=bG});var qP=b((ete,MP)=>{"use strict";var NP=()=>{},kP=Symbol.for("@libp2p/js-interfaces/topology"),LP=class{constructor({min:e=0,max:r=1/0,handlers:i={}}){this.min=e,this.max=r,this._onConnect=i.onConnect||NP,this._onDisconnect=i.onDisconnect||NP,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[kP](){return!0}static isTopology(e){return Boolean(e&&e[kP])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};MP.exports=LP});var VP=b((tte,KP)=>{"use strict";var UP=qe(),EG=Object.assign(UP("libp2p:registrar"),{error:UP("libp2p:registrar:err")}),wG=Ae(),{codes:{ERR_INVALID_PARAMETERS:_G}}=yt(),SG=qP(),FP=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}async register(e){if(!SG.isTopology(e))throw EG.error("topology must be an instance of interfaces/topology"),wG(new Error("topology must be an instance of interfaces/topology"),_G);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),await e.setRegistrar(this),r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};KP.exports=FP});var Ig=b((rte,Qu)=>{"use strict";var{Buffer:F0}=xi(),K0=xa();Qu.exports=async function*(t){for await(let e of t)F0.isBuffer(e)?yield e:K0.isBufferList(e)?yield e.slice():yield F0.from(e)};Qu.exports.toBuffer=Qu.exports;Qu.exports.toList=async function*(t){for await(let e of t)F0.isBuffer(e)?yield new K0().append(e):K0.isBufferList(e)?yield e:yield new K0().append(F0.from(e))}});var HP=b((ite,GP)=>{"use strict";var gc=tn(),jP=gc.Reader,xG=gc.Writer,Mt=gc.util,Xu=gc.roots["libp2p-identify"]||(gc.roots["libp2p-identify"]={});Xu.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=Mt.newBuffer([]),t.prototype.listenAddrs=Mt.emptyArray,t.prototype.observedAddr=Mt.newBuffer([]),t.prototype.protocols=Mt.emptyArray,t.prototype.signedPeerRecord=Mt.newBuffer([]),t.encode=function(r,i){if(i||(i=xG.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&i.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var n=0;n<r.listenAddrs.length;++n)i.uint32(18).bytes(r.listenAddrs[n]);if(r.protocols!=null&&r.protocols.length)for(var n=0;n<r.protocols.length;++n)i.uint32(26).string(r.protocols[n]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&i.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&i.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&i.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&i.uint32(66).bytes(r.signedPeerRecord),i},t.decode=function(r,i){r instanceof jP||(r=jP.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new Xu.Identify;r.pos<n;){var a=r.uint32();switch(a>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof Xu.Identify)return r;var i=new Xu.Identify;if(r.protocolVersion!=null&&(i.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(i.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?Mt.base64.decode(r.publicKey,i.publicKey=Mt.newBuffer(Mt.base64.length(r.publicKey)),0):r.publicKey.length&&(i.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<r.listenAddrs.length;++n)typeof r.listenAddrs[n]=="string"?Mt.base64.decode(r.listenAddrs[n],i.listenAddrs[n]=Mt.newBuffer(Mt.base64.length(r.listenAddrs[n])),0):r.listenAddrs[n].length&&(i.listenAddrs[n]=r.listenAddrs[n])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?Mt.base64.decode(r.observedAddr,i.observedAddr=Mt.newBuffer(Mt.base64.length(r.observedAddr)),0):r.observedAddr.length&&(i.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<r.protocols.length;++n)i.protocols[n]=String(r.protocols[n])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?Mt.base64.decode(r.signedPeerRecord,i.signedPeerRecord=Mt.newBuffer(Mt.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(i.signedPeerRecord=r.signedPeerRecord)),i},t.toObject=function(r,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Mt.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Mt.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Mt.newBuffer(n.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Mt.base64.encode(r.publicKey,0,r.publicKey.length):i.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Mt.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){n.protocols=[];for(var s=0;s<r.protocols.length;++s)n.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Mt.base64.encode(r.observedAddr,0,r.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(n.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(n.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Mt.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,gc.util.toJSONOptions)},t}();GP.exports=Xu});var eB=b((nte,JP)=>{"use strict";var zP=qe(),ai=Object.assign(zP("libp2p:identify"),{error:zP("libp2p:identify:err")}),Ag=Ae(),V0=Ia(),{pipe:j0}=kr(),{collect:WP,take:$P,consume:YP}=x0(),{fromString:mc}=(ar(),pr),CG=rr(),{Multiaddr:Tg}=Pr(),{toBuffer:QP}=Ig(),Zu=HP(),XP=Tu(),ZP=jf(),{MULTICODEC_IDENTIFY:IG,MULTICODEC_IDENTIFY_PUSH:AG,IDENTIFY_PROTOCOL_VERSION:TG,MULTICODEC_IDENTIFY_PROTOCOL_NAME:RG,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:PG,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:BG,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:DG}=Tp(),{codes:Rg}=yt(),Fa=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${RG}/${BG}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${PG}/${DG}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=Fa.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${TG}`,...e._options.host},this.connectionManager.on("peer:connect",i=>{this.identify(i).catch(ai.error)}),this.peerStore.on("change:multiaddrs",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(n=>ai.error(n))}),this.peerStore.on("change:protocols",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(n=>ai.error(n))})}async start(){await this.peerStore.metadataBook.setValue(this.peerId,"AgentVersion",mc(this._host.agentVersion)),await this.peerStore.metadataBook.setValue(this.peerId,"ProtocolVersion",mc(this._host.protocolVersion))}async stop(){}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(a=>a.bytes),n=await this.peerStore.protoBook.get(this.peerId),s=e.map(async a=>{try{let{stream:o}=await a.newStream(this.identifyPushProtocolStr);await j0([Zu.Identify.encode({listenAddrs:i,signedPeerRecord:r,protocols:n}).finish()],V0.encode(),o,YP)}catch(o){ai.error("could not push identify update to peer",o)}});return Promise.all(s)}async pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for await(let i of this.peerStore.getPeers())i.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(i.id))&&e.push(r);await this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[i]=await j0([],r,V0.decode(),$P(1),QP,WP);if(!i)throw Ag(new Error("No data could be retrieved"),Rg.ERR_CONNECTION_ENDED);let n;try{n=Zu.Identify.decode(i)}catch(h){throw Ag(h,Rg.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:a,protocols:o,observedAddr:c,signedPeerRecord:u}=n,l=await CG.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw Ag(new Error("identified peer does not match the expected peer"),Rg.ERR_INVALID_PEER);let f=Fa.getCleanMultiaddr(c);try{let h=await XP.openAndCertify(u,ZP.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(h)){await this.peerStore.protoBook.set(l,o),await this.peerStore.metadataBook.setValue(l,"AgentVersion",mc(n.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",mc(n.protocolVersion));return}}catch(h){ai("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{await this.peerStore.addressBook.set(l,a.map(h=>new Tg(h)))}catch(h){ai.error("received invalid addrs",h)}await this.peerStore.protoBook.set(l,o),await this.peerStore.metadataBook.setValue(l,"AgentVersion",mc(n.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",mc(n.protocolVersion)),ai("received observed address of %s",f)}handleMessage({connection:e,stream:r,protocol:i}){switch(i){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:ai.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:r}){try{let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=await this.peerStore.protoBook.get(this.peerId),a=Zu.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(o=>o.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();await j0([a],V0.encode(),r,YP)}catch(i){ai.error("could not respond to identify request",i)}}async _handlePush({connection:e,stream:r}){let i;try{let[s]=await j0([],r,V0.decode(),$P(1),QP,WP);i=Zu.Identify.decode(s)}catch(s){return ai.error("received invalid message",s)}let n=e.remotePeer;try{let s=await XP.openAndCertify(i.signedPeerRecord,ZP.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(s)){await this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){ai("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{await this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new Tg(s)))}catch(s){ai.error("received invalid addrs",s)}try{await this.peerStore.protoBook.set(n,i.protocols)}catch(s){ai.error("received invalid protocols",s)}}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new Tg(e)}catch(r){return null}return null}},OG={IDENTIFY:IG,IDENTIFY_PUSH:AG};Fa.multicodecs=OG;Fa.Messsage=Zu;JP.exports=Fa});var iB=b((ste,rB)=>{"use strict";var Ka=tn(),G0=Ka.Reader,tB=Ka.Writer,vc=Ka.util,An=Ka.roots["libp2p-fetch"]||(Ka.roots["libp2p-fetch"]={});An.FetchRequest=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.identifier="",t.encode=function(r,i){return i||(i=tB.create()),r.identifier!=null&&Object.hasOwnProperty.call(r,"identifier")&&i.uint32(10).string(r.identifier),i},t.decode=function(r,i){r instanceof G0||(r=G0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new An.FetchRequest;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.identifier=r.string();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof An.FetchRequest)return r;var i=new An.FetchRequest;return r.identifier!=null&&(i.identifier=String(r.identifier)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.identifier=""),r.identifier!=null&&r.hasOwnProperty("identifier")&&(n.identifier=r.identifier),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ka.util.toJSONOptions)},t}();An.FetchResponse=function(){function t(e){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)e[r[i]]!=null&&(this[r[i]]=e[r[i]])}return t.prototype.status=0,t.prototype.data=vc.newBuffer([]),t.encode=function(r,i){return i||(i=tB.create()),r.status!=null&&Object.hasOwnProperty.call(r,"status")&&i.uint32(8).int32(r.status),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&i.uint32(18).bytes(r.data),i},t.decode=function(r,i){r instanceof G0||(r=G0.create(r));for(var n=i===void 0?r.len:r.pos+i,s=new An.FetchResponse;r.pos<n;){var a=r.uint32();switch(a>>>3){case 1:s.status=r.int32();break;case 2:s.data=r.bytes();break;default:r.skipType(a&7);break}}return s},t.fromObject=function(r){if(r instanceof An.FetchResponse)return r;var i=new An.FetchResponse;switch(r.status){case"OK":case 0:i.status=0;break;case"NOT_FOUND":case 1:i.status=1;break;case"ERROR":case 2:i.status=2;break}return r.data!=null&&(typeof r.data=="string"?vc.base64.decode(r.data,i.data=vc.newBuffer(vc.base64.length(r.data)),0):r.data.length&&(i.data=r.data)),i},t.toObject=function(r,i){i||(i={});var n={};return i.defaults&&(n.status=i.enums===String?"OK":0,i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=vc.newBuffer(n.data)))),r.status!=null&&r.hasOwnProperty("status")&&(n.status=i.enums===String?An.FetchResponse.StatusCode[r.status]:r.status),r.data!=null&&r.hasOwnProperty("data")&&(n.data=i.bytes===String?vc.base64.encode(r.data,0,r.data.length):i.bytes===Array?Array.prototype.slice.call(r.data):r.data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ka.util.toJSONOptions)},t.StatusCode=function(){var e={},r=Object.create(e);return r[e[0]="OK"]=0,r[e[1]="NOT_FOUND"]=1,r[e[2]="ERROR"]=2,r}(),t}();rB.exports=An});var sB=b((ate,nB)=>{"use strict";nB.exports={PROTOCOL:"/libp2p/fetch/0.0.1"}});var lB=b((cB,uB)=>{"use strict";var aB=qe(),NG=Object.assign(aB("libp2p:fetch"),{error:aB("libp2p:fetch:err")}),Pg=Ae(),{codes:Bg}=yt(),H0=Ia(),{FetchRequest:Dg,FetchResponse:Yi}=iB(),oB=zo(),{PROTOCOL:kG}=sB(),Ju=class{constructor(e){this._lookupFunctions=new Map,this._libp2p=e,this.handleMessage=this.handleMessage.bind(this)}async fetch(e,r){NG("dialing %s to %s",this._protocol,e.toB58String?e.toB58String():e);let i=await this._libp2p.dial(e),{stream:n}=await i.newStream(Ju.PROTOCOL),s=oB(n),a=new Dg({identifier:r});s.write(H0.encode.single(Dg.encode(a).finish()));let o=Yi.decode((await H0.decode.fromReader(s.reader).next()).value.slice());switch(o.status){case Yi.StatusCode.OK:return o.data;case Yi.StatusCode.NOT_FOUND:return null;case Yi.StatusCode.ERROR:{let c=new TextDecoder().decode(o.data);throw Pg(new Error("Error in fetch protocol response: "+c),Bg.ERR_INVALID_PARAMETERS)}default:throw Pg(new Error("Unknown response status"),Bg.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:r}=e,i=oB(r),n=Dg.decode((await H0.decode.fromReader(i.reader).next()).value.slice()),s,a=this._getLookupFunction(n.identifier);if(a){let o=await a(n.identifier);o?s=new Yi({status:Yi.StatusCode.OK,data:o}):s=new Yi({status:Yi.StatusCode.NOT_FOUND})}else{let o=new TextEncoder().encode("No lookup function registered for key: "+n.identifier);s=new Yi({status:Yi.StatusCode.ERROR,data:o})}i.write(H0.encode.single(Yi.encode(s).finish()))}_getLookupFunction(e){for(let r of this._lookupFunctions.keys())if(e.startsWith(r))return this._lookupFunctions.get(r);return null}registerLookupFunction(e,r){if(this._lookupFunctions.has(e))throw Pg(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),Bg.ERR_KEY_ALREADY_EXISTS);this._lookupFunctions.set(e,r)}unregisterLookupFunction(e,r){r!=null&&this._lookupFunctions.get(e)!==r||this._lookupFunctions.delete(e)}};Ju.PROTOCOL=kG;cB=uB.exports=Ju});var hB=b((ote,fB)=>{"use strict";fB.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var bB=b((cte,vB)=>{"use strict";var dB=qe(),LG=Object.assign(dB("libp2p:ping"),{error:dB("libp2p:ping:err")}),MG=Ae(),{codes:qG}=yt(),UG=Fu(),{pipe:pB}=kr(),{toBuffer:FG}=Ig(),{collect:KG,take:VG}=x0(),{equals:jG}=(pi(),di),{PROTOCOL_NAME:yB,PING_LENGTH:GG,PROTOCOL_VERSION:gB}=hB(),mB=class{static getProtocolStr(e){return`/${e._config.protocolPrefix}/${yB}/${gB}`}constructor(e){this._libp2p=e}handleMessage({stream:e}){return pB(e,e)}async ping(e){let r=`/${this._libp2p._config.protocolPrefix}/${yB}/${gB}`;LG("dialing %s to %s",r,e.toB58String?e.toB58String():e);let i=await this._libp2p.dial(e),{stream:n}=await i.newStream(r),s=Date.now(),a=UG.randomBytes(GG),[o]=await pB([a],n,u=>VG(1,u),FG,KG),c=Date.now();if(!jG(a,o))throw MG(new Error("Received wrong ping ack"),qG.ERR_WRONG_PING_ACK);return c-s}};vB.exports=mB});var EB=b(()=>{});var wB=b(Og=>{"use strict";Object.defineProperty(Og,"__esModule",{value:!0}),Og.promisify=z0;var HG="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function z0(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[HG],r=z0.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=Array(n),a=0;a<n;a++)s[a]=arguments[a];return new r(function(o,c){s.push(function(u){if(u)return c(u);for(var l=arguments.length,f=Array(1<l?l-1:0),h=1;h<l;h++)f[h-1]=arguments[h];if(f.length===1||!e)return o(f[0]);var p={};f.forEach(function(d,y){var g=e[y];g&&(p[g]=d)}),o(p)}),t.apply(i,s)})}}z0.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",z0.Promise=void 0});var SB=b((hte,_B)=>{function zG(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}_B.exports=zG});var CB=b((dte,xB)=>{"use strict";var WG=SB(),W0=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,el=WG(),$G=W0&&!el,YG=el&&!W0,QG=el&&W0,XG=typeof gl=="function"&&typeof globalThis.process!="undefined"&&typeof globalThis.process.release!="undefined"&&globalThis.process.release.name==="node"&&!el,ZG=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,JG=typeof globalThis.process!="undefined"&&typeof globalThis.process.env!="undefined"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",eH=typeof navigator!="undefined"&&navigator.product==="ReactNative";xB.exports={isTest:JG,isElectron:el,isElectronMain:YG,isElectronRenderer:QG,isNode:XG,isBrowser:$G,isWebWorker:ZG,isEnvWithDom:W0,isReactNative:eH}});var AB=b((pte,IB)=>{function Pi(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}IB.exports=Pi;Pi.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Pi.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Pi.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},r),this._options.unref&&this._timer.unref(),!0};Pi.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Pi.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};Pi.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};Pi.prototype.start=Pi.prototype.try;Pi.prototype.errors=function(){return this._errors};Pi.prototype.attempts=function(){return this._attempts};Pi.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,a=(t[s]||0)+1;t[s]=a,a>=r&&(e=n,r=a)}return e}});var TB=b(Va=>{var tH=AB();Va.operation=function(t){var e=Va.timeouts(t);return new tH(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};Va.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return t&&t.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,a){return s-a}),i};Va.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,i=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return i=Math.min(i,e.maxTimeout),i};Va.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var i in t)typeof t[i]=="function"&&r.push(i)}for(var n=0;n<r.length;n++){var s=r[n],a=t[s];t[s]=function(c){var u=Va.operation(e),l=Array.prototype.slice.call(arguments,1),f=l.pop();l.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),f.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,a),t[s].options=e}}});var PB=b((gte,RB)=>{RB.exports=TB()});var DB=b((mte,$0)=>{"use strict";var rH=PB(),iH=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],Ng=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},nH=(t,e,r)=>{let i=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=i,t},sH=t=>iH.includes(t),BB=(t,e)=>new Promise((r,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=rH.operation(e);n.attempt(async s=>{try{r(await t(s))}catch(a){if(!(a instanceof Error)){i(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof Ng)n.stop(),i(a.originalError);else if(a instanceof TypeError&&!sH(a.message))n.stop(),i(a);else{nH(a,s,e);try{await e.onFailedAttempt(a)}catch(o){i(o);return}n.retry(a)||i(n.mainError())}}})});$0.exports=BB;$0.exports.default=BB;$0.exports.AbortError=Ng});var NB=b((vte,OB)=>{"use strict";function aH(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}OB.exports=aH});var LB=b((bte,kB)=>{"use strict";var oH=NB();function cH(t){let{address:e}=t.nodeAddress();return oH(e)}kB.exports=cH});var VB=b((Ete,KB)=>{"use strict";var uH=EB(),MB=qe(),{promisify:kg}=wB(),{Multiaddr:lH}=Pr(),bc=Object.assign(MB("libp2p:nat"),{error:MB("libp2p:nat:err")}),{isBrowser:qB}=CB(),Lg=DB(),fH=Rp(),UB=Ap(),hH=Ae(),{codes:{ERR_INVALID_PARAMETERS:dH}}=yt(),pH=LB(),Mg=7200;function yH(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var FB=class{constructor({peerId:e,addressManager:r,transportManager:i,...n}){if(this._peerId=e,this._addressManager=r,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${UB.name}@${UB.version} ${this._peerId}`,ttl:n.ttl||Mg,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<Mg)throw hH(new Error(`NatManager ttl should be at least ${Mg} seconds`),dH)}start(){qB||!this._enabled||this._start().catch(e=>{bc.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:i,host:n,port:s,transport:a}=r.toOptions();if(!r.isThinWaistAddress()||a!=="tcp"||pH(r)||i!==4)continue;let o=this._getClient(),c=this._externalIp||await o.externalIp();if(fH(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=yH();bc(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await o.map({publicPort:u,privatePort:s,protocol:a.toUpperCase()}),this._addressManager.addObservedAddr(lH.fromNodeAddress({family:4,address:c,port:u},a))}}_getClient(){if(this._client)return this._client;let e=new uH(this._options),r=kg(e.map.bind(e)),i=kg(e.destroy.bind(e)),n=kg(e.externalIp.bind(e));return this._client={map:(...s)=>Lg(()=>r(...s),{onFailedAttempt:bc.error,unref:!0}),destroy:(...s)=>Lg(()=>i(...s),{onFailedAttempt:bc.error,unref:!0}),externalIp:(...s)=>Lg(()=>n(...s),{onFailedAttempt:bc.error,unref:!0})},this._client}async stop(){if(!(qB||!this._client))try{await this._client.destroy(),this._client=null}catch(e){bc.error(e)}}};KB.exports=FB});var $B=b((wte,WB)=>{"use strict";var jB=qe(),Or=Object.assign(jB("libp2p"),{error:jB("libp2p:err")}),{EventEmitter:gH}=_r(),qg=Ae(),mH=rr(),{Multiaddr:vH}=Pr(),{MemoryDatastore:bH}=(Gw(),jw),EH=v_(),wH=x_(),Ug=xp(),{validate:_H}=jS(),{codes:Y0,messages:SH}=yt(),xH=zS(),CH=ux(),IH=gx(),GB=rI(),AH=pI(),TH=HI(),HB=uR(),RH=IR(),PH=qp(),BH=c4(),DH=BP(),OH=OP(),NH=VP(),zB=eB(),Fg=lB(),Kg=bB(),kH=VB(),{updateSelfPeerRecord:LH}=Lp(),tl=class extends gH{static async create(e){if(e.peerId)return new tl(e);let r=await mH.create();return e.peerId=r,new tl(e)}constructor(e){super();if(this._options=_H(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this._options.metrics.enabled){let i=new RH({...this._options.metrics});this.metrics=i}if(this.connectionGater={denyDialPeer:async()=>Promise.resolve(!1),denyDialMultiaddr:async()=>Promise.resolve(!1),denyInboundConnection:async()=>Promise.resolve(!1),denyOutboundConnection:async()=>Promise.resolve(!1),denyInboundEncryptedConnection:async()=>Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>Promise.resolve(!1),denyInboundUpgradedConnection:async()=>Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>Promise.resolve(!1),filterMultiaddrForPeer:async()=>Promise.resolve(!0),...this._options.connectionGater},this.peerStore=new DH({peerId:this.peerId,datastore:this.datastore&&this._options.peerStore.persistence?this.datastore:new bH,addressFilter:this.connectionGater.filterMultiaddrForPeer}),this.addresses=this._options.addresses,this.addressManager=new xH(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{LH(this).catch(i=>{Or.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new CH(this,{...this._options.connectionManager}),this._autodialler=new IH(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.keychain&&this._options.keychain.datastore){Or("creating keychain");let i=HB.generateOptions();this.keychain=new HB(this._options.keychain.datastore,{...i,...this._options.keychain}),Or("keychain constructed")}if(this.upgrader=new BH({connectionGater:this.connectionGater,localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new PH({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new kH({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new NH({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw qg(new Error(SH.CONN_ENCRYPTION_REQUIRED),Y0.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new TH({transportManager:this.transportManager,connectionGater:this.connectionGater,peerStore:this.peerStore,metrics:this.metrics,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(GB.prototype[Symbol.toStringTag],GB),this.relay=new AH(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new zB({libp2p:this})),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=i.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=OH(i,this,this._config.pubsub)}this.peerRouting=new EH(this),this.contentRouting=new wH(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this),this.fetchService=new Fg(this),this.pingService=new Kg(this)}emit(e,...r){return e==="error"&&!this._events.error?(Or.error(r),!1):super.emit(e,...r)}async start(){Or("libp2p is starting"),this.identifyService&&await this.handle(Object.values(zB.getProtocolStr(this)),this.identifyService.handleMessage),this.fetchService&&await this.handle(Fg.PROTOCOL,this.fetchService.handleMessage),this.pingService&&await this.handle(Kg.getProtocolStr(this),this.pingService.handleMessage);try{await this._onStarting(),await this._onDidStart(),Or("libp2p has started")}catch(e){throw this.emit("error",e),Or.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Or("libp2p is stopping");try{this._isStarted=!1,this.identifyService&&await this.identifyService.stop(),this.relay&&this.relay.stop(),this.peerRouting.stop(),await this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),await this.unhandle(Fg.PROTOCOL),await this.unhandle(Kg.getProtocolStr(this)),this.dialer.destroy()}catch(e){e&&(Or.error(e),this.emit("error",e))}Or("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,i){if(!r||!r.length)throw qg(new Error("no protocols were provided to open a stream"),Y0.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(r)}async _dial(e,r){let{id:i,multiaddrs:n}=Ug(e);if(i.equals(this.peerId))throw qg(new Error("Cannot dial self"),Y0.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&await this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let r=this._options.addresses.announceFilter,i=new Set(e);return r(Array.from(i).map(n=>new vH(n)))}async hangUp(e){let{id:r}=Ug(e),i=this.connectionManager.connections.get(r.toB58String());!i||await Promise.all(i.map(n=>n.close()))}fetch(e,r){return this.fetchService.fetch(e,r)}ping(e){let{id:r,multiaddrs:i}=Ug(e);return i?this.pingService.ping(i[0]):this.pingService.ping(r)}async handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,r)}),await this.peerStore.protoBook.add(this.peerId,e)}async unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),await this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),this._config.pubsub.enabled&&this.pubsub&&await this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start(),this.identifyService&&await this.identifyService.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e).catch(r=>{Or.error(r)})});for await(let e of this.peerStore.getPeers())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Or.error(new Error(Y0.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs).catch(r=>Or.error(r)),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols).catch(r=>Or.error(r))}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Or("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){Or.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=r=>{let i={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(i={...i,...this._config.peerDiscovery[r.tag]}),i.enabled&&!this._discovery.has(r.tag)){let n;typeof r=="function"?n=new r(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=r,n.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,n)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};WB.exports=tl});var JB=b((_te,ZB)=>{"use strict";var YB=()=>{},QB=Symbol.for("@libp2p/js-interfaces/topology"),XB=class{constructor({min:e=0,max:r=1/0,handlers:i={}}){this.min=e,this.max=r,this._onConnect=i.onConnect||YB,this._onDisconnect=i.onDisconnect||YB,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[QB](){return!0}static isTopology(e){return Boolean(e&&e[QB])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};ZB.exports=XB});var s8=b((Ste,n8)=>{"use strict";var MH=JB(),e8=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),t8=qe(),r8=Object.assign(t8("libp2p:topology:multicodec-topology"),{error:t8("libp2p:topology:multicodec-topology:error")}),i8=class extends MH{constructor({min:e,max:r,multicodecs:i,handlers:n}){super({min:e,max:r,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[e8](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[e8])}async setRegistrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),await this._updatePeers(this._registrar.peerStore.getPeers())}async _updatePeers(e){for await(let{id:r,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(r.toB58String());let n=this._registrar.getConnection(r);n&&this._onConnect(r,n)}else this.peers.delete(r.toB58String())}async _onProtocolChange({peerId:e,protocols:r}){try{let i=this.peers.has(e.toB58String()),n=r.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let a=await this._registrar.peerStore.get(e);await this._updatePeers([a]);return}}catch(i){r8.error(i)}}async _onPeerConnect(e){try{let r=e.remotePeer,i=await this._registrar.peerStore.protoBook.get(r);if(!i)return;this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}catch(r){r8.error(r)}}};n8.exports=i8});var o8=b((xte,Q0)=>{"use strict";var{AbortController:a8,AbortSignal:qH}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;Q0.exports=a8;Q0.exports.AbortSignal=qH;Q0.exports.default=a8});var d8=b((Cte,h8)=>{"use strict";var c8=qe(),UH=Object.assign(c8("libp2p-pubsub:peer-streams"),{error:c8("libp2p-pubsub:peer-streams:err")}),{EventEmitter:FH}=_r(),u8=Ia(),KH=Bf(),{pipe:l8}=kr(),{source:VH}=Du(),jH=o8().default,f8=class extends FH{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new jH,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=VH(l8(this._rawInboundStream,u8.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=KH({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),l8(this.outboundStream,u8.encode(),this._rawOutboundStream).catch(i=>{UH.error(i)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};h8.exports=f8});var p8=b(X0=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0});X0.createGossipRpc=void 0;function GH(t=[],e={}){return{subscriptions:[],messages:t,control:{ihave:e.ihave??[],iwant:e.iwant??[],graft:e.graft??[],prune:e.prune??[]}}}X0.createGossipRpc=GH});var y8=b(Z0=>{"use strict";Object.defineProperty(Z0,"__esModule",{value:!0});Z0.shuffle=void 0;function HH(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let i=e(),n=t[r];t[r]=t[i],t[i]=n}return t}Z0.shuffle=HH});var rl=b(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS=re.ACCEPT_FROM_WHITELIST_DURATION_MS=re.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=re.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=re.ERR_TOPIC_VALIDATOR_IGNORE=re.ERR_TOPIC_VALIDATOR_REJECT=re.TimeCacheDuration=re.GossipsubSeenTTL=re.GossipsubIWantFollowupTime=re.GossipsubMaxIHaveMessages=re.GossipsubMaxIHaveLength=re.GossipsubGraftFloodThreshold=re.GossipsubOpportunisticGraftPeers=re.GossipsubOpportunisticGraftTicks=re.GossipsubDirectConnectInitialDelay=re.GossipsubDirectConnectTicks=re.GossipsubConnectionTimeout=re.GossipsubMaxPendingConnections=re.GossipsubConnectors=re.GossipsubPruneBackoffTicks=re.GossipsubPruneBackoff=re.GossipsubPrunePeers=re.GossipsubFanoutTTL=re.GossipsubHeartbeatInterval=re.GossipsubHeartbeatInitialDelay=re.GossipsubGossipRetransmission=re.GossipsubGossipFactor=re.GossipsubDlazy=re.GossipsubHistoryGossip=re.GossipsubHistoryLength=re.GossipsubDout=re.GossipsubDscore=re.GossipsubDhi=re.GossipsubDlo=re.GossipsubD=re.GossipsubIDv11=re.GossipsubIDv10=re.FloodsubID=re.minute=re.second=void 0;re.second=1e3;re.minute=60*re.second;re.FloodsubID="/floodsub/1.0.0";re.GossipsubIDv10="/meshsub/1.0.0";re.GossipsubIDv11="/meshsub/1.1.0";re.GossipsubD=6;re.GossipsubDlo=4;re.GossipsubDhi=12;re.GossipsubDscore=4;re.GossipsubDout=2;re.GossipsubHistoryLength=5;re.GossipsubHistoryGossip=3;re.GossipsubDlazy=6;re.GossipsubGossipFactor=.25;re.GossipsubGossipRetransmission=3;re.GossipsubHeartbeatInitialDelay=100;re.GossipsubHeartbeatInterval=re.second;re.GossipsubFanoutTTL=re.minute;re.GossipsubPrunePeers=16;re.GossipsubPruneBackoff=re.minute;re.GossipsubPruneBackoffTicks=15;re.GossipsubConnectors=8;re.GossipsubMaxPendingConnections=128;re.GossipsubConnectionTimeout=30*re.second;re.GossipsubDirectConnectTicks=300;re.GossipsubDirectConnectInitialDelay=re.second;re.GossipsubOpportunisticGraftTicks=60;re.GossipsubOpportunisticGraftPeers=2;re.GossipsubGraftFloodThreshold=10*re.second;re.GossipsubMaxIHaveLength=5e3;re.GossipsubMaxIHaveMessages=10;re.GossipsubIWantFollowupTime=3*re.second;re.GossipsubSeenTTL=2*re.minute;re.TimeCacheDuration=120*1e3;re.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";re.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE";re.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0;re.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128;re.ACCEPT_FROM_WHITELIST_DURATION_MS=1e3;re.DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS=1e3});var m8=b(J0=>{"use strict";Object.defineProperty(J0,"__esModule",{value:!0});J0.hasGossipProtocol=void 0;var g8=rl();function zH(t){return t===g8.GossipsubIDv10||t===g8.GossipsubIDv11}J0.hasGossipProtocol=zH});var v8=b(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.messageIdFromString=Ec.messageIdToString=void 0;var WH=(ar(),pr),$H=(yr(),Sr);function YH(t){return(0,$H.toString)(t,"base64")}Ec.messageIdToString=YH;function QH(t){return(0,WH.fromString)(t,"base64")}Ec.messageIdFromString=QH});var ja=b(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.rejectReasonFromAcceptance=jt.MessageStatus=jt.ValidateError=jt.RejectReason=jt.MessageAcceptance=jt.PublishConfigType=jt.SignaturePolicy=void 0;var XH;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(XH=jt.SignaturePolicy||(jt.SignaturePolicy={}));var ZH;(function(t){t[t.Signing=0]="Signing",t[t.Author=1]="Author",t[t.Anonymous=2]="Anonymous"})(ZH=jt.PublishConfigType||(jt.PublishConfigType={}));var Vg;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(Vg=jt.MessageAcceptance||(jt.MessageAcceptance={}));var jg;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(jg=jt.RejectReason||(jt.RejectReason={}));var JH;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(JH=jt.ValidateError||(jt.ValidateError={}));var ez;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(ez=jt.MessageStatus||(jt.MessageStatus={}));function tz(t){switch(t){case Vg.Ignore:return jg.Ignore;case Vg.Reject:return jg.Reject}}jt.rejectReasonFromAcceptance=tz});var Gg=b(th=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.getPublishConfigFromPeerId=void 0;var eh=ja();function rz(t,e){switch(t){case eh.SignaturePolicy.StrictSign:{if(!e)throw Error("Must provide PeerId");if(e.privKey==null)throw Error("Cannot sign message, no private key present");if(e.pubKey==null)throw Error("Cannot sign message, no public key present");let r=e.privKey;return{type:eh.PublishConfigType.Signing,author:e,key:e.pubKey.bytes,privateKey:r}}case eh.SignaturePolicy.StrictNoSign:return{type:eh.PublishConfigType.Anonymous}}}th.getPublishConfigFromPeerId=rz});var ih=b(Bi=>{"use strict";var iz=Bi&&Bi.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),rh=Bi&&Bi.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&iz(e,t,r)};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.getPublishConfigFromPeerId=void 0;rh(p8(),Bi);rh(y8(),Bi);rh(m8(),Bi);rh(v8(),Bi);var nz=Gg();Object.defineProperty(Bi,"getPublishConfigFromPeerId",{enumerable:!0,get:function(){return nz.getPublishConfigFromPeerId}})});var E8=b(nh=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0});nh.MessageCache=void 0;var Hg=ih(),b8=class{constructor(e,r){this.gossip=e,this.msgs=new Map,this.history=[];for(let i=0;i<r;i++)this.history[i]=[]}get size(){return this.msgs.size}put(e,r){if(this.msgs.has(e))return!1;this.msgs.set(e,{message:r,validated:!1,originatingPeers:new Set,iwantCounts:new Map});let i=(0,Hg.messageIdFromString)(e);return this.history[0].push({msgId:i,topic:r.topic}),!0}observeDuplicate(e,r){let i=this.msgs.get(e);i&&!i.validated&&i.originatingPeers.add(r)}get(e){return this.msgs.get((0,Hg.messageIdToString)(e))?.message}getWithIWantCount(e,r){let i=this.msgs.get(e);if(!i)return null;let n=(i.iwantCounts.get(r)??0)+1;return i.iwantCounts.set(r,n),{msg:i.message,count:n}}getGossipIDs(e){let r=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{n.topic===e&&r.push(n.msgId)});return r}validate(e){let r=this.msgs.get(e);if(!r)return null;let{message:i,originatingPeers:n}=r;return r.validated=!0,r.originatingPeers=new Set,{message:i,originatingPeers:n}}shift(){this.history[this.history.length-1].forEach(r=>{let i=(0,Hg.messageIdToString)(r.msgId);this.msgs.delete(i)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r?(this.msgs.delete(e),r):null}};nh.MessageCache=b8});var zg=b((w8,il)=>{(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof gl=="function"&&typeof il=="object"&&il&&il.exports&&(il.exports=e(tn()))})(w8,function(t){"use strict";var e=t.Reader,r=t.Writer,i=t.util,n=t.roots.default||(t.roots.default={});return n.RPC=function(){function s(o){if(this.subscriptions=[],this.messages=[],o)for(var c=Object.keys(o),u=0;u<c.length;++u)o[c[u]]!=null&&(this[c[u]]=o[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.messages=i.emptyArray,s.prototype.control=null;var a;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(a=["control"]),set:i.oneOfSetter(a)}),s.encode=function(c,u){if(u||(u=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)n.RPC.SubOpts.encode(c.subscriptions[l],u.uint32(10).fork()).ldelim();if(c.messages!=null&&c.messages.length)for(var l=0;l<c.messages.length;++l)n.RPC.Message.encode(c.messages[l],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,f=new n.RPC;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:f.subscriptions&&f.subscriptions.length||(f.subscriptions=[]),f.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:f.messages&&f.messages.length||(f.messages=[]),f.messages.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:f.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return f},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[l]=n.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.messages){if(!Array.isArray(c.messages))throw TypeError(".RPC.messages: array expected");u.messages=[];for(var l=0;l<c.messages.length;++l){if(typeof c.messages[l]!="object")throw TypeError(".RPC.messages: object expected");u.messages[l]=n.RPC.Message.fromObject(c.messages[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.subscriptions=[],l.messages=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var f=0;f<c.subscriptions.length;++f)l.subscriptions[f]=n.RPC.SubOpts.toObject(c.subscriptions[f],u)}if(c.messages&&c.messages.length){l.messages=[];for(var f=0;f<c.messages.length;++f)l.messages[f]=n.RPC.Message.toObject(c.messages[f],u)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function o(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}o.prototype.subscribe=null,o.prototype.topicID=null;var c;return Object.defineProperty(o.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),o.encode=function(l,f){return f||(f=r.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&f.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(18).string(l.topicID),f},o.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,p=new n.RPC.SubOpts;l.pos<h;){var d=l.uint32();switch(d>>>3){case 1:p.subscribe=l.bool();break;case 2:p.topicID=l.string();break;default:l.skipType(d&7);break}}return p},o.fromObject=function(l){if(l instanceof n.RPC.SubOpts)return l;var f=new n.RPC.SubOpts;return l.subscribe!=null&&(f.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(f.topicID=String(l.topicID)),f},o.toObject=function(l,f){f||(f={});var h={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(h.subscribe=l.subscribe,f.oneofs&&(h._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),h},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.Message=function(){function o(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}o.prototype.from=null,o.prototype.data=null,o.prototype.seqno=null,o.prototype.topic="",o.prototype.signature=null,o.prototype.key=null;var c;return Object.defineProperty(o.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),o.encode=function(l,f){return f||(f=r.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&f.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&f.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&f.uint32(26).bytes(l.seqno),f.uint32(34).string(l.topic),l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&f.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&f.uint32(50).bytes(l.key),f},o.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,p=new n.RPC.Message;l.pos<h;){var d=l.uint32();switch(d>>>3){case 1:p.from=l.bytes();break;case 2:p.data=l.bytes();break;case 3:p.seqno=l.bytes();break;case 4:p.topic=l.string();break;case 5:p.signature=l.bytes();break;case 6:p.key=l.bytes();break;default:l.skipType(d&7);break}}if(!p.hasOwnProperty("topic"))throw i.ProtocolError("missing required 'topic'",{instance:p});return p},o.fromObject=function(l){if(l instanceof n.RPC.Message)return l;var f=new n.RPC.Message;return l.from!=null&&(typeof l.from=="string"?i.base64.decode(l.from,f.from=i.newBuffer(i.base64.length(l.from)),0):l.from.length&&(f.from=l.from)),l.data!=null&&(typeof l.data=="string"?i.base64.decode(l.data,f.data=i.newBuffer(i.base64.length(l.data)),0):l.data.length&&(f.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?i.base64.decode(l.seqno,f.seqno=i.newBuffer(i.base64.length(l.seqno)),0):l.seqno.length&&(f.seqno=l.seqno)),l.topic!=null&&(f.topic=String(l.topic)),l.signature!=null&&(typeof l.signature=="string"?i.base64.decode(l.signature,f.signature=i.newBuffer(i.base64.length(l.signature)),0):l.signature.length&&(f.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?i.base64.decode(l.key,f.key=i.newBuffer(i.base64.length(l.key)),0):l.key.length&&(f.key=l.key)),f},o.toObject=function(l,f){f||(f={});var h={};return f.defaults&&(h.topic=""),l.from!=null&&l.hasOwnProperty("from")&&(h.from=f.bytes===String?i.base64.encode(l.from,0,l.from.length):f.bytes===Array?Array.prototype.slice.call(l.from):l.from,f.oneofs&&(h._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(h.data=f.bytes===String?i.base64.encode(l.data,0,l.data.length):f.bytes===Array?Array.prototype.slice.call(l.data):l.data,f.oneofs&&(h._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(h.seqno=f.bytes===String?i.base64.encode(l.seqno,0,l.seqno.length):f.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,f.oneofs&&(h._seqno="seqno")),l.topic!=null&&l.hasOwnProperty("topic")&&(h.topic=l.topic),l.signature!=null&&l.hasOwnProperty("signature")&&(h.signature=f.bytes===String?i.base64.encode(l.signature,0,l.signature.length):f.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,f.oneofs&&(h._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(h.key=f.bytes===String?i.base64.encode(l.key,0,l.key.length):f.bytes===Array?Array.prototype.slice.call(l.key):l.key,f.oneofs&&(h._key="key")),h},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.ControlMessage=function(){function o(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return o.prototype.ihave=i.emptyArray,o.prototype.iwant=i.emptyArray,o.prototype.graft=i.emptyArray,o.prototype.prune=i.emptyArray,o.encode=function(u,l){if(l||(l=r.create()),u.ihave!=null&&u.ihave.length)for(var f=0;f<u.ihave.length;++f)n.RPC.ControlIHave.encode(u.ihave[f],l.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var f=0;f<u.iwant.length;++f)n.RPC.ControlIWant.encode(u.iwant[f],l.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var f=0;f<u.graft.length;++f)n.RPC.ControlGraft.encode(u.graft[f],l.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var f=0;f<u.prune.length;++f)n.RPC.ControlPrune.encode(u.prune[f],l.uint32(34).fork()).ldelim();return l},o.decode=function(u,l){u instanceof e||(u=e.create(u));for(var f=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlMessage;u.pos<f;){var p=u.uint32();switch(p>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(p&7);break}}return h},o.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var l=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var f=0;f<u.ihave.length;++f){if(typeof u.ihave[f]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[f]=n.RPC.ControlIHave.fromObject(u.ihave[f])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var f=0;f<u.iwant.length;++f){if(typeof u.iwant[f]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[f]=n.RPC.ControlIWant.fromObject(u.iwant[f])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var f=0;f<u.graft.length;++f){if(typeof u.graft[f]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[f]=n.RPC.ControlGraft.fromObject(u.graft[f])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var f=0;f<u.prune.length;++f){if(typeof u.prune[f]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[f]=n.RPC.ControlPrune.fromObject(u.prune[f])}}return l},o.toObject=function(u,l){l||(l={});var f={};if((l.arrays||l.defaults)&&(f.ihave=[],f.iwant=[],f.graft=[],f.prune=[]),u.ihave&&u.ihave.length){f.ihave=[];for(var h=0;h<u.ihave.length;++h)f.ihave[h]=n.RPC.ControlIHave.toObject(u.ihave[h],l)}if(u.iwant&&u.iwant.length){f.iwant=[];for(var h=0;h<u.iwant.length;++h)f.iwant[h]=n.RPC.ControlIWant.toObject(u.iwant[h],l)}if(u.graft&&u.graft.length){f.graft=[];for(var h=0;h<u.graft.length;++h)f.graft[h]=n.RPC.ControlGraft.toObject(u.graft[h],l)}if(u.prune&&u.prune.length){f.prune=[];for(var h=0;h<u.prune.length;++h)f.prune[h]=n.RPC.ControlPrune.toObject(u.prune[h],l)}return f},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.ControlIHave=function(){function o(u){if(this.messageIDs=[],u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}o.prototype.topicID=null,o.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(o.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),o.encode=function(l,f){if(f||(f=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)f.uint32(18).bytes(l.messageIDs[h]);return f},o.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,p=new n.RPC.ControlIHave;l.pos<h;){var d=l.uint32();switch(d>>>3){case 1:p.topicID=l.string();break;case 2:p.messageIDs&&p.messageIDs.length||(p.messageIDs=[]),p.messageIDs.push(l.bytes());break;default:l.skipType(d&7);break}}return p},o.fromObject=function(l){if(l instanceof n.RPC.ControlIHave)return l;var f=new n.RPC.ControlIHave;if(l.topicID!=null&&(f.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");f.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?i.base64.decode(l.messageIDs[h],f.messageIDs[h]=i.newBuffer(i.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(f.messageIDs[h]=l.messageIDs[h])}return f},o.toObject=function(l,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var p=0;p<l.messageIDs.length;++p)h.messageIDs[p]=f.bytes===String?i.base64.encode(l.messageIDs[p],0,l.messageIDs[p].length):f.bytes===Array?Array.prototype.slice.call(l.messageIDs[p]):l.messageIDs[p]}return h},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.ControlIWant=function(){function o(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return o.prototype.messageIDs=i.emptyArray,o.encode=function(u,l){if(l||(l=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var f=0;f<u.messageIDs.length;++f)l.uint32(10).bytes(u.messageIDs[f]);return l},o.decode=function(u,l){u instanceof e||(u=e.create(u));for(var f=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlIWant;u.pos<f;){var p=u.uint32();switch(p>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return h},o.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var l=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var f=0;f<u.messageIDs.length;++f)typeof u.messageIDs[f]=="string"?i.base64.decode(u.messageIDs[f],l.messageIDs[f]=i.newBuffer(i.base64.length(u.messageIDs[f])),0):u.messageIDs[f].length&&(l.messageIDs[f]=u.messageIDs[f])}return l},o.toObject=function(u,l){l||(l={});var f={};if((l.arrays||l.defaults)&&(f.messageIDs=[]),u.messageIDs&&u.messageIDs.length){f.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)f.messageIDs[h]=l.bytes===String?i.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):l.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return f},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.ControlGraft=function(){function o(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}o.prototype.topicID=null;var c;return Object.defineProperty(o.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),o.encode=function(l,f){return f||(f=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(10).string(l.topicID),f},o.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,p=new n.RPC.ControlGraft;l.pos<h;){var d=l.uint32();switch(d>>>3){case 1:p.topicID=l.string();break;default:l.skipType(d&7);break}}return p},o.fromObject=function(l){if(l instanceof n.RPC.ControlGraft)return l;var f=new n.RPC.ControlGraft;return l.topicID!=null&&(f.topicID=String(l.topicID)),f},o.toObject=function(l,f){f||(f={});var h={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),h},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.ControlPrune=function(){function o(u){if(this.peers=[],u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}o.prototype.topicID=null,o.prototype.peers=i.emptyArray,o.prototype.backoff=null;var c;return Object.defineProperty(o.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),o.encode=function(l,f){if(f||(f=r.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&f.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var h=0;h<l.peers.length;++h)n.RPC.PeerInfo.encode(l.peers[h],f.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&f.uint32(24).uint64(l.backoff),f},o.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,p=new n.RPC.ControlPrune;l.pos<h;){var d=l.uint32();switch(d>>>3){case 1:p.topicID=l.string();break;case 2:p.peers&&p.peers.length||(p.peers=[]),p.peers.push(n.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:p.backoff=l.uint64();break;default:l.skipType(d&7);break}}return p},o.fromObject=function(l){if(l instanceof n.RPC.ControlPrune)return l;var f=new n.RPC.ControlPrune;if(l.topicID!=null&&(f.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");f.peers=[];for(var h=0;h<l.peers.length;++h){if(typeof l.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");f.peers[h]=n.RPC.PeerInfo.fromObject(l.peers[h])}}return l.backoff!=null&&(i.Long?(f.backoff=i.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?f.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?f.backoff=l.backoff:typeof l.backoff=="object"&&(f.backoff=new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),f},o.toObject=function(l,f){f||(f={});var h={};if((f.arrays||f.defaults)&&(h.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,f.oneofs&&(h._topicID="topicID")),l.peers&&l.peers.length){h.peers=[];for(var p=0;p<l.peers.length;++p)h.peers[p]=n.RPC.PeerInfo.toObject(l.peers[p],f)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?h.backoff=f.longs===String?String(l.backoff):l.backoff:h.backoff=f.longs===String?i.Long.prototype.toString.call(l.backoff):f.longs===Number?new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,f.oneofs&&(h._backoff="backoff")),h},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s.PeerInfo=function(){function o(u){if(u)for(var l=Object.keys(u),f=0;f<l.length;++f)u[l[f]]!=null&&(this[l[f]]=u[l[f]])}o.prototype.peerID=null,o.prototype.signedPeerRecord=null;var c;return Object.defineProperty(o.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(o.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),o.encode=function(l,f){return f||(f=r.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&f.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&f.uint32(18).bytes(l.signedPeerRecord),f},o.decode=function(l,f){l instanceof e||(l=e.create(l));for(var h=f===void 0?l.len:l.pos+f,p=new n.RPC.PeerInfo;l.pos<h;){var d=l.uint32();switch(d>>>3){case 1:p.peerID=l.bytes();break;case 2:p.signedPeerRecord=l.bytes();break;default:l.skipType(d&7);break}}return p},o.fromObject=function(l){if(l instanceof n.RPC.PeerInfo)return l;var f=new n.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?i.base64.decode(l.peerID,f.peerID=i.newBuffer(i.base64.length(l.peerID)),0):l.peerID.length&&(f.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?i.base64.decode(l.signedPeerRecord,f.signedPeerRecord=i.newBuffer(i.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(f.signedPeerRecord=l.signedPeerRecord)),f},o.toObject=function(l,f){f||(f={});var h={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(h.peerID=f.bytes===String?i.base64.encode(l.peerID,0,l.peerID.length):f.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,f.oneofs&&(h._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=f.bytes===String?i.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):f.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,f.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},o.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},o}(),s}(),n})});var Wg=b(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.ERR_INVALID_PEER_SCORE_THRESHOLDS=wc.ERR_INVALID_PEER_SCORE_PARAMS=void 0;wc.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";wc.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var $g=b(wr=>{"use strict";var sz=wr&&wr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wr,"__esModule",{value:!0});wr.validateTopicScoreParams=wr.validatePeerScoreParams=wr.createTopicScoreParams=wr.createPeerScoreParams=wr.defaultTopicScoreParams=wr.defaultPeerScoreParams=void 0;var gt=Wg(),mt=sz(Ae());wr.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};wr.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function az(t={}){return{...wr.defaultPeerScoreParams,...t,topics:t.topics?Object.entries(t.topics).reduce((e,[r,i])=>(e[r]=_8(i),e),{}):{}}}wr.createPeerScoreParams=az;function _8(t={}){return{...wr.defaultTopicScoreParams,...t}}wr.createTopicScoreParams=_8;function oz(t){for(let[e,r]of Object.entries(t.topics))try{S8(r)}catch(i){throw(0,mt.default)(new Error(`invalid score parameters for topic ${e}: ${i.message}`),gt.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw(0,mt.default)(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw(0,mt.default)(new Error("missing application specific score function"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw(0,mt.default)(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw(0,mt.default)(new Error("invalid IPColocationFactorThreshold; must be at least 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw(0,mt.default)(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw(0,mt.default)(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw(0,mt.default)(new Error("invalid DecayInterval; must be at least 1s"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw(0,mt.default)(new Error("invalid DecayToZero; must be between 0 and 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS)}wr.validatePeerScoreParams=oz;function S8(t){if(t.topicWeight<0)throw(0,mt.default)(new Error("invalid topic weight; must be >= 0"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw(0,mt.default)(new Error("invalid TimeInMeshQuantum; must be non zero"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw(0,mt.default)(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw(0,mt.default)(new Error("invalid TimeInMeshQuantum; must be positive"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw(0,mt.default)(new Error("invalid TimeInMeshCap; must be positive"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw(0,mt.default)(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw(0,mt.default)(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw(0,mt.default)(new Error("invalid FirstMessageDeliveriesCap; must be positive"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw(0,mt.default)(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw(0,mt.default)(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw(0,mt.default)(new Error("invalid MeshMessageDeliveriesCap; must be positive"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw(0,mt.default)(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw(0,mt.default)(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw(0,mt.default)(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw(0,mt.default)(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw(0,mt.default)(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw(0,mt.default)(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),gt.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw(0,mt.default)(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),gt.ERR_INVALID_PEER_SCORE_PARAMS)}wr.validateTopicScoreParams=S8});var x8=b(Qi=>{"use strict";var cz=Qi&&Qi.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.validatePeerScoreThresholds=Qi.createPeerScoreThresholds=Qi.defaultPeerScoreThresholds=void 0;var nl=Wg(),sl=cz(Ae());Qi.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function uz(t={}){return{...Qi.defaultPeerScoreThresholds,...t}}Qi.createPeerScoreThresholds=uz;function lz(t){if(t.gossipThreshold>0)throw(0,sl.default)(new Error("invalid gossip threshold; it must be <= 0"),nl.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw(0,sl.default)(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),nl.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw(0,sl.default)(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),nl.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw(0,sl.default)(new Error("invalid accept PX threshold; it must be >= 0"),nl.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw(0,sl.default)(new Error("invalid opportunistic grafting threshold; it must be >= 0"),nl.ERR_INVALID_PEER_SCORE_THRESHOLDS)}Qi.validatePeerScoreThresholds=lz});var C8=b(sh=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});sh.computeScore=void 0;function fz(t,e,r,i){let n=0;if(Object.entries(e.topics).forEach(([a,o])=>{let c=r.topics[a];if(c===void 0)return;let u=0;if(o.inMesh){let p=o.meshTime/c.timeInMeshQuantum;p>c.timeInMeshCap&&(p=c.timeInMeshCap),u+=p*c.timeInMeshWeight}let l=o.firstMessageDeliveries;if(l>c.firstMessageDeliveriesCap&&(l=c.firstMessageDeliveriesCap),u+=l*c.firstMessageDeliveriesWeight,o.meshMessageDeliveriesActive&&o.meshMessageDeliveries<c.meshMessageDeliveriesThreshold){let p=c.meshMessageDeliveriesThreshold-o.meshMessageDeliveries;u+=p*p*c.meshMessageDeliveriesWeight}u+=o.meshFailurePenalty*c.meshFailurePenaltyWeight,u+=o.invalidMessageDeliveries*o.invalidMessageDeliveries*c.invalidMessageDeliveriesWeight,n+=u*c.topicWeight}),r.topicScoreCap>0&&n>r.topicScoreCap&&(n=r.topicScoreCap),n+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(a=>{if(r.IPColocationFactorWhitelist.has(a))return;let o=i.get(a),c=o?o.size:0;if(c>r.IPColocationFactorThreshold){let u=c-r.IPColocationFactorThreshold;n+=u*u*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let a=e.behaviourPenalty-r.behaviourPenaltyThreshold;n+=a*a*r.behaviourPenaltyWeight}return n}sh.computeScore=fz});var A8=b((Ute,I8)=>{"use strict";function Gt(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}Gt.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};Gt.prototype.get=function(e){return this.peekAt(e)};Gt.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Gt.prototype.peekFront=function(){return this.peek()};Gt.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Gt.prototype,"length",{get:function(){return this.size()}});Gt.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Gt.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Gt.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Gt.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Gt.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),i}};Gt.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var s=this._list[r],a;if(e<i/2){for(a=e;a>0;a--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(a=i-1-e;a>0;a--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};Gt.prototype.remove=function(e,r){var i=e,n,s=r;if(i===(i|0)&&this._head!==this._tail){var a=this.size(),o=this._list.length;if(!(i>=a||i<-a||r<1)){if(i<0&&(i+=a),r===1||!r)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+r>=a)return n=this.toArray(),this.clear(),n;i+r>a&&(r=a-i);var c;for(n=new Array(r),c=0;c<r;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+r===a){for(this._tail=this._tail-r+o&this._capacityMask,c=r;c>0;c--)this._list[i=i+1+o&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+o&this._capacityMask,c=r-1;c>0;c--)this._list[i=i+1+o&this._capacityMask]=void 0;return n}if(i<a/2){for(this._head=this._head+e+r+o&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+o&this._capacityMask]);for(i=this._head-1+o&this._capacityMask;s>0;)this._list[i=i-1+o&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+o&this._capacityMask,c=a-(r+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+o&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),n}}};Gt.prototype.splice=function(e,r){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,a,o,c=arguments.length,u=this._list.length,l=2;if(!n||i<n/2){for(a=new Array(i),s=0;s<i;s++)a[s]=this._list[this._head+s&this._capacityMask];for(r===0?(o=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(o=this.remove(i,r),this._head=this._head+i+u&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(a[s-1])}else{a=new Array(n-(i+r));var f=a.length;for(s=0;s<f;s++)a[s]=this._list[this._head+i+r+s&this._capacityMask];for(r===0?(o=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(o=this.remove(i,r),this._tail=this._tail-f+u&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<f;s++)this.push(a[s])}return o}else return this.remove(i,r)}};Gt.prototype.clear=function(){this._head=0,this._tail=0};Gt.prototype.isEmpty=function(){return this._head===this._tail};Gt.prototype.toArray=function(){return this._copyArray(!1)};Gt.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};Gt.prototype._copyArray=function(e){var r=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)r.push(i[s]);for(s=0;s<this._tail;s++)r.push(i[s])}else for(s=this._head;s<this._tail;s++)r.push(i[s]);return r};Gt.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};Gt.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};I8.exports=Gt});var P8=b(Jn=>{"use strict";var hz=Jn&&Jn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.MessageDeliveries=Jn.DeliveryRecordStatus=void 0;var dz=rl(),pz=hz(A8()),T8;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(T8=Jn.DeliveryRecordStatus||(Jn.DeliveryRecordStatus={}));var R8=class{constructor(){this.records=new Map,this.queue=new pz.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:T8.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let i={msgId:e,expire:Date.now()+dz.TimeCacheDuration};return this.queue.push(i),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};Jn.MessageDeliveries=R8});var O8=b(Sc=>{"use strict";var B8=Sc&&Sc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.PeerScore=void 0;var yz=$g(),gz=C8(),Di=P8(),mz=B8(rr()),vz=B8(qe()),Yg=ja(),_c=(0,vz.default)("libp2p:gossipsub:score"),D8=class{constructor(e,r,i,n){this.params=e,this.connectionManager=r,this.metrics=i,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new Di.MessageDeliveries,(0,yz.validatePeerScoreParams)(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){_c("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),_c("started")}stop(){if(!this._backgroundInterval){_c("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),_c("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this.removeIPs(n,i.ips),this.peerStats.delete(n),this.scoreCache.delete(n));return}Object.entries(i.topics).forEach(([s,a])=>{let o=this.params.topics[s];o!==void 0&&(a.firstMessageDeliveries*=o.firstMessageDeliveriesDecay,a.firstMessageDeliveries<r&&(a.firstMessageDeliveries=0),a.meshMessageDeliveries*=o.meshMessageDeliveriesDecay,a.meshMessageDeliveries<r&&(a.meshMessageDeliveries=0),a.meshFailurePenalty*=o.meshFailurePenaltyDecay,a.meshFailurePenalty<r&&(a.meshFailurePenalty=0),a.invalidMessageDeliveries*=o.invalidMessageDeliveriesDecay,a.invalidMessageDeliveries<r&&(a.invalidMessageDeliveries=0),a.inMesh&&(a.meshTime=e-a.graftTime,a.meshTime>o.meshMessageDeliveriesActivation&&(a.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<r&&(i.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(!r)return 0;let i=Date.now(),n=this.scoreCache.get(e);if(n&&n.cacheUntil>i)return n.score;this.metrics?.scoreFnRuns.inc();let s=(0,gz.computeScore)(e,r,this.params,this.peerIPs),a=i+this.scoreCacheValidityMs;return n?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-n.score)),n.score=s,n.cacheUntil=a):this.scoreCache.set(e,{score:s,cacheUntil:a}),s}addPenalty(e,r,i){let n=this.peerStats.get(e);n&&(n.behaviourPenalty+=r,this.metrics?.onScorePenalty(i))}addPeer(e){let r={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,r);let i=this.getIPs(e);this.setIPs(e,i,r.ips),r.ips=i}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this.removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let a=s-n.meshMessageDeliveries;n.meshFailurePenalty+=a*a}n.inMesh=!1,n.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let i=this.peerStats.get(e);if(i){let n=this.getPtopicStats(i,r);n&&(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}}prune(e,r){let i=this.peerStats.get(e);if(i){let n=this.getPtopicStats(i,r);if(n){let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let a=s-n.meshMessageDeliveries;n.meshFailurePenalty+=a*a}n.meshMessageDeliveriesActive=!1,n.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,i){this.markFirstMessageDelivery(e,i);let n=this.deliveryRecords.ensureRecord(r),s=Date.now();if(n.status!==Di.DeliveryRecordStatus.unknown){_c("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",e,s-n.firstSeen,Di.DeliveryRecordStatus[n.status]);return}n.status=Di.DeliveryRecordStatus.valid,n.validated=s,n.peers.forEach(a=>{a!==e&&this.markDuplicateMessageDelivery(a,i)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,i,n){switch(n){case Yg.RejectReason.Error:this.markInvalidMessageDelivery(e,i);return;case Yg.RejectReason.Blacklisted:return}let s=this.deliveryRecords.ensureRecord(r);if(s.status!==Di.DeliveryRecordStatus.unknown){_c("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeen,Di.DeliveryRecordStatus[s.status]);return}if(n===Yg.RejectReason.Ignore){s.status=Di.DeliveryRecordStatus.ignored,s.peers.clear();return}s.status=Di.DeliveryRecordStatus.invalid,this.markInvalidMessageDelivery(e,i),s.peers.forEach(a=>{this.markInvalidMessageDelivery(a,i)}),s.peers.clear()}duplicateMessage(e,r,i){let n=this.deliveryRecords.ensureRecord(r);if(!n.peers.has(e))switch(n.status){case Di.DeliveryRecordStatus.unknown:n.peers.add(e);break;case Di.DeliveryRecordStatus.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,i,n.validated);break;case Di.DeliveryRecordStatus.invalid:this.markInvalidMessageDelivery(e,i);break;case Di.DeliveryRecordStatus.ignored:break}}markInvalidMessageDelivery(e,r){let i=this.peerStats.get(e);if(i){let n=this.getPtopicStats(i,r);n&&(n.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let i=this.peerStats.get(e);if(i){let n=this.getPtopicStats(i,r);if(n){let s=this.params.topics[r].firstMessageDeliveriesCap;n.firstMessageDeliveries=Math.min(s,n.firstMessageDeliveries+1),n.inMesh&&(s=this.params.topics[r].meshMessageDeliveriesCap,n.meshMessageDeliveries=Math.min(s,n.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,i){let n=this.peerStats.get(e);if(n){let s=i!==void 0?Date.now():0,a=this.getPtopicStats(n,r);if(a&&a.inMesh){let o=this.params.topics[r];if(i!==void 0){let u=s-i,l=u>o.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,u,l),l)return}let c=o.meshMessageDeliveriesCap;a.meshMessageDeliveries=Math.min(c,a.meshMessageDeliveries+1)}}}getIPs(e){let r=mz.default.createFromB58String(e);return this.connectionManager.getAll(r).map(i=>i.remoteAddr.toOptions().host)}setIPs(e,r,i){e:for(let n of r){for(let a of i)if(n===a)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let a of r)if(n===a)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}removeIPs(e,r){r.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}updateIPs(){this.peerStats.forEach((e,r)=>{let i=this.getIPs(r);this.setIPs(r,i,e.ips),e.ips=i})}getPtopicStats(e,r){let i=e.topics[r];return i!==void 0?i:this.params.topics[r]!==void 0?(i={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=i,i):null}};Sc.PeerScore=D8});var N8=b(es=>{"use strict";var bz=es&&es.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),Qg=es&&es.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&bz(e,t,r)};Object.defineProperty(es,"__esModule",{value:!0});Qg($g(),es);Qg(x8(),es);Qg(O8(),es)});var L8=b(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.IWantTracer=void 0;var Ez=ih(),wz=ja(),k8=class{constructor(e,r){this.gossipsubIWantFollowupMs=e,this.metrics=r,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let i=Math.floor(Math.random()*r.length),n=r[i],s=(0,Ez.messageIdToString)(n),a=this.promises.get(s);a||(a=new Map,this.promises.set(s,a));let o=Date.now();a.has(e)||(a.set(e,o+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(s)||this.requestMsByMsg.set(s,o)))}getBrokenPromises(){let e=Date.now(),r=new Map,i=0;return this.promises.forEach((n,s)=>{n.forEach((a,o)=>{a<e&&(r.set(o,(r.get(o)??0)+1),n.delete(o),i++)}),n.size||this.promises.delete(s)}),this.metrics?.iwantPromiseBroken.inc(i),r}deliverMessage(e){this.trackMessage(e);let r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case wz.RejectReason.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire;for(let[r,i]of this.requestMsByMsg.entries())if(i<e)this.requestMsByMsg.delete(r);else break}trackMessage(e){if(this.metrics){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};ah.IWantTracer=k8});var q8=b(oh=>{"use strict";Object.defineProperty(oh,"__esModule",{value:!0});oh.SimpleTimeCache=void 0;var M8=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs})}prune(){let e=Date.now();for(let[r,i]of this.entries.entries())if(i.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};oh.SimpleTimeCache=M8});var U8=b(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.getMetrics=Ht.ScoreThreshold=Ht.IHaveIgnoreReason=Ht.ScorePenalty=Ht.ChurnReason=Ht.InclusionReason=Ht.MessageSource=void 0;var _z=ja(),Sz;(function(t){t.forward="forward",t.publish="publish"})(Sz=Ht.MessageSource||(Ht.MessageSource={}));var xz;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(xz=Ht.InclusionReason||(Ht.InclusionReason={}));var Cz;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Unsub="unsubscribed",t.Excess="excess"})(Cz=Ht.ChurnReason||(Ht.ChurnReason={}));var Iz;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(Iz=Ht.ScorePenalty||(Ht.ScorePenalty={}));var Az;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(Az=Ht.IHaveIgnoreReason||(Ht.IHaveIgnoreReason={}));var al;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(al=Ht.ScoreThreshold||(Ht.ScoreThreshold={}));function Tz(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:t.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:t.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:t.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:t.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:e,toTopic(i){return this.topicStrToLabel.get(i)??i},onJoin(i){this.topicSubscriptionStatus.set({topicStr:i},1),this.meshPeerCounts.set({topicStr:i},0)},onLeave(i){this.topicSubscriptionStatus.set({topicStr:i},0),this.meshPeerCounts.set({topicStr:i},0)},onAddToMesh(i,n,s){let a=this.toTopic(i);this.meshPeerInclusionEvents.inc({topic:a,reason:n},s)},onRemoveFromMesh(i,n,s){let a=this.toTopic(i);this.meshPeerChurnEvents.inc({topic:a,reason:n},s)},onReportValidationMcacheHit(i){this.asyncValidationMcacheHit.inc({hit:i?"hit":"miss"})},onReportValidation(i,n){let s=this.toTopic(i);this.asyncValidationResult.inc({topic:s,acceptance:n})},onScorePenalty(i){this.scoringPenalties.inc({penalty:i},1)},onIhaveRcv(i,n,s){let a=this.toTopic(i);this.ihaveRcvMsgids.inc({topic:a},n),this.ihaveRcvNotSeenMsgids.inc({topic:a},s)},onIwantRcv(i,n){for(let[s,a]of i){let o=this.toTopic(s);this.iwantRcvMsgids.inc({topic:o},a)}this.iwantRcvDonthaveMsgids.inc(n)},onForwardMsg(i,n){let s=this.toTopic(i);this.msgForwardCount.inc({topic:s},1),this.msgForwardPeers.inc({topic:s},n)},onPublishMsg(i,n,s,a){let o=this.toTopic(i);this.msgPublishCount.inc({topic:o},1),this.msgPublishBytes.inc({topic:o},s*a),this.msgPublishPeers.inc({topic:o},s),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"direct"},n.direct),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"floodsub"},n.floodsub),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"mesh"},n.mesh),this.msgPublishPeersByGroup.inc({topic:o,peerGroup:"fanout"},n.fanout)},onMsgRecvPreValidation(i){let n=this.toTopic(i);this.msgReceivedPreValidation.inc({topic:n},1)},onMsgRecvResult(i,n){let s=this.toTopic(i);this.msgReceivedStatus.inc({topic:s,status:n})},onMsgRecvInvalid(i,n){let s=this.toTopic(i),a=n.reason===_z.RejectReason.Error?n.error:n.reason;this.msgReceivedInvalid.inc({topic:s,error:a},1)},onDuplicateMsgDelivery(i,n,s){if(this.duplicateMsgDeliveryDelay.observe(n/1e3),s){let a=this.toTopic(i);this.duplicateMsgLateDelivery.inc({topic:a},1)}},onRpcRecv(i,n){this.rpcRecvBytes.inc(n),this.rpcRecvCount.inc(1),i.subscriptions&&this.rpcRecvSubscription.inc(i.subscriptions.length),i.messages&&this.rpcRecvMessage.inc(i.messages.length),i.control&&(this.rpcRecvControl.inc(1),i.control.ihave&&this.rpcRecvIHave.inc(i.control.ihave.length),i.control.iwant&&this.rpcRecvIWant.inc(i.control.iwant.length),i.control.graft&&this.rpcRecvGraft.inc(i.control.graft.length),i.control.prune&&this.rpcRecvPrune.inc(i.control.prune.length))},onRpcSent(i,n){this.rpcSentBytes.inc(n),this.rpcSentCount.inc(1),i.subscriptions&&this.rpcSentSubscription.inc(i.subscriptions.length),i.messages&&this.rpcSentMessage.inc(i.messages.length),i.control&&(this.rpcSentControl.inc(1),i.control.ihave&&this.rpcSentIHave.inc(i.control.ihave.length),i.control.iwant&&this.rpcSentIWant.inc(i.control.iwant.length),i.control.graft&&this.rpcSentGraft.inc(i.control.graft.length),i.control.prune&&this.rpcSentPrune.inc(i.control.prune.length))},registerScores(i,n){let s=0,a=0,o=0,c=0;for(let u of i)u>=n.graylistThreshold&&s++,u>=n.publishThreshold&&a++,u>=n.gossipThreshold&&o++,u>=0&&c++;this.peersByScoreThreshold.set({threshold:al.graylist},s),this.peersByScoreThreshold.set({threshold:al.publish},a),this.peersByScoreThreshold.set({threshold:al.gossip},o),this.peersByScoreThreshold.set({threshold:al.mesh},c),this.score.set(i)},registerScoreWeights(i){for(let[n,s]of i.byTopic)this.scoreWeights.set({topic:n,p:"p1"},s.p1w),this.scoreWeights.set({topic:n,p:"p2"},s.p2w),this.scoreWeights.set({topic:n,p:"p3"},s.p3w),this.scoreWeights.set({topic:n,p:"p3b"},s.p3bw),this.scoreWeights.set({topic:n,p:"p4"},s.p4w);this.scoreWeights.set({p:"p5"},i.p5w),this.scoreWeights.set({p:"p6"},i.p6w),this.scoreWeights.set({p:"p7"},i.p7w)},registerScorePerMesh(i,n){let s=new Map;i.forEach((a,o)=>{let c=this.topicStrToLabel.get(o)??"unknown",u=s.get(c);u||(u=new Set,s.set(c,u)),a.forEach(l=>u?.add(l))});for(let[a,o]of s){let c=[];o.forEach(u=>{c.push(n.get(u)??0)}),this.scorePerMesh.set({topic:a},c)}}}}Ht.getMetrics=Tz});var Xg=b((zte,F8)=>{F8.exports=_r().EventEmitter});var Zg=b(()=>{});var G8=b((Yte,j8)=>{"use strict";function K8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function Rz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?K8(Object(r),!0).forEach(function(i){Pz(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):K8(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function Pz(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V8(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dz(t,e,r){return e&&V8(t.prototype,e),r&&V8(t,r),t}var Oz=xi(),ch=Oz.Buffer,Nz=Zg(),Jg=Nz.inspect,kz=Jg&&Jg.custom||"inspect";function Lz(t,e,r){ch.prototype.copy.call(t,e,r)}j8.exports=function(){function t(){Bz(this,t),this.head=null,this.tail=null,this.length=0}return Dz(t,[{key:"push",value:function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n}},{key:"concat",value:function(r){if(this.length===0)return ch.alloc(0);for(var i=ch.allocUnsafe(r>>>0),n=this.head,s=0;n;)Lz(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(r,i){var n;return r<this.head.data.length?(n=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?n=this.shift():n=i?this._getString(r):this._getBuffer(r),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var i=this.head,n=1,s=i.data;for(r-=s.length;i=i.next;){var a=i.data,o=r>a.length?a.length:r;if(o===a.length?s+=a:s+=a.slice(0,r),r-=o,r===0){o===a.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=a.slice(o));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(r){var i=ch.allocUnsafe(r),n=this.head,s=1;for(n.data.copy(i),r-=n.data.length;n=n.next;){var a=n.data,o=r>a.length?a.length:r;if(a.copy(i,i.length-r,0,o),r-=o,r===0){o===a.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=a.slice(o));break}++s}return this.length-=s,i}},{key:kz,value:function(r,i){return Jg(this,Rz({},i,{depth:0,customInspect:!1}))}}]),t}()});var tm=b((Qte,z8)=>{"use strict";function Mz(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(em,this,t)):process.nextTick(em,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(uh,r):(r._writableState.errorEmitted=!0,process.nextTick(H8,r,s)):process.nextTick(H8,r,s):e?(process.nextTick(uh,r),e(s)):process.nextTick(uh,r)}),this)}function H8(t,e){em(t,e),uh(t)}function uh(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function qz(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function em(t,e){t.emit("error",e)}function Uz(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}z8.exports={destroy:Mz,undestroy:qz,errorOrDestroy:Uz}});var Ga=b((Xte,Y8)=>{"use strict";function Fz(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var W8={};function Oi(t,e,r){r||(r=Error);function i(s,a,o){return typeof e=="string"?e:e(s,a,o)}var n=function(s){Fz(a,s);function a(o,c,u){return s.call(this,i(o,c,u))||this}return a}(r);n.prototype.name=r.name,n.prototype.code=t,W8[t]=n}function $8(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(i){return String(i)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function Kz(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function Vz(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function jz(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}Oi("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Oi("ERR_INVALID_ARG_TYPE",function(t,e,r){var i;typeof e=="string"&&Kz(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(Vz(t," argument"))n="The ".concat(t," ").concat(i," ").concat($8(e,"type"));else{var s=jz(t,".")?"property":"argument";n='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat($8(e,"type"))}return n+=". Received type ".concat(typeof r),n},TypeError);Oi("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Oi("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Oi("ERR_STREAM_PREMATURE_CLOSE","Premature close");Oi("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Oi("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Oi("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Oi("ERR_STREAM_WRITE_AFTER_END","write after end");Oi("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Oi("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Oi("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Y8.exports.codes=W8});var rm=b((Zte,Q8)=>{"use strict";var Gz=Ga().codes.ERR_INVALID_OPT_VALUE;function Hz(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function zz(t,e,r,i){var n=Hz(e,i,r);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?r:"highWaterMark";throw new Gz(s,n)}return Math.floor(n)}return t.objectMode?16:16*1024}Q8.exports={getHighWaterMark:zz}});var xc=b((Jte,im)=>{typeof Object.create=="function"?im.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:im.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}}});var Z8=b((ere,X8)=>{X8.exports=Wz;function Wz(t,e){if(nm("noDeprecation"))return t;var r=!1;function i(){if(!r){if(nm("throwDeprecation"))throw new Error(e);nm("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return i}function nm(t){try{if(!globalThis.localStorage)return!1}catch(r){return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var om=b((tre,nD)=>{"use strict";nD.exports=zt;function J8(t){var e=this;this.next=null,this.entry=null,this.finish=function(){EW(e,t)}}var Cc;zt.WritableState=ol;var $z={deprecate:Z8()},eD=Xg(),lh=xi().Buffer,Yz=globalThis.Uint8Array||function(){};function Qz(t){return lh.from(t)}function Xz(t){return lh.isBuffer(t)||t instanceof Yz}var sm=tm(),Zz=rm(),Jz=Zz.getHighWaterMark,Vs=Ga().codes,eW=Vs.ERR_INVALID_ARG_TYPE,tW=Vs.ERR_METHOD_NOT_IMPLEMENTED,rW=Vs.ERR_MULTIPLE_CALLBACK,iW=Vs.ERR_STREAM_CANNOT_PIPE,nW=Vs.ERR_STREAM_DESTROYED,sW=Vs.ERR_STREAM_NULL_VALUES,aW=Vs.ERR_STREAM_WRITE_AFTER_END,oW=Vs.ERR_UNKNOWN_ENCODING,Ic=sm.errorOrDestroy;xc()(zt,eD);function cW(){}function ol(t,e,r){Cc=Cc||Ha(),t=t||{},typeof r!="boolean"&&(r=e instanceof Cc),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=Jz(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=t.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){yW(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new J8(this)}ol.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(ol.prototype,"buffer",{get:$z.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}})();var fh;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(fh=Function.prototype[Symbol.hasInstance],Object.defineProperty(zt,Symbol.hasInstance,{value:function(e){return fh.call(this,e)?!0:this!==zt?!1:e&&e._writableState instanceof ol}})):fh=function(e){return e instanceof this};function zt(t){Cc=Cc||Ha();var e=this instanceof Cc;if(!e&&!fh.call(zt,this))return new zt(t);this._writableState=new ol(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),eD.call(this)}zt.prototype.pipe=function(){Ic(this,new iW)};function uW(t,e){var r=new aW;Ic(t,r),process.nextTick(e,r)}function lW(t,e,r,i){var n;return r===null?n=new sW:typeof r!="string"&&!e.objectMode&&(n=new eW("chunk",["string","Buffer"],r)),n?(Ic(t,n),process.nextTick(i,n),!1):!0}zt.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&Xz(t);return s&&!lh.isBuffer(t)&&(t=Qz(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=cW),i.ending?uW(this,r):(s||lW(this,i,t,r))&&(i.pendingcb++,n=hW(this,i,s,t,e,r)),n};zt.prototype.cork=function(){this._writableState.corked++};zt.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&rD(this,t))};zt.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new oW(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(zt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function fW(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=lh.from(e,r)),e}Object.defineProperty(zt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function hW(t,e,r,i,n,s){if(!r){var a=fW(e,i,n);i!==a&&(r=!0,n="buffer",i=a)}var o=e.objectMode?1:i.length;e.length+=o;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else am(t,e,!1,o,i,n,s);return c}function am(t,e,r,i,n,s,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new nW("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function dW(t,e,r,i,n){--e.pendingcb,r?(process.nextTick(n,i),process.nextTick(cl,t,e),t._writableState.errorEmitted=!0,Ic(t,i)):(n(i),t._writableState.errorEmitted=!0,Ic(t,i),cl(t,e))}function pW(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function yW(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(typeof n!="function")throw new rW;if(pW(r),e)dW(t,r,i,e,n);else{var s=iD(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&rD(t,r),i?process.nextTick(tD,t,r,s,n):tD(t,r,s,n)}}function tD(t,e,r,i){r||gW(t,e),e.pendingcb--,i(),cl(t,e)}function gW(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function rD(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)n[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;n.allBuffers=o,am(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new J8(e),e.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,l=r.callback,f=e.objectMode?1:c.length;if(am(t,e,!1,f,c,u,l),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}zt.prototype._write=function(t,e,r){r(new tW("_write()"))};zt.prototype._writev=null;zt.prototype.end=function(t,e,r){var i=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||bW(this,i,r),this};Object.defineProperty(zt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function iD(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function mW(t,e){t._final(function(r){e.pendingcb--,r&&Ic(t,r),e.prefinished=!0,t.emit("prefinish"),cl(t,e)})}function vW(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(mW,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function cl(t,e){var r=iD(e);if(r&&(vW(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}function bW(t,e,r){e.ending=!0,cl(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function EW(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(zt.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});zt.prototype.destroy=sm.destroy;zt.prototype._undestroy=sm.undestroy;zt.prototype._destroy=function(t,e){e(t)}});var Ha=b((rre,aD)=>{"use strict";var wW=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};aD.exports=Tn;var sD=lm(),cm=om();xc()(Tn,sD);for(um=wW(cm.prototype),hh=0;hh<um.length;hh++)dh=um[hh],Tn.prototype[dh]||(Tn.prototype[dh]=cm.prototype[dh]);var um,dh,hh;function Tn(t){if(!(this instanceof Tn))return new Tn(t);sD.call(this,t),cm.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",_W)))}Object.defineProperty(Tn.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Tn.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Tn.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function _W(){this._writableState.ended||process.nextTick(SW,this)}function SW(t){t.end()}Object.defineProperty(Tn.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var uD=b((fm,cD)=>{var ph=xi(),Rn=ph.Buffer;function oD(t,e){for(var r in t)e[r]=t[r]}Rn.from&&Rn.alloc&&Rn.allocUnsafe&&Rn.allocUnsafeSlow?cD.exports=ph:(oD(ph,fm),fm.Buffer=za);function za(t,e,r){return Rn(t,e,r)}za.prototype=Object.create(Rn.prototype);oD(Rn,za);za.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Rn(t,e,r)};za.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=Rn(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};za.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Rn(t)};za.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ph.SlowBuffer(t)}});var pm=b(fD=>{"use strict";var hm=uD().Buffer,lD=hm.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function xW(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function CW(t){var e=xW(t);if(typeof e!="string"&&(hm.isEncoding===lD||!lD(t)))throw new Error("Unknown encoding: "+t);return e||t}fD.StringDecoder=ul;function ul(t){this.encoding=CW(t);var e;switch(this.encoding){case"utf16le":this.text=BW,this.end=DW,e=4;break;case"utf8":this.fillLast=TW,e=4;break;case"base64":this.text=OW,this.end=NW,e=3;break;default:this.write=kW,this.end=LW;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=hm.allocUnsafe(e)}ul.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};ul.prototype.end=PW;ul.prototype.text=RW;ul.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function dm(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function IW(t,e,r){var i=e.length-1;if(i<r)return 0;var n=dm(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=dm(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=dm(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function AW(t,e,r){if((e[0]&192)!=128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return t.lastNeed=2,"\uFFFD"}}function TW(t){var e=this.lastTotal-this.lastNeed,r=AW(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function RW(t,e){var r=IW(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function PW(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function BW(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function DW(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function OW(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function NW(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function kW(t){return t.toString(this.encoding)}function LW(t){return t&&t.length?this.write(t):""}});var yh=b((nre,pD)=>{"use strict";var hD=Ga().codes.ERR_STREAM_PREMATURE_CLOSE;function MW(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}function qW(){}function UW(t){return t.setHeader&&typeof t.abort=="function"}function dD(t,e,r){if(typeof e=="function")return dD(t,null,e);e||(e={}),r=MW(r||qW);var i=e.readable||e.readable!==!1&&t.readable,n=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||o()},a=t._writableState&&t._writableState.finished,o=function(){n=!1,a=!0,i||r.call(t)},c=t._readableState&&t._readableState.endEmitted,u=function(){i=!1,c=!0,n||r.call(t)},l=function(d){r.call(t,d)},f=function(){var d;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(d=new hD),r.call(t,d);if(n&&!a)return(!t._writableState||!t._writableState.ended)&&(d=new hD),r.call(t,d)},h=function(){t.req.on("finish",o)};return UW(t)?(t.on("complete",o),t.on("abort",f),t.req?h():t.on("request",h)):n&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",u),t.on("finish",o),e.error!==!1&&t.on("error",l),t.on("close",f),function(){t.removeListener("complete",o),t.removeListener("abort",f),t.removeListener("request",h),t.req&&t.req.removeListener("finish",o),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",o),t.removeListener("end",u),t.removeListener("error",l),t.removeListener("close",f)}}pD.exports=dD});var gD=b((sre,yD)=>{"use strict";var gh;function js(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var FW=yh(),Gs=Symbol("lastResolve"),Wa=Symbol("lastReject"),ll=Symbol("error"),mh=Symbol("ended"),$a=Symbol("lastPromise"),ym=Symbol("handlePromise"),Ya=Symbol("stream");function Hs(t,e){return{value:t,done:e}}function KW(t){var e=t[Gs];if(e!==null){var r=t[Ya].read();r!==null&&(t[$a]=null,t[Gs]=null,t[Wa]=null,e(Hs(r,!1)))}}function VW(t){process.nextTick(KW,t)}function jW(t,e){return function(r,i){t.then(function(){if(e[mh]){r(Hs(void 0,!0));return}e[ym](r,i)},i)}}var GW=Object.getPrototypeOf(function(){}),HW=Object.setPrototypeOf((gh={get stream(){return this[Ya]},next:function(){var e=this,r=this[ll];if(r!==null)return Promise.reject(r);if(this[mh])return Promise.resolve(Hs(void 0,!0));if(this[Ya].destroyed)return new Promise(function(a,o){process.nextTick(function(){e[ll]?o(e[ll]):a(Hs(void 0,!0))})});var i=this[$a],n;if(i)n=new Promise(jW(i,this));else{var s=this[Ya].read();if(s!==null)return Promise.resolve(Hs(s,!1));n=new Promise(this[ym])}return this[$a]=n,n}},js(gh,Symbol.asyncIterator,function(){return this}),js(gh,"return",function(){var e=this;return new Promise(function(r,i){e[Ya].destroy(null,function(n){if(n){i(n);return}r(Hs(void 0,!0))})})}),gh),GW),zW=function(e){var r,i=Object.create(HW,(r={},js(r,Ya,{value:e,writable:!0}),js(r,Gs,{value:null,writable:!0}),js(r,Wa,{value:null,writable:!0}),js(r,ll,{value:null,writable:!0}),js(r,mh,{value:e._readableState.endEmitted,writable:!0}),js(r,ym,{value:function(s,a){var o=i[Ya].read();o?(i[$a]=null,i[Gs]=null,i[Wa]=null,s(Hs(o,!1))):(i[Gs]=s,i[Wa]=a)},writable:!0}),r));return i[$a]=null,FW(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Wa];s!==null&&(i[$a]=null,i[Gs]=null,i[Wa]=null,s(n)),i[ll]=n;return}var a=i[Gs];a!==null&&(i[$a]=null,i[Gs]=null,i[Wa]=null,a(Hs(void 0,!0))),i[mh]=!0}),e.on("readable",VW.bind(null,i)),i};yD.exports=zW});var vD=b((are,mD)=>{mD.exports=function(){throw new Error("Readable.from is not available in the browser")}});var lm=b((cre,TD)=>{"use strict";TD.exports=Je;var Ac;Je.ReadableState=ED;var ore=_r().EventEmitter,bD=function(e,r){return e.listeners(r).length},fl=Xg(),vh=xi().Buffer,WW=globalThis.Uint8Array||function(){};function $W(t){return vh.from(t)}function YW(t){return vh.isBuffer(t)||t instanceof WW}var gm=Zg(),Me;gm&&gm.debuglog?Me=gm.debuglog("stream"):Me=function(){};var QW=G8(),mm=tm(),XW=rm(),ZW=XW.getHighWaterMark,bh=Ga().codes,JW=bh.ERR_INVALID_ARG_TYPE,e$=bh.ERR_STREAM_PUSH_AFTER_EOF,t$=bh.ERR_METHOD_NOT_IMPLEMENTED,r$=bh.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Tc,vm,bm;xc()(Je,fl);var hl=mm.errorOrDestroy,Em=["error","close","destroy","pause","resume"];function i$(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function ED(t,e,r){Ac=Ac||Ha(),t=t||{},typeof r!="boolean"&&(r=e instanceof Ac),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=ZW(this,t,"readableHighWaterMark",r),this.buffer=new QW,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(Tc||(Tc=pm().StringDecoder),this.decoder=new Tc(t.encoding),this.encoding=t.encoding)}function Je(t){if(Ac=Ac||Ha(),!(this instanceof Je))return new Je(t);var e=this instanceof Ac;this._readableState=new ED(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),fl.call(this)}Object.defineProperty(Je.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Je.prototype.destroy=mm.destroy;Je.prototype._undestroy=mm.undestroy;Je.prototype._destroy=function(t,e){e(t)};Je.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=vh.from(t,e),e=""),i=!0),wD(this,t,e,!1,i)};Je.prototype.unshift=function(t){return wD(this,t,null,!0,!1)};function wD(t,e,r,i,n){Me("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,a$(t,s);else{var a;if(n||(a=n$(s,e)),a)hl(t,a);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==vh.prototype&&(e=$W(e)),i)s.endEmitted?hl(t,new r$):wm(t,s,e,!0);else if(s.ended)hl(t,new e$);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?wm(t,s,e,!1):_m(t,s)):wm(t,s,e,!1)}else i||(s.reading=!1,_m(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function wm(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Eh(t)),_m(t,e)}function n$(t,e){var r;return!YW(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new JW("chunk",["string","Buffer","Uint8Array"],e)),r}Je.prototype.isPaused=function(){return this._readableState.flowing===!1};Je.prototype.setEncoding=function(t){Tc||(Tc=pm().StringDecoder);var e=new Tc(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";r!==null;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var _D=1073741824;function s$(t){return t>=_D?t=_D:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function SD(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=s$(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Je.prototype.read=function(t){Me("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return Me("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?xm(this):Eh(this),null;if(t=SD(t,e),t===0&&e.ended)return e.length===0&&xm(this),null;var i=e.needReadable;Me("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,Me("length less than watermark",i)),e.ended||e.reading?(i=!1,Me("reading or ended",i)):i&&(Me("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=SD(r,e)));var n;return t>0?n=ID(t,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&xm(this)),n!==null&&this.emit("data",n),n};function a$(t,e){if(Me("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Eh(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,xD(t)))}}function Eh(t){var e=t._readableState;Me("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(Me("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(xD,t))}function xD(t){var e=t._readableState;Me("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Sm(t)}function _m(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(o$,t,e))}function o$(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(Me("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Je.prototype._read=function(t){hl(this,new t$("_read()"))};Je.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,Me("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?o:y;i.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(g,m){Me("onunpipe"),g===r&&m&&m.hasUnpiped===!1&&(m.hasUnpiped=!0,l())}function o(){Me("onend"),t.end()}var c=c$(r);t.on("drain",c);var u=!1;function l(){Me("cleanup"),t.removeListener("close",p),t.removeListener("finish",d),t.removeListener("drain",c),t.removeListener("error",h),t.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",y),r.removeListener("data",f),u=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&c()}r.on("data",f);function f(g){Me("ondata");var m=t.write(g);Me("dest.write",m),m===!1&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&AD(i.pipes,t)!==-1)&&!u&&(Me("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function h(g){Me("onerror",g),y(),t.removeListener("error",h),bD(t,"error")===0&&hl(t,g)}i$(t,"error",h);function p(){t.removeListener("finish",d),y()}t.once("close",p);function d(){Me("onfinish"),t.removeListener("close",p),y()}t.once("finish",d);function y(){Me("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(Me("pipe resume"),r.resume()),t};function c$(t){return function(){var r=t._readableState;Me("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&bD(t,"data")&&(r.flowing=!0,Sm(t))}}Je.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=AD(e.pipes,t);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Je.prototype.on=function(t,e){var r=fl.prototype.on.call(this,t,e),i=this._readableState;return t==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):t==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,Me("on readable",i.length,i.reading),i.length?Eh(this):i.reading||process.nextTick(u$,this)),r};Je.prototype.addListener=Je.prototype.on;Je.prototype.removeListener=function(t,e){var r=fl.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(CD,this),r};Je.prototype.removeAllListeners=function(t){var e=fl.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(CD,this),e};function CD(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function u$(t){Me("readable nexttick read 0"),t.read(0)}Je.prototype.resume=function(){var t=this._readableState;return t.flowing||(Me("resume"),t.flowing=!t.readableListening,l$(this,t)),t.paused=!1,this};function l$(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(f$,t,e))}function f$(t,e){Me("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Sm(t),e.flowing&&!e.reading&&t.read(0)}Je.prototype.pause=function(){return Me("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Me("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Sm(t){var e=t._readableState;for(Me("flow",e.flowing);e.flowing&&t.read()!==null;);}Je.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(Me("wrapped end"),r.decoder&&!r.ended){var a=r.decoder.end();a&&a.length&&e.push(a)}e.push(null)}),t.on("data",function(a){if(Me("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!(r.objectMode&&a==null)&&!(!r.objectMode&&(!a||!a.length))){var o=e.push(a);o||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(o){return function(){return t[o].apply(t,arguments)}}(n));for(var s=0;s<Em.length;s++)t.on(Em[s],this.emit.bind(this,Em[s]));return this._read=function(a){Me("wrapped _read",a),i&&(i=!1,t.resume())},this};typeof Symbol=="function"&&(Je.prototype[Symbol.asyncIterator]=function(){return vm===void 0&&(vm=gD()),vm(this)});Object.defineProperty(Je.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Je.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Je.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Je._fromList=ID;Object.defineProperty(Je.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ID(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function xm(t){var e=t._readableState;Me("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(h$,e,t))}function h$(t,e){if(Me("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Je.from=function(t,e){return bm===void 0&&(bm=vD()),bm(Je,t,e)});function AD(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var Cm=b((ure,PD)=>{"use strict";PD.exports=ts;var wh=Ga().codes,d$=wh.ERR_METHOD_NOT_IMPLEMENTED,p$=wh.ERR_MULTIPLE_CALLBACK,y$=wh.ERR_TRANSFORM_ALREADY_TRANSFORMING,g$=wh.ERR_TRANSFORM_WITH_LENGTH_0,_h=Ha();xc()(ts,_h);function m$(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(i===null)return this.emit("error",new p$);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function ts(t){if(!(this instanceof ts))return new ts(t);_h.call(this,t),this._transformState={afterTransform:m$.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",v$)}function v$(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){RD(t,e,r)}):RD(this,null,null)}ts.prototype.push=function(t,e){return this._transformState.needTransform=!1,_h.prototype.push.call(this,t,e)};ts.prototype._transform=function(t,e,r){r(new d$("_transform()"))};ts.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};ts.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};ts.prototype._destroy=function(t,e){_h.prototype._destroy.call(this,t,function(r){e(r)})};function RD(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new g$;if(t._transformState.transforming)throw new y$;return t.push(null)}});var OD=b((lre,DD)=>{"use strict";DD.exports=dl;var BD=Cm();xc()(dl,BD);function dl(t){if(!(this instanceof dl))return new dl(t);BD.call(this,t)}dl.prototype._transform=function(t,e,r){r(null,t)}});var qD=b((fre,MD)=>{"use strict";var Im;function b$(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var ND=Ga().codes,E$=ND.ERR_MISSING_ARGS,w$=ND.ERR_STREAM_DESTROYED;function kD(t){if(t)throw t}function _$(t){return t.setHeader&&typeof t.abort=="function"}function S$(t,e,r,i){i=b$(i);var n=!1;t.on("close",function(){n=!0}),Im===void 0&&(Im=yh()),Im(t,{readable:e,writable:r},function(a){if(a)return i(a);n=!0,i()});var s=!1;return function(a){if(!n&&!s){if(s=!0,_$(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(a||new w$("pipe"))}}}function LD(t){t()}function x$(t,e){return t.pipe(e)}function C$(t){return!t.length||typeof t[t.length-1]!="function"?kD:t.pop()}function I$(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=C$(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new E$("streams");var n,s=e.map(function(a,o){var c=o<e.length-1,u=o>0;return S$(a,c,u,function(l){n||(n=l),l&&s.forEach(LD),!c&&(s.forEach(LD),i(n))})});return e.reduce(x$)}MD.exports=I$});var FD=b((Ni,UD)=>{Ni=UD.exports=lm();Ni.Stream=Ni;Ni.Readable=Ni;Ni.Writable=om();Ni.Duplex=Ha();Ni.Transform=Cm();Ni.PassThrough=OD();Ni.finished=yh();Ni.pipeline=qD()});var jD=b((hre,VD)=>{"use strict";var{Readable:A$}=FD(),KD=Cd(),T$=(t=1/0)=>{let e=0;return new A$({read(r){if(e>=t)return this.push(null);e+r>=t&&(r=t-e),e+=r,this.push(KD(r))}})};VD.exports={randomStream:T$,randomBytes:KD}});var WD=b(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.validateToRawMessage=Pn.buildRawMessage=Pn.SignPrefix=void 0;var GD=jD(),HD=(qn(),Mn),R$=(ar(),pr),P$=Fu(),B$=rr(),zD=zg(),Nr=ja();Pn.SignPrefix=(0,R$.fromString)("libp2p-pubsub:");async function D$(t,e,r){switch(t.type){case Nr.PublishConfigType.Signing:{let i={from:t.author.toBytes(),data:r,seqno:(0,GD.randomBytes)(8),topic:e,signature:void 0,key:void 0},n=(0,HD.concat)([Pn.SignPrefix,zD.RPC.Message.encode(i).finish()]);return i.signature=await t.privateKey.sign(n),i.key=t.key,i}case Nr.PublishConfigType.Author:return{from:t.author.toBytes(),data:r,seqno:(0,GD.randomBytes)(8),topic:e,signature:void 0,key:void 0};case Nr.PublishConfigType.Anonymous:return{from:void 0,data:r,seqno:void 0,topic:e,signature:void 0,key:void 0}}}Pn.buildRawMessage=D$;async function O$(t,e){switch(t){case Nr.SignaturePolicy.StrictNoSign:return e.signature!=null?{valid:!1,error:Nr.ValidateError.SignaturePresent}:e.seqno!=null?{valid:!1,error:Nr.ValidateError.SeqnoPresent}:e.key!=null?{valid:!1,error:Nr.ValidateError.FromPresent}:{valid:!0,fromPeerId:null};case Nr.SignaturePolicy.StrictSign:{if(e.seqno==null)return{valid:!1,error:Nr.ValidateError.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:Nr.ValidateError.InvalidSeqno};if(e.signature==null)return{valid:!1,error:Nr.ValidateError.InvalidSignature};if(e.from==null)return{valid:!1,error:Nr.ValidateError.InvalidPeerId};let r;try{r=(0,B$.createFromBytes)(e.from)}catch(a){return{valid:!1,error:Nr.ValidateError.InvalidPeerId}}let i;if(e.key){if(i=P$.keys.unmarshalPublicKey(e.key),r.pubKey!==void 0&&!i.equals(r.pubKey))return{valid:!1,error:Nr.ValidateError.InvalidPeerId}}else{if(r.pubKey===void 0)return{valid:!1,error:Nr.ValidateError.InvalidPeerId};i=r.pubKey}let n={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},s=(0,HD.concat)([Pn.SignPrefix,zD.RPC.Message.encode(n).finish()]);return await i.verify(s,e.signature)?{valid:!0,fromPeerId:r}:{valid:!1,error:Nr.ValidateError.InvalidSignature}}}}Pn.validateToRawMessage=O$});var $D=b(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.msgIdFnStrictNoSign=Rc.msgIdFnStrictSign=void 0;var N$=(ps(),Ln);function k$(t){if(!t.from)throw Error("missing from field");if(!t.seqno)throw Error("missing seqno field");let e=new Uint8Array(t.from.length+t.seqno.length);return e.set(t.from,0),e.set(t.seqno,t.from.length),e}Rc.msgIdFnStrictSign=k$;async function L$(t){return N$.sha256.encode(t.data)}Rc.msgIdFnStrictNoSign=L$});var QD=b(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});Pc.computeAllPeersScoreWeights=Pc.computeScoreWeights=void 0;function YD(t,e,r,i,n){let s=0,a=new Map;if(Object.entries(e.topics).forEach(([h,p])=>{let d=n.get(h)??"unknown",y=r.topics[h];if(y===void 0)return;let g=a.get(d);g||(g={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},a.set(d,g));let m=0,w=0,C=0,V=0,T=0;p.inMesh&&(m+=Math.max(p.meshTime/y.timeInMeshQuantum,y.timeInMeshCap)*y.timeInMeshWeight);let A=p.firstMessageDeliveries;if(A>y.firstMessageDeliveriesCap&&(A=y.firstMessageDeliveriesCap),w+=A*y.firstMessageDeliveriesWeight,p.meshMessageDeliveriesActive&&p.meshMessageDeliveries<y.meshMessageDeliveriesThreshold){let $=y.meshMessageDeliveriesThreshold-p.meshMessageDeliveries;C+=$*$*y.meshMessageDeliveriesWeight}V+=p.meshFailurePenalty*y.meshFailurePenaltyWeight,T+=p.invalidMessageDeliveries*p.invalidMessageDeliveries*y.invalidMessageDeliveriesWeight,s+=(m+w+C+V+T)*y.topicWeight,g.p1w+=m,g.p2w+=w,g.p3w+=C,g.p3bw+=V,g.p4w+=T}),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;let h=r.topicScoreCap/s;for(let p of a.values())p.p1w*=h,p.p2w*=h,p.p3w*=h,p.p3bw*=h,p.p4w*=h}let o=0,c=0,u=0;return o+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(h=>{if(r.IPColocationFactorWhitelist.has(h))return;let p=i.get(h),d=p?p.size:0;if(d>r.IPColocationFactorThreshold){let y=d-r.IPColocationFactorThreshold;c+=y*y*r.IPColocationFactorWeight}}),u+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,s+=o+c+u,{byTopic:a,p5w:o,p6w:c,p7w:u,score:s}}Pc.computeScoreWeights=YD;function M$(t,e,r,i,n){let s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let a of t){let o=e.get(a);if(o){let c=YD(a,o,r,i,n);for(let[u,l]of c.byTopic){let f=s.byTopic.get(u);f||(f={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(u,f)),f.p1w.push(l.p1w),f.p2w.push(l.p2w),f.p3w.push(l.p3w),f.p3bw.push(l.p3bw),f.p4w.push(l.p4w)}s.p5w.push(c.p5w),s.p6w.push(c.p6w),s.p7w.push(c.p7w),s.score.push(c.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}Pc.computeAllPeersScoreWeights=M$});var X$=b(ci=>{"use strict";var q$=ci&&ci.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),U$=ci&&ci.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),F$=ci&&ci.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&q$(e,t,r);return U$(e,t),e},pl=ci&&ci.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ci,"__esModule",{value:!0});ci.multicodec=void 0;var K$=pl(kr()),V$=$B(),j$=pl(Tu()),Am=rr(),G$=pl(qe()),H$=pl(s8()),z$=pl(d8()),W$=E8(),XD=zg(),Te=F$(rl()),Wt=ih(),Tm=N8(),$$=L8(),Rm=q8(),Pm=rl(),Ir=U8(),$t=ja(),ZD=WD(),JD=$D(),Y$=QD(),Q$=Gg();ci.multicodec=Te.GossipsubIDv11;var oi;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(oi||(oi={}));var Bm=class extends V$.EventEmitter{constructor(e,r={}){super();this.peers=new Map,this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.multicodecs=[Te.GossipsubIDv11,Te.GossipsubIDv10],this.directPeerInitial=null,this.status={code:oi.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let n=this.metrics?.heartbeatDuration.startTimer();try{this.heartbeat()}catch(s){this.log("Error running heartbeat",s)}if(n&&n(),this.status.code===oi.started){clearTimeout(this.status.heartbeatTimeout);let s=(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;s<this.opts.heartbeatInterval*.25&&(s+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,s)}};let i={gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:Te.GossipsubD,Dlo:Te.GossipsubDlo,Dhi:Te.GossipsubDhi,Dscore:Te.GossipsubDscore,Dout:Te.GossipsubDout,Dlazy:Te.GossipsubDlazy,heartbeatInterval:Te.GossipsubHeartbeatInterval,fanoutTTL:Te.GossipsubFanoutTTL,mcacheLength:Te.GossipsubHistoryLength,mcacheGossip:Te.GossipsubHistoryGossip,seenTTL:Te.GossipsubSeenTTL,gossipsubIWantFollowupMs:Te.GossipsubIWantFollowupTime,...r,scoreParams:(0,Tm.createPeerScoreParams)(r.scoreParams),scoreThresholds:(0,Tm.createPeerScoreThresholds)(r.scoreThresholds)};if(this.globalSignaturePolicy=i.globalSignaturePolicy??$t.SignaturePolicy.StrictSign,this.publishConfig=(0,Q$.getPublishConfigFromPeerId)(this.globalSignaturePolicy,e.peerId),this.peerId=e.peerId,i.fallbackToFloodsub&&this.multicodecs.push(Te.FloodsubID),this.log=(0,G$.default)(i.debugName??"libp2p:gossipsub"),this.opts=i,this.direct=new Set(i.directPeers.map(n=>n.id.toB58String())),i.directPeers.forEach(n=>{e.peerStore.addressBook.add(n.id,n.addrs)}),this.seenCache=new Rm.SimpleTimeCache({validityMs:i.seenTTL}),this.publishedMessageIds=new Rm.SimpleTimeCache({validityMs:i.seenTTL}),this.mcache=r.messageCache||new W$.MessageCache(i.mcacheGossip,i.mcacheLength),r.msgIdFn)this.msgIdFn=r.msgIdFn;else switch(this.globalSignaturePolicy){case $t.SignaturePolicy.StrictSign:this.msgIdFn=JD.msgIdFnStrictSign;break;case $t.SignaturePolicy.StrictNoSign:this.msgIdFn=JD.msgIdFnStrictNoSign;break}if(r.fastMsgIdFn&&(this.fastMsgIdFn=r.fastMsgIdFn,this.fastMsgIdCache=new Rm.SimpleTimeCache({validityMs:i.seenTTL})),r.dataTransform&&(this.dataTransform=r.dataTransform),r.metricsRegister){if(!r.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let n=Math.max(...Object.values(i.scoreParams.topics).map(a=>a.meshMessageDeliveriesWindow),Te.DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS),s=(0,Ir.getMetrics)(r.metricsRegister,r.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:i.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:n/1e3});s.mcacheSize.addCollect(()=>this.onScrapeMetrics(s));for(let a of this.multicodecs)s.protocolsEnabled.set({protocol:a},1);this.metrics=s}else this.metrics=null;this.gossipTracer=new $$.IWantTracer(this.opts.gossipsubIWantFollowupMs,this.metrics),this._libp2p=e,this.registrar=e.registrar,this.score=new Tm.PeerScore(this.opts.scoreParams,e.connectionManager,this.metrics,{scoreCacheValidityMs:i.heartbeatInterval})}async start(){if(this.status.code===oi.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this.onIncomingStream.bind(this));let e=new H$.default({multicodecs:this.multicodecs,handlers:{onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}}),r=await this.registrar.register(e),i=setTimeout(this.runHeartbeat,Te.GossipsubHeartbeatInitialDelay);this.status={code:oi.started,registrarHandlerId:"TODO",registrarTopologyId:r,heartbeatTimeout:i,hearbeatStartMs:Date.now()+Te.GossipsubHeartbeatInitialDelay},this.log("started"),this.score.start(),this.directPeerInitial=setTimeout(()=>{this.direct.forEach(n=>{this.connect(n)})},Te.GossipsubDirectConnectInitialDelay)}async stop(){if(this.status.code!==oi.started)return;let{registrarTopologyId:e}=this.status;this.status={code:oi.stopped},this.registrar.unregister(e),this.log("stopping");for(let r of this.peers.values())r.close();this.peers.clear(),this.subscriptions.clear(),this.log("stopped"),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial)}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({protocol:e,stream:r,connection:i}){let n=i.remotePeer,a=this.addPeer(n,e,i.stat.direction).attachInboundStream(r);this.pipePeerReadStream(n,a).catch(o=>this.log(o))}async onPeerConnected(e,r){this.log("connected %s %s",e.toB58String(),r.stat.direction);try{let{stream:i,protocol:n}=await r.newStream(this.multicodecs);await this.addPeer(e,n,r.stat.direction).attachOutboundStream(i)}catch(i){this.log(i)}this.subscriptions.size>0&&this.sendSubscriptions(e.toB58String(),Array.from(this.subscriptions),!0)}onPeerDisconnected(e,r){let i=e.toB58String();this.log("connection ended",i,r),this.removePeer(e)}addPeer(e,r,i){let n=e.toB58String(),s=this.peers.get(n);return s===void 0&&(this.log("new peer %s",n),s=new z$.default({id:e,protocol:r}),this.peers.set(n,s),s.addListener("close",()=>this.removePeer(e))),this.score.addPeer(n),r===Te.FloodsubID&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:r},1),this.outbound.get(n)||this.outbound.set(n,i==="outbound"),s}removePeer(e){let r=e.toB58String(),i=this.peers.get(r);if(i!=null){this.metrics?.peersPerProtocol.inc({protocol:i.protocol},-1),this.log("delete peer %s",r),this.peers.delete(r),i.close();for(let n of this.topics.values())n.delete(r)}for(let[n,s]of this.mesh)s.delete(r)===!0&&this.metrics?.onRemoveFromMesh(n,Ir.ChurnReason.Dc,1);for(let n of this.fanout.values())n.delete(r);return this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r),i}get started(){return this.status.code===oi.started}getMeshPeers(e){let r=this.mesh.get(e);return r?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return r?Array.from(r):[]}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await(0,K$.default)(r,async i=>{for await(let n of i)try{let s=n instanceof Uint8Array?n:n.slice(),a=XD.RPC.decode(s);this.metrics?.onRpcRecv(a,s.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,a):this.handleReceivedRpc(e,a).catch(o=>this.log(o))}catch(s){this.log(s)}})}catch(i){this.onPeerDisconnected(e,i)}}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toB58String())){this.log("received message from unacceptable peer %s",e.toB58String()),this.metrics?.rpcRecvNotAccepted.inc();return}if(this.log("rpc from %s",e.toB58String()),r.subscriptions&&r.subscriptions.length>0&&(r.subscriptions.forEach(i=>{this.handleReceivedSubscription(e,i)}),this.emit("pubsub:subscription-change",e,r.subscriptions)),r.messages)for(let i of r.messages){let n=this.handleReceivedMessage(e,i).catch(s=>this.log(s));this.opts.awaitRpcMessageHandler&&await n}r.control&&await this.handleControlMessage(e.toB58String(),r.control)}handleReceivedSubscription(e,r){if(r.topicID==null)return;this.log("subscription update from %s topic %s",e.toB58String(),r.topicID);let i=this.topics.get(r.topicID);i==null&&(i=new Set,this.topics.set(r.topicID,i)),r.subscribe?i.add(e.toB58String()):i.delete(e.toB58String())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let i=await this.validateReceivedMessage(e,r);switch(this.metrics?.onMsgRecvResult(r.topic,i.code),i.code){case $t.MessageStatus.duplicate:this.score.duplicateMessage(e.toB58String(),i.msgId,r.topic),this.mcache.observeDuplicate(i.msgId,e.toB58String());return;case $t.MessageStatus.invalid:i.msgId?(this.score.rejectMessage(e.toB58String(),i.msgId,r.topic,i.reason),this.gossipTracer.rejectMessage(i.msgId,i.reason)):this.score.rejectInvalidMessage(e.toB58String(),r.topic),this.metrics?.onMsgRecvInvalid(r.topic,i);return;case $t.MessageStatus.valid:{let{msgIdStr:n,msg:s}=i;this.score.validateMessage(n),this.gossipTracer.deliverMessage(n),this.mcache.put(n,r),this.subscriptions.has(r.topic)&&(!(this.peerId!==void 0&&this.peerId.equals(e))||this.opts.emitSelf)&&(super.emit("gossipsub:message",{propagationSource:e,msgId:n,msg:s}),super.emit(r.topic,s)),this.opts.asyncValidation||this.forwardMessage(n,r,e.toB58String())}}}async validateReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let i=await(0,ZD.validateToRawMessage)(this.globalSignaturePolicy,r);if(!i.valid)return{code:$t.MessageStatus.invalid,reason:$t.RejectReason.Error,error:i.error};let n=this.fastMsgIdFn?.(r),s=n&&this.fastMsgIdCache?.get(n);if(s)return{code:$t.MessageStatus.duplicate,msgId:s};let a;try{let l=r.data??new Uint8Array(0);a=this.dataTransform?this.dataTransform.inboundTransform(r.topic,l):l}catch(l){return this.log("Invalid message, transform failed",l),{code:$t.MessageStatus.invalid,reason:$t.RejectReason.Error,error:$t.ValidateError.TransformFailed}}let o={from:r.from===null?void 0:r.from,data:a,seqno:r.seqno===null?void 0:r.seqno,topic:r.topic},c=s??(0,Wt.messageIdToString)(await this.msgIdFn(o));if(n&&this.fastMsgIdCache?.put(n,c),this.seenCache.has(c))return{code:$t.MessageStatus.duplicate,msgId:c};this.seenCache.put(c);let u=this.topicValidators.get(r.topic);if(u!=null){let l;try{l=await u(o.topic,o,e)}catch(f){let h=f.code;h===Te.ERR_TOPIC_VALIDATOR_IGNORE&&(l=$t.MessageAcceptance.Ignore),h===Te.ERR_TOPIC_VALIDATOR_REJECT?l=$t.MessageAcceptance.Reject:l=$t.MessageAcceptance.Ignore}if(l!==$t.MessageAcceptance.Accept)return{code:$t.MessageStatus.invalid,reason:(0,$t.rejectReasonFromAcceptance)(l),msgId:c}}return{code:$t.MessageStatus.valid,msgIdStr:c,msg:o}}sendSubscriptions(e,r,i){this.sendRpc(e,{subscriptions:r.map(n=>({topicID:n,subscribe:i})),messages:[]})}async handleControlMessage(e,r){if(r===void 0)return;let i=r.ihave?this.handleIHave(e,r.ihave):[],n=r.iwant?this.handleIWant(e,r.iwant):[],s=r.graft?await this.handleGraft(e,r.graft):[];r.prune&&this.handlePrune(e,r.prune),!(!i.length&&!n.length&&!s.length)&&this.sendRpc(e,(0,Wt.createGossipRpc)(n,{iwant:i,prune:s}))}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),i=this.acceptFromWhitelist.get(e);if(i&&i.messagesAccepted<Pm.ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&i.acceptUntil>=r)return i.messagesAccepted+=1,!0;let n=this.score.score(e);return n>=Pm.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+Pm.ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:Ir.IHaveIgnoreReason.LowScore}),[];let n=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,n),n>Te.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:Ir.IHaveIgnoreReason.MaxIhave}),[];let s=this.iasked.get(e)??0;if(s>=Te.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:Ir.IHaveIgnoreReason.MaxIasked}),[];let a=new Map;if(r.forEach(({topicID:u,messageIDs:l})=>{if(!u||!l||!this.mesh.has(u))return;let f=0;l.forEach(h=>{let p=(0,Wt.messageIdToString)(h);this.seenCache.has(p)||(a.set(p,h),f++)}),this.metrics?.onIhaveRcv(u,l.length,f)}),!a.size)return[];let o=a.size;o+s>Te.GossipsubMaxIHaveLength&&(o=Te.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",o,a.size,e);let c=Array.from(a.values());return(0,Wt.shuffle)(c),c=c.slice(0,o),this.iasked.set(e,s+o),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}handleIWant(e,r){if(!r.length)return[];let i=this.score.score(e);if(i<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map,s=new Map,a=0;return r.forEach(({messageIDs:o})=>{o&&o.forEach(c=>{let u=(0,Wt.messageIdToString)(c),l=this.mcache.getWithIWantCount(u,e);if(!l){a++;return}if(s.set(l.msg.topic,1+(s.get(l.msg.topic)??0)),l.count>Te.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,c);return}n.set(u,l.msg)})}),this.metrics?.onIwantRcv(s,a),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values())):[]}async handleGraft(e,r){let i=[],n=this.score.score(e),s=this._now(),a=this.opts.doPX;return r.forEach(({topicID:o})=>{if(!o)return;let c=this.mesh.get(o);if(!c){a=!1;return}if(c.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(o),a=!1;return}let u=this.backoff.get(o)?.get(e);if(typeof u=="number"&&s<u){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,Ir.ScorePenalty.GraftBackoff),a=!1;let l=u+Te.GossipsubGraftFloodThreshold-Te.GossipsubPruneBackoff;s<l&&this.score.addPenalty(e,1,Ir.ScorePenalty.GraftBackoff),this.addBackoff(e,o),i.push(o);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,o),i.push(o),a=!1,this.addBackoff(e,o);return}if(c.size>=this.opts.Dhi&&!this.outbound.get(e)){i.push(o),this.addBackoff(e,o);return}this.log("GRAFT: Add mesh link from %s in %s",e,o),this.score.graft(e,o),c.add(e),this.metrics?.onAddToMesh(o,Ir.InclusionReason.Subscribed,1)}),i.length?Promise.all(i.map(o=>this.makePrune(e,o,a))):[]}handlePrune(e,r){let i=this.score.score(e);r.forEach(({topicID:n,backoff:s,peers:a})=>{if(!n)return;let o=this.mesh.get(n);if(!!o&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),o.delete(e)===!0&&this.metrics?.onRemoveFromMesh(n,Ir.ChurnReason.Unsub,1),typeof s=="number"&&s>0?this.doAddBackoff(e,n,s*1e3):this.addBackoff(e,n),a&&a.length)){if(i<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this.pxConnect(a)}})}addBackoff(e,r){this.doAddBackoff(e,r,Te.GossipsubPruneBackoff)}doAddBackoff(e,r,i){let n=this.backoff.get(r);n||(n=new Map,this.backoff.set(r,n));let s=this._now()+i;(n.get(e)??0)<s&&n.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,Ir.ScorePenalty.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%Te.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((r,i)=>{r.forEach((n,s)=>{n<e&&r.delete(s)}),r.size===0&&this.backoff.delete(i)})}directConnect(){let e=[];this.direct.forEach(r=>{let i=this.peers.get(r);(!i||!i.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this.connect(r)})}async pxConnect(e){e.length>Te.GossipsubPrunePeers&&((0,Wt.shuffle)(e),e=e.slice(0,Te.GossipsubPrunePeers));let r=[];await Promise.all(e.map(async i=>{if(!i.peerID)return;let s=(0,Am.createFromBytes)(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){r.push(s);return}try{let a=await j$.default.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),o=a.peerId.toB58String();if(s!==o){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",o,s);return}if(!await this._libp2p.peerStore.addressBook.consumePeerRecord(a)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch(a){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),!!r.length&&r.forEach(i=>this.connect(i))}connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol((0,Am.createFromB58String)(e),this.multicodecs)}subscribe(e){if(this.status.code!==oi.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==oi.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let i of this.peers.keys())this.sendSubscriptions(i,[e],!1);this.leave(e)}join(e){if(this.status.code!==oi.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,i=this.fanout.get(e);if(i&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),i.forEach(n=>{!this.direct.has(n)&&this.score.score(n)>=0&&r.add(n)}),this.metrics?.onAddToMesh(e,Ir.InclusionReason.Fanout,r.size)),r.size<this.opts.D){let n=r.size;this.getRandomGossipPeers(e,this.opts.D,a=>!r.has(a)&&!this.direct.has(a)&&this.score.score(a)>=0).forEach(a=>{r.add(a)}),this.metrics?.onAddToMesh(e,Ir.InclusionReason.Random,r.size-n)}this.mesh.set(e,r),this.mesh.get(e).forEach(n=>{this.log("JOIN: Add mesh link to %s in %s",n,e),this.sendGraft(n,e)})}leave(e){if(this.status.code!==oi.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r&&(r.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this.sendPrune(i,e)}),this.mesh.delete(e))}selectPeersToForward(e,r,i){let n=new Set,s=this.topics.get(e);s&&(this.direct.forEach(o=>{s.has(o)&&r!==o&&!i?.has(o)&&n.add(o)}),this.floodsubPeers.forEach(o=>{s.has(o)&&r!==o&&!i?.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&n.add(o)}));let a=this.mesh.get(e);return a&&a.size>0&&a.forEach(o=>{r!==o&&!i?.has(o)&&n.add(o)}),n}selectPeersToPublish(e){let r=new Set,i={direct:0,floodsub:0,mesh:0,fanout:0},n=this.topics.get(e);if(n)if(this.opts.floodPublish)n.forEach(s=>{this.direct.has(s)?(r.add(s),i.direct++):this.score.score(s)>=this.opts.scoreThresholds.publishThreshold&&(r.add(s),i.floodsub++)});else{this.direct.forEach(a=>{n.has(a)&&(r.add(a),i.direct++)}),this.floodsubPeers.forEach(a=>{n.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&(r.add(a),i.floodsub++)});let s=this.mesh.get(e);if(s&&s.size>0)s.forEach(a=>{r.add(a),i.mesh++});else{let a=this.fanout.get(e);if(a&&a.size>0)a.forEach(o=>{r.add(o),i.fanout++});else{let o=this.getRandomGossipPeers(e,this.opts.D,c=>this.score.score(c)>=this.opts.scoreThresholds.publishThreshold);o.size>0&&(this.fanout.set(e,o),o.forEach(c=>{r.add(c),i.fanout++}))}this.fanoutLastpub.set(e,this._now())}}return{tosend:r,tosendCount:i}}forwardMessage(e,r,i,n){i&&this.score.deliverMessage(i,e,r.topic);let s=this.selectPeersToForward(r.topic,i,n),a=(0,Wt.createGossipRpc)([r]);s.forEach(o=>{this.sendRpc(o,a)}),this.metrics?.onForwardMsg(r.topic,s.size)}async publish(e,r){let i=this.dataTransform?this.dataTransform.outboundTransform(e,r):r,n=await(0,ZD.buildRawMessage)(this.publishConfig,e,i),s={from:n.from===null?void 0:n.from,data:r,seqno:n.seqno===null?void 0:n.seqno,topic:e},a=await this.msgIdFn(s),o=(0,Wt.messageIdToString)(a);if(this.seenCache.has(o))throw Error("PublishError.Duplicate");let{tosend:c,tosendCount:u}=this.selectPeersToPublish(n.topic);if(c.size===0&&!this.opts.allowPublishToZeroPeers)throw Error("PublishError.InsufficientPeers");this.seenCache.put(o),this.mcache.put(o,n),this.publishedMessageIds.put(o);let l=(0,Wt.createGossipRpc)([n]);c.forEach(f=>{this.sendRpc(f,l)}),this.metrics?.onPublishMsg(e,u,c.size,n.data?n.data.length:0),this.opts.emitSelf&&this.subscriptions.has(e)&&(super.emit("gossipsub:message",{propagationSource:this.peerId.toB58String(),msgId:o,msg:s}),super.emit(e,s))}reportMessageValidationResult(e,r,i){if(i===$t.MessageAcceptance.Accept){let n=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(n!==null),n){let{message:s,originatingPeers:a}=n;this.score.deliverMessage(r.toB58String(),e,s.topic),this.forwardMessage(e,n.message,r.toB58String(),a),this.metrics?.onReportValidation(s.topic,i)}}else{let n=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(n!==null),n){let s=(0,$t.rejectReasonFromAcceptance)(i),{message:a,originatingPeers:o}=n;this.score.rejectMessage(r.toB58String(),e,a.topic,s);for(let c of o)this.score.rejectMessage(c,e,a.topic,s);this.metrics?.onReportValidation(a.topic,i)}}}sendGraft(e,r){let i=[{topicID:r}],n=(0,Wt.createGossipRpc)([],{graft:i});this.sendRpc(e,n)}async sendPrune(e,r){let i=[await this.makePrune(e,r,this.opts.doPX)],n=(0,Wt.createGossipRpc)([],{prune:i});this.sendRpc(e,n)}sendRpc(e,r){let i=this.peers.get(e);if(!i||!i.isWritable){this.log(`Cannot send RPC to ${e} as there is no open stream to it available`);return}let n=this.control.get(e);n&&(this.piggybackControl(e,r,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this.piggybackGossip(e,r,s),this.gossip.delete(e));let a=XD.RPC.encode(r).finish();i.write(a),this.metrics?.onRpcSent(r,a.length)}piggybackControl(e,r,i){let n=(i.graft||[]).filter(({topicID:a})=>(a&&this.mesh.get(a)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:a})=>!(a&&this.mesh.get(a)||new Set).has(e));!n.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(n),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:n,prune:s})}piggybackGossip(e,r,i){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=i}async sendGraftPrune(e,r,i){let n=this.opts.doPX;for(let[s,a]of e){let o=a.map(f=>({topicID:f})),c=[],u=r.get(s);u&&(c=await Promise.all(u.map(f=>this.makePrune(s,f,n&&!i.get(s)))),r.delete(s));let l=(0,Wt.createGossipRpc)([],{graft:o,prune:c});this.sendRpc(s,l)}for(let[s,a]of r){let o=await Promise.all(a.map(u=>this.makePrune(s,u,n&&!i.get(s)))),c=(0,Wt.createGossipRpc)([],{prune:o});this.sendRpc(s,c)}}emitGossip(e,r){let i=this.mcache.getGossipIDs(e);if(!i.length)return;(0,Wt.shuffle)(i),i.length>Te.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!r.has(c)&&!this.direct.has(c)&&(0,Wt.hasGossipProtocol)(u.protocol)&&this.score.score(c)>=this.opts.scoreThresholds.gossipThreshold&&n.push(c)});let a=this.opts.Dlazy,o=Te.GossipsubGossipFactor*n.length;o>a&&(a=o),a>n.length?a=n.length:(0,Wt.shuffle)(n),n.slice(0,a).forEach(c=>{let u=i;i.length>Te.GossipsubMaxIHaveLength&&(u=(0,Wt.shuffle)(u.slice()).slice(0,Te.GossipsubMaxIHaveLength)),this.pushGossip(c,{topicID:e,messageIDs:u})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,(0,Wt.createGossipRpc)([],{ihave:r}));for(let[e,r]of this.control.entries())this.control.delete(e),this.sendRpc(e,(0,Wt.createGossipRpc)([],{graft:r.graft,prune:r.prune}))}pushGossip(e,r){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(r))}_now(){return Date.now()}async makePrune(e,r,i){if(this.peers.get(e).protocol===Te.GossipsubIDv10)return{topicID:r,peers:[]};let n=Te.GossipsubPruneBackoff/1e3;if(!i)return{topicID:r,peers:[],backoff:n};let s=this.getRandomGossipPeers(r,Te.GossipsubPrunePeers,o=>o!==e&&this.score.score(o)>=0),a=await Promise.all(Array.from(s).map(async o=>{let c=(0,Am.createFromB58String)(o);return{peerID:c.toBytes(),signedPeerRecord:await this._libp2p.peerStore.addressBook.getRawEnvelope(c)}}));return{topicID:r,peers:a,backoff:n}}heartbeat(){let{D:e,Dlo:r,Dhi:i,Dscore:n,Dout:s,fanoutTTL:a}=this.opts;this.heartbeatTicks++;let o=new Map,c=p=>{let d=o.get(p);return d===void 0&&(d=this.score.score(p),o.set(p,d)),d},u=new Map,l=new Map,f=new Map;this.clearBackoff(),this.peerhave.clear(),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%Te.GossipsubDirectConnectTicks==0&&this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune(),this.mesh.forEach((p,d)=>{let y=(m,w)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",m,d),this.score.prune(m,d),this.addBackoff(m,d),p.delete(m),this.metrics?.onRemoveFromMesh(d,w,1);let C=l.get(m);C?C.push(d):l.set(m,[d])},g=(m,w)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",m,d),this.score.graft(m,d),p.add(m),this.metrics?.onAddToMesh(d,w,1);let C=u.get(m);C?C.push(d):u.set(m,[d])};if(p.forEach(m=>{let w=c(m);w<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",m,w,d),y(m,Ir.ChurnReason.BadScore),f.set(m,!0))}),p.size<r){let m=this.backoff.get(d),w=e-p.size;this.getRandomGossipPeers(d,w,V=>!p.has(V)&&!this.direct.has(V)&&(!m||!m.has(V))&&c(V)>=0).forEach(V=>g(V,Ir.InclusionReason.NotEnough))}if(p.size>i){let m=Array.from(p);m.sort((C,V)=>c(V)-c(C)),m=m.slice(0,n).concat((0,Wt.shuffle)(m.slice(n)));let w=0;if(m.slice(0,e).forEach(C=>{this.outbound.get(C)&&w++}),w<s){let C=T=>{let A=m[T];for(let te=T;te>0;te--)m[te]=m[te-1];m[0]=A};if(w>0){let T=w;for(let A=1;A<e&&T>0;A++)this.outbound.get(m[A])&&(C(A),T--)}let V=e-w;for(let T=e;T<m.length&&V>0;T++)this.outbound.get(m[T])&&(C(T),V--)}m.slice(e).forEach(C=>y(C,Ir.ChurnReason.Excess))}if(p.size>=r){let m=0;if(p.forEach(w=>{this.outbound.get(w)&&m++}),m<s){let w=s-m,C=this.backoff.get(d);this.getRandomGossipPeers(d,w,T=>!p.has(T)&&!this.direct.has(T)&&(!C||!C.has(T))&&c(T)>=0).forEach(T=>g(T,Ir.InclusionReason.Outbound))}}if(this.heartbeatTicks%Te.GossipsubOpportunisticGraftTicks==0&&p.size>1){let m=Array.from(p).sort((V,T)=>c(V)-c(T)),w=Math.floor(p.size/2),C=c(m[w]);if(C<this.opts.scoreThresholds.opportunisticGraftThreshold){let V=this.backoff.get(d);this.getRandomGossipPeers(d,Te.GossipsubOpportunisticGraftPeers,A=>p.has(A)&&!this.direct.has(A)&&(!V||!V.has(A))&&c(A)>C).forEach(A=>{this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",A,d),g(A,Ir.InclusionReason.Opportunistic)})}}this.emitGossip(d,p)});let h=this._now();this.fanoutLastpub.forEach((p,d)=>{p+a<h&&(this.fanout.delete(d),this.fanoutLastpub.delete(d))}),this.fanout.forEach((p,d)=>{let y=this.topics.get(d);if(p.forEach(g=>{(!y.has(g)||c(g)<this.opts.scoreThresholds.publishThreshold)&&p.delete(g)}),p.size<e){let g=e-p.size;this.getRandomGossipPeers(d,g,w=>!p.has(w)&&!this.direct.has(w)&&c(w)>=this.opts.scoreThresholds.publishThreshold).forEach(w=>{p.add(w)})}this.emitGossip(d,p)}),this.sendGraftPrune(u,l,f),this.flush(),this.mcache.shift(),this.emit("gossipsub:heartbeat")}getRandomGossipPeers(e,r,i=()=>!0){let n=this.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(a=>{let o=this.peers.get(a);!o||(0,Wt.hasGossipProtocol)(o.protocol)&&i(a)&&s.push(a)}),s=(0,Wt.shuffle)(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"iasked"},this.iasked.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0;for(let a of this.backoff.values())r+=a.size;e.cacheSize.set({cache:"backoff"},r);for(let[a,o]of this.topics)e.topicPeersCount.set({topicStr:a},o.size);for(let[a,o]of this.mesh)e.meshPeerCounts.set({topicStr:a},o.size);let i=[],n=new Map;e.behaviourPenalty.reset();for(let a of this.peers.keys()){let o=this.score.score(a);i.push(o),n.set(a,o),e.behaviourPenalty.observe(this.score.peerStats.get(a)?.behaviourPenalty??0)}e.registerScores(i,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,n);let s=(0,Y$.computeAllPeersScoreWeights)(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}};ci.default=Bm;Bm.multicodec=Te.GossipsubIDv11});return X$();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
return Libp2pGossipsub}));
